"use strict";(self.webpackChunk_postman_app_renderer=self.webpackChunk_postman_app_renderer||[]).push([[42],{"../../packages/api-observability/live-collections/src/utils/compare.js":function(e,t,i){i.r(t),i.d(t,{compare:function(){return b},compareNode:function(){return y},compareNodeReordering:function(){return v},computeArrayDiff:function(){return f},computeBasicDiff:function(){return m},computePropertyDiff:function(){return g},getLabel:function(){return h}});var n=i("../../node_modules/lodash/lodash.js"),o=i.n(n),s=i("../../packages/api-observability/live-collections/src/constants/diff.ts"),a=i("../../packages/version-control/change-management/index.ts");const{ORDER:l,TEXT:r,SELECTION:c,TABLE:d,COLLECTION_AUTH:p,COLLECTION_REQUEST_BODY:u}=s.DIFF_TYPES;function m(e,t,i){let n=o().get(i,"diff.type"),s=null;return n===c?s=a.selection.diff(e,t,o().get(i,"diff",{})).diffs:n===r?s=a.text.diff(e,t,i.diff).diffs:n===u?(s=a.collectionDiffHelpers.computeCollectionRequestBodyDiff(e,t).diffs,n="selection-and-config"):n===p&&(s=a.collectionDiffHelpers.computeCollectionAuthDiff(e,t).diffs,n="selection-and-config"),n===r&&"line"===i.diff.granularity&&(n="line"),s?{diff:s,type:n}:null}function f(e,t,i){const n=o().get(i,"primary.diff.type"),s=o().get(i,"primary.diff.keys"),l=o().get(i,"primary.diff.conceal"),r=o().get(i,"primary.diff.colsMeta"),c=o().get(i,"primary.diff.uniqueKey"),p=o().transform(o().get(i,"items.0"),((e,t,i)=>{t&&(e[i]=t.diff)}),{});if(n!==d)throw new Error(`${n} is not a valid diff type.`);const u=a.table.diff(e,t,{keys:s,diffSchema:p,conceal:l,colsMeta:r,uniqueKey:c}).diffs;return u?{diff:u,diffType:n}:null}function h(e,t){const i=o().get(e,"display.label"),n=o().get(e,"primary.display.label");let s=null,a=t||"";return o().includes(t,".")?(a=o().last(o().split(t,".")),s=a.charAt(0).toUpperCase()+a.slice(1)):s=a.charAt(0).toUpperCase()+a.slice(1),i||n||s}function g(e,t,i,n){if(!n)return null;let s=null;if(o().has(n,"diff")?s="basic":o().has(n,"primary")&&(s="array"),"basic"===s){const o=m(e,t,n);return o?{label:h(n,i),pathId:i,diffType:o.type,diff:o.diff}:null}if("array"===s){const o=f(e,t,n);return o?{label:h(n,i),pathId:i,diffType:o.diffType,diff:o.diff}:null}return null}function y(e,t){const{options:i}=t,n=e&&e.value,s=t&&t.value,a=new Map;for(const e of o().keys(i)){const t=i[e],l=o().get(n,e),r=o().get(s,e);if(!t)continue;const c=g(l,r,e,t);c&&a.set(e,c)}return a.size?a:null}function v(e,t,i){const n=new Set(e),o=new Set(t);for(const e of i.values())n.delete(e),o.delete(e);return a.order.diff(Array.from(n),Array.from(o)).diffs?{diff:a.order.diff(e,t).diffs,previousOrder:n,currentOrder:o}:{diff:null,previousOrder:n,currentOrder:o}}function b(e,t){const i=new Map,n=new Set([...t.keys(),...e.keys()]),a=new Map;for(const l of n){const n=e.get(l),r=n&&n.parentRef,c=t.get(l),d=c&&c.parentRef;if(n&&c&&o().isEqual(r,d)){o().last(n.path).index!==o().last(c.path).index&&d&&!a.has(d.id)&&a.set(d.id,new Set)}if(!c&&n){if(i.set(l,{operations:[s.ENTITY_OPERATIONS.REMOVE],entity:n.type,type:s.ENTITY_DATA_REPRESENTATION_TYPE_MAP[n.type]||n.type,icon:n.icon,label:n.name,id:n.id,previousPath:n.path,currentPath:null,changedAttributes:null}),r){const e=a.get(r.id);e?e.add(l):a.set(r.id,new Set([l]))}continue}const p=y(n,c);if(c&&n&&!c.hasSameParent(n)){if(i.set(l,{operations:[s.ENTITY_OPERATIONS.MOVE],entity:c.type,type:s.ENTITY_DATA_REPRESENTATION_TYPE_MAP[c.type]||c.type,icon:c.icon,label:c.name,id:c.id,previousPath:n.path,currentPath:c.path,changedAttributes:null}),r){const e=a.get(r.id);e?e.add(l):a.set(r.id,new Set([l]))}if(d){const e=a.get(d.id);e?e.add(l):a.set(d.id,new Set([l]))}}else if(n||!c)p&&i.set(l,{operations:[s.ENTITY_OPERATIONS.MODIFY],entity:c.type,type:s.ENTITY_DATA_REPRESENTATION_TYPE_MAP[c.type]||c.type,icon:c.icon,label:c.name,id:c.id,previousPath:n.path,currentPath:c.path,changedAttributes:p});else if(i.set(l,{operations:[s.ENTITY_OPERATIONS.ADD],entity:c.type,type:s.ENTITY_DATA_REPRESENTATION_TYPE_MAP[c.type]||c.type,icon:c.icon,label:c.name,id:c.id,changedAttributes:p,previousPath:null,currentPath:c.path}),d){const e=a.get(d.id);e?e.add(l):a.set(d.id,new Set([l]))}}for(const[n,r]of a.entries()){const a=e.get(n),c=t.get(n);if(!a||!c)continue;const d=new Set([...a.getChildrenKeys(),...c.getChildrenKeys()]);for(const e of d){const t=i.get(n),d=t&&t.changedAttributes,p=a.getChildrenOrder(e),u=c.getChildrenOrder(e),{previousOrder:m,currentOrder:f,diff:g}=v(p,u,r),y=g&&{label:h(c.childrenNodeOptions[e],e)||"Children Order",pathId:e,diffType:l,diff:g,childrenReordering:!0}||null;y&&t?(d?d.set(e,y):o().set(t,"changedAttributes",new Map([[e,y]])),!o().includes(t.operations,s.ENTITY_OPERATIONS.MODIFY)&&t.operations.push(s.ENTITY_OPERATIONS.MODIFY)):y&&!t&&i.set(n,{operations:[s.ENTITY_OPERATIONS.MODIFY],entity:c.type,type:s.ENTITY_DATA_REPRESENTATION_TYPE_MAP[c.type]||c.type,icon:c.icon,label:c.name,id:c.id,previousPath:a.path,currentPath:c.path,changedAttributes:new Map([[e,y]])}),g&&(a.setNonSideEffectChildren(e,m),c.setNonSideEffectChildren(e,f))}}return i}},"../../packages/api-observability/live-collections/src/utils/diff-utils.js":function(e,t,i){i.r(t),i.d(t,{calculateChunkMidIndex:function(){return g},calculateItemHeaderDiffCount:function(){return c},calculateItemPropertyDiffCount:function(){return r},parseCollectionDiff:function(){return m}});var n=i("../../packages/api-observability/live-collections/src/utils/pmDiffV2.js"),o=i("../../packages/api-observability/live-collections/src/utils/compare.js"),s=i("./runtime-repl/_common/uid-helper.ts"),a=i("./runtime-repl/request-http/_api/RequestStoreV2.js"),l=i("../../node_modules/lodash/lodash.js");function r(e){return l.isEmpty(e)?0:"response"!==e.itemType?1:l.size(e.diff)||1}function c(e,t){let i=0,n=0;return i=l.reduce(e[t].meta.responses,((t,i)=>t+r(e[i])),0),n=l.size(e[t].diff),"modified"!==e[t].type&&0===e[t].diff.length&&n++,n+i}function d(e,t,i){if(!i)return[];const n=[],{from:s=[],to:a=[]}=i,r={diff:{type:"text",granularity:"char"}},c=l.differenceBy(a,s,(e=>e.key)),d=l.differenceBy(s,a,(e=>e.key)),p=l.intersectionBy(s,a,(e=>e.key));return c.forEach((i=>{const s="added";n.push({description:f(t,s),uiDiff:(0,o.computePropertyDiff)("",i.key,e,r),payload:i,type:s})})),d.forEach((i=>{const s="deleted";n.push({description:f(t,s),uiDiff:(0,o.computePropertyDiff)(i.key,"",e,r),payload:i,type:s})})),p.forEach((e=>{n.push({description:"",uiDiff:null,payload:e,type:"unchanged"})})),n}function p(e,t){const{item:i,itemType:o,type:s,itemId:a}=e,l=(0,n.default)(o,s,i.diff||i),r=[];return l.forEach((e=>{var i,n;const l=null===(i=t.diff[o].update)||void 0===i||null===(n=i.objs)||void 0===n?void 0:n[a],c=l?l.diff[e.pathId]:null;r.push({name:e.pathId,friendlyName:e.label,uiDiff:e,children:d(e.pathId,e.label,c),description:h(s,e.label),payload:c?c.to:null,type:s})})),r}function u(e,t){const i=[];return e.forEach((e=>{var n,o;let s,a=null==e?void 0:e.id;s=null===(n=t.diff.response.create.objs)||void 0===n?void 0:n[a],s&&i.push({itemId:a,itemType:"response",method:null,name:s.name,type:"added",attributes:p({itemId:a,item:s,itemType:"response",type:"added"},t),payload:s,responses:[]}),s=null===(o=t.diff.response.update.objs)||void 0===o?void 0:o[a],s&&i.push({itemId:a,itemType:"response",method:null,name:s.name,type:"modified",attributes:p({itemId:a,item:s,itemType:"response",type:"modified"},t),responses:[],payload:null})})),i}async function m(e,t){var i,n;const o=[],r=(null===(i=e.diff.request.create)||void 0===i?void 0:i.objs)||{},c=[];Object.keys(r).forEach((t=>{const i=r[t];c[t]=!0,o.push({itemId:t,name:i.name,itemType:"request",method:i.method,type:"added",attributes:p({itemId:t,item:i,itemType:"request",type:"added"},e),responses:u(null==i?void 0:i.responses,e),payload:i})}));const d=l.reduce(l.keys(null===(n=e.diff.response.create)||void 0===n?void 0:n.objs),((t,i)=>{var n;const o=null===(n=e.diff.response.create)||void 0===n?void 0:n.objs[i];return c[o.request]||(t[o.request]?t[o.request].push(o):t[o.request]=[o]),t}),{}),m=await(async(e,t)=>{const i={};if(l.isEmpty(e))return{};for(const n of e){const e=(0,s.decomposeUID)(t).owner||"",o=(0,s.composeUID)(n,e),l=await(0,a.getOne)(o,t,{exclude:"response"});i[n]=l}return i})(l.keys(d),t);return l.forEach(l.keys(d),(t=>{const i=m[t];var n;o.push({itemId:t,name:i.name,itemType:"request",method:i.method,type:"modified",responses:u(d[t],e),payload:i,folderPath:(n=i.path,n.filter((e=>"folder"===e.type)).map((e=>e.name)))})})),o}function f(e,t){return"added"===t?`Add required ${l.lowerCase(e)}`:"modified"===t?`Modify required ${l.lowerCase(e)}`:"deleted"===t?`Remove ${l.lowerCase(e)}`:""}function h(e="destroyed",t){const i={"path variables":"don't",headers:"don't","response headers":"don't","query params":"don't"};switch(e){case"added":return`Additional ${t} found in schema`;case"modified":return`${l.capitalize(t)} ${i[t]||"doesn't"} match schema`;case"deleted":return`${l.capitalize(t)} not found in schema. Selecting this change will remove this       ${t} from collection.`;case"destroyed":return`${l.capitalize(t)} not found in schema`;default:return""}}const g=e=>{if(l.size(e)<3)return{start:0,end:l.size(e)-1};const t=l.floor(l.size(e)/2);return{start:t-1,end:t+1}}},"../../packages/api-observability/live-collections/src/utils/pmDiffV2.js":function(e,t,i){i.r(t),i.d(t,{default:function(){return a}});var n=i("../../packages/api-observability/live-collections/src/utils/compare.js"),o=i("../../packages/api-observability/live-collections/src/constants/diff-configs.ts"),s=i("../../node_modules/lodash/lodash.js");function a(e,t,i){return Object.keys(i).map((e=>s.isEmpty(s.get(i,[e]))?null:{property:e,diff:i[e]})).map((i=>{var s,a;if(!i)return null;const l=i&&i.property;let r=o.default[e][l];if("table"===(null===(s=r)||void 0===s||null===(a=s.diff)||void 0===a?void 0:a.type)&&(r={primary:{...r}}),"modified"===t){const e=i.diff.from,t=i.diff.to;return(0,n.computePropertyDiff)(e,t,l,r)}{const e=Array.isArray(i.diff)?[]:null,t=i.diff;return(0,n.computePropertyDiff)(e,t,l,r)}})).filter(Boolean)}},"./js/utils/Collapsible.js":function(e,t,i){i.r(t),i.d(t,{default:function(){return l},toggleable:function(){return a}});var n=i("../../node_modules/react/index.js"),o=i("./node_modules/lodash/lodash.js");function s(){return s=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},s.apply(this,arguments)}function a(e,t={}){return class extends n.Component{constructor(e){super(e),this.state=t,this.methods={};for(let e of Object.keys(this.state))this.methods[`toggle${o.capitalize(e)}`]=()=>{this.state.hasOwnProperty(e)&&this.setState({[e]:!this.state[e]})}}render(){return n.createElement(e,s({},this.props,this.state,this.methods))}}}function l(e,t=!0){return a(e,{expanded:t})}},"../../packages/api-observability/live-collections/src/components/context-bar/LiveCollectionContextBar.tsx":function(e,t,i){i.r(t);var n=i("../../node_modules/react/index.js"),o=i("../../node_modules/@postman/aether/esmLib/src/components/Flex/Flex.js"),s=i("../../node_modules/@postman/aether/esmLib/src/components/Spinner/Spinner.js"),a=i("../../node_modules/@postman/aether/esmLib/src/components/Toast/withToast.js"),l=i("./appsdk/contextbar/ContextBarViewHeader.js"),r=i("../../node_modules/mobx-react/dist/mobx-react.module.js"),c=i("../../packages/api-observability/live-collections/src/components/live-settings/index.tsx"),d=i("./js/stores/StoreManager.js"),p=i("./js/stores/LiveCollectionStore.js"),u=function(e,t,i,n){var o,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(s<3?o(a):s>3?o(t,i,a):o(t,i))||a);return s>3&&a&&Object.defineProperty(t,i,a),a};let m=class extends n.Component{constructor(e){super(e)}render(){const e=(0,d.resolveStoreInstance)(p.default);if(!e.isLoaded)return n.createElement(o.default,{alignItems:"center",justifyContent:"center",height:"100%"},n.createElement(s.default,null));const t=this.props.contextData.modelId,i=!!e.get(t);return n.createElement(n.Fragment,null,n.createElement(l.ContextBarViewHeader,{onClose:this.props.onClose,title:"Live Collection"}),i?n.createElement(c.LiveSettingsContainer,{collectionId:t}):n.createElement(c.EmptyState,{collectionId:t}))}};m=u([r.observer],m),t.default=(0,a.default)(m)},"../../packages/api-observability/live-collections/src/components/diff-view/DiffContent.tsx":function(e,t,i){i.r(t),i.d(t,{DiffItemDescription:function(){return D},DiffItemLabel:function(){return L},DiffItemSection:function(){return R},DiffItemTitle:function(){return P},FolderBreadcrumbs:function(){return _},default:function(){return K}});var n=i("../../node_modules/react/index.js"),o=i("../../node_modules/@postman/aether/esmLib/src/components/Flex/Flex.js"),s=i("../../node_modules/@postman/aether/esmLib/src/components/Button/Button.js"),a=i("../../node_modules/@postman/aether/esmLib/src/components/Text/Text.js"),l=i("../../node_modules/@postman/aether/esmLib/src/components/Tooltip/Tooltip.js"),r=i("../../node_modules/@postman/aether/esmLib/src/components/Heading/Heading.js"),c=i("../../node_modules/@postman/aether/esmLib/src/components/Badge/Badge.js"),d=i("../../node_modules/styled-components/dist/styled-components.browser.esm.js"),p=i("./runtime-repl/request-http/RequestIcon.js"),u=i("./js/utils/Collapsible.js"),m=i("../../node_modules/@postman/aether-icons/esmLib/src/design-system-icons/icon-entity-example-stroke.js"),f=i("../../node_modules/@postman/aether-icons/esmLib/src/design-system-icons/icon-entity-folder-stroke.js"),h=i("../../node_modules/@postman/aether-icons/esmLib/src/design-system-icons/icon-direction-down.js"),g=i("../../node_modules/@postman/aether-icons/esmLib/src/design-system-icons/icon-direction-right.js"),y=i("../../packages/version-control/diff-components/index.ts"),v=i("../../packages/api-observability/live-collections/src/utils/diff-utils.js"),b=i("../../packages/api-observability/live-collections/src/services/pub-sub/Diff.ts"),E=i("../../packages/api-observability/live-collections/src/utils/diffView.ts"),x=i("../../node_modules/lodash/lodash.js");const S=(0,d.default)(o.default)`
  padding-left: var(--spacing-xxl) !important;
  margin-left: var(--spacing-s);
  max-height: ${({expanded:e})=>e?"auto":"0px"};
  opacity: ${({expanded:e})=>e?1:0};
  overflow: hidden;
  transition: all 0.1s;
`,I=(0,d.default)(o.default)`
  max-height: ${({expanded:e})=>e?"auto":"0px"};
  opacity: ${({expanded:e})=>e?1:0};
  overflow: hidden;
  transition: all 0.1s;
`,k=(0,d.default)(s.default)`
  height: fit-content;
  background-color: transparent !important;
  padding-left: var(--spacing-zero);
  padding-right: var(--spacing-zero);
`,C=(0,d.default)(m.default)`
  margin-left: var(--spacing-xs);
`,T=(0,d.default)(p.default)`
  margin-left: var(--spacing-xs);
  display: inline;
  font-size: var(--text-size-m);
  font-weight: var(--text-weight-medium);
`,j=(0,d.default)(o.default)`
  padding-top: var(--spacing-xl);
`,w=(0,d.default)(o.default)`
  background: var(--background-color-secondary);
  border-radius: 4px;
  &.expanded {
    border-radius: 4px 4px 0px 0px;
  }
`;function L(e){return"request"===e.itemType?n.createElement(T,{method:e.method||""}):n.createElement(C,null)}function _(e){if(x.isEmpty(e.items))return null;const t=e.items.length>2,i=(0,n.useRef)(null);return n.createElement(n.Fragment,null,n.createElement("span",{ref:i},n.createElement(o.default,{alignItems:"center",gap:"spacing-xs",justifyContent:"end"},n.createElement(f.default,{size:"small"}),n.createElement(a.default,{isTruncated:!0,type:"body-medium"},(()=>{const i=[...e.items];if(!t)return i;if(i.splice(1,i.length-2),i.splice(1,0,"..."),x.size(x.last(i))>5){const e=x.last(i);i[x.size(i)-1]=`${e.substring(0,5)}...`}return i})().join(" / ")))),t&&n.createElement(l.default,{content:e.items.join(" / "),triggerRef:i}))}function P(e){return n.createElement(w,{padding:"spacing-m",className:e.expanded?"expanded":"",justifyContent:"space-between",alignItems:"center",gap:"spacing-xs",border:e.expanded&&{borderBottom:"border-width-default"}},n.createElement(o.default,{gap:"spacing-xs",alignItems:"center",width:"70%"},e.canExpand&&n.createElement(k,{"data-testid":"item-toggle-icon",type:"tertiary",onClick:e.onExpand,size:"small",icon:e.expanded?n.createElement(h.default,null):n.createElement(g.default,null)}),!e.canExpand&&!e.showCheckbox&&n.createElement(o.default,{padding:{paddingLeft:"spacing-l"}}),n.createElement(L,{method:e.diffItem.method,itemType:e.diffItem.itemType}),n.createElement(r.default,{"data-testid":"item-heading",isTruncated:!0,type:"h5",text:e.diffItem.name}),"added"===e.diffItem.type&&n.createElement(c.default,{"data-testid":"item-modification-badge",status:"success",text:"Add",type:"light"}),"modified"===e.diffItem.type&&n.createElement(c.default,{"data-testid":"item-modification-badge",status:"neutral",text:"Modify",type:"light"}),"deleted"===e.diffItem.type&&n.createElement(c.default,{"data-testid":"item-modification-badge",status:"critical",text:"Remove",type:"light"})),n.createElement(_,{items:e.diffItem.folderPath}))}const A=(0,u.default)((e=>{const t=t=>{const{uniqueScrollIds:i,currentScrollIterator:n}=x.get(t,"payload",[]);if(n===x.max([x.size(e.scrollId)-1,0])&&n<x.size(e.scrollId)&&n<x.size(i)&&e.scrollId[n]===i[n]){e.expanded||e.toggleExpanded();const t=document.getElementById(i[n]);t&&(0,E.waitForScrollToEnd)().then((()=>t.scrollIntoView({behavior:"smooth"})))}};return(0,n.useEffect)((()=>{const e=b.default.subscribe("diffView",t);return()=>e()})),n.createElement(o.default,{direction:"column",gap:"spacing-l",padding:{paddingLeft:"spacing-xxl",paddingRight:"spacing-m"}},n.createElement(o.default,{direction:"row",gap:"spacing-m"},n.createElement(k,{type:"tertiary",icon:e.expanded?n.createElement(h.default,null):n.createElement(g.default,null),onClick:e.toggleExpanded}),n.createElement(r.default,{type:"h5",text:e.heading})),n.createElement(S,{expanded:e.expanded,border:{borderLeft:"border-width-default"}},e.children))}));function D(e){return n.createElement(n.Fragment,null,e.showCheckbox&&!!e.attribute.children.length&&e.attribute.children.map((e=>{var t;return"unchanged"===e.type?null:n.createElement(o.default,{key:e,gap:"spacing-s",alignItems:"center"},e.uiDiff&&n.createElement(y.TextDiff,{diff:null===(t=null==e?void 0:e.uiDiff)||void 0===t?void 0:t.diff}),n.createElement(a.default,{color:"content-color-primary"},e.description))})))}function R(e){var t;if("line"===e.attribute.uiDiff.diffType){const i=null===(t=e.attribute.uiDiff.diff.chunks[0])||void 0===t?void 0:t.textBits,[s,a]=(0,n.useState)((0,v.calculateChunkMidIndex)(i)),l={chunks:[{hasTextBitsBefore:0!==s.start,hasTextBitsAfter:s.end!==x.size(i)-1,textBits:i.slice(s.start,s.end)}]};return n.createElement(A,{heading:x.capitalize(e.attribute.friendlyName),scrollId:e.scrollId},n.createElement(o.default,{width:"100%",direction:"column",gap:"spacing-m"},n.createElement(D,{attribute:e.attribute,showCheckbox:e.showCheckbox}),n.createElement(y.LineDiff,{diff:l,onExpand:e=>{e.below?a({start:0,end:s.end}):a({start:s.start,end:x.size(i)-1})}})))}return n.createElement(A,{heading:x.capitalize(e.attribute.friendlyName),scrollId:e.scrollId},n.createElement(o.default,{width:"100%",direction:"column",gap:"spacing-m"},n.createElement(D,{attribute:e.attribute,showCheckbox:e.showCheckbox}),"text"===e.attribute.uiDiff.diffType&&n.createElement(y.TextDiff,{diff:e.attribute.uiDiff.diff}),"table"===e.attribute.uiDiff.diffType&&n.createElement(y.TableDiff,{diff:e.attribute.uiDiff.diff}),"json"===e.attribute.uiDiff.diffType&&n.createElement(y.JSONDiff,{diff:e.attribute.uiDiff.diff}),"selection"===e.attribute.uiDiff.diffType&&n.createElement(y.SelectionDiff,{diff:e.attribute.uiDiff.diff}),"selection-and-config"===e.attribute.uiDiff.diffType&&n.createElement(y.SelectionAndConfigDiff,{diff:e.attribute.uiDiff.diff}),"order"===e.attribute.uiDiff.diffType&&n.createElement(y.OrderDiff,{diff:e.attribute.uiDiff.diff})))}const O=(0,u.default)((e=>{if(!e.diffItem)return null;const t=!x.isEmpty(e.diffItem.attributes),i=!x.isEmpty(e.diffItem.responses),s=t||i,a=x.max([x.size(e.scrollId)-1,0]),l=t=>{const{uniqueScrollIds:i,currentScrollIterator:n}=x.get(t,"payload",[]);if(n===a&&n<x.size(e.scrollId)&&n<x.size(i)&&e.scrollId[n]===i[n]){e.expanded||e.toggleExpanded();const t=document.getElementById(i[n]),o=n+1<x.size(i);(null==t?void 0:t.scrollIntoView)&&!o&&(0,E.waitForScrollToEnd)().then((()=>t.scrollIntoView({behavior:"smooth"}))),setTimeout((()=>{o&&b.default.publish("diffView",{action:"expandDiffSection",payload:{uniqueScrollIds:i,currentScrollIterator:n+1}})}),500)}};return(0,n.useEffect)((()=>{const e=b.default.subscribe("diffView",l);return()=>e()})),n.createElement(o.default,{direction:"column",width:"100%"},n.createElement(P,{diffItem:e.diffItem,canExpand:s,expanded:e.expanded,onExpand:e.toggleExpanded}),n.createElement(I,{"data-testid":`live-collections-diff-item-${e.diffItem.itemId}`,expanded:e.expanded,border:{border:"border-width-default"},direction:"column",width:"100%",gap:"spacing-l",padding:e.expanded?{paddingTop:"spacing-m",paddingBottom:"spacing-m"}:{}},t&&e.diffItem.attributes.map((t=>{const i=`${e.scrollId[a]}-${t.name}`;return n.createElement("div",{id:i,key:i},n.createElement(R,{key:i,attribute:t,scrollId:[...e.scrollId,i]}))})),i&&n.createElement(A,{heading:"Examples"},n.createElement(o.default,{direction:"column",gap:"spacing-l",width:"100%"},(e.diffItem.responses||[]).map((t=>{const i=t.itemType+"-"+t.itemId;return n.createElement("div",{id:i,key:i},n.createElement(O,{key:t.itemId,diffItem:t,parentDiffType:e.diffItem.type,scrollId:[...e.scrollId,i]}))}))))))}),!1);function N(e){return n.createElement(o.default,{padding:{paddingBottom:"spacing-l"},direction:"column"},n.createElement(o.default,{padding:{paddingTop:"spacing-l",paddingBottom:"spacing-m"},direction:"column"},n.createElement(r.default,{type:"h5",text:e.title,color:"content-color-secondary"}),n.createElement(a.default,null,e.description)),n.createElement(o.default,{direction:"column",gap:"spacing-l"},e.diffList.map((e=>{const t=e.itemType+"-"+e.itemId;return n.createElement("div",{id:t,key:t},n.createElement(O,{diffItem:e,key:e.itemId,scrollId:[t]}))}))))}class K extends n.Component{constructor(e){super(e)}render(){const{diff:e,totalUpdatesCount:t,sections:i}=this.props;return n.createElement(j,{direction:"column",width:"70%","data-testid":"live-collections-diff"},n.createElement(r.default,{type:"h4",text:`Updates (${t})`}),x.reduce(i,((t,i)=>{const o=e[i];return x.isEmpty(o.data)||t.push(n.createElement(N,Object.assign({diffList:o.data,title:`${o.title} (${o.data.length})`},this.props))),t}),[]))}}},"../../packages/api-observability/live-collections/src/components/diff-view/DiffHeader.tsx":function(e,t,i){i.r(t),i.d(t,{default:function(){return d}});var n=i("../../node_modules/react/index.js"),o=i("../../node_modules/@postman/aether/esmLib/src/components/Flex/Flex.js"),s=i("../../node_modules/@postman/aether/esmLib/src/components/Heading/Heading.js"),a=i("../../node_modules/@postman/aether/esmLib/src/components/Button/Button.js"),l=i("../../node_modules/@postman/aether/esmLib/src/components/Tooltip/Tooltip.js"),r=function(e,t,i,n){return new(i||(i=Promise))((function(o,s){function a(e){try{r(n.next(e))}catch(e){s(e)}}function l(e){try{r(n.throw(e))}catch(e){s(e)}}function r(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,l)}r((n=n.apply(e,t||[])).next())}))};const c="Refresh to review new updates";class d extends n.Component{constructor(e){super(e),this.handleRejectAll=()=>r(this,void 0,void 0,(function*(){this.setState({isRejectButtonLoading:!0},(()=>r(this,void 0,void 0,(function*(){yield this.props.onRejectUpdates(),this.setState({isRejectButtonLoading:!1})}))))})),this.handleAcceptAll=()=>r(this,void 0,void 0,(function*(){this.setState({isUpdateButtonLoading:!0},(()=>r(this,void 0,void 0,(function*(){yield this.props.onUpdateCollection(),this.setState({isUpdateButtonLoading:!1})}))))})),this.state={isRejectButtonLoading:!1,isUpdateButtonLoading:!1}}render(){const{actionStatus:e}=this.props;return n.createElement(o.default,{justifyContent:"space-between",padding:"spacing-m spacing-l",alignItems:"center",border:{borderBottom:"border-width-default"}},n.createElement(s.default,{type:"h4",text:`Review updates to the '${this.props.collectionName}' collection`}),n.createElement(o.default,{gap:"spacing-s",alignItems:"center"},n.createElement(a.default,{type:"secondary",onClick:this.handleRejectAll,isLoading:this.state.isRejectButtonLoading,isDisabled:e.updateCollectionDisabled,tooltip:e.updateCollectionDisabled?n.createElement(l.default,{content:c}):null,text:"Reject all","data-testid":"live-collections-reject-changes"}),n.createElement(a.default,{type:"primary",onClick:this.handleAcceptAll,isLoading:this.state.isUpdateButtonLoading,isDisabled:e.rejectAllDisabled,tooltip:e.rejectAllDisabled?n.createElement(l.default,{content:c}):null,text:"Update Collection","data-testid":"live-collections-update-changes"})))}}},"../../packages/api-observability/live-collections/src/components/diff-view/DiffView.tsx":function(e,t,i){i.r(t);var n=i("../../node_modules/react/index.js"),o=i("../../node_modules/mobx-react/dist/mobx-react.module.js"),s=i("../../node_modules/@postman/aether/esmLib/src/components/Flex/Flex.js"),a=i("../../node_modules/@postman/aether/esmLib/src/components/Banner/Banner.js"),l=i("../../node_modules/@postman/aether/esmLib/src/components/Button/Button.js"),r=i("../../node_modules/styled-components/dist/styled-components.browser.esm.js"),c=i("../../packages/api-observability/live-collections/src/components/diff-view/DiffHeader.tsx"),d=i("../../packages/api-observability/live-collections/src/components/diff-view/DiffContent.tsx"),p=i("../../packages/api-observability/live-collections/src/components/diff-view/JumpTo.tsx"),u=i("../../packages/api-observability/live-collections/src/constants/diff.ts"),m=i("../../packages/api-observability/live-collections/src/services/pub-sub/Diff.ts"),f=i("../../packages/api-observability/live-collections/src/utils/trackEvent.ts"),h=i("../../node_modules/lodash/lodash.js"),g=function(e,t,i,n){var o,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(s<3?o(a):s>3?o(t,i,a):o(t,i))||a);return s>3&&a&&Object.defineProperty(t,i,a),a};const y=(0,r.default)(s.default)`
    height: 100%;
  `,v=r.default.div`
    position: sticky;
    top: 0;
    background-color: var(--background-color-primary);
    z-index: 1;
  `,b=(0,r.default)(s.default)`
    width: 100%;
    overflow-x: hidden;
    height: 90%;
  `;let E=class extends n.Component{constructor(e){super(e),this.state={showRefreshBanner:!1},this.handleDiffViewEvents=this.handleDiffViewEvents.bind(this)}componentDidMount(){m.default.subscribe("diffView",this.handleDiffViewEvents)}handleDiffViewEvents(e){"collectionDiffUpdate"===e.action&&(this.setState({showRefreshBanner:!0}),(0,f.trackEvent)(this.props.collectionId,"diff-updated"))}render(){const e=(i=this.props.diff,h.reduce(i,((e,t)=>(h.get(e[t.type+"-"+t.itemType],"data")&&e[t.type+"-"+t.itemType].data.push(t),e)),{[u.ADDED_REQUEST_SECTION]:{title:"Add requests",data:[]},[u.MODIFIED_REQUEST_SECTION]:{title:"Modify requests",data:[]}})),t=[u.ADDED_REQUEST_SECTION,u.MODIFIED_REQUEST_SECTION];var i,o;return n.createElement(y,{direction:"column","data-testid":"live-collections-diff-view"},this.state.showRefreshBanner&&n.createElement(a.default,{title:"",type:"global",status:"warning",primaryAction:n.createElement(l.default,{type:"outline",text:"Refresh",size:"small",onClick:this.props.onRefreshChanges})},"There are new updates available to the collection. Refresh the page to view them."),n.createElement(v,null,n.createElement(c.default,{actionStatus:{updateCollectionDisabled:this.state.showRefreshBanner,rejectAllDisabled:this.state.showRefreshBanner},collectionName:this.props.collectionName,onRejectUpdates:this.props.onRejectUpdates,onUpdateCollection:this.props.onUpdateCollection})),n.createElement(b,{padding:"spacing-zero spacing-l spacing-xl spacing-l",gap:"spacing-xl"},n.createElement(d.default,{diff:e,totalUpdatesCount:(o=e,h.reduce(h.mapValues(o),((e,t)=>e+h.size(t.data)),0)),sections:t}),n.createElement(p.default,{sections:t,diff:e})))}};E=g([o.observer],E),t.default=E},"../../packages/api-observability/live-collections/src/components/diff-view/JumpTo.tsx":function(e,t,i){i.r(t);var n=i("../../node_modules/react/index.js"),o=i("../../node_modules/mobx-react/dist/mobx-react.module.js"),s=i("../../node_modules/@postman/aether/esmLib/src/components/Flex/Flex.js"),a=i("../../node_modules/@postman/aether/esmLib/src/components/Text/Text.js"),l=i("../../node_modules/@postman/aether/esmLib/src/components/Label/Label.js"),r=i("../../node_modules/@postman/aether-icons/esmLib/src/design-system-icons/icon-direction-down.js"),c=i("../../node_modules/@postman/aether-icons/esmLib/src/design-system-icons/icon-direction-right.js"),d=i("../../packages/api-observability/live-collections/src/services/pub-sub/Diff.ts"),p=i("../../node_modules/styled-components/dist/styled-components.browser.esm.js"),u=i("../../node_modules/lodash/lodash.js"),m=i.n(u),f=function(e,t,i,n){var o,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(s<3?o(a):s>3?o(t,i,a):o(t,i))||a);return s>3&&a&&Object.defineProperty(t,i,a),a};const h=(0,p.default)(s.default)`
    padding-top: var(--spacing-xs);
    padding-left: var(--spacing-l);
    border-left: thin solid var(--border-color-default);
    margin-left: var(--spacing-s);
  `,g=p.default.div`
    cursor: pointer;
  `,y=p.default.div`
    cursor: pointer;
    max-width: 200px;

    :hover {
      text-decoration: underline;
    }
  `,v=(0,p.default)(s.default)`
    padding-top: var(--spacing-xl);
    position: sticky;
    top: 8px;
    align-self: flex-start;
  `,b=p.default.span`
    font-size: 10px;
  `,E=(e,t)=>m().map(e,(e=>{const i=e.itemType+"-"+e.itemId;return{id:e.itemId,name:e.name,method:e.method,scrollId:[t,i],children:[]}})),x=({currentItem:e})=>{const[t,i]=(0,n.useState)(!0),o=e.children,l=()=>{e.scrollId&&d.default.publish("diffView",{action:"expandDiffSection",payload:{uniqueScrollIds:e.scrollId,currentScrollIterator:0}})};return n.createElement(s.default,{direction:"column"},n.createElement(s.default,{gap:"spacing-xs",alignItems:"center"},!m().isEmpty(o)&&n.createElement(g,{onClick:()=>i(!t),"data-testid":`live-collections-${e.id}-${t?"expanded":"closed"}`},t?n.createElement(r.default,null):n.createElement(c.default,null)),e.method&&n.createElement(b,{className:`request-method--${e.method}`},e.method),n.createElement(y,{onClick:()=>{t||m().isEmpty(e.children)||i(!0),l()}},n.createElement(a.default,{text:e.name,color:"content-color-primary",type:"para"}))),t&&!m().isEmpty(o)&&n.createElement(h,{gap:"spacing-xs",direction:"column"},m().map(o,(e=>n.createElement(x,{currentItem:e})))))};let S=class extends n.Component{constructor(e){super(e)}render(){const{sections:e,diff:t}=this.props,i=((e,t)=>m().reduce(e,((e,i)=>{var n;return m().isEmpty(t[i].data)||e.push({id:i,name:t[i].title,children:(n=t[i].data,m().map(n,(e=>{const t=e.itemType+"-"+e.itemId;return{id:e.itemId,name:e.name,method:e.method,scrollId:[t],children:[...(i=e.attributes,n=t,m().map(i,(e=>{const t=`${n}-${e.name}`;return{id:t,name:e.friendlyName,scrollId:[n,t],children:[]}}))),...E(e.responses,t)]};var i,n})))}),e}),[]))(e,t);return n.createElement(v,{direction:"column",gap:"spacing-l","data-testid":"live-collections-jump-to"},n.createElement(l.default,{text:"Jump to",size:"large"}),m().map(i,(e=>n.createElement(x,{currentItem:e}))))}};S=f([o.observer],S),t.default=S},"../../packages/api-observability/live-collections/src/components/live-settings/EmptyState.tsx":function(e,t,i){i.r(t);var n=i("../../node_modules/@postman/aether/esmLib/src/components/Flex/Flex.js"),o=i("../../node_modules/@postman/aether/esmLib/src/components/BlankState/BlankState.js"),s=i("../../node_modules/@postman/aether/esmLib/src/components/Text/Text.js"),a=i("../../node_modules/@postman/aether/esmLib/src/components/Button/Button.js"),l=i("../../node_modules/@postman/aether/esmLib/src/components/Illustration/Illustration.js"),r=i("../../node_modules/react/index.js"),c=i("../../node_modules/mobx-react/dist/mobx-react.module.js"),d=i("./js/services/NavigationService.js"),p=i("../../packages/api-observability/live-collections/src/constants/index.ts");t.default=(0,c.observer)((e=>r.createElement(n.default,{height:"65%"},r.createElement(o.default,{title:"",description:r.createElement(s.default,{type:"para"},"Keep your collections up-to-date based on usage patterns"),primaryAction:r.createElement(a.default,{type:"primary",text:"Enable Live",onClick:()=>{d.default.transitionTo("build.workspace-enable-live",{},{collection:e.collectionId},{additionalContext:{source:p.ENABLE_LIVE_COLLECTION_SOURCE.CONTEXT_BAR}})}})},r.createElement(l.default,{name:"illustration-hit-send"})))))},"../../packages/api-observability/live-collections/src/components/live-settings/LiveCollectionStatus.tsx":function(e,t,i){i.r(t);var n=i("../../node_modules/react/index.js"),o=i("../../node_modules/mobx/lib/mobx.module.js"),s=i("../../node_modules/@postman/aether/esmLib/src/components/Toast/ToastManager.js"),a=i("../../node_modules/@postman/aether/esmLib/src/components/Flex/Flex.js"),l=i("../../node_modules/@postman/aether/esmLib/src/components/Label/Label.js"),r=i("../../node_modules/@postman/aether/esmLib/src/components/Text/Text.js"),c=i("../../node_modules/@postman/aether/esmLib/src/components/ToggleSwitch/ToggleSwitch.js"),d=i("./js/stores/LiveCollectionStore.js"),p=i("../../packages/api-observability/live-collections/src/controllers/index.ts"),u=i("./js/stores/StoreManager.js"),m=function(e,t,i,n){return new(i||(i=Promise))((function(o,s){function a(e){try{r(n.next(e))}catch(e){s(e)}}function l(e){try{r(n.throw(e))}catch(e){s(e)}}function r(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,l)}r((n=n.apply(e,t||[])).next())}))};class f extends n.Component{constructor(e){super(e),this.isEnabledReaction=null,this.getCurrentIsEnabled=()=>{var e;return null===(e=(0,u.resolveStoreInstance)(d.default).get(this.props.collectionId))||void 0===e?void 0:e.isEnabled},this.updateStatusToggle=()=>{this.setState((e=>({statusToggle:!e.statusToggle})),(()=>m(this,void 0,void 0,(function*(){try{yield p.LiveCollectionController.update(this.props.collectionId,{isEnabled:this.state.statusToggle})}catch(e){(0,s.toast)({status:"error",description:"Cannot update status, please try again"}),this.setState((e=>({statusToggle:!e.statusToggle})))}}))))},this.state={statusToggle:this.getCurrentIsEnabled()}}componentDidMount(){this.isEnabledReaction=(0,o.reaction)(this.getCurrentIsEnabled,(e=>{this.state.statusToggle!==e&&this.setState({statusToggle:e})}),{fireImmediately:!0})}componentWillUnmount(){this.isEnabledReaction&&this.isEnabledReaction()}render(){const{statusToggle:e}=this.state;return n.createElement(a.default,{direction:"column",gap:"spacing-l"},n.createElement(a.default,{justifyContent:"space-between"},n.createElement(a.default,{direction:"column",width:"80%"},n.createElement(l.default,{text:"Status",size:"small"}),n.createElement(r.default,{text:"Switch on or off data collection at anytime."})),n.createElement(a.default,{gap:"spacing-xs",width:"20%",padding:{paddingRight:"spacing-s"},justifyContent:"flex-end"},n.createElement(c.default,{isChecked:e,onChange:this.updateStatusToggle}),n.createElement(r.default,{color:"content-color-primary",text:e?"On":"Off"}))))}}t.default=f},"../../packages/api-observability/live-collections/src/components/live-settings/LiveSettings.tsx":function(e,t,i){i.r(t),i.d(t,{LiveSettings:function(){return T}});var n=i("../../node_modules/react/index.js"),o=i("../../node_modules/mobx-react/dist/mobx-react.module.js"),s=i("../../node_modules/mobx/lib/mobx.module.js"),a=i("../../node_modules/styled-components/dist/styled-components.browser.esm.js"),l=i("../../node_modules/@postman/aether/esmLib/src/components/Button/Button.js"),r=i("../../node_modules/@postman/aether/esmLib/src/components/Flex/Flex.js"),c=i("../../node_modules/@postman/aether/esmLib/src/components/Heading/Heading.js"),d=i("../../node_modules/@postman/aether/esmLib/src/components/Label/Label.js"),p=i("../../node_modules/@postman/aether/esmLib/src/components/RadioGroup/RadioGroup.js"),u=i("../../node_modules/@postman/aether/esmLib/src/components/Radio/Radio.js"),m=i("../../node_modules/@postman/aether/esmLib/src/components/Text/Text.js"),f=i("../../node_modules/@postman/aether/esmLib/src/components/Toast/withToast.js"),h=i("../../node_modules/@postman/aether-icons/esmLib/src/design-system-icons/icon-state-info-stroke.js"),g=i("./js/services/NavigationService.js"),y=i("./appsdk/components/link/Link.js"),v=i("./js/stores/StoreManager.js"),b=i("../../packages/api-observability/live-collections/src/services/DiffService.ts"),E=i("./js/stores/LiveCollectionStore.js"),x=i("../../packages/api-observability/live-collections/src/controllers/index.ts"),S=i("../../packages/api-observability/live-collections/src/constants/index.ts"),I=function(e,t,i,n){return new(i||(i=Promise))((function(o,s){function a(e){try{r(n.next(e))}catch(e){s(e)}}function l(e){try{r(n.throw(e))}catch(e){s(e)}}function r(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,l)}r((n=n.apply(e,t||[])).next())}))};const k=(0,a.default)(h.default)`
  padding-top: var(--spacing-xs);
`,C=(0,v.resolveStoreInstance)(E.default);class T extends n.Component{constructor(e){super(e),this.mergeStrategyReaction=null,this.saveSettings=e=>I(this,void 0,void 0,(function*(){this.setState({isSavingSettings:!0},(()=>I(this,void 0,void 0,(function*(){try{e&&(yield this.mergePendingDiffChanges(e)),yield x.LiveCollectionController.update(this.props.collectionId,{mergeStrategy:this.state.mergeStrategy}),this.setState({isSavingSettings:!1})}catch(t){const i={mergeStrategy:this.state.mergeStrategy};this.setState({isSavingSettings:!1,mergeStrategy:this.getCurrentMergeStrategy()},(()=>{this.props.addToast&&this.props.addToast({status:"error",description:n.createElement(n.Fragment,null,"Live settings update failed, Please",n.createElement(l.default,{onClick:()=>{this.setState({mergeStrategy:i.mergeStrategy},(()=>this.saveSettings(e)))},type:"monochrome-plain",text:"try again"}))})}))}}))))})),this.getCurrentMergeStrategy=()=>{var e;return null===(e=C.get(this.props.collectionId))||void 0===e?void 0:e.mergeStrategy},this.state={mergeStrategy:this.getCurrentMergeStrategy(),isSavingSettings:!1}}componentDidMount(){this.mergeStrategyReaction=(0,s.reaction)(this.getCurrentMergeStrategy,(e=>{this.setState({mergeStrategy:e})}),{fireImmediately:!0})}componentWillUnmount(){this.mergeStrategyReaction&&this.mergeStrategyReaction()}mergePendingDiffChanges(e){var t;return I(this,void 0,void 0,(function*(){const i=null===(t=C.get(this.props.collectionId))||void 0===t?void 0:t.id;try{yield(0,b.mergeUpdates)(i,C.activeWorkspaceId,{accept:e})}catch(e){throw pm.logger.error(`LiveSettings~mergePendingDiffChanges: Error merging the changes: ${e}`),e}}))}render(){const{isSavingSettings:e}=this.state,t=this.getCurrentMergeStrategy(),i=!this.props.isCollectionInSync&&this.state.mergeStrategy===S.MERGE_STRATEGY.AUTOMATIC&&t===S.MERGE_STRATEGY.MANUAL;return n.createElement(r.default,{direction:"column",gap:"spacing-xl"},n.createElement(r.default,{direction:"column",gap:"spacing-l"},n.createElement(c.default,{type:"h4",text:"Settings"}),n.createElement(r.default,{direction:"column",gap:"spacing-s"},n.createElement(r.default,{direction:"column"},n.createElement(r.default,{gap:"spacing-xs",alignItems:"center"},n.createElement(d.default,{text:"Select how to stay updated",size:"small"})),n.createElement(p.default,{direction:"column",name:"live-c-options",value:this.state.mergeStrategy,onChange:e=>this.setState({mergeStrategy:e})},n.createElement(u.default,{value:S.MERGE_STRATEGY.AUTOMATIC,label:"Automatically update",id:`context-bar-${S.MERGE_STRATEGY.AUTOMATIC}`}),n.createElement(u.default,{value:S.MERGE_STRATEGY.MANUAL,label:"Review before updating",id:`context-bar-${S.MERGE_STRATEGY.MANUAL}`})),n.createElement(r.default,null))),i&&n.createElement(r.default,{gap:"spacing-s"},n.createElement(k,null),n.createElement(m.default,null,"Some updates are yet to be reviewed. If you don’t want them to automatically update, ",n.createElement(y.default,{onClick:()=>{g.default.transitionTo("build.workspace-live-collection-review-changes",{},{collection:this.props.collectionId},{})}},n.createElement(m.default,{text:"review manually",type:"link-default"})),"."))),n.createElement(r.default,null,n.createElement(l.default,{onClick:()=>{this.saveSettings(i)},text:"Save Changes",type:"primary",isLoading:e,isDisabled:this.state.mergeStrategy===t})))}}t.default=(0,o.observer)((0,f.default)(T))},"../../packages/api-observability/live-collections/src/components/live-settings/LiveSettingsContainer.tsx":function(e,t,i){i.r(t);var n=i("../../node_modules/@postman/aether/esmLib/src/components/Flex/Flex.js"),o=i("../../node_modules/@postman/aether/esmLib/src/components/Text/Text.js"),s=i("../../node_modules/@postman/aether/esmLib/src/components/Label/Label.js"),a=i("../../node_modules/react/index.js"),l=i("../../node_modules/styled-components/dist/styled-components.browser.esm.js"),r=i("../../node_modules/mobx-react/dist/mobx-react.module.js"),c=i("./js/stores/StoreManager.js"),d=i("../../node_modules/@postman/date-helper/index.js"),p=i.n(d),u=i("./appsdk/components/link/Link.js"),m=i("./js/services/NavigationService.js"),f=i("../../packages/api-observability/live-collections/src/constants/index.ts"),h=i("./js/stores/LiveCollectionStore.js"),g=i("../../packages/api-observability/live-collections/src/components/live-settings/LiveCollectionStatus.tsx"),y=i("../../packages/api-observability/live-collections/src/components/live-settings/LiveSettings.tsx"),v=function(e,t,i,n){var o,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(s<3?o(a):s>3?o(t,i,a):o(t,i))||a);return s>3&&a&&Object.defineProperty(t,i,a),a};const b=l.default.div`
    padding: var(--spacing-zero) var(--spacing-s);
    overflow-y: auto;
  `,E=l.default.div`
    transition: all 500ms;
    transition-timing-function: ease-out;
    opacity: ${e=>e.isEnabled?1:0};
  `,x=(0,c.resolveStoreInstance)(h.default);let S=class extends a.Component{constructor(e){super(e)}render(){const e=this.props.collectionId,{lastSyncedAt:t,isCollectionInSync:i,isEnabled:l}=x.get(this.props.collectionId);return a.createElement(b,null,a.createElement(n.default,{direction:"column",gap:"spacing-xl"},a.createElement(n.default,{direction:"column",gap:"spacing-xxl"},a.createElement(n.default,{direction:"column",gap:"spacing-l"},a.createElement(o.default,null,"Streamline collaboration with collections that are always up-to-date. ",a.createElement(u.default,{target:"_blank",to:f.LIVE_COLLECTION_LEARNING_CENTER_URL},a.createElement(o.default,{type:"link-default",isExternal:!0},"Learn more"))),a.createElement(g.default,{collectionId:e}),a.createElement(n.default,{direction:"column"},a.createElement(s.default,{text:"Last updated",size:"small"}),t?a.createElement(o.default,{text:p().getFormattedDateAndTime(t)}):i?a.createElement(o.default,null,"No updates yet. Try ",a.createElement(u.default,{onClick:()=>{m.default.transitionTo("build.create-request",{},{},{})}},a.createElement(o.default,{text:"sending a request",type:"link-default"})),"."):a.createElement(o.default,null,"Updates are available. ",a.createElement(u.default,{onClick:()=>{m.default.transitionTo("build.workspace-live-collection-review-changes",{},{collection:e},{})}},a.createElement(o.default,{text:"Review changes",type:"link-default"}))," to update the collection."))),a.createElement(E,{"data-testid":"styled-live-settings-container",isEnabled:l},a.createElement(y.default,{collectionId:e,isCollectionInSync:i})))))}};S=v([r.observer],S),t.default=S},"../../packages/api-observability/live-collections/src/components/live-settings/index.tsx":function(e,t,i){i.r(t),i.d(t,{EmptyState:function(){return o.default},LiveSettingsContainer:function(){return n.default}});var n=i("../../packages/api-observability/live-collections/src/components/live-settings/LiveSettingsContainer.tsx"),o=i("../../packages/api-observability/live-collections/src/components/live-settings/EmptyState.tsx")},"../../packages/api-observability/live-collections/src/components/setup-steps/APIKeyRenderer.tsx":function(e,t,i){i.r(t),i.d(t,{default:function(){return b}});var n=i("../../node_modules/react/index.js"),o=i("../../node_modules/@postman/aether/esmLib/src/components/Flex/Flex.js"),s=i("../../node_modules/@postman/aether/esmLib/src/components/Heading/Heading.js"),a=i("../../node_modules/@postman/aether/esmLib/src/components/Text/Text.js"),l=i("../../node_modules/@postman/aether/esmLib/src/components/Button/Button.js"),r=i("../../node_modules/@postman/aether/esmLib/src/components/TextInput/TextInput.js"),c=i("../../node_modules/@postman/aether/esmLib/src/components/Popover/Popover.js"),d=i("../../node_modules/styled-components/dist/styled-components.browser.esm.js"),p=i("../../node_modules/@postman/aether-icons/esmLib/src/design-system-icons/icon-action-close-stroke.js"),u=i("./iam/src/common/api/IAMservice.js"),m=i("./appsdk/components/link/Link.js"),f=i("../../packages/api-observability/live-collections/src/types/index.ts"),h=i("../../node_modules/lodash/lodash.js");const g=d.default.span`
    margin-left: var(--spacing-xs);
    margin-right: var(--spacing-xs);
    display: inline-block;
  `,y=d.default.div`
    display: grid;
    grid-auto-flow: column;
  `,v=d.default.div`
    padding: var(--spacing-s);
  `;class b extends n.Component{constructor(e){super(e),this.state={isPopoverOpen:!1,apiKey:null,popoverView:f.APIKeyRendererViews.InsertAPIKey,isGeneratingKey:!1,isButtonLoading:!1,apiKeyGenerationError:"",apiKeyInputText:"",apiKeyName:"",isAPILimitReached:!1},this.setApiKey=this.setApiKey.bind(this)}setApiKey(){this.setState({apiKey:this.state.apiKeyInputText,isPopoverOpen:!1}),this.props.setApiKey(this.state.apiKeyInputText)}getInsertAPIKeyBody(){return n.createElement(o.default,{direction:"column",gap:"spacing-m"},n.createElement(o.default,{direction:"column",gap:"spacing-s"},n.createElement(s.default,{type:"h3",text:"Add Postman API key"}),n.createElement(a.default,{type:"body-medium",color:"content-color-primary"},"API key is needed to access Postman API and fetch live Postman data. Learn how to ",n.createElement(m.default,{to:"https://learning.postman.com/docs/developer/intro-api/#generating-a-postman-api-key",target:"_blank"},n.createElement(a.default,{type:"link-default",isExternal:!0},"generate a Postman API key")))),n.createElement(o.default,{padding:{paddingTop:"spacing-xs"},alignItems:"center",gap:"spacing-m"},n.createElement(l.default,{type:"primary",isLoading:this.state.isButtonLoading,onClick:()=>{this.setState({isButtonLoading:!0},(()=>(0,u.fetchAllApiKeys)().then((e=>{const t=h.get(e,"apiKeys",[]),i=h.size(t)>4?f.APIKeyRendererViews.EnterAPIKey:f.APIKeyRendererViews.GenerateAPIKey;this.setState({popoverView:i,isAPILimitReached:h.size(t)>4,isButtonLoading:!1})}))))},text:"Generate Key","data-testid":"generate-api-key-button"}),n.createElement(l.default,{type:"secondary",onClick:()=>{this.setState({popoverView:f.APIKeyRendererViews.EnterAPIKey,isAPILimitReached:!1,apiKeyInputText:""})},text:"Use Existing Key","data-testid":"use-existing-key-button"})))}getEnterApiKeyBody(){const e=this.state.isAPILimitReached?"Postman API key limit reached":"Paste an existing Postman API key",t=this.state.isAPILimitReached?"You already have 5 keys. Enter existing key or delete/regenerate keys in ":"You can also delete, regenerate or check status of existing API keys in your ";return n.createElement(o.default,{direction:"column",gap:"spacing-l"},n.createElement(o.default,{direction:"column",gap:"spacing-s"},n.createElement(s.default,{type:"h3",text:e}),n.createElement(a.default,{type:"body-medium",color:"content-color-primary"},t,n.createElement(m.default,{to:`${pm.artemisUrl}/settings/me/api-keys`,target:"_blank"},n.createElement(a.default,{type:"link-default",isExternal:!0},"account settings")))),n.createElement(r.default,{type:"text",placeholder:"Paste an existing Postman API key",value:this.state.apiKeyInputText,autoFocus:!0,onChange:e=>{this.setState({apiKeyInputText:e.target.value})},onKeyDown:e=>"Enter"===e.key&&this.setApiKey(),onClear:()=>this.setState({apiKeyInputText:""}),"data-testid":"api-key-input"}),n.createElement(o.default,{gap:"spacing-m"},n.createElement(l.default,{type:"primary",onClick:this.setApiKey,text:"Insert Key","data-testid":"insert-key-button"}),n.createElement(l.default,{type:"secondary",onClick:()=>this.setState({popoverView:f.APIKeyRendererViews.UseExistingKey,apiKeyName:"",apiKeyInputText:""}),text:"Back","data-testid":"go-back-button"})))}getGenerateApiKeyBody(){const e=e=>{this.setState({isGeneratingKey:e})},t=()=>{e(!0),(0,u.createNewApiKey)(this.state.apiKeyName).then((e=>{if("error"===e.status)this.setState({isGeneratingKey:!1,apiKeyGenerationError:h.get(e,"error.message","Unable to create API key")});else{const t=h.get(e,"apikey.key");this.setState({apiKeyInputText:t,popoverView:f.APIKeyRendererViews.GeneratedKey,isGeneratingKey:!1})}})).catch((e=>{this.setState({isPopoverOpen:!1,isGeneratingKey:!1},(()=>{pm.toasts.error(h.get(e,"error.message","Unable to create API key"))}))}))};return n.createElement(o.default,{direction:"column",gap:"spacing-s"},n.createElement(s.default,{type:"h3",text:"Name your API key"}),n.createElement(a.default,{type:"body-medium",color:"content-color-primary"},"This will help you identify and manage the keys."),n.createElement(r.default,{type:"text",placeholder:"Enter name",value:this.state.apiKeyName,autoFocus:!0,onKeyDown:e=>"Enter"===e.key&&t(),onChange:e=>{var t;this.setState({apiKeyName:null===(t=e.target.value)||void 0===t?void 0:t.replace(/[^A-Za-z0-9-_]/g,"-")})},onClear:()=>{this.setState({apiKeyName:"",apiKeyGenerationError:""})},validationStatus:h.isEmpty(this.state.apiKeyGenerationError)?null:"error",validationMessage:h.isEmpty(this.state.apiKeyGenerationError)?null:this.state.apiKeyGenerationError,"data-testid":"key-name-input"}),n.createElement(o.default,{gap:"spacing-m",padding:"spacing-s spacing-zero spacing-zero spacing-zero"},n.createElement(l.default,{type:"primary",onClick:t,text:"Generate",isLoading:this.state.isGeneratingKey,isDisabled:h.isEmpty(this.state.apiKeyName),"data-testid":"create-api-key-button"}),n.createElement(l.default,{type:"secondary",onClick:()=>this.setState({popoverView:f.APIKeyRendererViews.UseExistingKey,apiKeyName:"",apiKeyInputText:""}),text:"Back","data-testid":"go-back-button"})))}getGeneratedKeyBody(){return n.createElement(o.default,{direction:"column",gap:"spacing-s"},n.createElement(s.default,{type:"h3",text:"Key generated!"}),n.createElement(a.default,{type:"body-medium",color:"content-color-primary"},"Make sure you copy and save this API key."),n.createElement(r.default,{type:"text",value:this.state.apiKeyInputText,enableCopy:!0}),n.createElement("div",{style:{paddingTop:"var(--spacing-s)",width:"fit-content"}},n.createElement(l.default,{type:"primary",onClick:this.setApiKey,text:"Insert Key","data-testid":"insert-generated-key-button"})))}getInsertedAPIKeyBody(){return n.createElement(o.default,{direction:"column",gap:"spacing-s",width:"270px"},n.createElement(s.default,{type:"h3",text:"Inserted API key"}),n.createElement(r.default,{type:"text",value:this.state.apiKey,enableCopy:!0}),n.createElement(o.default,{padding:{paddingTop:"spacing-s"},alignItems:"center",justifyContent:"space-between"},n.createElement(l.default,{type:"primary",onClick:()=>{this.setState({isPopoverOpen:!1})},text:"Done"}),n.createElement(l.default,{type:"plain",onClick:()=>{this.setState({isPopoverOpen:!0,popoverView:f.APIKeyRendererViews.InsertAPIKey,apiKeyName:"",apiKeyInputText:"",isButtonLoading:!1,isAPILimitReached:!1,apiKeyGenerationError:""})},text:"Change Key"})))}getPopoverBody(){switch(this.state.popoverView){case"InsertAPIKey":default:return this.getInsertAPIKeyBody();case"EnterAPIKey":return this.getEnterApiKeyBody();case"GenerateAPIKey":return this.getGenerateApiKeyBody();case"GeneratedKey":return this.getGeneratedKeyBody();case"InsertedAPIKey":return this.getInsertedAPIKeyBody()}}render(){return n.createElement(c.default,{isOpen:this.state.isPopoverOpen,placement:"top-start",padding:"spacing-l",appendTo:"parent",maxWidth:"350px",trigger:this.state.apiKey?n.createElement("span",{onClick:()=>this.setState({isPopoverOpen:!0,popoverView:f.APIKeyRendererViews.InsertedAPIKey,apiKeyName:"",isButtonLoading:!1,isAPILimitReached:!1,apiKeyGenerationError:""})},n.createElement(a.default,{type:"link-primary"},"'",h.truncate(this.state.apiKey,{length:18}),"'")):n.createElement(g,null,n.createElement(l.default,{size:"small",type:"outline",text:"Add API Key",onClick:()=>this.setState({isPopoverOpen:!0,popoverView:f.APIKeyRendererViews.InsertAPIKey,apiKeyName:"",isButtonLoading:!1,isAPILimitReached:!1,apiKeyGenerationError:""})}))},n.createElement(y,null,n.createElement(v,null,this.getPopoverBody()),n.createElement(l.default,{type:"tertiary",icon:n.createElement(p.default,null),onClick:()=>this.setState({isPopoverOpen:!1})})))}}},"../../packages/api-observability/live-collections/src/components/setup-steps/LanguageCard.tsx":function(e,t,i){i.r(t),i.d(t,{default:function(){return f}});var n=i("../../node_modules/react/index.js"),o=i("../../node_modules/@postman/aether-icons/esmLib/src/design-system-icons/icon-state-pass-fill-small.js"),s=i("../../node_modules/@postman/aether/esmLib/src/components/Flex/Flex.js"),a=i("../../node_modules/@postman/aether/esmLib/src/components/Text/Text.js"),l=i("../../node_modules/styled-components/dist/styled-components.browser.esm.js"),r=i("../../node_modules/lodash/lodash.js");const c=(0,l.default)(s.default)`
  position: absolute;
  top: 5px;
  right: 5px;
`,d=l.default.div`
  display: flex;
  flex-direction: row;
  cursor: pointer;
  width: 150px;
  height: 48px;
  padding: var(--spacing-m);
  align-items: center;

  ${({isSelected:e})=>e?l.css`
          border: 1px solid var(--blue-50);
        `:l.css`
          border: var(--border-width-default) solid var(--border-color-strong);
        `}
  box-sizing: border-box;
  border-radius: var(--border-radius-default);
  margin-right: var(--spacing-l);
  justify-content: space-between;
  position: relative;

  &:hover {
    background: var(--background-color-tertiary);
    ${({isSelected:e})=>e?l.css`
            border: 1px solid var(--blue-50);
          `:l.css`
            border: var(--border-width-default) solid var(--border-color-strong);
          `}
    box-sizing: border-box;
    border-radius: var(--border-radius-default);
  }
`,p=(0,l.default)(a.default)`
  font-weight: var(--text-weight-medium);
  font-size: var(--text-size-m);
  line-height: var(--line-height-s);
  margin-left: var(--spacing-s);
`,u=(0,l.default)(s.default)`
  border-radius: var(--border-radius-default);
  width: 28px;
  height: 28px;
  justify-content: center;
`,m=l.default.img`
  width: var(--size-s);
  height: var(--size-s);
`;class f extends n.Component{constructor(e){super(e),this.handleOnClick=this.handleOnClick.bind(this)}handleOnClick(){const{handleSelection:e}=this.props;r.isFunction(e)&&e(this.props.id)}render(){const{icon:e,label:t,id:i,selected:a}=this.props;return n.createElement(d,{onClick:this.handleOnClick,isSelected:a===i,"data-testid":`language-card-${t}`},n.createElement(s.default,{alignItems:"center"},n.createElement(u,{alignItems:"center"},n.createElement(m,{src:e})),n.createElement(p,null,t)),a===i?n.createElement(c,null,n.createElement(o.default,{color:"green-50"})):null)}}},"../../packages/api-observability/live-collections/src/components/setup-steps/LiveCollectionSetupSteps.tsx":function(e,t,i){i.r(t);var n=i("../../node_modules/react/index.js"),o=i("../../node_modules/@postman/aether/esmLib/src/components/Dropdown/SingleSelect/SingleSelect.js"),s=i("../../node_modules/@postman/aether/esmLib/src/components/Flex/Flex.js"),a=i("../../node_modules/@postman/aether/esmLib/src/components/Spinner/Spinner.js"),l=i("../../node_modules/@postman/aether/esmLib/src/components/Heading/Heading.js"),r=i("../../node_modules/@postman/aether/esmLib/src/components/Text/Text.js"),c=i("../../node_modules/@postman/aether/esmLib/src/components/Button/Button.js"),d=i("../../node_modules/mobx/lib/mobx.module.js"),p=i("../../node_modules/mobx-react/dist/mobx-react.module.js"),u=i("../../node_modules/styled-components/dist/styled-components.browser.esm.js"),m=i("../../node_modules/@postman/aether-icons/esmLib/src/design-system-icons/icon-action-edit-stroke.js"),f=i("../../node_modules/@postman/aether-icons/esmLib/src/design-system-icons/icon-state-error-stroke.js"),h=i("../../node_modules/@postman/aether-icons/esmLib/src/design-system-icons/icon-state-success-stroke.js"),g=i("../../packages/api-observability/live-collections/src/constants/index.ts"),y=i("../../packages/api-observability/live-collections/src/components/setup-steps/Step.tsx"),v=i("../../packages/api-observability/live-collections/src/components/setup-steps/LanguageCard.tsx"),b=i("./js/components/base/InlineInput.js"),E=i("./js/stores/StoreManager.js"),x=i("./runtime-repl/collection/_api/CollectionInterface.js"),S=i("./collaboration/workspace/model/ActiveWorkspaceBaseStore.ts"),I=i("./js/services/NavigationService.js"),k=i("../../packages/api-observability/live-collections/src/services/pub-sub/LiveCollections.ts"),C=i("./runtime-repl/collection/_api/CollectionStoreV2.js"),T=i("./js/stores/LiveCollectionStore.js"),j=i("./appsdk/components/link/Link.js"),w=i("../../packages/api-observability/live-collections/src/utils/trackEvent.ts"),L=i("../../packages/api-observability/live-collections/src/utils/setupSteps.ts"),_=i("../../node_modules/lodash/lodash.js"),P=function(e,t,i,n){var o,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(s<3?o(a):s>3?o(t,i,a):o(t,i))||a);return s>3&&a&&Object.defineProperty(t,i,a),a},A=function(e,t,i,n){return new(i||(i=Promise))((function(o,s){function a(e){try{r(n.next(e))}catch(e){s(e)}}function l(e){try{r(n.throw(e))}catch(e){s(e)}}function r(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,l)}r((n=n.apply(e,t||[])).next())}))};const D=(0,u.default)(o.default)`
    padding-bottom: var(--spacing-xs);
  `,R=u.default.div`
    padding-left: 4px;
    padding-top: 2px;
    visibility: hidden;
  `,O=(0,u.default)(s.default)`
    .inline-input__wrapper .input-box {
      padding: calc(var(--spacing-xs) / 2);
      width: 460px;
    }

    &:hover ${R} {
      visibility: visible;
      cursor: pointer;
    }
  `,N=(0,E.resolveStoreInstance)(T.default);let K=class extends n.Component{constructor(e){super(e),this.LANGUAGE_OPTIONS={},this.FRAMEWORKS={},this.STEPS_CONFIG={},this.createCollection=()=>A(this,void 0,void 0,(function*(){const e=(0,E.resolveStoreInstance)(S.default).id,t=yield(0,x.createCollection)({name:"New Collection"},e);return this.subscribeToCollectionNameChange(t.uid),this.props.controllerProps.setCollectionId(t.uid),this.setState({collectionName:t.name,collectionId:t.uid,isEditingName:!0,isLoading:!1},(()=>{var e,i,n;null===(e=this.inputRef)||void 0===e||e.startEditing(),null===(i=this.inputRef)||void 0===i||i.focus(),null===(n=this.inputRef)||void 0===n||n.selectAll(),N.setOnboardingState(Object.assign(Object.assign({},N.onboardingState),{collectionId:t.uid}))})),t})),this.startEditingName=()=>{this.setState({isEditingName:!1},(()=>{var e;null===(e=this.inputRef)||void 0===e||e.startEditing()}))},this.toggleEdit=e=>{this.setState({isEditingName:e},(()=>{var t,i;e&&(null===(t=this.inputRef)||void 0===t||t.focus(),null===(i=this.inputRef)||void 0===i||i.selectAll())}))},this.updateCollectionName=e=>A(this,void 0,void 0,(function*(){if(e)try{yield(0,x.updateCollection)(this.state.collectionId,{name:e}),this.setState({collectionName:e,isEditingName:!1})}catch(e){this.setState({isEditingName:!1}),pm.logger.error("OnboardingInfo~updateCollectionName",e)}})),this.handleToggleEditName=e=>{var t,i;e&&(null===(t=this.inputRef)||void 0===t||t.focus(),null===(i=this.inputRef)||void 0===i||i.selectAll())},this.state={selectedLanguage:"",frameworkOptions:[],selectedFramework:null,isValidating:!1,hasValidated:!1,validationTimedOut:!1,isEditingName:!1,isBootstrapFailed:!1,isLoading:!this.props.controllerProps.collectionId,collectionId:this.props.controllerProps.collectionId||"",collectionName:this.props.controllerProps.collectionName},this.handleLanguageSelection=this.handleLanguageSelection.bind(this),this.handleLiveCollectionEvents=this.handleLiveCollectionEvents.bind(this),this.validate=this.validate.bind(this)}componentDidMount(){return A(this,void 0,void 0,(function*(){if(this.unsubscribeEvents=k.default.subscribe("liveCollections",this.handleLiveCollectionEvents),({LANGUAGE_OPTIONS:this.LANGUAGE_OPTIONS,FRAMEWORKS:this.FRAMEWORKS,STEPS_CONFIG:this.STEPS_CONFIG}=yield(0,L.getSetupStepsConfig)()),this.props.controllerProps.collectionId)this.subscribeToCollectionNameChange(this.props.controllerProps.collectionId),(0,w.trackOnboardingEvent)(this.props.controllerProps.collectionId,"view-enable-live");else{const e=yield this.createCollection();(0,w.trackOnboardingEvent)(e.uid,"view-enable-live")}}))}componentWillUnmount(){this.unsubscribeEvents()}subscribeToCollectionNameChange(e){return A(this,void 0,void 0,(function*(){const t=yield(0,C.subscribeOne)(e,{exclude:["response","request"]});this.nameReactionDisposer=(0,d.reaction)((()=>t.name),(e=>{this.setCollectionName(e)}),{fireImmediately:!0})}))}setCollectionName(e){this.setState({collectionName:e}),this.props.controllerProps.setTabTitle(e)}handleLiveCollectionEvents(e){"bootstrapConnection"===e.action&&(e.payload.success&&k.default.publish("liveCollections",{action:"connectionSuccessful",payload:{collectionId:e.payload.collectionId}}),this.setState({isValidating:!1,validationTimedOut:!1,hasValidated:!0,isBootstrapFailed:!e.payload.success},(()=>{var e;(0,w.trackOnboardingEvent)(this.state.collectionId,"connection-success",`lng:${this.state.selectedLanguage}|frmwk:${null===(e=this.state.selectedFramework)||void 0===e?void 0:e.value}`)})))}handleLanguageSelection(e){this.setState({selectedLanguage:e,frameworkOptions:this.FRAMEWORKS[e],selectedFramework:null})}renderLanguageOptions(){return(_.keys(this.LANGUAGE_OPTIONS)||[]).map((e=>{const{label:t,id:i,icon:o,isEnabled:s}=this.LANGUAGE_OPTIONS[e];return s()?n.createElement(v.default,{key:i,label:t,id:i,icon:o,handleSelection:this.handleLanguageSelection,selected:this.state.selectedLanguage}):null}))}validate(){this.setState({isValidating:!0},(()=>{var e;(0,w.trackOnboardingEvent)(this.state.collectionId,"test-connection",`lng:${this.state.selectedLanguage}|frmwk:${null===(e=this.state.selectedFramework)||void 0===e?void 0:e.value}`),setTimeout((()=>{this.state.isValidating&&this.setState({isValidating:!1,validationTimedOut:!0})}),1e4)}))}render(){var e,t;const i=null===(t=null===(e=I.default.getActiveQueryParams())||void 0===e?void 0:e.get())||void 0===t?void 0:t.edit;return this.state.isLoading?n.createElement(a.default,null):n.createElement(s.default,{gap:"spacing-l",direction:"column"},n.createElement(s.default,{direction:"column",gap:"spacing-xl",width:"500px"},n.createElement(s.default,{direction:"column",gap:"spacing-s"},n.createElement(l.default,{type:"h2",text:"Instrument your application with Postman SDK"}),n.createElement("div",null,n.createElement(r.default,{color:"content-color-secondary"},"Postman SDK observes your application and updates the Live Collection. ",n.createElement(j.default,{target:"_blank",to:g.LIVE_COLLECTION_LEARNING_CENTER_URL},n.createElement(r.default,{type:"link-default",isExternal:!0},"Learn more"))))),n.createElement(s.default,{gap:"spacing-zero",alignItems:"center"},n.createElement(r.default,{typographyStyle:{fontSize:"text-size-s",fontWeight:"text-weight-medium",lineHeight:"line-height-m"}},"Collection: "),n.createElement(O,{alignItems:"center"},n.createElement(b.default,{editable:!0,ref:e=>{this.inputRef=e},value:this.state.collectionName,onSubmit:this.updateCollectionName,onToggleEdit:this.toggleEdit,disableTrim:!0}),i&&!this.state.isEditingName&&n.createElement(R,{"data-testid":"collection-name-edit-icon",onClick:this.startEditingName},n.createElement(m.default,{size:"small"})))),n.createElement(s.default,{direction:"column",gap:"spacing-s"},n.createElement(r.default,{typographyStyle:{fontSize:"text-size-s",fontWeight:"text-weight-medium",lineHeight:"line-height-m"}},"Select application language"),n.createElement(s.default,{gap:"spacing-l"},this.renderLanguageOptions())),this.state.selectedLanguage?n.createElement(D,{onChange:e=>{this.setState({selectedFramework:e})},key:this.state.selectedLanguage,options:this.state.frameworkOptions,value:this.state.selectedFramework,label:"Framework",placeholder:"Select framework",isSearchable:!1,isClearable:!1,viaPortal:!0,"data-testid":"select-framework-dropdown"}):null,this.state.selectedFramework?n.createElement(n.Fragment,null,_.map(this.STEPS_CONFIG[this.state.selectedFramework.value],((e,t)=>n.createElement(y.default,{key:`${e.title}-${t}`,step:e,index:t,collectionId:this.state.collectionId})))):null),this.state.selectedFramework&&(this.state.hasValidated||this.state.validationTimedOut?this.state.isBootstrapFailed||this.state.validationTimedOut?n.createElement(s.default,{gap:"spacing-s",alignItems:"center"},n.createElement(s.default,{gap:"spacing-xs",alignItems:"center"},n.createElement(f.default,{color:"content-color-error"}),n.createElement(r.default,{text:"Unable to connect",color:"content-color-error"})),n.createElement(s.default,null,n.createElement(c.default,{type:"monochrome-plain",text:"Try Again",onClick:this.validate,isLoading:this.state.isValidating}))):n.createElement(s.default,{gap:"spacing-xs",alignItems:"center"},n.createElement(h.default,{color:"content-color-success"}),n.createElement(r.default,{text:"Connected",color:"content-color-success"})):n.createElement(s.default,null,n.createElement(c.default,{type:"secondary",text:"Test Connection",onClick:this.validate,isDisabled:this.state.hasValidated,isLoading:this.state.isValidating,minWidth:"120px"}))))}};K=P([p.observer],K),t.default=K},"../../packages/api-observability/live-collections/src/components/setup-steps/Step.tsx":function(e,t,i){i.r(t),i.d(t,{default:function(){return g}});var n=i("../../node_modules/react/index.js"),o=i("../../node_modules/styled-components/dist/styled-components.browser.esm.js"),s=i("../../packages/api-observability/live-collections/src/components/setup-steps/APIKeyRenderer.tsx"),a=i("../../node_modules/@postman/aether-icons/esmLib/src/design-system-icons/icon-action-copy-stroke-small.js"),l=i("../../node_modules/@postman/aether/esmLib/src/components/Flex/Flex.js"),r=i("../../node_modules/@postman/aether/esmLib/src/components/Button/Button.js"),c=i("../../node_modules/@postman/aether/esmLib/src/components/Text/Text.js"),d=i("../../node_modules/@postman/aether/esmLib/src/components/Heading/Heading.js"),p=i("../../node_modules/@postman/aether/esmLib/src/components/Tooltip/Tooltip.js"),u=i("./js/utils/ClipboardHelper.js");const m=(0,o.default)(l.default)`
    background-color: var(--background-color-secondary);
    border: 1px solid var(--border-color-default);
    border-radius: var(--border-radius-default);
  `,f=o.default.div`
    background-color: var(--background-color-primary);
    border-radius: var(--border-radius-default);
    padding: var(--spacing-m) var(--spacing-l);
    overflow-y: auto;
    white-space: pre-wrap;
    text-align: ${({alignCenter:e})=>e?"center":"start"};
  `,h=(0,o.default)(r.default)`
    height: 18px;
  `;class g extends n.Component{constructor(e){super(e),this.clearCopySuccessTimeout=null,this.state={isCopySuccess:!1,copiedIndex:null,apiKey:""},this.handleApiKeyChange=this.handleApiKeyChange.bind(this)}componentWillUnmount(){this.clearCopySuccessTimeout&&clearTimeout(this.clearCopySuccessTimeout)}handleApiKeyChange(e){this.setState({apiKey:e})}handleCopy(e,t){let i="";i=t.replace("%cid",this.props.collectionId),i=i.replace("<add-your-api-key-here>%pid","'"+this.state.apiKey+"'"),u.default.copy(i),this.setState({isCopySuccess:!0,copiedIndex:e},(()=>{this.clearCopySuccessTimeout=setTimeout((()=>this.setState({isCopySuccess:!1,copiedIndex:null})),1500)}))}renderCommand(e){const[t,i]=e.split("%pid"),o=t.replace("%cid",this.props.collectionId),{apiKey:a}=this.state;return n.createElement(c.default,{color:"content-color-primary",typographyStyle:{fontSize:"text-size-m",lineHeight:"line-height-l",fontFamily:"text-family-code"}},a?o.replace("<add-your-api-key-here>",""):o,i?n.createElement(n.Fragment,null,n.createElement(s.default,{setApiKey:this.handleApiKeyChange}),i):null)}render(){const{step:e,index:t}=this.props;return n.createElement(l.default,{direction:"column",gap:"spacing-s"},n.createElement(l.default,{direction:"column"},n.createElement(c.default,{typographyStyle:{fontSize:"text-size-s",fontWeight:"text-weight-medium",lineHeight:"line-height-m"}},e.title),n.createElement(c.default,{color:"content-color-secondary",typographyStyle:{fontSize:"text-size-s",lineHeight:"line-height-m"}},e.description)),e.codeSnippet?n.createElement(m,{direction:"column",padding:"spacing-l",gap:"spacing-s"},n.createElement(l.default,{justifyContent:"space-between",alignItems:"center"},n.createElement(d.default,{type:"h5",text:e.codeSnippet.title}),n.createElement(h,{type:"tertiary",icon:n.createElement(a.default,null),onClick:()=>{var i;return this.handleCopy(t,(null===(i=e.codeSnippet)||void 0===i?void 0:i.content)||"")},tooltip:n.createElement(p.default,{content:"Copied",isOpen:t===this.state.copiedIndex&&this.state.isCopySuccess})})),n.createElement(f,null,this.renderCommand(e.codeSnippet.content))):null)}}},"../../packages/api-observability/live-collections/src/constants/diff-configs.ts":function(e,t,i){i.r(t),t.default={request:{queryParams:{diff:{type:"table",keys:["key","value","description"],colsMeta:[{name:"key"},{name:"value"},{name:"description"}],uniqueKey:"key"},display:{label:"Query Params"}},variables:{diff:{type:"table",keys:["key","value"],colsMeta:[{name:"key"},{name:"value"}],uniqueKey:"key"},display:{label:"Variables"}},headerData:{diff:{type:"table",keys:["key","value","description"],colsMeta:[{name:"key"},{name:"value"},{name:"description"}],uniqueKey:"key"},display:{label:"Headers"}},pathVariablesData:{diff:{type:"table",keys:["key","value","description"],colsMeta:[{name:"key"},{name:"value"},{name:"description"}],uniqueKey:"key"},display:{label:"Path Variables"}},name:{diff:{type:"text",granularity:"word"},display:{label:"Name"}},description:{diff:{type:"text",granularity:"line"},display:{label:"Description"}},url:{diff:{type:"text",granularity:"char"},display:{label:"URL"}},data:{diff:{type:"collectionRequestBody"},display:{label:"Body"}},method:{diff:{type:"selection"},display:{label:"Method"}},events:null,dataMode:{diff:{type:"selection"},display:{label:"Body Type"}},dataOptions:{diff:{type:"json"},display:{label:"Language"}},graphql:null,graphqlModeData:null,rawModeData:{diff:{type:"text",granularity:"line"}},auth:{diff:{type:"collectionAuth"},display:{label:"Authorization"},parser:{skip:!0}},order:null,folders_order:{node:{order:!0},display:{label:"Folders and Requests Order"},diff:{type:"order"}},responses_order:{node:{order:!0,identifier:["id"],type:"response",display:{icon:"icon-entity-example-stroke",namePath:["name"]}},display:{label:"Examples Order"},diff:{type:"order"}}},response:{headers:{diff:{type:"table",keys:["key","value","description"],colsMeta:[{name:"key"},{name:"value"},{name:"description"}],uniqueKey:"key"},display:{label:"Response headers"}},language:{diff:{type:"selection"},display:{label:"Language"}},responseCode:{diff:{type:"selection"},display:{label:"Response"}},text:{diff:{type:"text",granularity:"line"},display:{label:"Response body"}},name:{diff:{type:"text",granularity:"word"},display:{label:"Name"}},requestObject:null,headerData:{diff:{type:"table",keys:["key","value","description"],colsMeta:[{name:"key"},{name:"value"},{name:"description"}],uniqueKey:"key"},display:{label:"Headers"}},dataMode:{diff:{type:"selection"},display:{label:"Body Type"}},dataOptions:{diff:{type:"json"},display:{label:"Language"}},queryParams:{diff:{type:"table",keys:["key","value","description"],colsMeta:[{name:"key"},{name:"value"},{name:"description"}],uniqueKey:"key"},display:{label:"Query Params"}},url:{diff:{type:"text",granularity:"char"},display:{label:"URL"}},pathVariableData:{diff:{type:"table",keys:["key","value","description"],colsMeta:[{name:"key"},{name:"value"},{name:"description"}],uniqueKey:"key"},display:{label:"Path Variables"}},data:{diff:{type:"collectionRequestBody"},display:{label:"Body"}}}}},"../../packages/api-observability/live-collections/src/constants/diff.ts":function(e,t,i){i.r(t),i.d(t,{ADDED_REQUEST_SECTION:function(){return l},ADDED_RESPONSE_SECTION:function(){return r},DELETED_REQUEST_SECTION:function(){return p},DELETED_RESPONSE_SECTION:function(){return u},DIFF_TYPES:function(){return s},ENTITY_DATA_REPRESENTATION_TYPE_MAP:function(){return o},ENTITY_OPERATIONS:function(){return n},MERGE_ACTION_TYPES:function(){return a},MODIFIED_REQUEST_SECTION:function(){return c},MODIFIED_RESPONSE_SECTION:function(){return d}});const n={ADD:"added",REMOVE:"removed",MODIFY:"modified",MOVE:"moved"},o={item:"request","item-group":"folder"},s={TEXT:"text",SELECTION:"selection",TABLE:"table",LIST:"list",ORDER:"order",COLLECTION_REQUEST_BODY:"collectionRequestBody",COLLECTION_AUTH:"collectionAuth"},a={ACCEPT_CHANGES:"accept-changes",REJECT_CHANGES:"reject-changes"},l="added-request",r="added-response",c="modified-request",d="modified-response",p="deleted-request",u="deleted-response"},"../../packages/api-observability/live-collections/src/containers/DiffContainer.tsx":function(e,t,i){i.r(t);var n=i("../../node_modules/react/index.js"),o=i("../../node_modules/mobx-react/dist/mobx-react.module.js"),s=i("../../node_modules/@postman/aether/esmLib/src/components/Flex/Flex.js"),a=i("../../node_modules/@postman/aether/esmLib/src/components/Spinner/Spinner.js"),l=i("../../node_modules/@postman/aether/esmLib/src/components/BlankState/BlankState.js"),r=i("../../node_modules/@postman/aether/esmLib/src/components/Button/Button.js"),c=i("../../node_modules/@postman/aether/esmLib/src/components/Illustration/illustrations/UnableToLoad.js"),d=i("../../node_modules/@postman/aether/esmLib/src/components/Illustration/illustrations/NoPermission.js"),p=i("../../packages/api-observability/live-collections/src/components/diff-view/DiffView.tsx"),u=i("../../packages/api-observability/live-collections/src/constants/diff.ts"),m=i("./js/services/NavigationService.js"),f=i("../../packages/api-observability/live-collections/src/constants/index.ts"),h=i("./appsdk/workbench/TabService.js"),g=i("./js/stores/StoreManager.js"),y=i("./js/stores/LiveCollectionStore.js"),v=i("../../packages/api-observability/live-collections/src/utils/trackEvent.ts"),b=i("../../node_modules/lodash/lodash.js"),E=function(e,t,i,n){var o,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(s<3?o(a):s>3?o(t,i,a):o(t,i))||a);return s>3&&a&&Object.defineProperty(t,i,a),a},x=function(e,t,i,n){return new(i||(i=Promise))((function(o,s){function a(e){try{r(n.next(e))}catch(e){s(e)}}function l(e){try{r(n.throw(e))}catch(e){s(e)}}function r(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,l)}r((n=n.apply(e,t||[])).next())}))};const S=(0,g.resolveStoreInstance)(y.default);let I=class extends n.Component{constructor(e){super(e),this.closeTab=()=>{h.default.closeByRoute(f.LIVE_COLLECTION_DIFF.ROUTE)},this.state={isLoading:!1,isError:!1,diff:null,isPermissionError:!1,isConflictsError:!1}}getOrUpdateDiff(){return x(this,void 0,void 0,(function*(){this.setState({isLoading:!0},(()=>x(this,void 0,void 0,(function*(){try{const{hasConflicts:e,diff:t}=yield this.props.controller.getParsedDiff();if(e)return void this.setState({isLoading:!1,isConflictsError:!0,diff:null});this.setState({isLoading:!1,diff:t})}catch(e){return void this.setState({isLoading:!1,isError:!0})}}))))}))}componentDidMount(){return x(this,void 0,void 0,(function*(){if(this.setState({isLoading:!0}),!S.isLiveCollectionEnabled)return void this.setState({isLoading:!1});(yield S.hasCollectionEditAccess(this.props.controller.collectionId))?yield this.getOrUpdateDiff():this.setState({isPermissionError:!0,isLoading:!1})}))}mergeChanges(e){return x(this,void 0,void 0,(function*(){try{const t=this.props.controller.collectionId;yield this.props.controller.mergeChanges(e),yield this.closeTab(),yield m.default.transitionTo("build.collection",{cid:t},{})}catch(e){pm.toasts.error("Something went wrong. Please try again later")}}))}refreshDiffView(){return x(this,void 0,void 0,(function*(){yield this.getOrUpdateDiff(),(0,v.trackEvent)(this.props.controller.collectionId,"refresh-diff-view")}))}render(){return this.state.isLoading?n.createElement(s.default,{padding:"spacing-xxl spacing-xl",alignItems:"center",justifyContent:"center"},n.createElement(a.default,null)):S.isLiveCollectionEnabled?this.state.isPermissionError?n.createElement(l.default,{title:"You don't have access",description:"Please contact the admin of this workspace.",primaryAction:n.createElement(r.default,{type:"outline",text:"Close",onClick:this.closeTab})},n.createElement(d.default,null)):this.state.isConflictsError?n.createElement(l.default,{title:"Couldn't load the changes",description:"We encountered some conflicts while fetching the changes, try restoring the collection from the changelog.",primaryAction:n.createElement(r.default,{type:"outline",text:"Go to Changelog",onClick:()=>{m.default.transitionTo("build.collection",{cid:this.props.controller.collectionId},{ctx:"changelog"})}})},n.createElement(c.default,null)):this.state.isError?n.createElement(l.default,{title:"Couldn't load the changes",description:"Just a faulty wire. Try reloading.",primaryAction:n.createElement(r.default,{type:"outline",text:"Reload",onClick:this.getOrUpdateDiff})},n.createElement(c.default,null)):!b.isNull(this.state.diff)&&b.isEmpty(this.state.diff)?n.createElement(l.default,{title:"There are no changes at the moment",description:"Please come back later",primaryAction:n.createElement(r.default,{type:"outline",text:"Close",onClick:this.closeTab})},n.createElement(c.default,null)):n.createElement(p.default,{diff:this.state.diff,collectionName:this.props.controller.collectionName,collectionId:this.props.controller.collectionId,onRejectUpdates:()=>x(this,void 0,void 0,(function*(){yield this.mergeChanges(u.MERGE_ACTION_TYPES.REJECT_CHANGES)})),onUpdateCollection:()=>x(this,void 0,void 0,(function*(){return yield this.mergeChanges(u.MERGE_ACTION_TYPES.ACCEPT_CHANGES)})),onRefreshChanges:()=>x(this,void 0,void 0,(function*(){yield this.refreshDiffView()}))}):n.createElement(l.default,{title:"Not Enabled",description:"The feature you're trying to access is not enabled. Please come back later.",primaryAction:n.createElement(r.default,{type:"outline",text:"Close",onClick:this.closeTab})},n.createElement(c.default,null))}};I=E([o.observer],I),t.default=I},"../../packages/api-observability/live-collections/src/containers/LiveCollectionSetupContainer.tsx":function(e,t,i){i.r(t);var n=i("../../node_modules/react/index.js"),o=i("../../node_modules/mobx-react/dist/mobx-react.module.js"),s=i("../../packages/api-observability/live-collections/src/components/setup-steps/LiveCollectionSetupSteps.tsx"),a=i("../../node_modules/@postman/aether/esmLib/src/components/Flex/Flex.js"),l=i("../../node_modules/@postman/aether/esmLib/src/components/Spinner/Spinner.js"),r=i("../../node_modules/@postman/aether/esmLib/src/components/BlankState/BlankState.js"),c=i("../../node_modules/@postman/aether/esmLib/src/components/Button/Button.js"),d=i("../../node_modules/@postman/aether/esmLib/src/components/Illustration/illustrations/UnableToLoad.js"),p=i("../../node_modules/@postman/aether/esmLib/src/components/ResponsiveContainer/ResponsiveContainer.js"),u=i("../../packages/api-observability/live-collections/src/constants/index.ts"),m=i("./appsdk/workbench/TabService.js"),f=i("./js/stores/StoreManager.js"),h=i("./js/stores/LiveCollectionStore.js"),g=function(e,t,i,n){var o,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(s<3?o(a):s>3?o(t,i,a):o(t,i))||a);return s>3&&a&&Object.defineProperty(t,i,a),a},y=function(e,t,i,n){return new(i||(i=Promise))((function(o,s){function a(e){try{r(n.next(e))}catch(e){s(e)}}function l(e){try{r(n.throw(e))}catch(e){s(e)}}function r(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,l)}r((n=n.apply(e,t||[])).next())}))};const v=(0,f.resolveStoreInstance)(h.default);let b=class extends n.Component{constructor(e){super(e),this.state={isLoading:!1,isPermissionError:!1}}componentDidMount(){return y(this,void 0,void 0,(function*(){if(this.setState({isLoading:!0}),!v.isLiveCollectionEnabled)return void this.setState({isLoading:!1});if(!this.props.controller.collectionId)return void this.setState({isLoading:!1});(yield v.hasCollectionEditAccess(this.props.controller.collectionId))?this.setState({isLoading:!1}):this.setState({isPermissionError:!0,isLoading:!1})}))}closeTab(){m.default.closeByRoute(u.ENABLE_LIVE.ROUTE)}render(){return this.state.isLoading?n.createElement(a.default,{padding:"spacing-xxl spacing-xl",alignItems:"center",justifyContent:"center"},n.createElement(l.default,null)):v.isLiveCollectionEnabled?this.state.isPermissionError?n.createElement(r.default,{title:"Restricted",description:"You don't have permission to view this page. Please contact the admin of this workspace.",primaryAction:n.createElement(c.default,{type:"outline",text:"Close",onClick:this.closeTab})},n.createElement(d.default,null)):n.createElement(p.default,{type:"row",padding:"spacing-xxl spacing-xl"},n.createElement(p.default,{type:"column",span:2}),n.createElement(p.default,{type:"column",span:8,mobile:12,tablet:12,padding:{paddingLeft:"spacing-s",paddingRight:"spacing-s"}},n.createElement(a.default,{justifyContent:"center"},n.createElement(s.default,{close:this.props.close,controllerProps:this.props.controller})))):n.createElement(r.default,{title:"Not Enabled",description:"The feature you're trying to access is not enabled. Please come back later.",primaryAction:n.createElement(c.default,{type:"outline",text:"Close",onClick:this.closeTab})},n.createElement(d.default,null))}};b=g([o.observer],b),t.default=b},"../../packages/api-observability/live-collections/src/controllers/DiffController.ts":function(e,t,i){i.r(t),i.d(t,{default:function(){return y}});var n=i("./appsdk/workbench/BaseWorkbenchController.js"),o=i("./js/stores/StoreManager.js"),s=i("./js/stores/LiveCollectionStore.js"),a=i("../../packages/api-observability/live-collections/src/services/DiffService.ts"),l=i("../../packages/api-observability/live-collections/src/controllers/LiveCollectionController.ts"),r=i("../../packages/api-observability/live-collections/src/constants/diff.ts"),c=i("../../node_modules/mobx/lib/mobx.module.js"),d=i("../../packages/api-observability/live-collections/src/utils/diff-utils.js"),p=i("../../packages/api-observability/live-collections/src/services/pub-sub/Diff.ts"),u=i("./js/services/NavigationService.js"),m=i("./runtime-repl/collection/_api/CollectionStoreV2.js"),f=i("../../packages/api-observability/live-collections/src/utils/trackEvent.ts"),h=i("../../node_modules/lodash/lodash.js"),g=function(e,t,i,n){return new(i||(i=Promise))((function(o,s){function a(e){try{r(n.next(e))}catch(e){s(e)}}function l(e){try{r(n.throw(e))}catch(e){s(e)}}function r(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,l)}r((n=n.apply(e,t||[])).next())}))};class y extends n.default{constructor(){super(...arguments),this.liveCollectionStore=(0,o.resolveStoreInstance)(s.default),this.collectionId=null,this.liveCollectionId="",this.collectionName="",this.getParsedDiff=()=>g(this,void 0,void 0,(function*(){var e,t;try{this.collectionId||(this.collectionId=null===(e=u.default.getActiveQueryParams().get())||void 0===e?void 0:e.collection),yield(0,c.when)((()=>this.liveCollectionStore.isLoaded));if(!this.liveCollectionStore.get(this.collectionId))throw pm.logger.error(`DiffController~populateDiff: Unable to get collection from LiveCollectionStore for collection: ${this.collectionId}`),new Error(`Unable to get LiveCollectionStore for collection: ${this.collectionId}`);this.liveCollectionId=null===(t=this.liveCollectionStore.get(this.collectionId))||void 0===t?void 0:t.id;const i=yield(0,a.getUpdates)(this.liveCollectionId);if(!h.isEmpty(i.data.conflicts))return{hasConflicts:!0,diff:null};return{hasConflicts:!1,diff:yield(0,d.parseCollectionDiff)(null==i?void 0:i.data,this.collectionId)}}catch(e){throw pm.logger.error(`DiffController~populateDiff: Unable to populate diff with error: ${e}`),e}})),this.mergeChanges=e=>g(this,void 0,void 0,(function*(){if(h.includes(h.mapValues(r.MERGE_ACTION_TYPES),e)){this.collectionId&&(0,f.trackEvent)(this.collectionId,r.MERGE_ACTION_TYPES.ACCEPT_CHANGES?"update-collection":"reject-all");try{yield(0,a.mergeUpdates)(this.liveCollectionId,this.liveCollectionStore.activeWorkspaceId,{accept:e===r.MERGE_ACTION_TYPES.ACCEPT_CHANGES})}catch(e){throw pm.logger.error(`DiffController~mergeChanges: Error merging the changes: ${e}`),e}}else pm.logger.error(`DiffController~mergeChanges: Invalid merge strategy: ${e}, should be one of: ${Object.values(r.MERGE_ACTION_TYPES).join(", ")}`)})),this.getTotalUpdatesCount=e=>h.reduce(h.mapValues(e),((e,t)=>e+h.size(t.data)),0)}didCreate({queryParams:e}){return g(this,void 0,void 0,(function*(){this.collectionId=e.collection,(0,f.trackEvent)(this.collectionId,"diff-view"),this.subscribeToDiff(),this.liveCollectionStore.isLoaded||(yield l.default.loadLiveCollections()),(0,m.getOne)(this.collectionId,{exclude:["response","request"]}).then((e=>h.get(e,"name","Collection"))).then((e=>{this.collectionName=e,this.setTitle(`Review Changes (${e})`)})).catch((()=>{pm.logger.error(`DiffController~didCreate: Unable to get the collection name for collection: ${this.collectionId}`)}))}))}subscribeToDiff(){try{(0,a.subscribeToDiffUpdates)(this.collectionId,this.handleEvent.bind(this))}catch(e){pm.logger.error("DiffController~subscribeToDiff failed on subscribeToDiffUpdates",e)}}unsubscribeToDiff(){try{(0,a.unsubscribeToDiffUpdates)(this.collectionId)}catch(e){pm.logger.error("DiffController~unsubscribeToDiff failed on unsubscribeToDiffUpdates",e)}}handleEvent(e){const t=e.data.collectionId;if("collectionDiffUpdate"===e.state){if(this.collectionId!==t)return;p.default.publish("diffView",{action:e.state})}}beforeDestroy(){this.unsubscribeToDiff()}}},"../../packages/api-observability/live-collections/src/controllers/LiveCollectionSetupController.ts":function(e,t,i){i.r(t),i.d(t,{default:function(){return m}});var n=i("../../node_modules/mobx/lib/mobx.module.js"),o=i("./appsdk/workbench/BaseWorkbenchController.js"),s=i("./js/stores/LiveCollectionStore.js"),a=i("./js/stores/StoreManager.js"),l=i("./collaboration/workspace/model/ActiveWorkspaceBaseStore.ts"),r=i("../../packages/api-observability/live-collections/src/controllers/LiveCollectionController.ts"),c=i("../../packages/api-observability/live-collections/src/constants/index.ts"),d=i("../../packages/api-observability/live-collections/src/utils/trackEvent.ts"),p=function(e,t,i,n){var o,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(s<3?o(a):s>3?o(t,i,a):o(t,i))||a);return s>3&&a&&Object.defineProperty(t,i,a),a},u=function(e,t,i,n){return new(i||(i=Promise))((function(o,s){function a(e){try{r(n.next(e))}catch(e){s(e)}}function l(e){try{r(n.throw(e))}catch(e){s(e)}}function r(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,l)}r((n=n.apply(e,t||[])).next())}))};class m extends o.default{constructor(){super(...arguments),this.liveCollectionStore=(0,a.resolveStoreInstance)(s.default),this.source="",this.collectionId=null,this.activeWorkspaceId=null}didCreate(e){return u(this,void 0,void 0,(function*(){const{queryParams:t,additionalContext:i}=e;try{this.source=(null==i?void 0:i.source)||"",this.collectionId=t.collection,(0,d.trackEvent)(this.collectionId,"view-enable-live",this.source),this.liveCollectionStore.isLoaded||(yield r.default.loadLiveCollections()),this.activeWorkspaceId=(0,a.resolveStoreInstance)(l.default).id}catch(e){pm.logger.error("LiveCollectionSetupController~didCreate: error while creating controller",e)}}))}shouldClose(){return u(this,void 0,void 0,(function*(){return this.source!==c.ENABLE_LIVE_COLLECTION_SOURCE.CNX||(pm.mediator.trigger("showConfirmDeleteLiveCollectionOnTabCloseModal",{tabId:this.tabId,collectionId:this.collectionId}),!1)}))}setCollectionId(e){this.collectionId=e}setTabTitle(e){this.setTitle("Enabling live "+("("+e+")"))}}p([n.observable],m.prototype,"collectionId",void 0),p([n.observable],m.prototype,"activeWorkspaceId",void 0)},"../../packages/api-observability/live-collections/src/services/DiffService.ts":function(e,t,i){i.r(t),i.d(t,{getUpdates:function(){return d},mergeUpdates:function(){return m},subscribeToDiffUpdates:function(){return p},unsubscribeToDiffUpdates:function(){return u}});var n=i("../../node_modules/rxjs/_esm5/internal/operators/filter.js"),o=i("./js/utils/PostmanGatewayService.js"),s=i("./js/modules/services/RemoteSyncRequestService.js"),a=i("./js/stores/StoreManager.js"),l=i("./js/stores/SyncStatusStore.js"),r=i("./js/modules/services/RemoteRealtimeRequestService.js"),c=function(e,t,i,n){return new(i||(i=Promise))((function(o,s){function a(e){try{r(n.next(e))}catch(e){s(e)}}function l(e){try{r(n.throw(e))}catch(e){s(e)}}function r(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,l)}r((n=n.apply(e,t||[])).next())}))};const d=e=>c(void 0,void 0,void 0,(function*(){const t=yield o.default.request("/ws/proxy",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({service:"liveCollection",method:"GET",path:`/live-collections/${e}/diff`})},{returnRawResponse:!0});if(t.ok)return yield t.json();throw new Error("Cannot parse the response as json")})),p=(e,t)=>{(0,a.resolveStoreInstance)(l.default).onSyncAvailable({timeout:1e4}).then((()=>{(0,r.default)("/ws/proxy",{method:"POST",data:{service:"liveCollection",method:"POST",path:"/collection/diff/subscribe",body:{collectionId:e}}}).pipe((0,n.filter)((e=>"collectionDiffUpdate"===e.state))).subscribe((e=>{try{t(e)}catch(e){pm.logger.error("DiffService~subscribeToDiffUpdates failed due to handler method error",e)}}))})).catch((e=>{pm.logger.error("DiffService~subscribeToDiffUpdates failed due to websocket error",e)}))},u=e=>s.default.request("/ws/proxy",{method:"POST",data:{service:"liveCollection",method:"POST",path:"/collection/diff/unsubscribe",body:{collectionId:e},timeout:6e4}}),m=(e,t,i)=>c(void 0,void 0,void 0,(function*(){const n=yield o.default.request("/ws/proxy",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({service:"liveCollection",method:"POST",path:`/live-collections/${e}/merge`,body:{acceptChanges:i.accept,workspaceId:t}})},{returnRawResponse:!0});if(n.ok)return yield n.json();throw new Error("Cannot parse the response as json")}))},"../../packages/api-observability/live-collections/src/services/pub-sub/Diff.ts":function(e,t,i){i.r(t);var n=i("./runtime-repl/_common/services/PubSub.ts");class o extends n.default{}const s=new o;t.default=s},"../../packages/api-observability/live-collections/src/types/DiffView.ts":function(e,t,i){i.r(t)},"../../packages/api-observability/live-collections/src/types/SetupSteps.ts":function(e,t,i){var n;i.r(t),i.d(t,{APIKeyRendererViews:function(){return n}}),function(e){e.InsertAPIKey="InsertAPIKey",e.EnterAPIKey="EnterAPIKey",e.GenerateAPIKey="GenerateAPIKey",e.GeneratedKey="GeneratedKey",e.InsertedAPIKey="InsertedAPIKey",e.UseExistingKey="UseExistingKey"}(n||(n={}))},"../../packages/api-observability/live-collections/src/types/index.ts":function(e,t,i){i.r(t),i.d(t,{APIKeyRendererViews:function(){return n.APIKeyRendererViews}});i("../../packages/api-observability/live-collections/src/types/popovers/LiveCollectionMetaPopover.ts");var n=i("../../packages/api-observability/live-collections/src/types/SetupSteps.ts");i("../../packages/api-observability/live-collections/src/types/DiffView.ts")},"../../packages/api-observability/live-collections/src/types/popovers/LiveCollectionMetaPopover.ts":function(e,t,i){i.r(t)},"../../packages/api-observability/live-collections/src/utils/diffView.ts":function(e,t,i){function n(){let e=0,t=window.scrollX,i=window.scrollY;return new Promise((n=>{!function o(s){s-e>10?n():(window.scrollX===t&&window.scrollY===i||(e=s,t=window.scrollX,i=window.scrollY),requestAnimationFrame(o.bind(null,s+1)))}(0)}))}i.r(t),i.d(t,{waitForScrollToEnd:function(){return n}})},"../../packages/api-observability/live-collections/src/utils/setupSteps.ts":function(e,t,i){i.r(t),i.d(t,{getSetupStepsConfig:function(){return c}});var n=i("../../packages/api-observability/live-collections/src/data/fallback-steps.json"),o=i("../../packages/api-observability/live-collections/src/constants/index.ts"),s=i("./js/utils/HttpService.js"),a=i("./onboarding/src/common/LaunchDarkly.js"),l=i("../../packages/api-observability/live-collections/src/utils/trackEvent.ts"),r=function(e,t,i,n){return new(i||(i=Promise))((function(o,s){function a(e){try{r(n.next(e))}catch(e){s(e)}}function l(e){try{r(n.throw(e))}catch(e){s(e)}}function r(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,l)}r((n=n.apply(e,t||[])).next())}))};const c=()=>r(void 0,void 0,void 0,(function*(){let e=[];const t={},i={},r={};return(0,l.trackEvent)("","setup-steps","get-config"),yield s.default.request(o.LIVE_COLLECTIONS_ASSETS_URL,{method:"GET",headers:{},credentials:"omit"}).then((t=>{e=t.body.data,(0,l.trackEvent)("","setup-steps","get-config-success")})).catch((t=>{e=n.data,pm.logger.error("LiveCollectionSetupSteps~getSetupStepsConfig - There was an error while fetching the steps config",t),pm.logger.info("LiveCollectionSetupSteps~getSetupStepsConfig - Using fallback steps config"),(0,l.trackEvent)("","setup-steps","get-config-error")})),e.forEach((e=>{t[e.id]={id:e.id,label:e.label,icon:e.icon,isEnabled:()=>!e.launchDarklyFlag||a.launchDarkly.getFlag(e.launchDarklyFlag,!1)},i[e.id]=e.frameworks.reduce(((e,t)=>(t.launchDarklyFlag&&!a.launchDarkly.getFlag(t.launchDarklyFlag,!1)||(r[t.id]=t.steps,e.push({label:t.label,value:t.id})),e)),[])})),{LANGUAGE_OPTIONS:t,FRAMEWORKS:i,STEPS_CONFIG:r}}))},"../../packages/api-observability/live-collections/src/data/fallback-steps.json":function(e){e.exports=JSON.parse('{"data":[{"id":"node","label":"Node.js","icon":"https://live-collection-assets.pstmn.io/setup-steps/node-js.svg","launchDarklyFlag":"","frameworks":[{"id":"express","label":"Express.js","launchDarklyFlag":"","steps":[{"title":"1. Install Postman SDK","description":"From your project\'s root directory install the latest Postman SDK.","codeSnippet":{"title":"Install SDK","content":"npm install --save @postman/postman-sdk"}},{"title":"2. Configure Postman SDK in the code","description":"Paste the following code snippet at the top in your project\'s main index.js file","codeSnippet":{"title":"JavaScript","content":"const pm = require(\'@postman/postman-sdk\');\\n  \\n  pm.initialize({\\n    collectionId: \'%cid\',\\n    apiKey: <add-your-api-key-here>%pid\\n  });"}},{"title":"3. Restart your Node.js application","description":"For changes to reflect, restart your application."},{"title":"4. Test the connection","description":"To know if the connection is established, test it."}]},{"id":"sails","label":"Sails.js","launchDarklyFlag":"","steps":[{"title":"1. Install Postman SDK","description":"From your project\'s root directory install the latest Postman SDK.","codeSnippet":{"title":"Install SDK","content":"npm install --save @postman/postman-sdk"}},{"title":"2. Configure Postman SDK in the code","description":"Paste the following code snippet at the top in your project\'s main index.js file","codeSnippet":{"title":"JavaScript","content":"const pm = require(\'@postman/postman-sdk\');\\n  \\n  pm.initialize({\\n    collectionId: \'%cid\',\\n    apiKey: <add-your-api-key-here>%pid\\n  });"}},{"title":"3. Restart your Node.js application","description":"For changes to reflect, restart your application."},{"title":"4. Test the connection","description":"To know if the connection is established, test it."}]}]},{"id":"python","label":"Python","icon":"https://live-collection-assets.pstmn.io/setup-steps/python.svg","launchDarklyFlag":"is_python_sdk_enabled_for_live_collections","frameworks":[{"id":"flask","label":"Flask","launchDarklyFlag":"","steps":[{"title":"1. Install Postman SDK","description":"From your project\'s root directory install the latest Postman SDK.","codeSnippet":{"title":"Install SDK","content":"pip install postman-sdk"}},{"title":"2. Configure Postman SDK in the code","description":"Paste the following code snippet before you initialize your Flask app","codeSnippet":{"title":"Python","content":"import postman_sdk as pm\\n  \\n  pm.initialize({\\n      \'collection_id\': \'%cid\',\\n      \'api_key\': <add-your-api-key-here>%pid\\n  })"}},{"title":"3. Restart your Python application","description":"For changes to reflect, restart your application."},{"title":"4. Test the connection","description":"To know if the connection is established, test it."}]}]}]}')}}]);