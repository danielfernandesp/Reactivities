"use strict";(self.webpackChunk_postman_app_renderer=self.webpackChunk_postman_app_renderer||[]).push([[68],{"../../node_modules/@postman/aether/esmLib/src/components/FileUploader/FileUploader.js":function(e,t,n){n.r(t);var a=n("../../node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),s=n("../../node_modules/react/index.js"),r=n("../../node_modules/styled-components/dist/styled-components.browser.esm.js"),o=n("../../node_modules/prop-types/index.js"),i=n.n(o),l=n("../../node_modules/@postman/aether/esmLib/src/components/Flex/Flex.js"),c=n("../../node_modules/@postman/aether/esmLib/src/components/Label/Label.js"),d=n("../../node_modules/@postman/aether/esmLib/src/components/Text/Text.js"),u=n("../../node_modules/@postman/aether/esmLib/src/components/Button/Button.js"),p=r.default.input.attrs({type:"file"}).withConfig({displayName:"FileUploader__StyledInputFile",componentId:"yxf6ba-0"})(["height:0.1px;opacity:0;width:0.1px;z-index:-1;&:focus + label{box-shadow:",";outline:none;}"],(function(e){return e.theme["shadow-focus"]})),m=r.default.label.withConfig({displayName:"FileUploader__StyledFileUploaderLabel",componentId:"yxf6ba-1"})(["user-select:none;color:",";font-size:",";width:max-content;height:",";vertical-align:middle;line-height:",";display:inline-block;padding:",";border:",";border-color:",";box-sizing:border-box;border-radius:",";margin-top:",";&:hover{cursor:",";border-color:",";}"],(function(e){return e.isDisabled?e.theme["content-color-tertiary"]:e.theme["content-color-primary"]}),(function(e){return e.theme["text-size-m"]}),(function(e){return e.theme["size-m"]}),(function(e){return"calc(".concat(e.theme["line-height-xxl"]," - 2px)")}),(function(e){return"".concat(e.theme["spacing-zero"]," ").concat(e.theme["spacing-m"])}),(function(e){return e.theme["button-outline-border"]}),(function(e){return e.theme["button-outline-border-color"]}),(function(e){return e.theme["border-radius-default"]}),(function(e){return e.theme["spacing-s"]}),(function(e){return e.isDisabled?"not-allowed":"pointer"}),(function(e){return!e.isDisabled&&e.theme["button-outline-hover-border-color"]})),f=r.default.div.withConfig({displayName:"FileUploader__StyleFileListWrapper",componentId:"yxf6ba-2"})(["width:320px;height:32px;border-radius:",";padding-left:",";display:flex;justify-content:space-between;align-items:'center';background-color:",";& .aether-remove-uploaded-file-btn{border-top-left-radius:0;border-bottom-left-radius:0;}color:",";"],(function(e){return e.theme["border-radius-default"]}),(function(e){return e.theme["spacing-m"]}),(function(e){return e.theme["background-color-secondary"]}),(function(e){return e.theme["content-color-primary"]})),g=r.default.div.withConfig({displayName:"FileUploader__StyledFileNameContainer",componentId:"yxf6ba-3"})(["display:flex;align-items:center;width:258px;"]);var y=s.forwardRef((function(e,t){var n=e.initialList,r=e.label,o=e.helperText,i=e.actionLabel,y=e.id,h=e.name,b=e.className,v=e.isDisabled,E=e.multiple,x=e.onChange,S=e.accept,j=e.autoFocus,_=e["data-testid"],C=e["data-click"],R=(0,s.useState)(!E&&Array.isArray(n)?n:[]),w=(0,a.default)(R,2),L=w[0],k=w[1],T=(0,s.useRef)(null);T=t||T;var O=(0,s.useRef)(null);return s.createElement(l.default,{direction:"column"},function(e){return"string"==typeof e?s.createElement(c.default,{size:"medium"},e):e&&s.isValidElement(e)&&e.type===c.default?s.cloneElement(e,{size:"medium"}):null}(r),o&&s.createElement(d.default,{type:"_input-meta-text",color:"content-color-secondary",lineLengthType:"none"},o),s.createElement(p,{id:y,ref:T,onChange:function(e){var t=e.target,n=t&&t.files;0!==n.length?(k(Object.values(n).map((function(e){return{name:e.name}}))),O.current=n,x&&!v&&x(n)):T.current.files=O.current},multiple:E,disabled:v,accept:S,name:h,className:b,"data-testid":_,"data-click":C,autoFocus:j}),s.createElement(m,{"data-aether-id":"aether-label",htmlFor:y,isDisabled:v},i),L.length>0&&s.createElement(l.default,{direction:"column",padding:{paddingTop:"spacing-l"},gap:"spacing-xs"},L.map((function(e){return s.createElement(f,{className:"aether-file-list-wrapper","data-aether-id":"aether-fileUploader",key:e.name},s.createElement(g,null,s.createElement(d.default,{type:"body-medium",isTruncated:!0},e.name)),s.createElement(u.default,{className:"aether-remove-uploaded-file-btn",onClick:function(){!function(e){for(var t=T.current&&T.current.files,n=new DataTransfer,a=0;a<t.length;a+=1){var s=t[a];e!==s.name&&n.items.add(s)}k(L.filter((function(t){return e!==t.name}))),T.current.files=n.files,x&&!v&&x(T.current.files)}(e.name)},type:"tertiary",icon:"icon-action-close-stroke"}))}))))}));y.defaultProps={initialList:void 0,helperText:"",actionLabel:"Add Files",isDisabled:!1,multiple:!1,accept:"*",name:"",className:"",autoFocus:!1,"data-testid":"aether-file-uploader","data-click":""},y.propTypes={initialList:i().arrayOf(i().object),label:i().oneOfType([i().string,i().instanceOf(c.default)]).isRequired,onChange:i().func.isRequired,helperText:i().string,actionLabel:i().node,id:i().string.isRequired,name:i().string,className:i().string,isDisabled:i().bool,multiple:i().bool,accept:i().string,autoFocus:i().bool,"data-testid":i().string,"data-click":i().string},y.displayName="FileUploader",t.default=y},"../../packages/api-security/admin-panels/src/components/AddCustomRule.tsx":function(e,t,n){n.r(t);var a=n("../../node_modules/lodash/lodash.js"),s=n("../../node_modules/react/index.js"),r=n("../../node_modules/styled-components/dist/styled-components.browser.esm.js"),o=n("../../node_modules/@postman/aether/esmLib/src/components/Flex/Flex.js"),i=n("../../node_modules/@postman/aether/esmLib/src/components/ResponsiveContainer/ResponsiveContainer.js"),l=n("../../node_modules/@postman/aether/esmLib/src/components/Text/Text.js"),c=n("../../node_modules/@postman/aether/esmLib/src/components/Heading/Heading.js"),d=n("../../node_modules/@postman/aether/esmLib/src/components/FileUploader/FileUploader.js"),u=n("../../node_modules/@postman/aether/esmLib/src/components/Button/Button.js"),p=n("../../node_modules/@postman/aether/esmLib/src/components/Toast/ToastManager.js"),m=n("./appsdk/components/link/Link.js"),f=n("./js/modules/services/AnalyticsService.js"),g=n("../../packages/api-security/admin-panels/src/components/Editor/index.tsx"),y=n("../../packages/api-security/admin-panels/src/components/Header.tsx"),h=n("../../packages/api-security/admin-panels/src/components/NoAccessPopover.tsx"),b=n("../../packages/api-security/admin-panels/src/constants/index.ts"),v=n("../../packages/api-security/admin-panels/src/utils/index.ts");const E=(0,r.default)(o.default)`
  align-self: center;
  justify-self: flex-end;

  > div {
    align-items: flex-end;

    > label {
      margin-top: 0px;
      border-color: var(--content-color-tertiary);
    }
  }
`;t.default=function({store:e,heading:t,ruleCategory:n,backHandler:r,canManageRuleset:x}){const[S,j]=(0,s.useState)(!1),[_,C]=(0,s.useState)({}),[R,w]=(0,s.useState)({value:"yaml",label:"YAML"}),[L,k]=(0,s.useState)(e.getBoilerplate(R.value));return s.createElement(i.default,{type:"row",padding:"spacing-xxl spacing-xl"},s.createElement(i.default,{type:"column",span:2,gap:"spacing-xl"}),s.createElement(i.default,{type:"column",span:8,gap:"spacing-xl"},s.createElement(i.default,{type:"column",gap:"spacing-zero"},s.createElement(y.default,{heading:t,noBottomPadding:!0,previousItem:"governance"===n?{route:{path:b.GOVERNANCE_ROUTE_IDENTIFIER,queryParams:{activeTab:"rules"}},name:"API Governance"}:{route:{path:b.SECURITY_ROUTE_IDENTIFIER},name:"API Security"},info:s.createElement(l.default,{type:"body-large",maxLine:2,lineLengthType:"none"},"Postman uses"," ",s.createElement(l.default,{type:"link-default"},s.createElement(m.default,{to:b.SPECTRAL_LINK,target:"_blank"},"Spectral v6"))," ","for defining the linting rules. To know more about creating your own rules, read"," ",s.createElement(l.default,{type:"link-default",isExternal:!0},s.createElement(m.default,{target:"_blank",to:"governance"===n?b.API_GOV_CUSTOM_RULES_LC_LINK:b.API_SEC_CUSTOM_RULES_LC_LINK},`Configuring API ${a.capitalize(n)} rules`)))})),s.createElement(i.default,{type:"column",gap:"spacing-xs"},s.createElement(i.default,{type:"row"},s.createElement(i.default,{type:"column",overflow:"hidden",span:a.size(_)>0?6:8,gap:"spacing-zero"},s.createElement(c.default,{type:"h6",text:"Define rule"}),s.createElement(l.default,null,"Write the logic for the rule from scratch, or upload YAML/JSON file(s).")),s.createElement(i.default,{overflow:"hidden",direction:"column",span:a.size(_)>0?6:4},s.createElement(h.default,{isDisabled:!x,placement:"bottom-end",message:"Only Admins can upload files.",triggerElement:s.createElement(E,{padding:{paddingRight:"spacing-xs"}},s.createElement(d.default,{multiple:!0,accept:".yaml,.json",actionLabel:"Upload file(s)",isDisabled:!x,onChange:C,id:`${n}-rule-file-uploader`,"data-testid":`${n}-rule-file-uploader`}))}))),s.createElement(i.default,{type:"column",minHeight:"50vh",overflow:"hidden",padding:{paddingRight:"spacing-xs"}},s.createElement(g.default,{snippets:e.snippets,errors:e.errors,readOnly:a.size(_)>0||!x,content:L,setContent:k,ruleCategory:n,activeLanguage:R,setActiveLanguage:t=>{L===e.getBoilerplate(R.value)&&k(e.getBoilerplate(t.value)),w(t)}}))),s.createElement(i.default,{type:"column"},s.createElement(o.default,{gap:"spacing-s"},s.createElement(h.default,{isDisabled:!x,placement:"top-start",message:"Only Admins can create rules.",triggerElement:s.createElement("div",null,s.createElement(u.default,{text:"Create",type:"primary","data-testid":`${n}-add-rule-create-button`,isDisabled:S||!L&&0===a.size(_)||!x,onClick:()=>{if(L&&0===a.size(_)){const t=L===e.getBoilerplate(R.value)?"custom-rule-using-boilerplate":"custom-rule-using-text-editor";j(!0),e.createCustomRule({body:L,tags:[n],engine:b.SPECTRAL_V6,language:R.value},t).then((()=>{j(!1)}))}else if(_[0])j(!0),(0,v.getFileContent)(_).then((({content:t,language:a})=>{e.createCustomRule({body:t,tags:[n],engine:b.SPECTRAL_V6,language:a},"custom-rule-with-file-upload").then((()=>{j(!1)}))})).catch((e=>{j(!1),(0,p.toast)({status:"error",title:"File upload was unsuccessful",description:e.message||"Something went wrong, try again"}),f.default.addEventV2({category:`${n}-create-custom-rule`,label:"custom-rule-with-file-upload-failed",action:"create-custom-rule",value:1})}));else{const e=L||0!==a.size(_)?"Something went wrong, try again":"Write up the logic for the rule, or upload YAML/JSON file(s)";(0,p.toast)({status:"error",description:e})}}}))}),s.createElement(u.default,{text:"Cancel",type:"secondary",onClick:()=>{f.default.addEventV2({category:`${n}-create-custom-rule`,action:"cancel-create-custom-rule",value:1}),r()},"data-testid":`${n}-add-rule-cancel-button`})))))}},"../../packages/api-security/admin-panels/src/components/Editor/EditorActions.tsx":function(e,t,n){n.r(t),n.d(t,{default:function(){return p}});var a=n("../../node_modules/react/index.js"),s=n("../../node_modules/@postman/aether/esmLib/src/components/Flex/Flex.js"),r=n("../../node_modules/@postman/aether/esmLib/src/components/Dropdown/SingleSelect/SingleSelect.js"),o=n("../../node_modules/@postman/aether/esmLib/src/components/Button/Button.js"),i=n("../../node_modules/@postman/aether-icons/esmLib/src/design-system-icons/icon-action-pretty-stroke.js"),l=n("../../node_modules/@postman/aether-icons/esmLib/src/design-system-icons/icon-action-wrap-stroke.js"),c=n("../../node_modules/@postman/aether-icons/esmLib/src/design-system-icons/icon-action-copy-stroke.js"),d=n("../../node_modules/@postman/aether-icons/esmLib/src/design-system-icons/icon-action-search-stroke.js"),u=n("./js/utils/ClipboardHelper.js");function p({editor:e,content:t,wordWrap:n,readOnly:p,setWordWrap:m,activeLanguage:f,setActiveLanguage:g}){const y=pm.settings.getSetting("editorIndentCount"),h="space"===pm.settings.getSetting("editorIndentType");return a.createElement(s.default,{gap:"spacing-xs",justifyContent:"flex-end",alignItems:"center"},a.createElement(r.default,{triggerWidth:"javascript"===f.value?110:80,isClearable:!1,isSearchable:!1,isDisabled:"javascript"===f.value||p,triggerType:"tertiary",value:f,onChange:g,options:"javascript"===f.value?[]:[{value:"yaml",label:"YAML"},{value:"json",label:"JSON"}],"data-testid":"api-governance-rule-editor-language-selector"}),a.createElement(o.default,{type:"tertiary",tooltip:"Beautify",isDisabled:p,onClick:function(){if(e.current){const t=e.current.beautifyContent;e.current.editor.getModel().updateOptions({insertSpaces:h,tabSize:y}),t&&t(),e.current.focus()}},icon:a.createElement(i.default,null),"data-testid":"api-governance-rule-editor-beautify"}),a.createElement(o.default,{type:"tertiary",tooltip:"Wrap text",isDisabled:p,onClick:()=>m(!n),"data-testid":"api-governance-rule-editor-wrap-text",icon:a.createElement(l.default,{color:n?"content-color-primary":""})}),a.createElement(o.default,{tooltip:"Copy",type:"tertiary",isDisabled:p,onClick:function(){u.default.copy(t),pm.toasts.success("Copied to clipboard",{dedupeId:"api-governance-copied-message"})},icon:a.createElement(c.default,null),"data-testid":"api-governance-rule-editor-copy-text"}),a.createElement(o.default,{type:"tertiary",tooltip:"Search",isDisabled:p,onClick:function(){e.current.toggleFindWidget()},icon:a.createElement(d.default,null),"data-testid":"api-governance-rule-editor-search-text"}))}},"../../packages/api-security/admin-panels/src/components/Editor/EditorErrors.tsx":function(e,t,n){n.r(t),n.d(t,{default:function(){return f}});var a=n("../../node_modules/lodash/lodash.js"),s=n("../../node_modules/react/index.js"),r=n("../../node_modules/styled-components/dist/styled-components.browser.esm.js"),o=n("../../node_modules/@postman/aether/esmLib/src/components/Flex/Flex.js"),i=n("../../node_modules/@postman/aether/esmLib/src/components/Text/Text.js"),l=n("../../node_modules/@postman/aether/esmLib/src/components/Popover/Popover.js"),c=n("../../node_modules/@postman/aether/esmLib/src/components/Table/Table.js"),d=n("../../node_modules/@postman/aether-icons/esmLib/src/design-system-icons/icon-state-fail-fill-small.js"),u=n("../../node_modules/@postman/aether-icons/esmLib/src/design-system-icons/icon-direction-up.js"),p=n("../../node_modules/@postman/aether-icons/esmLib/src/design-system-icons/icon-direction-down.js");const m=r.default.div`
  cursor: pointer;
`;function f({errors:e}){const[t,n]=(0,s.useState)(!1);return e&&0!==e.length?1===e.length?s.createElement(o.default,{alignItems:"center",gap:"spacing-s",padding:"spacing-zero spacing-l"},s.createElement(d.default,{color:"base-color-error"}),s.createElement(i.default,{type:"para",maxLines:2,color:"base-color-error"},a.get(e,"0.message",""))):s.createElement(l.default,{maxWidth:"55vw",isOpen:t,placement:"bottom-start",onClickOutside:()=>n(!1),trigger:s.createElement(m,{"data-testid":"rule-editor-multiple-errors-label",onClick:()=>n(!t)},s.createElement(o.default,{alignItems:"center",gap:"spacing-s",padding:"spacing-zero spacing-l"},s.createElement(d.default,{color:"base-color-error"}),s.createElement(o.default,{alignItems:"center",gap:"spacing-xs"},s.createElement(i.default,{type:"para",maxLines:1,color:"base-color-error"},`${e.length} issues found`),t?s.createElement(u.default,{color:"base-color-error"}):s.createElement(p.default,{color:"base-color-error"}))))},s.createElement(c.default,{data:e,columns:[{Header:"Name",accessor:"message"},{Header:"Path",accessor:"instancePath"}],bodyMaxHeight:"40vh"})):null}},"../../packages/api-security/admin-panels/src/components/Editor/EditorSnippets.tsx":function(e,t,n){n.r(t),n.d(t,{default:function(){return p}});var a=n("../../node_modules/react/index.js"),s=n("../../node_modules/styled-components/dist/styled-components.browser.esm.js"),r=n("../../node_modules/@postman/aether/esmLib/src/components/Button/Button.js"),o=n("../../node_modules/@postman/aether/esmLib/src/components/Flex/Flex.js"),i=n("../../node_modules/@postman/aether/esmLib/src/components/Text/Text.js"),l=n("./js/modules/services/AnalyticsService.js"),c=n("../../node_modules/lodash/lodash.js");const d=(0,s.default)(r.default)`
  justify-content: flex-start;
  text-align: left;
`,u=(0,s.default)(o.default)`
  flex: 1;
  overflow-y: auto;
`;function p({editor:e,activeLanguage:t,snippets:n,ruleCategory:s}){return a.createElement(o.default,{direction:"column",padding:"spacing-s",gap:"spacing-xl",width:"auto",height:"100%",shrink:1},a.createElement(o.default,{shrink:1},a.createElement(i.default,{type:"body-medium",color:"content-color-secondary",typographyStyle:{fontWeight:"text-weight-bold"}},"Snippets")),a.createElement(u,{direction:"column"},a.createElement(o.default,{direction:"column",gap:"spacing-xl"},n.map((({name:n,snippets:r})=>a.createElement(o.default,{direction:"column",gap:"spacing-s"},a.createElement(i.default,{type:"body-medium",color:"content-color-secondary",typographyStyle:{fontWeight:"text-weight-regular"}},n),a.createElement(o.default,{direction:"column",gap:"spacing-m"},r.map((({id:n,name:r,code:o})=>a.createElement(d,{key:n,fullWidth:!0,type:"plain",text:r,onClick:()=>{const a=o[t.value]||"",r=pm.settings.getSetting("editorIndentCount");let i="";c.times(r,(()=>{i+=" "})),e.current.insertTextBlock(a.replace(/{%i}/g,i)),function(e,t){const n="space"===pm.settings.getSetting("editorIndentType");if(e.current){const a=e.current.beautifyContent;e.current.editor.getModel().updateOptions({insertSpaces:n,tabSize:t}),a&&a(),e.current.focus()}}(e,r),l.default.addEventV2({category:`${s}-custom-rule`,action:"snippet-added",entityType:"snippet",entityId:n})}}))))))))))}},"../../packages/api-security/admin-panels/src/components/Editor/index.tsx":function(e,t,n){n.r(t);var a=n("../../node_modules/react/index.js"),s=n("../../node_modules/styled-components/dist/styled-components.browser.esm.js"),r=n("../../node_modules/@postman/aether/esmLib/src/components/Flex/Flex.js"),o=n("../../packages/client-foundation/text-editor/index.js"),i=n("../../packages/api-security/admin-panels/src/components/Editor/EditorActions.tsx"),l=n("../../packages/api-security/admin-panels/src/components/Editor/EditorErrors.tsx"),c=n("../../packages/api-security/admin-panels/src/components/Editor/EditorSnippets.tsx"),d=n("../../packages/api-security/admin-panels/src/utils/schemas/spectralRuleFormat.json");const u=(0,s.default)(r.default)`
  overflow: hidden;

  .text-editor__lazy_loading-indicator {
    margin: auto;
    position: unset;
  }
`;t.default=function({errors:e,readOnly:t,content:n,snippets:s,setContent:p,activeLanguage:m,ruleCategory:f,setActiveLanguage:g,typeDefinitionsProvider:y,onTextEditorRegister:h=(()=>{})}){const b=(0,a.useRef)(),[v,E]=(0,a.useState)(!1),x=pm.settings.getSetting("editorIndentCount");return a.createElement(r.default,{height:"50vh",border:{border:"border-width-default",borderColor:"content-color-tertiary"}},a.createElement(u,{grow:1,shrink:1,width:s&&0!==s.length?"50vw":"100%",height:"100%",direction:"column",border:{borderRight:s&&0!==s.length?"border-width-default":"0px",borderColor:"content-color-tertiary"}},a.createElement(r.default,{alignItems:"center",justifyContent:"space-between",padding:"spacing-m spacing-xs",width:"100%",border:{borderBottom:"border-width-default",borderColor:"content-color-tertiary"}},a.createElement("div",null,a.createElement(l.default,{errors:e})),a.createElement(r.default,{justifyContent:"flex-end"},a.createElement(i.default,{editor:b,content:n,readOnly:t,wordWrap:v,setWordWrap:E,activeLanguage:m,setActiveLanguage:g}))),a.createElement(o.TextEditor,{key:m.value,ref:b,fontSize:12,value:n,readOnly:t,wordWrap:v,onChange:p,language:m.value,registerTextEditor:h,indentation:{indentationType:"space",indentationSize:x},settings:{validate:!0,completion:!0,fileMatch:[m.value],schemas:[{schema:d}]},typeDefinitionsProvider:"javascript"===m.value?y:null})),s&&s.length>0?a.createElement(c.default,{editor:b,activeLanguage:m,snippets:s,ruleCategory:f}):null)}},"../../packages/api-security/admin-panels/src/components/UnauthorizedState.tsx":function(e,t,n){n.r(t),n.d(t,{default:function(){return l}});var a=n("../../node_modules/react/index.js"),s=n("../../node_modules/@postman/aether/esmLib/src/components/BlankState/BlankState.js"),r=n("../../node_modules/@postman/aether/esmLib/src/components/Button/Button.js"),o=n("../../node_modules/@postman/aether/esmLib/src/components/Illustration/illustrations/NoPermission.js"),i=n("./js/services/NavigationService.js");function l({category:e,testId:t,showHomeButton:n=!0}){return a.createElement(s.default,{"data-testid":t||`${e.toLowerCase()}-unauthorized-access`,description:"Only Admins can view this.",title:"You donâ€™t have access",primaryAction:n?a.createElement(r.default,{type:"primary",text:"Go to Home",onClick:()=>i.default.transitionTo("home")}):null},a.createElement(o.default,null))}},"../../packages/api-security/admin-panels/src/components/ViewRule.tsx":function(e,t,n){n.r(t);var a=n("../../node_modules/lodash/lodash.js"),s=n("../../node_modules/react/index.js"),r=n("../../node_modules/styled-components/dist/styled-components.browser.esm.js"),o=n("../../node_modules/@postman/aether/esmLib/src/components/Button/Button.js"),i=n("../../node_modules/@postman/aether/esmLib/src/components/ResponsiveContainer/ResponsiveContainer.js"),l=n("../../node_modules/@postman/aether/esmLib/src/components/Banner/Banner.js"),c=n("../../node_modules/@postman/aether/esmLib/src/components/Heading/Heading.js"),d=n("../../node_modules/@postman/aether/esmLib/src/components/Flex/Flex.js"),u=n("../../node_modules/@postman/aether/esmLib/src/components/Modal/Modal.js"),p=n("../../node_modules/@postman/aether/esmLib/src/components/Text/Text.js"),m=n("../../node_modules/@postman/aether/esmLib/src/components/ButtonGroup/ButtonGroup.js"),f=n("./js/modules/services/AnalyticsService.js"),g=n("../../packages/api-security/admin-panels/src/components/Editor/index.tsx"),y=n("../../packages/api-security/admin-panels/src/components/Header.tsx"),h=n("../../packages/api-security/admin-panels/src/components/NoAccessPopover.tsx"),b=n("../../packages/api-security/admin-panels/src/constants/index.ts");const v=(0,r.default)(o.default)`
  max-width: 62px;
`;t.default=function({rule:e,ruleCategory:t,canManageRuleset:n,deleteRule:r}){const E=a.get(e,"config.spectralRule.body")?a.get(e,"config.spectralRule.body"):JSON.stringify(a.get(e,"config.spectralRule.json")),x=a.get(e,"config.spectralRule.language")?a.get(e,"config.spectralRule.language"):"json",S="TEAM"===a.get(e,"ownerType"),[j,_]=(0,s.useState)(!1),[C,R]=(0,s.useState)(!1),w={body:E,language:x};if(!w||!e)return null;const L="json"===w.language?JSON.stringify(JSON.parse(w.body),null,2):w.body;return s.createElement(s.Fragment,null,s.createElement(i.default,{type:"row",padding:"spacing-xl"},s.createElement(i.default,{type:"column",span:2}),s.createElement(i.default,{type:"column",span:8,gap:"spacing-xl"},s.createElement(i.default,{type:"column"},s.createElement(y.default,{noBottomPadding:!0,heading:e.message,previousItem:"governance"===t?{route:{path:b.GOVERNANCE_ROUTE_IDENTIFIER,queryParams:{activeTab:"rules"}},name:"API Governance"}:{route:{path:b.SECURITY_ROUTE_IDENTIFIER},name:"API Security"}}),s.createElement(l.default,{status:"warning",title:"You can only view rule details"},S?"Editing rules aren't supported yet. You can try deleting and adding a new rule.":"This is a default rule. You can only view the details.")),s.createElement(i.default,{type:"column",gap:"spacing-xs"},s.createElement(i.default,{type:"row"},s.createElement(i.default,{type:"column",gap:"spacing-zero"},s.createElement(c.default,{type:"h6",text:"Rule details"}))),s.createElement(i.default,{type:"column",minHeight:"45vh",overflow:"hidden"},s.createElement(g.default,{readOnly:!0,errors:null,ruleCategory:t,content:L,setContent:()=>{},activeLanguage:{value:w.language,label:w.language.toUpperCase()},setActiveLanguage:()=>{}}))),S?s.createElement(i.default,{type:"column",gap:"spacing-zero"},s.createElement(d.default,null,s.createElement(h.default,{isDisabled:!n,placement:"top-start",message:"Only Admins can delete rules.",triggerElement:s.createElement("div",null,s.createElement(v,{isDisabled:!n,text:"Delete",type:"destructive",onClick:()=>_(!0),"data-testid":`${t}-view-rule-delete-button`}))}))):null)),s.createElement(u.Modal,{isOpen:j,size:"small",onClose:()=>_(!1)},s.createElement(u.ModalHeader,{heading:"Delete rule?"}),s.createElement(u.ModalContent,null,s.createElement(p.default,{type:"para",color:"content-color-primary"},b.DELETE_CUSTOM_RULE_MESSAGE[t])),s.createElement(u.ModalFooter,null,s.createElement(d.default,{justifyContent:"flex-end",grow:1,shrink:1},s.createElement(m.default,null,s.createElement(o.default,{text:"Cancel",type:"secondary",onClick:()=>_(!1),"data-testid":`${t}-view-rule-delete-modal-cancel-button`}),s.createElement(o.default,{text:"Delete",type:"destructive",onClick:()=>{R(!0),r().then((()=>{f.default.addEventV2({category:`${t}-admin-panel`,action:S?"delete-vulnerability":"remove-vulnerability",entityId:e.id,entityType:"vulnerability",value:1}),R(!1)})).catch((()=>{R(!1)})),_(!1)},isDisabled:C,"data-testid":`${t}-view-rule-delete-modal-delete-button`}))))))}},"../../packages/api-security/admin-panels/src/containers/SecurityAddCustomRule.tsx":function(e,t,n){n.r(t);var a=n("../../node_modules/mobx-react/dist/mobx-react.module.js"),s=n("../../node_modules/react/index.js"),r=n("../../node_modules/@postman/aether/esmLib/src/components/Flex/Flex.js"),o=n("../../node_modules/@postman/aether/esmLib/src/components/Spinner/Spinner.js"),i=n("./js/modules/services/AnalyticsService.js"),l=n("./js/services/NavigationService.js"),c=n("./js/stores/StoreManager.js"),d=n("../../packages/api-security/admin-panels/src/components/AddCustomRule.tsx"),u=n("../../packages/api-security/admin-panels/src/components/UnauthorizedState.tsx"),p=n("../../packages/api-security/admin-panels/src/constants/index.ts"),m=n("../../packages/api-security/admin-panels/src/stores/SecurityRuleStore.ts");t.default=(0,a.observer)((function(){const e=(0,c.resolveStoreInstance)(m.default),{manageSecurityCustomRules:t,isFeatureEnabled:n,viewSecurityCustomRules:a}=e.permissionStore;return(0,s.useEffect)((()=>(i.default.addEventV2({category:"security-create-custom-rule",action:"page-viewed",value:1}),()=>e.cleanUp())),[]),e.isHydrated?n&&a?s.createElement(d.default,{store:e,canManageRuleset:t,ruleCategory:"security",heading:"Create new Security rule",backHandler:()=>l.default.transitionTo(p.SECURITY_ROUTE_IDENTIFIER)}):s.createElement(r.default,{height:"100%",alignItems:"center",justifyContent:"center"},s.createElement(u.default,{category:"Security"})):s.createElement(r.default,{height:"100%",alignItems:"center",justifyContent:"center","data-testid":"security-add-custom-rule"},s.createElement(o.default,null))}))},"../../packages/api-security/admin-panels/src/containers/SecurityViewRule.tsx":function(e,t,n){n.r(t);var a=n("../../node_modules/mobx-react/dist/mobx-react.module.js"),s=n("../../node_modules/react/index.js"),r=n("../../node_modules/styled-components/dist/styled-components.browser.esm.js"),o=n("../../node_modules/@postman/aether/esmLib/src/components/Spinner/Spinner.js"),i=n("../../node_modules/@postman/aether/esmLib/src/components/Toast/ToastManager.js"),l=n("../../node_modules/@postman/aether/esmLib/src/components/Flex/Flex.js"),c=n("./js/modules/services/AnalyticsService.js"),d=n("./js/services/NavigationService.js"),u=n("./js/stores/StoreManager.js"),p=n("../../packages/api-security/admin-panels/src/components/UnauthorizedState.tsx"),m=n("../../packages/api-security/admin-panels/src/components/ViewRule.tsx"),f=n("../../packages/api-security/admin-panels/src/constants/index.ts"),g=n("../../packages/api-security/admin-panels/src/stores/SecurityRuleStore.ts");const y=(0,r.default)(o.default)`
  margin: auto;
`;t.default=(0,a.observer)((function(){const[e,t]=(0,s.useState)(!0),[n,a]=(0,s.useState)(null),r=d.default.getCurrentRouteParams(),o=(0,u.resolveStoreInstance)(g.default);return(0,s.useEffect)((()=>(o.getRule(r.id).then((e=>{t(!1);const n="TEAM"===e.ownerType;c.default.addEventV2({category:"security-admin-panel",entityId:e.id,entityType:"vulnerability",action:n?"view-default-rule":"view-custom-rule",value:1}),a(e)})).catch((e=>{t(!1),e.message!==f.FEATURE_NOT_ENABLED&&((0,i.toast)({status:"error",description:"This rule has been deleted and doesn't exist anymore."}),d.default.transitionTo(f.SECURITY_ROUTE_IDENTIFIER))})),()=>o.cleanUp())),[]),e?s.createElement(y,{"data-testid":"security-view-rule-spinner"}):o.permissionStore.isFeatureEnabled&&o.permissionStore.viewSecurityCustomRules?s.createElement(m.default,{rule:n,ruleCategory:"security",deleteRule:()=>o.deleteCustomRule(r.id),canManageRuleset:o.permissionStore.manageSecurityCustomRules}):s.createElement(l.default,{height:"100%",alignItems:"center",justifyContent:"center"},s.createElement(p.default,{category:"Security"}))}))},"../../packages/api-security/admin-panels/src/controllers/SecurityAdminPanelController.ts":function(e,t,n){n.r(t),n.d(t,{default:function(){return o}});var a=n("./appsdk/pages/BasePageController.js"),s=n("./js/stores/StoreManager.js"),r=n("../../packages/api-security/admin-panels/src/stores/SecurityAdminPanelStore.ts");class o extends a.default{constructor(){super(),this.store=(0,s.resolveStoreInstance)(r.default)}didCreate(){this.store.getRulesConfig().catch((()=>{}))}beforeDestroy(){}}},"../../packages/api-security/admin-panels/src/controllers/SecurityViewRuleController.ts":function(e,t,n){n.r(t),n.d(t,{default:function(){return o}});var a=n("./appsdk/pages/BasePageController.js"),s=n("./js/stores/StoreManager.js"),r=n("../../packages/api-security/admin-panels/src/stores/SecurityRuleStore.ts");class o extends a.default{constructor(){super(),this.store=(0,s.resolveStoreInstance)(r.default)}beforeDestroy(){}}},"../../packages/api-security/admin-panels/src/services/AssetService.ts":function(e,t,n){n.r(t);var a=n("./js/utils/HttpService.js"),s=function(e,t,n,a){return new(n||(n=Promise))((function(s,r){function o(e){try{l(a.next(e))}catch(e){r(e)}}function i(e){try{l(a.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,i)}l((a=a.apply(e,t||[])).next())}))};const r=pm.logger.getContext("admin-panels","api-governance");t.default=new class{constructor(){this.baseURL="/_common-assets/api-governance"}getConfig(e){return s(this,void 0,void 0,(function*(){try{return(yield a.default.request(`${this.baseURL}/config/${e}`,{method:"GET",headers:{},credentials:"omit"})).body}catch(e){return pm.logger.error("AssetService~getAsset - There was an error while fetching asset",e,{context:r}),null}}))}}},"../../packages/api-security/admin-panels/src/stores/EntityBaseStore.ts":function(e,t,n){n.r(t);var a=n("../../node_modules/lodash/lodash.js"),s=n("../../node_modules/mobx/lib/mobx.module.js"),r=n("../../node_modules/@postman/aether/esmLib/src/components/Toast/ToastManager.js"),o=n("./js/services/CurrentUserDetailsService.js"),i=n("../../packages/api-security/admin-panels/src/constants/index.ts"),l=n("../../packages/api-security/admin-panels/src/utils/index.ts"),c=function(e,t,n,a){var s,r=arguments.length,o=r<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,a);else for(var i=e.length-1;i>=0;i--)(s=e[i])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};class d{constructor(){this.errors=null,this.hydrationState="NotTriggered"}get canManageRuleset(){const{organizations:e}=o.default.getCurrentUserDetails(),t=a.get(e,"0.roles","");return a.includes(t,"admin")&&a.includes(t,"user")}setHydrationState(e){this.hydrationState=e}setErrors(e){this.errors=e}handleCustomError(e,t){if(e&&400===a.get(e,"status")){if(a.get(e,"error_level")===i.ERROR_LEVEL.VALIDATION)return void this.setErrors([{message:a.get(e,"event","Added definition is invalid"),instancePath:""}]);if(a.get(e,"error_level")===i.ERROR_LEVEL.SPECTRAL){if(!a.get(e,"detail.errors"))return void this.setErrors([{message:a.get(e,"event","Added definition is invalid"),instancePath:""}]);{const t=(0,l.getSpectralErrors)(a.get(e,"detail.errors",[]));if(t.length>0)return void this.setErrors(t)}}this.setErrors([{message:"Added definition is invalid",instancePath:""}])}else(0,r.toast)({status:"error",title:t,description:a.get(e,"title")||"Something went wrong, try again"})}isBaseStoreHydrated(){return Boolean(o.default.getCurrentUserDetails().organizations)}cleanUp(){this.errors=null}}c([s.observable],d.prototype,"errors",void 0),c([s.observable],d.prototype,"hydrationState",void 0),c([s.computed],d.prototype,"canManageRuleset",null),c([s.action],d.prototype,"setHydrationState",null),c([s.action],d.prototype,"setErrors",null),c([s.action],d.prototype,"cleanUp",null),t.default=d},"../../packages/api-security/admin-panels/src/stores/RuleBaseStore.ts":function(e,t,n){n.r(t);var a=n("../../node_modules/lodash/lodash.js"),s=n("../../node_modules/mobx/lib/mobx.module.js"),r=n("../../packages/api-security/admin-panels/src/stores/EntityBaseStore.ts"),o=n("../../packages/api-security/admin-panels/src/services/AssetService.ts"),i=function(e,t,n,a){var s,r=arguments.length,o=r<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,a);else for(var i=e.length-1;i>=0;i--)(s=e[i])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o},l=function(e,t,n,a){return new(n||(n=Promise))((function(s,r){function o(e){try{l(a.next(e))}catch(e){r(e)}}function i(e){try{l(a.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,i)}l((a=a.apply(e,t||[])).next())}))};const c=pm.logger.getContext("admin-panels","api-governance");class d extends r.default{constructor(){super(...arguments),this.snippets=void 0,this.boilerplate={definition:{json:"",yaml:""}}}fetchSnippets(e){return l(this,void 0,void 0,(function*(){try{const t=yield o.default.getConfig(e);Array.isArray(t)&&(this.snippets=t)}catch(e){throw pm.logger.error("RuleBaseStore~getSnippets~Error while fetching snippets",{context:c}),e}}))}fetchBoilerplate(e){return l(this,void 0,void 0,(function*(){try{const t=yield o.default.getConfig(e);t&&(this.boilerplate=t)}catch(e){pm.logger.error("RuleBaseStore~getSnippets~Error while fetching snippets",e,{context:c})}}))}getBoilerplate(e){var t,n,s,r,o,i;const l=pm.settings.getSetting("editorIndentCount");let c="";return a.times(l,(()=>{c+=" "})),"json"===e?(null===(s=null===(n=null===(t=this.boilerplate)||void 0===t?void 0:t.definition)||void 0===n?void 0:n.json)||void 0===s?void 0:s.replace(/{%i}/g,c))||"":(null===(i=null===(o=null===(r=this.boilerplate)||void 0===r?void 0:r.definition)||void 0===o?void 0:o.yaml)||void 0===i?void 0:i.replace(/{%i}/g,c))||""}}i([s.observable],d.prototype,"snippets",void 0),i([s.action],d.prototype,"fetchSnippets",null),i([s.action],d.prototype,"fetchBoilerplate",null),t.default=d},"../../packages/api-security/admin-panels/src/stores/SecurityRuleStore.ts":function(e,t,n){n.r(t);var a=n("../../node_modules/lodash/lodash.js"),s=n("../../node_modules/mobx/lib/mobx.module.js"),r=n("../../node_modules/@postman/aether/esmLib/src/components/Toast/ToastManager.js"),o=n("./js/modules/services/AnalyticsService.js"),i=n("./js/services/NavigationService.js"),l=n("./js/stores/StoreManager.js"),c=n("../../packages/api-security/admin-panels/src/stores/RuleBaseStore.ts"),d=n("../../packages/api-security/admin-panels/src/stores/SecurityAdminPanelStore.ts"),u=n("../../packages/api-security/admin-panels/src/stores/SecurityPermissionStore.ts"),p=n("../../packages/api-security/admin-panels/src/constants/index.ts"),m=n("../../packages/api-security/admin-panels/src/services/RulesetService.ts"),f=function(e,t,n,a){var s,r=arguments.length,o=r<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,a);else for(var i=e.length-1;i>=0;i--)(s=e[i])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o},g=function(e,t,n,a){return new(n||(n=Promise))((function(s,r){function o(e){try{l(a.next(e))}catch(e){r(e)}}function i(e){try{l(a.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,i)}l((a=a.apply(e,t||[])).next())}))};const y=pm.logger.getContext("admin-panels","api-governance");class h extends c.default{constructor(){super(),this.init(),this.permissionStore=(0,l.resolveStoreInstance)(u.default)}get isHydrated(){return("Completed"===this.hydrationState||"Error"===this.hydrationState)&&this.permissionStore.isHydrated}init(){return g(this,void 0,void 0,(function*(){try{this.setHydrationState("Hydrating"),yield this.fetchBoilerplate(p.SECURITY_RULE_BOILERPLATE_FILE),yield this.fetchSnippets(p.SECURITY_RULE_SNIPPETS_FILE),this.setHydrationState("Completed")}catch(e){this.setHydrationState("Error"),pm.logger.error("RuleBaseStore~init~Error hydrating store",e,{context:y})}}))}getRule(e){return g(this,void 0,void 0,(function*(){try{if(yield(0,s.when)((()=>this.isHydrated)),!this.permissionStore.isFeatureEnabled)throw new Error(p.FEATURE_NOT_ENABLED);const t=(0,l.resolveStoreInstance)(d.default);let n,{rulesConfig:r}=t;if(r||(yield t.getRulesConfig(),r=t.rulesConfig),r){for(let t=0;t<r.categories.length&&(n=r.categories[t].vulnerabilities.find((t=>t.id===parseInt(e,10))),!n);t++);const t=a.get(n,"rules.0");if(!t)throw new Error("Invalid rule id");return t}throw new Error("Invalid rules config")}catch(e){throw pm.logger.error("SecurityRuleStore~getRule: Failed to fetch the rule",e,{context:y}),e}}))}createCustomRule(e,t){return g(this,void 0,void 0,(function*(){try{const n=(0,l.resolveStoreInstance)(d.default);yield m.default.createCustomRule("security",e),yield n.getRulesConfig(),this.setErrors(null),i.default.transitionTo(p.SECURITY_ROUTE_IDENTIFIER),o.default.addEventV2({category:`${e.tags[0]}-create-custom-rule`,label:t,action:"create-custom-rule",value:1})}catch(n){this.handleCustomError(n,"Couldn't create rule"),o.default.addEventV2({category:`${e.tags[0]}-create-custom-rule`,label:`${t}-failed`,action:"create-custom-rule",value:1})}}))}deleteCustomRule(e){return g(this,void 0,void 0,(function*(){try{const t=(0,l.resolveStoreInstance)(d.default);yield m.default.deleteCheck("security",e),yield t.getRulesConfig(),i.default.transitionTo(p.SECURITY_ROUTE_IDENTIFIER)}catch(e){pm.logger.error("SecurityRuleStore~deleteCustomRule: Failed to remove rule",e,{context:y}),(0,r.toast)({status:"error",description:"Couldn't delete the rule. Try again."})}}))}}f([s.computed],h.prototype,"isHydrated",null),t.default=h},"../../packages/api-security/admin-panels/src/utils/schemas/spectralRuleFormat.json":function(e){e.exports=JSON.parse('{"description":"Spectral Rule Schema","type":"object","properties":{"rules":{"type":"object","patternProperties":{"^[a-zA-Z0-9\\\\.\\\\-_]+$":{"type":"object","properties":{"given":{"type":["array","string"],"items":{"type":"string"}},"description":{"type":"string"},"message":{"type":"string"},"recommended":{"type":"boolean"},"formats":{"type":"array","items":{"type":"string","enum":["oas3","oas2","oas3_0","oas3_1"]}},"severity":{"type":"string","enum":["error","warn","info","hint","off"]},"documentationUrl":{"type":"string"},"then":{"type":["array","object"],"anyOf":[{"items":{"type":"object","$ref":"#/definitions/ThenProperties"}},{"$ref":"#/definitions/ThenProperties"}]}},"additionalProperties":false,"required":["then","given","formats"]}}}},"additionalProperties":false,"definitions":{"ThenProperties":{"properties":{"field":{"type":"string"},"function":{"anyOf":[{"type":"string","pattern":"^[a-zA-Z_0-9]+$"},{"type":"string","enum":["alphabetical","enumeration","falsy","length","pattern","casing","schema","truthy","defined","undefined","unreferencedReusableObject","xor","typedEnum","oasOpSuccessResponse","oasOpFormDataConsumeCheck","oasOpIdUnique","oasOpParams","oasTagDefined","oasPathParam","oasSchema","uniquenessTags","refSiblings","oasDiscriminator","oasOpSecurityDefined","oasExample","oasDocumentSchema","oasUnusedComponent"]}]},"functionOptions":{"type":"object","additionalProperties":true}},"$ref":"#/definitions/AlphabeticalFunctionOptions"},"AlphabeticalFunctionOptions":{"if":{"properties":{"function":{"const":"alphabetical"}},"required":["function"]},"then":{"properties":{"functionOptions":{"type":"object","additionalProperties":false,"properties":{"keyedBy":{"type":"string"}}}}},"else":{"$ref":"#/definitions/EnumerationFunctionOptions"}},"EnumerationFunctionOptions":{"if":{"properties":{"function":{"const":"enumeration"}},"required":["function"]},"then":{"properties":{"functionOptions":{"type":"object","additionalProperties":false,"properties":{"values":{"type":"array"}}}}},"else":{"$ref":"#/definitions/LengthFunctionOptions"}},"LengthFunctionOptions":{"if":{"properties":{"function":{"const":"length"}},"required":["function"]},"then":{"properties":{"functionOptions":{"type":"object","additionalProperties":false,"properties":{"min":{"type":"number"},"max":{"type":"number"}}}}},"else":{"$ref":"#/definitions/PatternFunctionOptions"}},"PatternFunctionOptions":{"if":{"properties":{"function":{"const":"pattern"}},"required":["function"]},"then":{"properties":{"functionOptions":{"type":"object","additionalProperties":false,"properties":{"match":{"type":"string"},"notMatch":{"type":"string"}}}}},"else":{"$ref":"#/definitions/CasingFunctionOptions"}},"CasingFunctionOptions":{"if":{"properties":{"function":{"const":"casing"}},"required":["function"]},"then":{"properties":{"functionOptions":{"type":"object","additionalProperties":false,"required":["type"],"patternProperties":{"^type$":{"type":"string","enum":["flat","camel","pascal","kebab","cobol","snake","macro"]}},"properties":{"disallowDigits":{"type":"boolean"},"separator.char":{"type":"string"},"separator.allowLeading":{"type":"boolean"}}}}},"else":{"$ref":"#/definitions/SchemaFunctionOptions"}},"SchemaFunctionOptions":{"if":{"properties":{"function":{"const":"schema"}},"required":["function"]},"then":{"properties":{"functionOptions":{"type":"object","additionalProperties":false,"required":["schema"],"properties":{"dialect":{"type":"string","enum":["auto","draft4","draft6","draft7","draft2019-09","draft2020-12"]},"schema":{"type":"object"},"allErrors":{"type":"boolean"}}}}},"else":{"$ref":"#/definitions/UnreferencedReusableObjectFunctionOptions"}},"UnreferencedReusableObjectFunctionOptions":{"if":{"properties":{"function":{"const":"unreferencedReusableObject"}},"required":["function"]},"then":{"properties":{"functionOptions":{"type":"object","additionalProperties":false,"required":["reusableObjectsLocation"],"properties":{"reusableObjectsLocation":{"type":"string"}}}}},"else":{"$ref":"#/definitions/XORFunctionOptions"}},"XORFunctionOptions":{"if":{"properties":{"function":{"const":"xor"}},"required":["function"]},"then":{"properties":{"functionOptions":{"type":"object","additionalProperties":false,"required":["properties"],"properties":{"properties":{"type":"array","items":{"type":"string"}}}}}},"else":{"functionOptions":{"type":"object","additionalProperties":true}}}},"required":["rules"]}')}}]);