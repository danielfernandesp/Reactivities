"use strict";(self.webpackChunk_postman_app_renderer=self.webpackChunk_postman_app_renderer||[]).push([[149],{"./iam/src/TeamSettings/pages/ManageTeam/RemoveMemberFromTeam.js":function(e,t,a){a.r(t),a.d(t,{RemoveMemberFromTeam:function(){return $}});var r=a("../../node_modules/react/index.js"),s=a("../../node_modules/@postman/aether/esmLib/src/components/BlankState/BlankState.js"),o=a("../../node_modules/@postman/aether/esmLib/src/components/Text/Text.js"),n=a("../../node_modules/@postman/aether/esmLib/src/components/Spinner/Spinner.js"),m=a("../../node_modules/@postman/aether/esmLib/src/components/Button/Button.js"),l=a("../../node_modules/@postman/aether/esmLib/src/components/Illustration/illustrations/PageNotFound.js"),i=a("../../node_modules/@postman/aether/esmLib/src/components/Illustration/illustrations/NoPermission.js"),c=a("../../node_modules/@postman/aether/esmLib/src/components/Illustration/illustrations/UnableToLoad.js"),d=a("../../node_modules/@postman/aether/esmLib/src/components/ResponsiveContainer/ResponsiveContainer.js"),u=a("../../node_modules/@postman/aether/esmLib/src/components/Flex/Flex.js"),p=a("../../node_modules/@postman/aether/esmLib/src/components/Breadcrumb/Breadcrumb.js"),g=a("../../node_modules/@postman/aether/esmLib/src/components/Heading/Heading.js"),b=a("../../node_modules/@postman/aether/esmLib/src/components/Toast/ToastManager.js"),E=a("./js/services/NavigationService.js"),f=a("./js/stores/StoreManager.js"),h=a("./js/stores/TeamSettingsStore.js"),v=a("./js/stores/CurrentUserStore.js"),y=a("./iam/src/common/styled-components/StyledLoader.js"),_=a("./iam/src/TeamSettings/services/TeamAPIService.js"),T=a("./iam/src/common/api/IAMservice.js"),j=a("./iam/src/common/RouteIdentifierConfig.js"),I=a("./iam/src/common/components/SuccessIconWrapped.js"),x=a("../../node_modules/mobx/lib/mobx.module.js"),S=a("./node_modules/lodash/lodash.js"),w=a.n(S),R=a("./js/services/CurrentUserDetailsService.js"),U=a("./onboarding/src/common/LaunchDarkly.js"),M=a("../../node_modules/mobx-react/dist/mobx-react.module.js"),k=a("./iam/src/common/utils/index.js"),L=a("./iam/src/common/components/RemoveMemberFromTeamBody.js");const F="removing",A="removed",B="Couldn't remove this team member",P="You don't have permission to perform this action",C="Unable to load data",N="There was an unexpected error. Please try again.",O=({user:e})=>r.createElement(s.default,{title:`Removing ${e} from team`,description:r.createElement(o.default,{type:"para",color:"content-color-primary"},"Hang on for a few seconds. Please don't close or refresh this tab.")},r.createElement(n.default,null)),D=({isUserToBeRemovedPartner:e,isUserToBeRemovedGuest:t})=>e?"Remove Partner":t?"Remove Guest":"Remove Member",G=({isUserToBeRemovedPartner:e,isUserToBeRemovedGuest:t})=>e?"Remove Partner":t?"Remove Guest":"Remove Member",H=({userName:e})=>r.createElement(s.default,{title:`You've removed ${e} from your team`,description:r.createElement(o.default,{type:"para",color:"content-color-primary"}," They don't have access to the team anymore. "),secondaryAction:r.createElement(m.default,{type:"secondary",size:"medium",text:"Manage Team",onClick:()=>{E.default.transitionTo(j.MANAGE_TEAM_MEMBERS_ROUTE_IDENTIFIER)}})},r.createElement(I.default,{color:"background-color-success"})),z=(0,M.observer)((({userId:e,loading:t,error:a,active:o,userName:n,removeMemberAction:b,teamUserOption:f,isMultiTeamEnabled:h,isDataGovernanceEnabledForTeam:v,isPersonalContextExistForUser:_})=>{const T=`Remove ${n} from your team?`,[I,x]=r.useState(null),S=(0,k.isUserPartner)({id:e}),U=(0,k.isUserGuest)({id:e});if(a)return r.createElement(s.default,{title:w().get(a,"title"),description:w().get(a,"description"),secondaryAction:r.createElement(m.default,{type:"primary",size:"medium",text:"Back To Home",onClick:()=>{E.default.transitionTo("home")}})},a.title===B&&r.createElement(l.default,null),a.title===P&&r.createElement(i.default,null),a.title===C&&r.createElement(c.default,null));if(t||R.default.isLoadingUserFlags)return r.createElement(y.default,null);if(o===F)return r.createElement(O,{user:n});if(o===A)return r.createElement(H,{userName:n});const M=[{id:j.MANAGE_TEAM_MEMBERS_ROUTE_IDENTIFIER,name:"Manage team"},{id:j.REMOVE_USER_FROM_TEAM_IDENTIFIER,name:G({isUserToBeRemovedPartner:S,isUserToBeRemovedGuest:U})}];return r.createElement(d.default,{type:"row","overflow-y":"scroll",padding:"spacing-xxl spacing-zero"},r.createElement(d.default,{span:4,overflow:"unset"}," ",r.createElement("div",null)),r.createElement(d.default,{minHeight:"100vh",type:"column",span:4,maxWidth:"container-width-medium",overflow:"unset"},r.createElement(u.default,{direction:"column",gap:"spacing-s"},r.createElement(u.default,{width:"100%",padding:"spacing-l"},r.createElement(p.Breadcrumb,{onItemClick:e=>{E.default.transitionTo(e.id)}},M.map((e=>r.createElement(p.BreadcrumbItem,{itemData:e,key:e.id},e.name))))),r.createElement(u.default,{width:"100%",padding:"spacing-zero spacing-l spacing-l",direction:"column",gap:"spacing-xl"},r.createElement(g.default,{type:"h1",isTruncated:!0,text:T,tooltip:T}),r.createElement(L.default,{isPartner:S,isMultiTeamEnabled:h,selectedTeamUser:I,userName:n,teamUserOption:f,setSelectedTeamUser:x,isGuest:U,isDataGovernanceEnabledForTeam:v,isPersonalContextExistForUser:_}),r.createElement(u.default,{gap:"spacing-s"},r.createElement(m.default,{type:"destructive",text:D({isUserToBeRemovedPartner:S,isUserToBeRemovedGuest:U}),onClick:()=>b(S||U?null:h&&(v||_)?I.meta.id:null),isDisabled:!S&&!U&&!!h&&!(!v&&!_)&&w().isEmpty(I)}),r.createElement(m.default,{text:"Cancel",onClick:()=>{E.default.transitionTo(j.MANAGE_TEAM_MEMBERS_ROUTE_IDENTIFIER)}}))))))})),$=()=>{const[e,t]=(0,r.useState)(!0),[a,s]=(0,r.useState)(!1),[o,n]=(0,r.useState)(!1),[m,l]=(0,r.useState)({}),[i,c]=(0,r.useState)([]),[d,u]=(0,r.useState)(!1),[p,g]=(0,r.useState)(!0),[y,I]=(0,r.useState)(!0),S=(0,f.resolveStoreInstance)(h.default),R=(0,f.resolveStoreInstance)(v.default),M=E.default.getCurrentRouteParams().user_id,k="ENABLED"===U.launchDarkly.getFlag("iam_2684_multi_teams","DISABLED"),{addToast:L}=(0,b.default)(),O=pm.logger.getContext("LeaveTeam","iam"),D=()=>{let e=w().get(S,"team_users",[]),t=((e,t)=>{let a=e.get(String(t));return a||(a=R.partnerMembersByIds[t]),a||(a=R.guestMembersByIds[t]),a})(w().reduce(e,((e,t)=>e.set(t.id,t)),new Map),M);t||s({title:B,description:`Looks like this team member is no longer a part of ${S.teamName} team.`}),c(w().map(w().filter(e,(e=>e.id!==w().get(t,"id"))),(e=>({email:e.email,value:e.id,label:e.name,meta:JSON.parse(JSON.stringify(e))})))),l({name:w().get(t,"name")||w().get(t,"username"),id:w().get(t,"id")})};(0,r.useEffect)((()=>{(0,x.reaction)((()=>w().get(R,"userStoreInitialised")),(e=>{if(M===S.userId)return E.default.transitionTo(j.LEAVE_TEAM_ROUTE_IDENTIFIER);e&&async function(){try{let e=[];if(e.push((0,T.checkPermissionForAuthenticatedUser)({checks:{canRemoveUser:{permission:"MANAGE_USERS",objectType:"team",objectId:S.teamId}}})),!w().get(S,"team_users")){const t=(0,_.fetchAllUsersTeamInformation)({userId:S.userId,showAllUsers:!0});e.push(t)}const a=await Promise.all(e);w().get(a,"0.body.results.canRemoveUser.allowed")||s({title:P,description:`Only Team Admins are allowed to remove members from ${S.teamName} team.`}),a[1]&&S.updateTeamStore({team_users:w().get(a,"1.body.organizations[0].team_users"),scimEnabled:w().get(a,"1.body.organizations[0].settings.scim.enabled")});let r=await(0,T.fetchUserFlags)(M);u(w().get(r,"body.flags.multi_team.enabled",!1)&&k),D();try{const e=await(0,T.getUserRemovalFlags)({teamId:S.teamId,userId:M});g(e.data_governance_enabled),I(e.personal_context_present)}catch(e){pm.logger.error("RemoveTeam~getUserRemovalFlags",e)}t(!1)}catch(e){t(!1),s({title:C,description:N})}}()}),{fireImmediately:!0})}),[]);return r.createElement(z,{userId:M,loading:e,error:a,active:o,userName:m.name,removeMemberAction:async e=>{try{n(F);const t=await(0,T.removeUser)({userId:m.id,teamId:S.teamId,queryParams:d&&e?{new_owner_id:e}:{}});t.error?(L({title:"Something went wrong",status:"error",description:w().get(t,"error.message","Unable to process your request")}),n(!1)):"error"===t.result?(pm.logger.error("RemoveMember~remove-user-api-call-failed",t.result,{context:O,error:t.result}),L({title:"Unable to remove member",status:"error",description:w().get(t,"message","Unable to process your request")}),n(!1)):n(A)}catch(e){pm.logger.error("RemoveMember~remove-user-api-call-failed",e,{context:O,error:e}),s({title:C,description:N})}},teamUserOption:i,isMultiTeamEnabled:d,isPersonalContextExistForUser:y,isDataGovernanceEnabledForTeam:p})}},"./iam/src/common/components/RemoveMemberFromTeamBody.js":function(e,t,a){a.r(t);var r=a("../../node_modules/react/index.js"),s=a("../../node_modules/@postman/aether/esmLib/src/components/Text/Text.js"),o=a("../../node_modules/@postman/aether/esmLib/src/components/Dropdown/SingleSelect/SingleSelect.js"),n=a("../../node_modules/@postman/aether/esmLib/src/components/Label/Label.js"),m=a("../../node_modules/@postman/aether/esmLib/src/components/Flex/Flex.js"),l=a("../../node_modules/@postman/aether/esmLib/src/components/Avatar/Avatar.js"),i=a("../../node_modules/@postman/aether/esmLib/src/components/Heading/Heading.js"),c=a("./node_modules/lodash/lodash.js"),d=a.n(c),u=a("./iam/src/common/utils/index.js");t.default=({isPartner:e,isMultiTeamEnabled:t,selectedTeamUser:a,userName:c,teamUserOption:p,setSelectedTeamUser:g,isGuest:b,isDataGovernanceEnabledForTeam:E,isPersonalContextExistForUser:f})=>e?r.createElement(s.default,{type:"body-medium",color:"content-color-primary"},"Once you remove a partner, they won't have access to your team's partner workspaces."):b?r.createElement(s.default,{type:"body-medium",color:"content-color-primary"},"Once you remove a guest, they won't have access to your team's workspaces."):t?E||f?r.createElement(r.Fragment,null,r.createElement(s.default,{type:"body-medium",color:"content-color-primary"},"Once they are removed from the team, they won't have access to any data which belongs to the team, including their personal workspaces.",r.createElement("br",null),r.createElement("br",null),"To ensure that your team has access to their work, assign them to a team member."),r.createElement(o.default,{value:a,label:r.createElement(n.default,{text:`Assign ${c}'s personal workspaces to a team member`,fieldType:"required"}),options:p,onChange:e=>{if(d().isEmpty(e))return g(e);g({...e,label:r.createElement(m.default,{alignItems:"center",justifyContent:"flex-start",gap:"spacing-s"},r.createElement(l.default,{src:e.meta.profile_pic_url||"",type:"user",userId:d().parseInt(e.value),size:"s",isPartner:(0,u.isUserPartner)({id:e.value})}),r.createElement(s.default,null,d().isEmpty(e.label)?e.email:e.label))})},customOptionComponent:e=>r.createElement(m.default,{alignItems:"center",gap:"spacing-s"},r.createElement(l.default,{src:e.meta.profile_pic_url||"",type:"user",userId:d().parseInt(e.value),isPartner:(0,u.isUserPartner)({id:e.value})}),r.createElement(m.default,{direction:"column"},r.createElement(i.default,{type:"h5",text:e.label}),r.createElement(s.default,{color:"content-color-secondary"},e.email))),menuMaxHeight:200,placeholder:"Select a team member"})):r.createElement(r.Fragment,null,r.createElement(s.default,{type:"body-medium",color:"content-color-primary"},"Once you remove the member, they won't have any access to the team.",r.createElement("br",null),r.createElement("br",null),"Their personal workspaces won’t be accessible to your team. All team, public and private workspace will remain in the team.")):r.createElement(s.default,{type:"body-medium",color:"content-color-primary"},"Once you remove the member, they won't have any access to the team.",r.createElement("br",null),r.createElement("br",null),"Their personal workspaces won't be accessible to your team, while their team, public, and private workspace will be accessible to your team.")},"./iam/src/common/components/SuccessIconWrapped.js":function(e,t,a){a.r(t);var r=a("../../node_modules/react/index.js"),s=a("../../node_modules/@postman/aether-icons/esmLib/src/design-system-icons/icon-state-success-stroke.js");const o=a("../../node_modules/styled-components/dist/styled-components.browser.esm.js").default.div`
  border-radius: var(--border-radius-max);
  width: 56px;
  height: 56px;
  background-color: var(--background-color-success);
  svg {
    width: 32px;
    height: 32px;
    margin-top: 12px;
    margin-left: 12px;
  }
`;t.default=()=>r.createElement(o,null,r.createElement(s.default,{color:"content-color-success"}))},"./iam/src/common/styled-components/StyledLoader.js":function(e,t,a){a.r(t);var r=a("../../node_modules/styled-components/dist/styled-components.browser.esm.js"),s=a("../../node_modules/@postman/aether/esmLib/src/components/Spinner/Spinner.js");const o=(0,r.default)(s.default)`
  height: 90vh;
  display: grid;
  place-content: center;
`;t.default=o}}]);