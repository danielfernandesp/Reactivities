"use strict";(self.webpackChunk_postman_app_renderer=self.webpackChunk_postman_app_renderer||[]).push([[35],{"../../node_modules/@postman/aether/esmLib/src/components/Illustration/illustrations/NoHistory.js":function(e,t,s){s.r(t),s.d(t,{default:function(){return r}});var o=s("../../node_modules/react/index.js"),i=s("../../node_modules/@postman/aether/esmLib/src/components/Illustration/Illustration.js");function r(){return o.createElement(i.default,{name:"illustration-no-history"})}},"./integrations/proxy/components/ProxyHistorySidebarListItem.js":function(e,t,s){s.r(t),s.d(t,{default:function(){return R}});var o,i=s("../../node_modules/react/index.js"),r=s("../../node_modules/react-dom/index.js"),n=s("./node_modules/moment/moment.js"),a=s.n(n),l=s("./node_modules/classnames/index.js"),c=s.n(l),d=s("../../node_modules/@postman/aether/esmLib/src/components/Text/Text.js"),h=s("../../node_modules/@postman/aether/esmLib/src/components/Menu/DeprecatedMenuItem.js"),u=s("../../node_modules/@postman/aether-icons/esmLib/src/Icon/Icon.js"),p=s("../../node_modules/@postman/aether-icons/esmLib/src/design-system-icons/icon-action-capture-stroke.js"),m=s("../../node_modules/mobx-react/dist/mobx-react.module.js"),y=s("./js/components/base/Avatar.js"),S=s("./js/components/base/Tooltips.js"),b=s("./js/containers/apps/requester/sidebar/SidebarListItem.js"),g=s("./js/stores/CurrentUserStore.js"),f=s("./js/stores/StoreManager.js"),v=s("./integrations/proxy/stores/ProxySessionStore.js"),I=s("./runtime-repl/_common/DisabledTooltipConstants.js"),E=s("./js/components/base/Dropdowns.js"),w=s("./integrations/proxy/services/ProxyHistoryService.js"),T=s("./js/controllers/ShortcutsList.js"),C=s("./integrations/proxy/helpers/constants.ts"),_=s("./appsdk/workbench/WorkbenchService.js"),O=s("./node_modules/prop-types/index.js"),A=s.n(O),j=s("./node_modules/lodash/lodash.js");let R=(0,m.observer)(o=class extends i.Component{constructor(e){super(e),this.state={isTooltipVisible:!1},this.proxyStore=(0,f.resolveStoreInstance)(v.default),this.userAvatar=i.createRef(),this.handleSelect=this.handleSelect.bind(this),this.handleAction=this.handleAction.bind(this),this.showTooltip=this.showTooltip.bind(this),this.hideTooltip=this.hideTooltip.bind(this),this.getLeftAlignedComponents=this.getLeftAlignedComponents.bind(this),this.getActionMenuItems=this.getActionMenuItems.bind(this),this.handleRenameSubmit=this.handleRenameSubmit.bind(this),this.containerRef=this.containerRef.bind(this),this.handleDropdownActionSelect=this.handleDropdownActionSelect.bind(this),this.getAetherMenuItems=this.getAetherMenuItems.bind(this),this.getActions=this.getActions.bind(this),this.getMenuItems=this.getMenuItems.bind(this)}componentDidMount(){this.selfNode=(0,r.findDOMNode)(this),this.props.observeSizeChange&&this.props.observeSizeChange(this.selfNode)}componentWillUpdate(e){if(!this.props.selected&&e.selected){const e=(0,r.findDOMNode)(this);e&&e.scrollIntoViewIfNeeded&&e.scrollIntoViewIfNeeded()}}componentWillUnmount(){this.props.unobserveSizeChange&&this.props.unobserveSizeChange(this.selfNode,this.props.index)}getClasses(){return c()({"history-sidebar-list-item":!0,"history-sidebar-list-item__proxy-history":!0,"is-selected":this.props.selected})}getTooltipText(e,t){return e?t?I.DISABLED_TOOLTIP_IS_OFFLINE:I.DISABLED_TOOLTIP_NO_PERMISSION:"Delete history"}getLeftAlignedComponents(e){if(!e)return i.createElement("div",{className:"history-sidebar__indent"});const t=c()({"history-sidebar-list-item-updatedBy":!0,hovered:e}),s=(0,f.resolveStoreInstance)(g.default).teamMembers.get(String(this.props.owner)),o=s&&(s.name||s.username);return i.createElement("div",{className:t,onMouseOver:this.showTooltip,onMouseLeave:this.hideTooltip},this.props.owner&&"0"!==this.props.owner?i.createElement(y.default,{ref:this.userAvatar,size:"small",userId:this.props.owner}):i.createElement(u.default,{name:"icon-descriptive-user-stroke",color:"content-color-secondary"}),this.userAvatar.current&&i.createElement(S.Tooltip,{immediate:!0,show:this.state.isTooltipVisible,target:this.userAvatar.current,placement:"right"},i.createElement(S.TooltipBody,null,i.createElement("div",{className:"history-sidebar-list-item-avatar-tooltip"},i.createElement(d.default,{type:"body-medium"},o),i.createElement(d.default,{type:"body-medium"},a()(this.props.createdAt).format("DD MMM YYYY, h:mm A"))))))}showTooltip(){this.setState({isTooltipVisible:!0})}hideTooltip(){this.setState({isTooltipVisible:!1})}handleSelect(e){e.stopPropagation(),this.proxyStore.find(this.props.id)?this.proxyStore.update({id:this.props.id,name:this.props.name}):this.proxyStore.add({id:this.props.id,name:this.props.name,reqData:[],source:this.props.source,totalRecords:0});let t={name:this.props.name,source:this.props.source};const s=this.props.state;this.props.state!==C.SESSION_STATES.RUNNING&&j.assign(t,{createdAt:this.props.createdAt,fromActiveSession:!1}),this.props.onSelect&&this.props.onSelect({id:this.props.id,type:"proxyhistory",itemType:s},{},t)}handleAction(e){this.props.onSelectAction(e,{proxyhistory:[this.props.id]})}getProxySidebarIcon(e){return e==C.SESSION_STATES.RUNNING?i.createElement(p.default,{color:"content-color-success"}):i.createElement(p.default,null)}getActions(e){let t=!1;return e===C.SESSION_STATES.RUNNING&&(t=!0),[{type:"rename",label:"Rename Session",isEnabled:!0,disabledMessage:"",aetherMenuType:"default"},{type:"delete",label:"Delete Session",shortcut:"delete",isEnabled:!t,disabledMessage:"Session is in progress",aetherMenuType:"destructive"}]}getMenuItems(e){const t=this.getActions(e);return j.map(t,(e=>i.createElement(E.MenuItem,{key:e.type,refKey:e.type,disabled:!e.isEnabled,disabledText:e.disabledMessage},i.createElement("div",{className:"dropdown-menu-item-label"},e.label),i.createElement("div",{className:"dropdown-menu-item-shortcut"},(0,T.getShortcutByName)(e.shortcut)))))}getActionMenuItems(e){const t=this.getMenuItems(e);return i.createElement(E.DropdownMenu,{"align-right":!0},t)}getAetherMenuItems(e){const t=this.getActions(e);return j.map(t,(e=>i.createElement(h.default,{key:e.type,shortcutLabel:e.shortcut&&(0,T.getShortcutByName)(e.shortcut),onClick:()=>this.handleDropdownActionSelect(e.type),type:e.aetherMenuType,isDisabled:!e.isEnabled,tooltip:e.isEnabled?null:e.disabledMessage},e.label)))}async handleRenameSubmit(e){await w.default.updateProxyHistory({id:this.props.id,name:e}),this.proxyStore.update({id:this.props.id,name:e}),pm.toasts.success("Session renamed successfully")}containerRef(e){this.listItemRef=e}handleEditName(){j.invoke(this.listItemRef,"editText")}handleDropdownActionSelect(e){"rename"===e&&this.handleEditName(),"delete"===e&&this.props.onSelectAction("delete",{proxyhistory:[this.props.id]})}render(){return i.createElement(b.default,{ref:this.containerRef,text:this.props.name,icon:this.getProxySidebarIcon(this.props.state),isSelected:this.props.selected,onClick:this.handleSelect,className:this.getClasses(),leftMetaComponent:this.getLeftAlignedComponents,state:this.props.state,moreActions:this.props.hideActions?null:this.getActionMenuItems(this.props.state),onRename:this.handleRenameSubmit,onActionsDropdownSelect:this.handleDropdownActionSelect,moreActionsForAetherMenu:_.default.isUseBrowserTabsActive()?this.getAetherMenuItems(this.props.state):null})}})||o;R.propTypes={name:A().string.isRequired,source:A().string.isRequired,owner:A().string.isRequired,id:A().string.isRequired,createdAt:A().string.isRequired,state:A().string.isRequired,key:A().string.isRequired,selected:A().bool.isRequired,hideActions:A().func.isRequired,onSelect:A().func.isRequired,onSelectAction:A().func.isRequired,observeSizeChange:A().func.isRequired,unobserveSizeChange:A().func.isRequired,index:A().string.isRequired}},"./js/components/base/ToggleSwitch.js":function(e,t,s){s.r(t),s.d(t,{default:function(){return l}});var o=s("../../node_modules/react/index.js"),i=s("./node_modules/classnames/index.js"),r=s.n(i),n=s("./node_modules/prop-types/index.js"),a=s.n(n);class l extends o.Component{constructor(e){super(e),this.handleClick=this.handleClick.bind(this)}handleClick(){!this.props.disabled&&this.props.onClick&&this.props.onClick(!this.props.isActive)}getClasses(){return r()({"toggle-switch":!0,"is-active":this.props.isActive})}getWrapperClasses(){return r()({"toggle-switch-container":!0,"is-disabled":this.props.disabled},this.props.className)}render(){return o.createElement("div",{className:this.getWrapperClasses(),onClick:this.handleClick},o.createElement("div",{className:this.getClasses()}),!this.props.hideLabel&&o.createElement("div",{className:"toggle-switch-text"},this.props.isActive?o.createElement("span",{className:"toggle-switch-text-on"},this.props.activeLabel):o.createElement("span",{className:"toggle-switch-text-off"},this.props.inactiveLabel)))}}l.defaultProps={activeLabel:"ON",inactiveLabel:"OFF",isActive:!1,disabled:!1},l.propTypes={isActive:a().bool,disabled:a().bool,hideLabel:a().bool,activeLabel:a().node,inactiveLabel:a().node,onClick:a().func}},"./js/containers/apps/requester/sidebar/SidebarFilter.js":function(e,t,s){s.r(t),s.d(t,{default:function(){return c}});var o,i=s("../../node_modules/react/index.js"),r=s("../../node_modules/mobx-react/dist/mobx-react.module.js"),n=s("./js/components/base/XPaths/XPath.js"),a=s("./js/components/base/Inputs.js"),l=s("./node_modules/lodash/lodash.js");let c=(0,r.observer)(o=class extends i.Component{constructor(e){super(e),this.handleSearchChange=this.handleSearchChange.bind(this),this.handleSearchCancel=this.handleSearchCancel.bind(this),this.focusSearchBox=this.focusSearchBox.bind(this)}UNSAFE_componentWillMount(){pm.mediator.on("focusSearchBox",this.focusSearchBox)}componentWillUnmount(){pm.mediator.off("focusSearchBox",this.focusSearchBox)}focusSearchBox(){l.invoke(this,"refs.filter.focus")}handleSearchChange(e){this.props.onSearch&&this.props.onSearch(e)}handleSearchCancel(){this.props.onSearch&&this.props.onSearch("")}render(){return i.createElement(n.default,{identifier:"filter"},i.createElement(a.Input,{icon:"icon-action-filter-stroke",ref:"filter",inputStyle:"search",onChange:this.handleSearchChange,onCancel:this.handleSearchCancel,query:this.props.searchQuery,className:this.props.className}))}})||o},"./js/containers/apps/requester/sidebar/SidebarListActions.js":function(e,t,s){s.r(t),s.d(t,{default:function(){return m}});var o,i=s("../../node_modules/react/index.js"),r=s("../../node_modules/@postman/aether/esmLib/src/components/Button/Button.js"),n=s("../../node_modules/@postman/aether-icons/esmLib/src/design-system-icons/icon-action-add-stroke.js"),a=s("../../node_modules/@postman/aether-icons/esmLib/src/Icon/Icon.js"),l=s("../../node_modules/mobx-react/dist/mobx-react.module.js"),c=s("./js/containers/apps/requester/sidebar/SidebarFilter.js"),d=s("./js/components/base/Buttons.js"),h=s("./js/components/base/Dropdowns.js"),u=s("./js/components/base/XPaths/XPath.js"),p=s("./collaboration/utils/workspace.js");let m=(0,l.observer)(o=class extends i.Component{constructor(e){super(e),this.handleDropdownSelect=this.handleDropdownSelect.bind(this)}handleDropdownSelect(e){this.props.onActionsDropdownSelect&&this.props.onActionsDropdownSelect(e)}getCreateNewButton(e){if(!e)return null;const t=i.createElement(r.default,{className:"create-new__btn",onClick:e.onCreate,tooltip:e.tooltip,isDisabled:e.disabled,icon:i.createElement(n.default,null),type:"tertiary",size:"small"});return e.xPathIdentifier?i.createElement(u.default,{identifier:e.xPathIdentifier},t):t}render(){return i.createElement("div",{className:"requester-left-sidebar__actions-container"},this.getCreateNewButton(this.props.createNewConfig),i.createElement(c.default,{onSearch:this.props.onSearch,className:this.props.className,searchQuery:this.props.searchQuery}),!this.props.rightMetaContainer&&!this.props.moreActions||(0,p.shouldShowForGuestUser)()?"":i.createElement("div",{className:"secondary-actions-container"},this.props.rightMetaContainer,this.props.moreActions?i.createElement(h.Dropdown,{ref:"menu",onSelect:this.handleDropdownSelect,className:"actions-dropdown"},i.createElement(h.DropdownButton,{dropdownStyle:"nocaret",type:"custom"},i.createElement(d.Button,{tooltip:"View more actions"},i.createElement(a.default,{name:"icon-action-options-stroke",className:"dropdown-action-button pm-icon pm-icon-normal"}))),this.props.moreActions):null))}})||o},"./js/containers/new-button/CreateNewXService.js":function(e,t,s){s.r(t);var o=s("./js/stores/CurrentUserStore.js"),i=s("./runtime-repl/environment/datastores/ActiveEnvironmentStore.js"),r=s("./js/stores/StoreManager.js"),n=s("./js/stores/ActiveWorkspaceStore.js"),a=s("./js/modules/services/SignInModalService.js"),l=s("./js/services/NavigationService.js"),c=s("./onboarding/navigation/constants.js"),d=s("./runtime-repl/environment/_api/EnvironmentStoreV2.js"),h=s("./runtime-repl/collection/_api/CollectionStoreV2.js"),u=s("./node_modules/lodash/lodash.js");function p(...e){pm.mediator.trigger(...e)}t.default={create:async function(e,t,s=null,m={}){!function(e,t,s,i){let n=(0,r.resolveStoreInstance)(o.default);if("create_new_modal"===i.from&&(i.onBack=()=>l.default.transitionTo(c.OPEN_CREATE_NEW_IDENTIFIER)),!n.isLoggedIn)return(0,a.showContextualSignInModal)(e,(()=>{p(e,t,s)}),i);p(e,t,s)}(e,await async function({collectionId:e=null,requests:t=null,opts:s}){if(1===s.activeStep)return{workspaceId:(0,r.resolveStoreInstance)(n.default).id,from:s.from};const o=(0,r.resolveStoreInstance)(n.default).id,a=(0,r.resolveStoreInstance)(i.default).id;let l=null,c=await(0,d.getMeta)(o),p=a&&c.findOne(a),m=c.list,y=u.sortBy(m,(e=>u.toLower(e.name))),S=await(0,h.getMeta)(o),b=e&&await(0,h.getOne)(e,{exclude:["response","request"]}),g=S.list;p&&(l=p.id),m=u.concat({id:null,name:"No Environment"},y);let f={activeStep:2,activeSource:"workspace",ownCollections:g,ownEnvironments:m,workspaceId:(0,r.resolveStoreInstance)(n.default).id,from:s.from};return f.selectedOptions=e&&b?{environmentId:l,collectionId:e,ownerId:b.owner,name:b.name}:{environmentId:l,name:s.name,requests:t},f}(t),s,m)}}},"./js/modules/services/SignInModalService.js":function(e,t,s){s.r(t),s.d(t,{attachAuthEventHandler:function(){return c},attachSyncEventHandler:function(){return d},showContextualSignInModal:function(){return h}});var o=s("./js/services/UIEventService.js"),i=s("./js/stores/StoreManager.js"),r=s("./js/stores/SyncStatusStore.js"),n=s("../../node_modules/mobx/lib/mobx.module.js"),a=s("./node_modules/lodash/lodash.js");const l={openCreateNewDocumentationModal:"documentation",openCreateNewMockModal:"mock",openCreateNewMonitorModal:"monitor",mock:"mock",monitor:"monitor",documentation:"documentation",invite:"invite"};function c({onSignIn:e,onSkipSignIn:t}={}){if(!e&&!t)return;let s,i;return a.isFunction(e)&&(s=o.default.subscribe("userSignedIn",e)),a.isFunction(t)&&(i=o.default.subscribe("userSkippedSignIn",t)),()=>{s&&s(),i&&i()}}function d({onSuccess:e,onError:t}={}){if((0,i.resolveStoreInstance)(r.default).isInSync)return a.isFunction(e)&&e(),a.noop;let s=setTimeout((()=>a.isFunction(t)&&t()),6e4),o=(0,i.resolveStoreInstance)(r.default),l=(0,n.reaction)((()=>o.isInSync),(t=>{t&&(clearTimeout(s),a.isFunction(e)&&e())}));return()=>{l&&l()}}function h(e="invite",t=null,s={}){let o=l[e]||"invite";return pm.mediator.trigger("showContextualSignInModal",{type:o,from:s.from,onLogin:()=>{a.isFunction(t)&&t()},onBack:a.isFunction(s.onBack)&&s.onBack})}},"./js/stores/ListCacheStore.js":function(e,t,s){s.r(t),s.d(t,{default:function(){return p}});var o,i,r,n,a=s("../../node_modules/mobx/lib/mobx.module.js"),l=s("./js/stores/BaseListStore.js"),c=s("./js/modules/controllers/ListCacheController.js"),d=s("./node_modules/lodash/lodash.js");function h(e,t,s,o,i){var r={};return Object.keys(o).forEach((function(e){r[e]=o[e]})),r.enumerable=!!r.enumerable,r.configurable=!!r.configurable,("value"in r||r.initializer)&&(r.writable=!0),r=s.slice().reverse().reduce((function(s,o){return o(e,t,s)||s}),r),i&&void 0!==r.initializer&&(r.value=r.initializer?r.initializer.call(i):void 0,r.initializer=void 0),void 0===r.initializer&&(Object.defineProperty(e,t,r),r=null),r}let u=(o=a.action.bound,i=a.action.bound,n=h((r=class{constructor(e){var t,s,o,i;t=this,s="ranges",i=this,(o=n)&&Object.defineProperty(t,s,{enumerable:o.enumerable,configurable:o.configurable,writable:o.writable,value:o.initializer?o.initializer.call(i):void 0}),this.id=e.id,this.ranges=e.ranges,this.update(e)}getRange(e){return d.find(this.ranges,(t=>t[1]===e||t[1]<e&&t[0]>e||t[0]===e))}update(e){d.has(e,"ranges")&&(this.ranges=e.ranges)}}).prototype,"ranges",[a.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h(r.prototype,"getRange",[o],Object.getOwnPropertyDescriptor(r.prototype,"getRange"),r.prototype),h(r.prototype,"update",[i],Object.getOwnPropertyDescriptor(r.prototype,"update"),r.prototype),r);class p extends l.default{constructor(){super(u),this.modelEvents={namespace:"listcache"}}hydrate(){return c.default.getAll().then((e=>{this.add(e)}))}}},"./runtime-repl/extensible-collection/history/components/ECHistorySidebarListItem.js":function(e,t,s){s.r(t),s.d(t,{default:function(){return w}});var o,i=s("../../node_modules/react/index.js"),r=s("../../node_modules/react-dom/index.js"),n=s("./node_modules/moment/moment.js"),a=s.n(n),l=s("./node_modules/classnames/index.js"),c=s.n(l),d=s("../../node_modules/@postman/aether/esmLib/src/components/Text/Text.js"),h=s("../../node_modules/@postman/aether/esmLib/src/components/Button/Button.js"),u=s("../../node_modules/@postman/aether-icons/esmLib/src/Icon/Icon.js"),p=s("../../node_modules/mobx-react/dist/mobx-react.module.js"),m=s("./js/components/base/Avatar.js"),y=s("./js/components/base/Tooltips.js"),S=s("./js/containers/apps/requester/sidebar/SidebarListItem.js"),b=s("./js/stores/OnlineStatusStore.js"),g=s("./js/stores/PermissionStore.js"),f=s("./runtime-repl/history/HistoryActionsConstants.js"),v=s("./runtime-repl/_common/DisabledTooltipConstants.js"),I=s("./js/stores/StoreManager.js"),E=s("./js/stores/CurrentUserStore.js");let w=(0,p.observer)(o=class extends i.Component{constructor(e){super(e),this.state={isTooltipVisible:!1},this.userAvatar=i.createRef(),this.handleSelect=this.handleSelect.bind(this),this.handleAction=this.handleAction.bind(this),this.handleDelete=this.handleDelete.bind(this),this.showTooltip=this.showTooltip.bind(this),this.hideTooltip=this.hideTooltip.bind(this),this.getLeftAlignedComponents=this.getLeftAlignedComponents.bind(this),this.getRightAlignedComponents=this.getRightAlignedComponents.bind(this)}componentDidMount(){this.selfNode=(0,r.findDOMNode)(this),this.props.observeSizeChange&&this.props.observeSizeChange(this.selfNode)}componentWillUpdate(e){if(!this.props.selected&&e.selected){const e=(0,r.findDOMNode)(this);e&&e.scrollIntoViewIfNeeded&&e.scrollIntoViewIfNeeded()}}componentWillUnmount(){this.props.unobserveSizeChange&&this.props.unobserveSizeChange(this.selfNode,this.props.index)}getClasses(){return c()({"history-sidebar-list-item":!0,"history-sidebar-list-item__extensibleitem":!0,"is-selected":this.props.selected})}getTooltipText(e,t){return e?t?v.DISABLED_TOOLTIP_IS_OFFLINE:v.DISABLED_TOOLTIP_NO_PERMISSION:"Delete history"}getLeftAlignedComponents(e){var t;if(!e)return i.createElement("div",{className:"history-sidebar__indent"});const s=(0,I.resolveStoreInstance)(E.default),o=c()({"history-sidebar-list-item-updatedBy":!0,hovered:e}),r=s.isCurrentUserPartner?null===(t=s.partnerMembersByIds)||void 0===t?void 0:t[this.props.userId]:s.teamMembers.get(String(this.props.userId)),n=r&&(r.name||r.username);return i.createElement("div",{className:o,onMouseOver:this.showTooltip,onMouseLeave:this.hideTooltip},this.props.userId&&"0"!==this.props.userId?i.createElement(m.default,{ref:this.userAvatar,size:"small",userId:this.props.userId}):i.createElement(u.default,{name:"icon-descriptive-user-stroke",color:"content-color-secondary"}),this.userAvatar.current&&i.createElement(y.Tooltip,{immediate:!0,show:this.state.isTooltipVisible,target:this.userAvatar.current,placement:"right"},i.createElement(y.TooltipBody,null,i.createElement("div",{className:"history-sidebar-list-item-avatar-tooltip"},i.createElement(d.default,{type:"body-medium"},n),i.createElement(d.default,{type:"body-medium"},a()(this.props.createdAt).format("DD MMM YYYY, h:mm A"))))))}getRightAlignedComponents(e){const t=c()({"sidebar-list-item__right-section-actions":!0,hovered:e});if(!e)return null;const s=(0,I.resolveStoreInstance)(g.default),{userCanSave:o}=(0,I.resolveStoreInstance)(b.default),r=o&&s.can("delete","history");return i.createElement("div",{className:t},i.createElement(h.default,{type:"tertiary",icon:"icon-action-delete-stroke",onClick:this.handleDelete,isDisabled:!r,tooltip:this.getTooltipText(!r,!o)}))}showTooltip(){this.setState({isTooltipVisible:!0})}hideTooltip(){this.setState({isTooltipVisible:!1})}handleSelect(e){e.stopPropagation();const t={ctrlKey:e.ctrlKey,metaKey:e.metaKey,shiftKey:e.shiftKey};this.props.onSelect&&this.props.onSelect({id:this.props.id,type:"ecitemhistory",itemType:this.props.itemType},t)}handleAction(e){this.props.onSelectAction(e,{ecitemhistory:[this.props.id]})}handleDelete(e){e.stopPropagation(),this.handleAction(f.ACTION_TYPE_DELETE)}render(){const e=pm.ECItemRegistry.getConfig(this.props.itemType);return e?i.createElement("div",{"data-index":this.props.index},i.createElement(S.default,{text:this.props.url,icon:i.createElement(u.default,{name:e.icon,color:e.iconColor}),isSelected:this.props.isSelected,onClick:this.handleSelect,className:this.getClasses(),leftMetaComponent:this.getLeftAlignedComponents,rightMetaComponent:this.getRightAlignedComponents})):null}})||o},"./runtime-repl/history/HistoryActionsConstants.js":function(e,t,s){s.r(t),s.d(t,{ACTION_TYPE_DELETE:function(){return a},ACTION_TYPE_DOCUMENT:function(){return r},ACTION_TYPE_DOWNLOAD:function(){return l},ACTION_TYPE_MOCK:function(){return n},ACTION_TYPE_MONITOR:function(){return i},ACTION_TYPE_SAVE:function(){return o}});const o="save",i="monitor",r="document",n="mock",a="delete",l="download"},"./runtime-repl/history/HistoryActionsTooltipConstants.js":function(e,t,s){s.r(t),s.d(t,{ACTION_TYPE_DELETE_REQUESTS_TOOLTIP:function(){return i},ACTION_TYPE_DELETE_REQUEST_TOOLTIP:function(){return o},ACTION_TYPE_SAVE_REQUESTS_TOOLTIP:function(){return n},ACTION_TYPE_SAVE_REQUEST_TOOLTIP:function(){return r}});const o="Delete request",i="Delete items",r="Add request to Collection",n="Add requests to Collection"},"./runtime-repl/history/HistoryInfoHeader.js":function(e,t,s){s.r(t),s.d(t,{default:function(){return n}});var o=s("../../node_modules/react/index.js"),i=s("./node_modules/prop-types/index.js"),r=s.n(i);class n extends o.PureComponent{render(){const e=this.props.icon;return o.createElement("div",{className:"history-sidebar-info-header"},o.createElement("div",{className:"history-sidebar-info-header__icon"},o.createElement(e,null)),o.createElement("span",null,this.props.message))}}n.propTypes={message:r().string.isRequired}},"./runtime-repl/history/HistoryItemActionsDropdown.js":function(e,t,s){s.r(t),s.d(t,{default:function(){return R}});var o,i,r,n,a=s("../../node_modules/react/index.js"),l=s("./node_modules/classnames/index.js"),c=s.n(l),d=s("../../node_modules/mobx-react/dist/mobx-react.module.js"),h=s("../../node_modules/mobx/lib/mobx.module.js"),u=s("../../node_modules/@postman/aether-icons/esmLib/src/Icon/Icon.js"),p=s("./js/components/base/Dropdowns.js"),m=s("./js/components/base/Buttons.js"),y=s("./js/utils/PluralizeHelper.js"),S=s("./runtime-repl/history/HistoryActionsConstants.js"),b=s("./runtime-repl/_common/ScratchpadConstants.js"),g=s("./runtime-repl/_common/DisabledTooltipConstants.js"),f=s("./collaboration/workspace/model/ActiveWorkspacePermissionStore.ts"),v=s("./js/stores/OnlineStatusStore.js"),I=s("./js/stores/StoreManager.js"),E=s("./collaboration/workspace/model/ActiveWorkspaceBaseStore.ts"),w=s("./js/constants/MoreButtonTooltipConstant.js"),T=s("./js/controllers/ShortcutsList.js"),C=s("./runtime-repl/collection/_api/CollectionStoreV2.js"),_=s("./collaboration/workspace/types/PermissionTypes.ts"),O=s("./node_modules/lodash/lodash.js");function A(e,t,s,o,i){var r={};return Object.keys(o).forEach((function(e){r[e]=o[e]})),r.enumerable=!!r.enumerable,r.configurable=!!r.configurable,("value"in r||r.initializer)&&(r.writable=!0),r=s.slice().reverse().reduce((function(s,o){return o(e,t,s)||s}),r),i&&void 0!==r.initializer&&(r.value=r.initializer?r.initializer.call(i):void 0,r.initializer=void 0),void 0===r.initializer&&(Object.defineProperty(e,t,r),r=null),r}const j="Not available to collection run items";let R=(0,d.observer)(((n=class extends a.Component{constructor(e){var t,s,o,i;super(e),t=this,s="collectionStore",i=this,(o=r)&&Object.defineProperty(t,s,{enumerable:o.enumerable,configurable:o.configurable,writable:o.writable,value:o.initializer?o.initializer.call(i):void 0}),this.handleSelect=this.handleSelect.bind(this),this.handleShortcutSelect=this.handleShortcutSelect.bind(this),this.handleToggle=this.handleToggle.bind(this),this.workspaceReactionDisposer=null}async componentDidMount(){const e=(0,I.resolveStoreInstance)(E.default);this.workspaceReactionDisposer=(0,h.reaction)((()=>e.id),(async()=>{if(!e.id)return;this.collectionStore&&this.collectionStore.unsubscribe&&this.collectionStore.unsubscribe();const t=await(0,C.subscribeMeta)(e.id,{permissions:this.constructor.collectionPermissions});this.setCollectionStore(t)}),{fireImmediately:!0})}componentWillUnmount(){this.collectionStore&&this.collectionStore.unsubscribe&&this.collectionStore.unsubscribe(),this.workspaceReactionDisposer&&this.workspaceReactionDisposer()}getKeymapHandlers(){return{delete:pm.shortcuts.handle("delete",this.handleShortcutSelect.bind(this,S.ACTION_TYPE_DELETE))}}handleShortcutSelect(e){pm.mediator.trigger("focusSidebar"),this.handleSelect(e)}handleSelect(e){this.props.onSelect&&this.props.onSelect(e),this.handleToggle(!1)}handleToggle(e){this.props.onToggle&&this.props.onToggle(e)}getDropDownActionWrapperClasses(){return c()({"collection-sidebar-request-dropdown-actions-wrapper":!0})}getDisabledText(e){if(e)return(0,I.resolveStoreInstance)(v.default).userCanSave?g.DISABLED_TOOLTIP_NO_PERMISSION:g.DISABLED_TOOLTIP_IS_OFFLINE}getAddRequestTooltip(e,t){return e?t?j:g.DISABLED_TOOLTIP_NO_PERMISSION:g.DISABLED_TOOLTIP_IS_OFFLINE}setCollectionStore(e){this.collectionStore=e}get editableCollections(){return this.collectionStore&&this.collectionStore.list&&this.collectionStore.list.filter((e=>e.isEditable))}render(){const e=y.default.pluralize({count:this.props.count,singular:"request",plural:"requests"}),{userCanSave:t}=(0,I.resolveStoreInstance)(v.default),s=(0,I.resolveStoreInstance)(f.default),o=s&&s.permissions,i=!O.get(o,_.WORKSPACE_PERMISSIONS.ADD_MOCK_TO_WORKSPACE,!0),r=!O.get(o,_.WORKSPACE_PERMISSIONS.ADD_MONITOR_TO_WORKSPACE,!0),n=t&&O.get(o,_.WORKSPACE_PERMISSIONS.REMOVE_HISTORY_FROM_WORKSPACE,!0),l=!O.isEmpty(this.editableCollections),c=O.get(o,_.WORKSPACE_PERMISSIONS.ADD_COLLECTION_TO_WORKSPACE,!0),d=l||c;return a.createElement("div",{className:this.getDropDownActionWrapperClasses()},a.createElement(p.Dropdown,{isOpen:this.props.isOpen,keyMapHandlers:this.getKeymapHandlers(),ref:"menu",onSelect:this.handleSelect,onToggle:this.handleToggle,className:"collection-sidebar-request-actions-dropdown history-sidebar-multiple-request-selected-dropdown"},a.createElement(p.DropdownButton,{dropdownStyle:"nocaret",type:"custom"},a.createElement(m.Button,{className:"history-sidebar-list-item__button__options",tooltip:w.ACTION_TYPE_VIEW_MORE_ACTIONS_TOOLTIP}," ",a.createElement(u.default,{name:"icon-action-options-stroke",className:"history-sidebar-list-item__actions__options pm-icon pm-icon-normal"}))),a.createElement(p.DropdownMenu,{"align-right":!0},a.createElement(p.MenuItem,{refKey:S.ACTION_TYPE_SAVE,disabled:!t||this.props.disableRequestSpecificActions||!d,disabledText:this.getAddRequestTooltip(t,d)},a.createElement("div",{className:"dropdown-menu-item-label"},`Save ${e}`)),a.createElement(p.MenuItem,{refKey:S.ACTION_TYPE_MONITOR,disabled:!t||this.props.disableRequestSpecificActions||r,disabledText:t?this.props.disableRequestSpecificActions?j:g.DISABLED_TOOLTIP_WORKSPACE_VIEWER:g.DISABLED_TOOLTIP_IS_OFFLINE},a.createElement("div",{className:"dropdown-menu-item-label"},`Monitor ${e}`)),a.createElement(p.MenuItem,{refKey:S.ACTION_TYPE_DOCUMENT,disabled:!t||this.props.disableRequestSpecificActions,disabledText:t?this.props.disableRequestSpecificActions?j:b.DISABLED_IN_SCRATCHPAD_TOOLTIP:g.DISABLED_TOOLTIP_IS_OFFLINE},a.createElement("div",{className:"dropdown-menu-item-label"},`Document ${e}`)),a.createElement(p.MenuItem,{refKey:S.ACTION_TYPE_MOCK,disabled:!t||this.props.disableRequestSpecificActions||i,disabledText:t?this.props.disableRequestSpecificActions?j:g.DISABLED_TOOLTIP_WORKSPACE_VIEWER:g.DISABLED_TOOLTIP_IS_OFFLINE},a.createElement("div",{className:"dropdown-menu-item-label"},`Mock ${e}`)),"browser"!==window.SDK_PLATFORM&&a.createElement(p.MenuItem,{refKey:S.ACTION_TYPE_DOWNLOAD,disabled:!t||!this.props.disableRequestSpecificActions,disabledText:t?"You can only export collection runs":g.DISABLED_TOOLTIP_IS_OFFLINE},a.createElement("div",{className:"dropdown-menu-item-label"},"Export")),a.createElement(p.MenuItem,{refKey:S.ACTION_TYPE_DELETE,disabled:!n,disabledText:this.getDisabledText(!n)},a.createElement("div",{className:"dropdown-menu-item-label"},"Delete"),a.createElement("div",{className:"dropdown-menu-item-shortcut"},(0,T.getShortcutByName)("delete"))))))}}).collectionPermissions=["edit"],r=A((i=n).prototype,"collectionStore",[h.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A(i.prototype,"setCollectionStore",[h.action],Object.getOwnPropertyDescriptor(i.prototype,"setCollectionStore"),i.prototype),A(i.prototype,"editableCollections",[h.computed],Object.getOwnPropertyDescriptor(i.prototype,"editableCollections"),i.prototype),o=i))||o},"./runtime-repl/history/HistoryListCollectionRunItem.js":function(e,t,s){s.r(t),s.d(t,{default:function(){return E}});var o,i=s("../../node_modules/react/index.js"),r=s("../../node_modules/react-dom/index.js"),n=s("./node_modules/classnames/index.js"),a=s.n(n),l=s("../../node_modules/@postman/aether-icons/esmLib/src/Icon/Icon.js"),c=s("./node_modules/moment/moment.js"),d=s.n(c),h=s("../../node_modules/mobx-react/dist/mobx-react.module.js"),u=s("./js/components/base/Buttons.js"),p=s("./js/components/base/Avatar.js"),m=s("./js/components/base/Tooltips.js"),y=s("./runtime-repl/history/HistoryActionsConstants.js"),S=s("./runtime-repl/_common/DisabledTooltipConstants.js"),b=s("./js/stores/PermissionStore.js"),g=s("./js/stores/CurrentUserStore.js"),f=s("./js/stores/StoreManager.js"),v=s("./js/stores/OnlineStatusStore.js"),I=s("./js/containers/apps/requester/sidebar/SidebarListItem.js");let E=(0,h.observer)(o=class extends i.Component{constructor(e){super(e),this.state={dropdownOpen:!1,isTooltipVisible:!1},this.userAvatar=i.createRef(),this.handleSelect=this.handleSelect.bind(this),this.handleDropdownToggle=this.handleDropdownToggle.bind(this),this.handleDropdownActionSelect=this.handleDropdownActionSelect.bind(this),this.handleRemoveRun=this.handleRemoveRun.bind(this),this.showTooltip=this.showTooltip.bind(this),this.hideTooltip=this.hideTooltip.bind(this),this.getRightAlignedComponents=this.getRightAlignedComponents.bind(this),this.getLeftAlignedComponents=this.getLeftAlignedComponents.bind(this)}componentDidMount(){this.selfNode=(0,r.findDOMNode)(this),this.props.observeSizeChange&&this.props.observeSizeChange(this.selfNode)}componentWillUnmount(){this.props.unobserveSizeChange&&this.props.unobserveSizeChange(this.selfNode,this.props.index)}componentWillUpdate(e){if(!this.props.selected&&e.selected){const e=(0,r.findDOMNode)(this);e&&e.scrollIntoViewIfNeeded&&e.scrollIntoViewIfNeeded()}}showTooltip(){this.setState({isTooltipVisible:!0})}hideTooltip(){this.setState({isTooltipVisible:!1})}handleSelect(e){e.stopPropagation();const t={ctrlKey:e.ctrlKey,metaKey:e.metaKey,shiftKey:e.shiftKey};this.props.onSelect&&this.props.onSelect({id:this.props.id,type:"collectionrun"},t)}getClasses(){return a()({"history-sidebar-list-item":!0,"history-sidebar-list-item__collection":!0,"is-hovered":this.state.dropdownOpen,"is-selected":this.props.selected})}handleDropdownToggle(e){e!==this.state.dropdownOpen&&this.setState({dropdownOpen:e})}handleDropdownActionSelect(e){this.props.onSelectAction(e,{runs:[this.props.id]})}handleRemoveRun(e){e.stopPropagation(),this.handleDropdownActionSelect(y.ACTION_TYPE_DELETE)}getTooltipText(e){return e?(0,f.resolveStoreInstance)(v.default).userCanSave?S.DISABLED_TOOLTIP_NO_PERMISSION:S.DISABLED_TOOLTIP_IS_OFFLINE:"Delete collection run"}getLeftAlignedComponents(e,t){const s=a()({"history-sidebar-list-item-updatedBy":!0,hovered:e});if(!e&&!t)return i.createElement("div",{className:"history-sidebar__indent"});const o=(0,f.resolveStoreInstance)(g.default).teamMembers.get(this.props.owner),r=o&&(o.name||o.username);return i.createElement("div",{className:s,onMouseEnter:this.showTooltip,onMouseLeave:this.hideTooltip},this.props.owner&&"0"!==this.props.owner?i.createElement(p.default,{ref:this.userAvatar,size:"small",userId:this.props.owner}):i.createElement(l.default,{name:"icon-descriptive-user-stroke",className:"pm-icon pm-icon-normal"}),this.userAvatar.current&&i.createElement(m.Tooltip,{immediate:!0,show:this.state.isTooltipVisible,target:this.userAvatar.current,placement:"right"},i.createElement(m.TooltipBody,null,i.createElement("div",null,i.createElement("div",null,r),i.createElement("div",null,d()(this.props.createdAt).format("DD MMM YYYY, h:mm A"))))))}getRightAlignedComponents(e,t){const s=a()({"sidebar-list-item__right-section-actions":!0,hovered:e});if(!e&&!t)return null;const o=(0,f.resolveStoreInstance)(b.default),{userCanSave:r}=(0,f.resolveStoreInstance)(v.default),n=r&&o.can("delete","collectionrun",this.props.id);return i.createElement("div",{className:s},i.createElement(u.Button,{className:"history-sidebar-list-item__button__delete",type:"icon",onClick:this.handleRemoveRun,disabled:!n,tooltip:this.getTooltipText(!n)},i.createElement(l.default,{name:"icon-action-delete-stroke",className:"history-sidebar-list-item__actions__delete pm-icon pm-icon-normal"})))}render(){return i.createElement(I.default,{"data-index":this.props.index,text:this.props.name,icon:"icon-action-run-stroke",isSelected:this.props.selected,onClick:this.handleSelect,className:this.getClasses(),rightMetaComponent:this.getRightAlignedComponents,leftMetaComponent:this.getLeftAlignedComponents,entity:{routeIdentifier:"build.run.open",routeParams:{rid:this.props.id}},routeConfig:{routeIdentifier:"build.run.open",routeParams:{rid:this.props.id},isNonLink:!0}})}})||o},"./runtime-repl/history/HistoryListErrorItem.js":function(e,t,s){s.r(t),s.d(t,{default:function(){return i}});var o=s("../../node_modules/react/index.js");function i(e){return o.createElement("div",{className:"history-sidebar-list-item-group"},o.createElement("div",{className:"history-sidebar-list-item-group__error"},"Unable to load items."," ",o.createElement("span",{onClick:e.onRetry},"Retry")))}},"./runtime-repl/history/HistoryListItem.js":function(e,t,s){s.r(t),s.d(t,{default:function(){return z}});var o,i,r,n,a=s("../../node_modules/react/index.js"),l=s("../../node_modules/react-dom/index.js"),c=s("./node_modules/classnames/index.js"),d=s.n(c),h=s("./node_modules/moment/moment.js"),u=s.n(h),p=s("../../node_modules/mobx/lib/mobx.module.js"),m=s("../../node_modules/mobx-react/dist/mobx-react.module.js"),y=s("../../node_modules/@postman/aether/esmLib/src/components/Menu/MenuItem.js"),S=s("../../node_modules/@postman/aether-icons/esmLib/src/Icon/Icon.js"),b=s("./js/components/base/Buttons.js"),g=s("./js/components/base/Dropdowns.js"),f=s("./js/components/base/Avatar.js"),v=s("./js/components/base/Tooltips.js"),I=s("./js/containers/apps/requester/sidebar/SidebarListItem.js"),E=s("./runtime-repl/history/HistoryActionsConstants.js"),w=s("./runtime-repl/_common/DisabledTooltipConstants.js"),T=s("./runtime-repl/_common/ScratchpadConstants.js"),C=s("./collaboration/workspace/model/ActiveWorkspacePermissionStore.ts"),_=s("./js/stores/OnlineStatusStore.js"),O=s("./js/stores/PermissionStore.js"),A=s("./collaboration/workspace/model/ActiveWorkspaceBaseStore.ts"),j=s("./runtime-repl/history/HistoryActionsTooltipConstants.js"),R=s("./runtime-repl/request-http/RequestIcon.js"),k=s("./js/controllers/ShortcutsList.js"),D=s("./runtime-repl/collection/_api/CollectionStoreV2.js"),x=s("./collaboration/workspace/types/PermissionTypes.ts"),N=s("./runtime-repl/_common/uid-helper.ts"),H=s("./js/utils/TabOpeningUtil.js"),P=s("./appsdk/workbench/WorkbenchService.js"),L=s("./js/stores/StoreManager.js"),M=s("./js/stores/CurrentUserStore.js"),q=s("./js/constants/TabOpeningConstants.js"),W=s("./node_modules/lodash/lodash.js");function B(e,t,s,o,i){var r={};return Object.keys(o).forEach((function(e){r[e]=o[e]})),r.enumerable=!!r.enumerable,r.configurable=!!r.configurable,("value"in r||r.initializer)&&(r.writable=!0),r=s.slice().reverse().reduce((function(s,o){return o(e,t,s)||s}),r),i&&void 0!==r.initializer&&(r.value=r.initializer?r.initializer.call(i):void 0,r.initializer=void 0),void 0===r.initializer&&(Object.defineProperty(e,t,r),r=null),r}let z=(0,m.observer)(((n=class extends a.Component{constructor(e){var t,s,o,i;super(e),t=this,s="collectionStore",i=this,(o=r)&&Object.defineProperty(t,s,{enumerable:o.enumerable,configurable:o.configurable,writable:o.writable,value:o.initializer?o.initializer.call(i):void 0}),this.state={dropdownOpen:!1,isTooltipVisible:!1},this.userAvatar=a.createRef(),this.handleSelect=this.handleSelect.bind(this),this.handleDropdownToggle=this.handleDropdownToggle.bind(this),this.handleDropdownActionSelect=this.handleDropdownActionSelect.bind(this),this.handleAddRequestToCollectionClick=this.handleAddRequestToCollectionClick.bind(this),this.handleRemoveRequest=this.handleRemoveRequest.bind(this),this.showTooltip=this.showTooltip.bind(this),this.hideTooltip=this.hideTooltip.bind(this),this.getLeftAlignedComponents=this.getLeftAlignedComponents.bind(this),this.getRightAlignedComponents=this.getRightAlignedComponents.bind(this),this.getMenuItems=this.getMenuItems.bind(this),this.getActionsMenuItems=this.getActionsMenuItems.bind(this),this.workspaceReactionDisposer=null,this.getAetherMenuItems=this.getAetherMenuItems.bind(this)}async componentDidMount(){this.selfNode=(0,l.findDOMNode)(this),this.props.observeSizeChange&&this.props.observeSizeChange(this.selfNode);const e=(0,L.resolveStoreInstance)(A.default);this.workspaceReactionDisposer=(0,p.reaction)((()=>e.id),(async()=>{if(!e.id)return;this.collectionStore&&this.collectionStore.unsubscribe&&this.collectionStore.unsubscribe();const t=await(0,D.subscribeMeta)(e.id,{permissions:this.constructor.collectionPermissions});this.setCollectionStore(t)}),{fireImmediately:!0})}componentWillUpdate(e){if(!this.props.selected&&e.selected){const e=(0,l.findDOMNode)(this);if(!e)return;e.scrollIntoViewIfNeeded?e.scrollIntoViewIfNeeded():e.scrollIntoView()}}componentWillUnmount(){this.props.unobserveSizeChange&&this.props.unobserveSizeChange(this.selfNode,this.props.index),this.collectionStore&&this.collectionStore.unsubscribe&&this.collectionStore.unsubscribe(),this.workspaceReactionDisposer&&this.workspaceReactionDisposer()}setCollectionStore(e){this.collectionStore=e}get editableCollections(){return this.collectionStore&&this.collectionStore.list&&this.collectionStore.list.filter((e=>e.isEditable))}showTooltip(){this.setState({isTooltipVisible:!0})}hideTooltip(){this.setState({isTooltipVisible:!1})}handleSelect(e){e.stopPropagation();const t={ctrlKey:e.ctrlKey,metaKey:e.metaKey,shiftKey:e.shiftKey};this.props.onSelect&&this.props.onSelect({id:this.props.id,type:"request"},t)}getClasses(){return d()({"history-sidebar-list-item":!0,"history-sidebar-list-item__request":!0,"is-hovered":this.state.dropdownOpen,"is-selected":this.props.selected})}handleDropdownToggle(e){e!==this.state.dropdownOpen&&this.setState({dropdownOpen:e})}handleDropdownActionSelect(e){if(e===q.ACTION_OPEN_IN_NEW_BROWSER_TAB)return this.handleOpenInNewTab();this.props.onSelectAction(e,{requests:[this.props.id],from:"history_single"})}handleOpenInNewTab(){return(0,H.openInNewBrowserTab)("build.history",{hid:(0,N.composeUID)(this.props.id,this.props.owner)})}handleAddRequestToCollectionClick(e){e.stopPropagation(),this.handleDropdownActionSelect(E.ACTION_TYPE_SAVE,{from:"history_single"})}handleRemoveRequest(e){e.stopPropagation(),this.handleDropdownActionSelect(E.ACTION_TYPE_DELETE)}getTooltipText(e,t){return e?t?w.DISABLED_TOOLTIP_IS_OFFLINE:w.DISABLED_TOOLTIP_NO_PERMISSION:j.ACTION_TYPE_DELETE_REQUEST_TOOLTIP}getDisabledText(e,t){return t?w.DISABLED_TOOLTIP_IS_OFFLINE:w.DISABLED_TOOLTIP_NO_PERMISSION}getLeftAlignedComponents(e,t){var s;const o=d()({"history-sidebar-list-item-updatedBy":!0,hovered:e});if(!e&&!t)return a.createElement("div",{className:"history-sidebar__indent"});const i=(0,L.resolveStoreInstance)(M.default),r=i.isCurrentUserPartner?null===(s=i.partnerMembersByIds)||void 0===s?void 0:s[this.props.owner]:i.teamMembers.get(this.props.owner),n=r&&(r.name||r.username);return a.createElement("div",{className:o,onMouseEnter:this.showTooltip,onMouseLeave:this.hideTooltip},this.props.owner&&"0"!==this.props.owner?a.createElement(f.default,{ref:this.userAvatar,size:"small",userId:this.props.owner}):a.createElement(S.default,{name:"icon-descriptive-user-stroke",className:"pm-icon pm-icon-normal"}),this.userAvatar.current&&a.createElement(v.Tooltip,{immediate:!0,show:this.state.isTooltipVisible,target:this.userAvatar.current,placement:"right"},a.createElement(v.TooltipBody,null,a.createElement("div",null,a.createElement("div",null,n),a.createElement("div",null,u()(this.props.createdAt).format("DD MMM YYYY, h:mm A"))))))}getSaveRequestTooltip(e,t){return e?t?j.ACTION_TYPE_SAVE_REQUEST_TOOLTIP:w.DISABLED_TOOLTIP_NO_PERMISSION:w.DISABLED_TOOLTIP_IS_OFFLINE}getRightAlignedComponents(e,t){const s=d()({"sidebar-list-item__right-section-actions":!0,hovered:e});if(!e&&!t)return null;const o=(0,L.resolveStoreInstance)(O.default),{userCanSave:i}=(0,L.resolveStoreInstance)(_.default),r=i&&o.can("delete","history",this.props.id),n=!W.isEmpty(this.editableCollections),l=(0,L.resolveStoreInstance)(C.default),c=l&&l.permissions,h=W.get(c,x.WORKSPACE_PERMISSIONS.ADD_COLLECTION_TO_WORKSPACE,!0),u=n||h;return a.createElement("div",{className:s},a.createElement(b.Button,{className:"history-sidebar-list-item__button__add",type:"icon",onClick:this.handleAddRequestToCollectionClick,disabled:!i||!u,tooltip:this.getSaveRequestTooltip(i,u)},a.createElement(S.default,{size:"large",name:"icon-action-add-stroke",className:"history-sidebar-list-item__actions__add pm-icon pm-icon-normal"})),a.createElement(b.Button,{className:"history-sidebar-list-item__button__delete",type:"icon",onClick:this.handleRemoveRequest,disabled:!r,tooltip:this.getTooltipText(!r,!i)},a.createElement(S.default,{name:"icon-action-delete-stroke",size:"large",className:"history-sidebar-list-item__actions__delete pm-icon pm-icon-normal"})))}getDisabledTooltip(e,t){return e?t?w.DISABLED_TOOLTIP_WORKSPACE_VIEWER:T.DISABLED_IN_SCRATCHPAD_TOOLTIP:w.DISABLED_TOOLTIP_IS_OFFLINE}getMenuItems(e){const{userCanSave:t,userCanSaveAndSync:s}=(0,L.resolveStoreInstance)(_.default),o=(0,L.resolveStoreInstance)(C.default),i=o&&o.permissions,r=!W.get(i,x.WORKSPACE_PERMISSIONS.ADD_MOCK_TO_WORKSPACE,!0),n=!W.get(i,x.WORKSPACE_PERMISSIONS.ADD_MONITOR_TO_WORKSPACE,!0),l=!W.get(i,x.WORKSPACE_PERMISSIONS.ADD_COLLECTION_TO_WORKSPACE,!0),c=!W.isEmpty(this.editableCollections),d=W.get(i,x.WORKSPACE_PERMISSIONS.ADD_COLLECTION_TO_WORKSPACE,!0),h=c||d;return[a.createElement(g.MenuItem,{refKey:E.ACTION_TYPE_SAVE,disabled:!t||!h,disabledText:this.getSaveRequestTooltip(t,h)},a.createElement("div",{className:"dropdown-menu-item-label"},"Save request")),a.createElement(g.MenuItem,{refKey:E.ACTION_TYPE_MONITOR,disabled:!s||n,disabledText:t?w.DISABLED_TOOLTIP_WORKSPACE_VIEWER:w.DISABLED_TOOLTIP_IS_OFFLINE},a.createElement("div",{className:"dropdown-menu-item-label"},"Monitor request")),a.createElement(g.MenuItem,{refKey:E.ACTION_TYPE_DOCUMENT,disabled:!s||l,disabledText:this.getDisabledTooltip(t,l)},a.createElement("div",{className:"dropdown-menu-item-label"},"Document request")),a.createElement(g.MenuItem,{refKey:E.ACTION_TYPE_MOCK,disabled:!s||r,disabledText:t?w.DISABLED_TOOLTIP_WORKSPACE_VIEWER:w.DISABLED_TOOLTIP_IS_OFFLINE},a.createElement("div",{className:"dropdown-menu-item-label"},"Mock request")),a.createElement(g.MenuItem,{refKey:E.ACTION_TYPE_DELETE,disabled:!t||!e,disabledText:this.getDisabledText(!t)},a.createElement("div",{className:"dropdown-menu-item-label"},"Delete"),a.createElement("div",{className:"dropdown-menu-item-shortcut"},(0,k.getShortcutByName)("delete")))]}getActionsMenuItems(e){const t=this.getMenuItems(e);return a.createElement(g.DropdownMenu,{"align-right":!0},t)}getAetherMenuItems(e){const{userCanSave:t,userCanSaveAndSync:s}=(0,L.resolveStoreInstance)(_.default),o=(0,L.resolveStoreInstance)(C.default),i=o&&o.permissions,r=!W.get(i,x.WORKSPACE_PERMISSIONS.ADD_MOCK_TO_WORKSPACE,!0),n=!W.get(i,x.WORKSPACE_PERMISSIONS.ADD_MONITOR_TO_WORKSPACE,!0),l=!W.get(i,x.WORKSPACE_PERMISSIONS.ADD_COLLECTION_TO_WORKSPACE,!0),c=!W.isEmpty(this.editableCollections),d=W.get(i,x.WORKSPACE_PERMISSIONS.ADD_COLLECTION_TO_WORKSPACE,!0),h=c||d;return[P.default.isUseBrowserTabsActive()&&a.createElement(y.default,{isDisabled:!t,onClick:()=>this.handleOpenInNewTab(),shortcutLabel:(0,k.getShortcutByName)("openInNewBrowserTab"),key:"open-in-new-browser-tab"},"Open In New Tab"),a.createElement(y.default,{isDisabled:!t||!h,tooltip:(!t||!h)&&this.getSaveRequestTooltip(t,h),onClick:()=>this.handleDropdownActionSelect(E.ACTION_TYPE_SAVE),key:"save-request"},"Save Request"),a.createElement(y.default,{isDisabled:!s||n,tooltip:(!s||n)&&(t?w.DISABLED_TOOLTIP_WORKSPACE_VIEWER:w.DISABLED_TOOLTIP_IS_OFFLINE),onClick:()=>this.handleDropdownActionSelect(E.ACTION_TYPE_MONITOR),key:"monitor-request"},"Monitor Request"),a.createElement(y.default,{isDisabled:!s||l,tooltip:(!s||l)&&this.getDisabledTooltip(t,l),onClick:()=>this.handleDropdownActionSelect(E.ACTION_TYPE_DOCUMENT),key:"document-request"},"Document Request"),a.createElement(y.default,{isDisabled:!s||r,tooltip:(!s||r)&&(t?w.DISABLED_TOOLTIP_WORKSPACE_VIEWER:w.DISABLED_TOOLTIP_IS_OFFLINE),onClick:()=>this.handleDropdownActionSelect(E.ACTION_TYPE_MOCK),key:"mock-request"},"Mock Request"),a.createElement(y.default,{isDisabled:!t||!e,tooltip:(!t||!e)&&this.getDisabledText(!t),onClick:()=>this.handleDropdownActionSelect(E.ACTION_TYPE_DELETE),shortcutLabel:(0,k.getShortcutByName)("delete"),type:"destructive",key:"delete-request"},"Delete")].filter(Boolean)}render(){const e=(0,L.resolveStoreInstance)(O.default).can("delete","history",this.props.id);return a.createElement(I.default,{"data-index":this.props.index,text:this.props.url,onClick:this.handleSelect,isSelected:this.props.selected,icon:a.createElement(R.default,{method:this.props.method||"GET"}),className:this.getClasses(),moreActions:this.props.hideActions?null:this.getActionsMenuItems(e),rightMetaComponent:this.getRightAlignedComponents,leftMetaComponent:this.getLeftAlignedComponents,onActionsDropdownSelect:this.handleDropdownActionSelect,routeConfig:{routeIdentifier:"build.history",routeParams:{hid:(0,N.composeUID)(this.props.id,this.props.owner)},isNonLink:!0},moreActionsForAetherMenu:P.default.isUseBrowserTabsActive()?this.getAetherMenuItems(e):null})}}).collectionPermissions=["edit"],r=B((i=n).prototype,"collectionStore",[p.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B(i.prototype,"setCollectionStore",[p.action],Object.getOwnPropertyDescriptor(i.prototype,"setCollectionStore"),i.prototype),B(i.prototype,"editableCollections",[p.computed],Object.getOwnPropertyDescriptor(i.prototype,"editableCollections"),i.prototype),o=i))||o},"./runtime-repl/history/HistoryListMetaItem.js":function(e,t,s){s.r(t),s.d(t,{default:function(){return C}});var o,i,r,n=s("../../node_modules/react/index.js"),a=s("../../node_modules/mobx/lib/mobx.module.js"),l=s("./node_modules/classnames/index.js"),c=s.n(l),d=s("../../node_modules/@postman/aether-icons/esmLib/src/Icon/Icon.js"),h=s("./js/components/base/Buttons.js"),u=s("./runtime-repl/history/HistoryActionsConstants.js"),p=s("./runtime-repl/_common/DisabledTooltipConstants.js"),m=s("./collaboration/workspace/model/ActiveWorkspacePermissionStore.ts"),y=s("./js/stores/OnlineStatusStore.js"),S=s("./collaboration/workspace/model/ActiveWorkspaceBaseStore.ts"),b=s("./js/stores/StoreManager.js"),g=s("./runtime-repl/history/datastores/HistorySidebarStore.js"),f=s("./runtime-repl/history/HistoryActionsTooltipConstants.js"),v=s("./runtime-repl/collection/_api/CollectionStoreV2.js"),I=s("./collaboration/workspace/types/PermissionTypes.ts"),E=s("./runtime-repl/history/HistoryItemActionsDropdown.js"),w=s("./node_modules/lodash/lodash.js");function T(e,t,s,o,i){var r={};return Object.keys(o).forEach((function(e){r[e]=o[e]})),r.enumerable=!!r.enumerable,r.configurable=!!r.configurable,("value"in r||r.initializer)&&(r.writable=!0),r=s.slice().reverse().reduce((function(s,o){return o(e,t,s)||s}),r),i&&void 0!==r.initializer&&(r.value=r.initializer?r.initializer.call(i):void 0,r.initializer=void 0),void 0===r.initializer&&(Object.defineProperty(e,t,r),r=null),r}let C=((r=class extends n.PureComponent{constructor(e){var t,s,o,r;super(e),t=this,s="collectionStore",r=this,(o=i)&&Object.defineProperty(t,s,{enumerable:o.enumerable,configurable:o.configurable,writable:o.writable,value:o.initializer?o.initializer.call(r):void 0}),this.state={dropdownOpen:!1,isHovered:!1},this.store=(0,b.resolveStoreInstance)(g.default),this.handleToggleGroup=this.handleToggleGroup.bind(this),this.handleDropdownToggle=this.handleDropdownToggle.bind(this),this.handleDropdownActionSelect=this.handleDropdownActionSelect.bind(this),this.handleAddRequestToCollectionClick=this.handleAddRequestToCollectionClick.bind(this),this.handleRemoveRequest=this.handleRemoveRequest.bind(this),this.handleMouseOver=this.handleMouseOver.bind(this),this.handleMouseLeave=this.handleMouseLeave.bind(this),this.handleContextMenu=this.handleContextMenu.bind(this),this.$node=n.createRef(),this.workspaceReactionDisposer=null}async componentDidMount(){const e=(0,b.resolveStoreInstance)(S.default);document.addEventListener("contextmenu",this.handleContextMenu),this.workspaceReactionDisposer=(0,a.reaction)((()=>e.id),(async()=>{if(!e.id)return;this.collectionStore&&this.collectionStore.unsubscribe&&this.collectionStore.unsubscribe();const t=await(0,v.subscribeMeta)(e.id,{permissions:this.constructor.collectionPermissions});this.setCollectionStore(t)}),{fireImmediately:!0})}componentWillUnmount(){document.removeEventListener("contextmenu",this.handleContextMenu),this.collectionStore&&this.collectionStore.unsubscribe&&this.collectionStore.unsubscribe(),this.workspaceReactionDisposer&&this.workspaceReactionDisposer()}setCollectionStore(e){this.collectionStore=e}get editableCollections(){return this.collectionStore&&this.collectionStore.list&&this.collectionStore.list.filter((e=>e.isEditable))}handleMouseOver(){this.setState({isHovered:!0})}handleMouseLeave(){!this.state.dropdownOpen&&this.setState({isHovered:!1})}getCollapseButtonClasses(){return c()({caret:!0,"pm-icon":!0,"pm-icon-normal":!0,"is-closed":this.store.isItemCollapsed(this.props.name)})}getMetaClasses(){return c()({"history-sidebar-list-item-group__meta":!0,"is-hovered":this.state.dropdownOpen})}handleToggleGroup(){const{name:e}=this.props;if(this.store.isItemCollapsed(e))return this.store.expandItem(e);this.store.collapseItem(e)}handleDropdownToggle(e){e!==this.state.dropdownOpen&&this.setState({dropdownOpen:e})}handleContextMenu(e){var t,s,o;if(this.$node&&null!==(t=this.$node)&&void 0!==t&&null!==(s=t.current)&&void 0!==s&&null!==(o=s.contains)&&void 0!==o&&o.call(s,null==e?void 0:e.target))return e.preventDefault(),void this.setState((e=>({dropdownOpen:!e.dropdownOpen})));this.setState({dropdownOpen:!1})}handleDropdownActionSelect(e){const t={requests:w.reduce(this.props.items,((e,t)=>("request"===t.type&&e.push(t.id),e)),[]),runs:w.reduce(this.props.items,((e,t)=>("collectionrun"===t.type&&e.push(t.id),e)),[]),websockethistory:w.reduce(this.props.items,((e,t)=>("websockethistory"===t.type&&e.push(t.id),e)),[]),ecitemhistory:w.reduce(this.props.items,((e,t)=>("ecitemhistory"===t.type&&e.push(t.id),e)),[]),proxyhistory:w.reduce(this.props.items,((e,t)=>("proxyhistory"===t.type&&e.push(t.id),e)),[]),defaultCollectionName:this.props.name,from:"history_date_group"};e!==u.ACTION_TYPE_DELETE?this.props.onSelectAction(e,t):pm.mediator.trigger("showDeleteHistoryModal",(()=>{this.props.onSelectAction(e,t)}),{identifier:"selected"})}handleAddRequestToCollectionClick(e){e.stopPropagation(),this.handleDropdownActionSelect(u.ACTION_TYPE_SAVE)}handleRemoveRequest(e){e.stopPropagation(),this.handleDropdownActionSelect(u.ACTION_TYPE_DELETE)}getHistoryDeleteTooltip(e,t){return e?t?f.ACTION_TYPE_DELETE_REQUESTS_TOOLTIP:p.DISABLED_TOOLTIP_NO_PERMISSION:p.DISABLED_TOOLTIP_IS_OFFLINE}getAddRequestTooltip(e,t,s){return e?t?s?"Not available to collection run items":f.ACTION_TYPE_SAVE_REQUESTS_TOOLTIP:p.DISABLED_TOOLTIP_NO_PERMISSION:p.DISABLED_TOOLTIP_IS_OFFLINE}render(){const e=w.size(this.store.getSelectedItems())>1,{userCanSave:t}=(0,b.resolveStoreInstance)(y.default),s=(0,b.resolveStoreInstance)(m.default),o=s&&s.permissions,i=w.get(o,I.WORKSPACE_PERMISSIONS.REMOVE_HISTORY_FROM_WORKSPACE,!0),r=!w.isEmpty(this.editableCollections),a=w.get(o,I.WORKSPACE_PERMISSIONS.ADD_COLLECTION_TO_WORKSPACE,!0),l=r||a;return n.createElement("div",{ref:this.$node,className:"history-sidebar-list-item-group",onMouseOver:this.handleMouseOver,onMouseLeave:this.handleMouseLeave},n.createElement("div",{className:this.getMetaClasses(),onClick:this.handleToggleGroup},n.createElement("div",{className:"history-sidebar-list-item-group__name"},n.createElement(d.default,{name:"icon-direction-down",className:this.getCollapseButtonClasses()}),n.createElement("span",null,this.props.name)),!e&&this.state.isHovered&&n.createElement("div",{className:"history-sidebar-list-item-group__actions"},n.createElement(h.Button,{className:"history-sidebar-list-item__button__add",type:"icon",disabled:!t||this.props.disableRequestSpecificActions||!l,onClick:this.handleAddRequestToCollectionClick,tooltip:this.getAddRequestTooltip(t,l,this.props.disableRequestSpecificActions)},n.createElement(d.default,{name:"icon-action-add-stroke",className:"history-sidebar-list-item__actions__add pm-icon pm-icon-normal"})),n.createElement(h.Button,{className:"history-sidebar-list-item__button__delete",type:"icon",onClick:this.handleRemoveRequest,disabled:!t||!i,tooltip:this.getHistoryDeleteTooltip(t,i)},n.createElement(d.default,{name:"icon-action-delete-stroke",className:"history-sidebar-list-item__actions__delete pm-icon pm-icon-normal"})),n.createElement(E.default,{count:w.size(this.props.items),onSelect:this.handleDropdownActionSelect,onToggle:this.handleDropdownToggle,disableRequestSpecificActions:this.props.disableRequestSpecificActions,canAddRequest:this.props.canAddRequest,isOpen:this.state.dropdownOpen}))))}}).collectionPermissions=["edit"],i=T((o=r).prototype,"collectionStore",[a.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T(o.prototype,"setCollectionStore",[a.action],Object.getOwnPropertyDescriptor(o.prototype,"setCollectionStore"),o.prototype),T(o.prototype,"editableCollections",[a.computed],Object.getOwnPropertyDescriptor(o.prototype,"editableCollections"),o.prototype),o)},"./runtime-repl/history/HistorySidebar.js":function(e,t,s){s.r(t),s.d(t,{default:function(){return g}});var o,i=s("../../node_modules/react/index.js"),r=s("../../node_modules/react-dom/index.js"),n=s("./node_modules/pure-render-decorator/index.js"),a=s.n(n),l=s("./js/components/base/keymaps/KeyMaps.js"),c=s("./js/components/base/XPaths/XPath.js"),d=s("./runtime-repl/history/HistoryActionsConstants.js"),h=s("./runtime-repl/history/datastores/HistoryListStore.js"),u=s("./js/stores/StoreManager.js"),p=s("./runtime-repl/history/datastores/HistorySidebarStore.js"),m=s("./growth/activation/experiment/grw-468/index.ts"),y=s("./runtime-repl/history/HistorySidebarMenu.js"),S=s("./runtime-repl/history/HistorySidebarList.js"),b=s("./node_modules/lodash/lodash.js");let g=a()(o=class extends i.Component{constructor(e){super(e),this.store=(0,u.resolveStoreInstance)(p.default),this.historyStore=(0,u.resolveStoreInstance)(h.default),this.focus=this.focus.bind(this),this.groupItems=this.groupItems.bind(this),this.selectNext=this.selectNext.bind(this),this.selectPrev=this.selectPrev.bind(this),this.deleteItem=this.deleteItem.bind(this),this.selectItem=this.selectItem.bind(this),this.multiselectNextItem=this.multiselectNextItem.bind(this),this.multiselectPrevItem=this.multiselectPrevItem.bind(this)}getKeyMapHandlers(){return{groupItems:pm.shortcuts.handle("groupItems",this.groupItems),nextItem:pm.shortcuts.handle("nextItem",this.selectNext),prevItem:pm.shortcuts.handle("prevItem",this.selectPrev),delete:pm.shortcuts.handle("delete",this.deleteItem),multiselectNextItem:pm.shortcuts.handle("multiselectNextItem",this.multiselectNextItem),multiselectPrevItem:pm.shortcuts.handle("multiselectPrevtItem",this.multiselectPrevItem),select:pm.shortcuts.handle("select",this.selectItem),search:pm.shortcuts.handle("search"),saveCurrentRequest:e=>{e&&e.stopPropagation(),this.props.onSaveCurrentRequest()}}}focus(){const e=(0,r.findDOMNode)(this.refs.history);e&&e.focus()}selectNext(e){e&&e.preventDefault();const t=this.store.getNextItem();t&&b.invoke(this,"props.onSelect",t)}selectPrev(e){e&&e.preventDefault();const t=this.store.getPrevItem();t&&b.invoke(this,"props.onSelect",t)}deleteItem(e){if(document.activeElement.classList.contains("history-sidebar__filter"))return;e&&e.preventDefault();const t=this.store.getPrevItem();b.invoke(this,"props.onDeleteMultiple","selected",t)}selectItem(e){e&&e.preventDefault(),b.invoke(this,"refs.list.selectItem")}multiselectNextItem(e){e&&e.preventDefault();const t=this.store.getNextItem();t&&b.invoke(this,"props.onSelect",t,{metaKey:!0})}multiselectPrevItem(e){e&&e.preventDefault();const t=this.store.getPrevItem();t&&b.invoke(this,"props.onSelect",t,{metaKey:!0})}groupItems(){this.props.onSelectAction&&this.props.onSelectAction("all",d.ACTION_TYPE_SAVE,{requests:this.store.getSelectedItems(),from:"history_multiple"})}render(){return i.createElement(l.default,{handlers:this.getKeyMapHandlers(),keyMap:pm.shortcuts.getShortcuts()},i.createElement("div",{className:"history-sidebar",ref:"history"},i.createElement("div",{className:"history-sidebar-wrapper"},i.createElement(y.default,{historySidebar:this.store,historyStore:this.historyStore,enableHistoryResponseSaving:this.props.enableHistoryResponseSaving,isHistorySettingUpdating:this.props.isHistorySettingUpdating,onDeleteMultiple:this.props.onDeleteMultiple,onSelectAction:this.props.onSelectAction.bind(this,"all"),onToggleHistoryResponseSaving:this.props.onToggleHistoryResponseSaving}),i.createElement(m.CollectionFromHistoryRequestsSafe,null),i.createElement(c.default,{identifier:"history"},i.createElement(S.default,{ref:"list",initializing:this.props.initializing,isSocketConnected:this.props.isSocketConnected,isLoggedIn:this.props.isLoggedIn,workspace:this.props.workspace,onDeleteMultiple:this.props.onDeleteMultiple,onLoadMore:this.props.onLoadMore,onSelect:this.props.onSelect,onSelectAction:this.props.onSelectAction})))))}})||o},"./runtime-repl/history/HistorySidebarContainer.js":function(e,t,s){s.r(t),s.d(t,{default:function(){return z}});var o,i=s("../../node_modules/react/index.js"),r=s("./node_modules/@postman/react-click-outside/dist/index.js"),n=s.n(r),a=s("../../node_modules/mobx-react/dist/mobx-react.module.js"),l=s("./integrations/proxy/components/helpers/ProxyUtils.ts"),c=s("./runtime-repl/history/datastores/HistoryListStore.js"),d=s("./js/stores/CurrentUserStore.js"),h=s("./js/stores/SyncStatusStore.js"),u=s("./js/stores/ActiveWorkspaceStore.js"),p=s("./js/stores/OnlineStatusStore.js"),m=s("./collaboration/workspace/model/ActiveWorkspacePermissionStore.ts"),y=s("./runtime-repl/history/datastores/HistorySettingsStore.js"),S=s("./runtime-repl/runner/RunnerRun/RunnerRunStore.js"),b=s("./js/stores/StoreManager.js"),g=s("./runtime-repl/history/datastores/HistorySidebarStore.js"),f=s("./js/modules/model-event.js"),v=s("./js/modules/pipelines/user-action.js"),I=s("./runtime-repl/extensible-collection/api/HistorySDK.ts"),E=s("./runtime-repl/history/HistorySidebar.js"),w=s("./runtime-repl/history/HistoryService.js"),T=s("./runtime-repl/history/_api/HistoryInterface.js"),C=s("./js/containers/new-button/CreateNewXService.js"),_=s("./js/modules/services/AnalyticsService.js"),O=s("./js/stores/CurrentUserInfoStore.js"),A=s("./runtime-repl/request-websocket/base/api/WebSocketRequestInterface.js"),j=s("./integrations/proxy/services/ProxyHistoryService.js"),R=s("./collaboration/workspace/types/PermissionTypes.ts"),k=s("./js/components/network/NetworkTrouble.js"),D=s("./runtime-repl/runner/workbench/common.js"),x=s("./api-dev/interfaces/APIInterface.js"),N=s("./integrations/navigation/constants.js"),H=s("./integrations/proxy/helpers/constants.ts"),P=s("./runtime-repl/runner/_api/RunnerInterface.js"),L=s("./runtime-repl/_common/ToastHelpers.js"),M=s("./runtime-repl/_common/WorkspaceHelpers.js"),q=s("./runtime-repl/history/HistoryActionsConstants.js"),W=s("./runtime-repl/runner/RunnerHelper.js"),B=s("./node_modules/lodash/lodash.js");let z=n()(o=(0,a.observer)(o=class extends i.Component{constructor(e){super(e),this.store=(0,b.resolveStoreInstance)(g.default),this.focus=this.focus.bind(this),this.handleLoadRequestDebounced=B.debounce(this.handleLoadRequest,100,{leading:!0}).bind(this),this.handleLoadCollectionRunDebounced=B.debounce(this.handleLoadCollectionRun,100,{leading:!0}).bind(this),this.handleLoadProxyInterceptorSessionDebounced=B.debounce(this.handleLoadProxyInterceptorSession,100,{leading:!0}).bind(this),this.handleLoadWebSocketHistoryDebounced=B.debounce(this.handleLoadWebSocketHistory,100,{leading:!0}).bind(this),this.handleLoadECHistoryDebounced=B.debounce(this.handleLoadECHistory,100,{leading:!0}).bind(this),this.handleActiveRequestChange=this.handleActiveRequestChange.bind(this),this.handleAddToCollection=this.handleAddToCollection.bind(this),this.handleDeleteMultiple=this.handleDeleteMultiple.bind(this),this.handleItemSelect=this.handleItemSelect.bind(this),this.handleSelectAction=this.handleSelectAction.bind(this),this.handleSelectHistoryAction=this.handleSelectHistoryAction.bind(this),this.handleSelectCollectionRunAction=this.handleSelectCollectionRunAction.bind(this),this.handleSelectWebSocketHistoryAction=this.handleSelectWebSocketHistoryAction.bind(this),this.handleproxyHistoryAction=this.handleproxyHistoryAction.bind(this)}UNSAFE_componentWillMount(){pm.mediator.on("activeRequestChanged",this.handleActiveRequestChange)}componentWillUnmount(){pm.mediator.off("activeRequestChanged",this.handleActiveRequestChange)}focus(){B.invoke(this,"refs.history.focus")}selectNext(){B.invoke(this,"refs.history.selectNext")}handleActiveRequestChange(e){this.store.itemExists(e)?this.store.resetSelection([e]):this.store.resetSelection()}handleClickOutside(e){if(!B.isEmpty(this.store.getSelectedItems())){const t=document.getElementsByClassName("ReactModal__Content")[0],s=document.querySelector(".history-sidebar-multiple-request-selected-dropdown");if(t&&t.contains(e.target)||s&&s.contains(e.target))return;this.store.resetSelection()}}handleLoadRequest(e,t=!1){e&&w.default.openHistoryInTab(e,{newTab:t,preview:!0})}async handleLoadProxyInterceptorSession(e,t,s){e&&(t===H.SESSION_STATES.STOPPED?(0,l.openSessionsTab)(e,N.CAPTURE_REQUEST_POST_SESSION_PAGE_IDENTIFIER,{proxySessionId:e},s):(0,l.openSessionsTab)(e,N.CAPTURE_REQUESTS_SESSIONS_CONFIGURE_PAGE_IDENTIFIER,{proxyId:H.CONFIGURE_PAGE_ID},s))}async handleLoadCollectionRun(e,t=!1){if(!e)return;const{uid:s,source:o,context:i}=(0,b.resolveStoreInstance)(S.default).find(e)||{},r=(0,b.resolveStoreInstance)(O.default),n=await(0,D.getParentAPIContext)(null==i?void 0:i.collection).catch((e=>{pm.logger.warn("HistorySidebarContainer~handleLoadCollectionRun: Error while fetching parent api context",e)}));(null==n?void 0:n.id)&&await(0,x.hasAPIMigrated)(null==n?void 0:n.id)?(0,P.openRunInTab)(s,{newTab:t,preview:!t},n):(0,P.openRunInTab)(s,{newTab:t,preview:!t},{}),_.default.addEventV2({category:"history_sidebar",action:"open_run_details_view",label:o,userId:r.id,teamId:r.teamId,entityId:s})}handleLoadWebSocketHistory(e,t=!1){e&&(0,A.openWebSocketHistoryTab)(e,{forceNew:t,preview:!t})}handleLoadECHistory(e,t,s=!1){if(!e)return;const o=pm.ECItemRegistry.getSDK(t);o&&o.openHistoryTab(e,{forceNew:s,preview:!s})}handleItemSelect({id:e,type:t,itemType:s},o={},i={}){const r=B.includes(navigator.platform,"Mac");o.shiftKey&&(r?o.metaKey:o.ctrlKey)?("collectionrun"===t?this.handleLoadCollectionRunDebounced(e,!0):"websockethistory"===t?this.handleLoadWebSocketHistoryDebounced(e,!0):"ecitemhistory"===t?this.handleLoadECHistoryDebounced(e,s,!0):this.handleLoadRequestDebounced(e,!0),pm.mediator.trigger("focusSidebar")):o.ctrlKey||o.metaKey?this.store.isItemSelected(e)?this.store.unselectItem(e):this.store.selectItem(e):("collectionrun"===t?this.handleLoadCollectionRunDebounced(e,!1):"websockethistory"===t?this.handleLoadWebSocketHistoryDebounced(e,!1):"ecitemhistory"===t?this.handleLoadECHistoryDebounced(e,s,!1):"proxyhistory"===t?this.handleLoadProxyInterceptorSessionDebounced(e,s,i):this.handleLoadRequestDebounced(e,!1),pm.mediator.trigger("focusSidebar"),this.store.resetSelection([e]))}handleAddToCollection(e={}){const{requests:t}=e,s=B.isEmpty(t)?this.store.getSelectedItems():t;B.isEmpty(s)||(0,T.convertHistoryToRequests)(s,{populateIfPartial:!0}).then((t=>{1===B.size(t)?t[0]&&pm.mediator.trigger("showAddToCollectionModal",t[0],{from:e.from}):pm.mediator.trigger("addRequestsToCollection",t,e)}))}handleToggleHistoryResponseSaving(){if(!(0,M.isWorkspaceMember)())return(0,M.canJoinWorkspace)()?pm.mediator.trigger("openUnjoinedWorkspaceModal"):(0,M.isLoggedIn)()?pm.toasts.error("You do not have permissions required to perform the action."):pm.mediator.trigger("showSignInModal",{type:"history",origin:"history_save_response"});const e=(0,b.resolveStoreInstance)(y.default),t={enableHistoryResponseSaving:!(e&&e.enableHistoryResponseSaving)};return e.updateSettings(t)}resetHistorySelection(e){e&&e.id?this.store.resetSelection([e.id]):this.store.resetSelection()}handleDeleteMultiple(e,t){const s=(0,b.resolveStoreInstance)(S.default),o=(0,b.resolveStoreInstance)(m.default),i=o&&o.permissions,r=B.get(i,R.WORKSPACE_PERMISSIONS.REMOVE_HISTORY_FROM_WORKSPACE,!0);return(0,M.isWorkspaceMember)()?(0,b.resolveStoreInstance)(p.default).userCanSave?Promise.resolve().then((()=>{if("all"===e){const e=(0,b.resolveStoreInstance)(u.default).id;(0,v.default)((0,f.createEvent)("deleteAllInWorkspace","history",e)),s.deleteRun(B.map(s.values,(e=>e.id))),I.default.deleteAllHistory(e),(0,A.deleteAllWebSocketHistory)(),j.default.deleteProxyHistory()}else if("selected"===e){r?(0,v.default)((0,f.createEvent)("deleteMultiple","history",{ids:this.store.getSelectedItems()},null,null)):pm.toasts.error("You do not have permissions to delete history."),r?(0,b.resolveStoreInstance)(S.default).deleteRun(this.store.getSelectedItems()):pm.toasts.error("You do not have permissions to delete collection runs.");const e=(0,b.resolveStoreInstance)(u.default).id,t=this.store.getSelectedItems(),s=new Set,o=new Set;B.forEach(this.store.historyItems,(e=>{"ecitemhistory"===(null==e?void 0:e.type)&&s.add(e.id),"websockethistory"===(null==e?void 0:e.type)&&o.add(e.id)}));const i=B.filter(t,(e=>s.has(e))),n=B.filter(t,(e=>o.has(e)));I.default.deleteManyHistory(e,i),(0,A.deleteOneOrManyWebSocketHistory)(n),j.default.deleteProxyHistory(this.store.getSelectedItems())}})).then((()=>{this.resetHistorySelection(t)})).catch((()=>{this.resetHistorySelection(t)})):(0,L.showOfflineActionDisabledToast)():(0,M.canJoinWorkspace)()?pm.mediator.trigger("openUnjoinedWorkspaceModal"):(0,M.isLoggedIn)()?pm.toasts.error("You do not have permissions required to perform the action."):pm.mediator.trigger("showSignInModal",{type:"history",origin:"history_delete_multiple"})}handleAddRequestToService(e,t){const{requests:s,defaultCollectionName:o="",from:i=""}=e,r=B.isEmpty(s)?this.store.getSelectedItems():s;B.isEmpty(r)||(0,T.convertHistoryToRequests)(r,{populateIfPartial:e.populateIfPartial,populateResponse:e.populateResponse}).then((e=>{if(!B.isEmpty(e)){const s={name:o,from:i};C.default.create(t,{requests:e,opts:s},null,{from:"history_sidebar"})}}))}handleSelectHistoryAction(e,t){switch(e){case q.ACTION_TYPE_SAVE:if(!(0,b.resolveStoreInstance)(p.default).userCanSave)return(0,L.showOfflineActionDisabledToast)();this.handleAddToCollection(t);break;case q.ACTION_TYPE_MONITOR:this.handleAddRequestToService(t,"openCreateNewMonitorModal");break;case q.ACTION_TYPE_DOCUMENT:this.handleAddRequestToService(t,"openCreateNewDocumentationModal");break;case q.ACTION_TYPE_MOCK:this.handleAddRequestToService(B.assign(t,{populateIfPartial:!0,populateResponse:!0}),"openCreateNewMockModal");break;case q.ACTION_TYPE_DELETE:if(!(0,b.resolveStoreInstance)(p.default).userCanSave)return(0,L.showOfflineActionDisabledToast)();(0,v.default)((0,f.createEvent)("deleteMultiple","history",{ids:t.requests},null,null))}}handleSelectCollectionRunAction(e,t){switch(e){case q.ACTION_TYPE_DELETE:if(!(0,b.resolveStoreInstance)(p.default).userCanSave)return(0,L.showOfflineActionDisabledToast)();(0,b.resolveStoreInstance)(S.default).deleteRun(t.runs);break;case q.ACTION_TYPE_DOWNLOAD:return(0,W.exportRuns)(t.runs);default:pm.logger.warn(`HistorySidebarContainer~handleSelectCollectionRunAction: ${e} - action not handled`)}}handleSelectWebSocketHistoryAction(e,t){if(e===q.ACTION_TYPE_DELETE){if(!(0,b.resolveStoreInstance)(p.default).userCanSave)return(0,L.showOfflineActionDisabledToast)();(0,A.deleteOneOrManyWebSocketHistory)(t.websockethistory)}}handleSelectECHistoryAction(e,t){if(e===q.ACTION_TYPE_DELETE){if(!(0,b.resolveStoreInstance)(p.default).userCanSave)return(0,L.showOfflineActionDisabledToast)();I.default.deleteManyHistory((0,b.resolveStoreInstance)(u.default).id,t.ecitemhistory)}}async handleproxyHistoryAction(e,t){if(e===q.ACTION_TYPE_DELETE)try{await j.default.deleteProxyHistory(t.proxyhistory)}catch(e){pm.toasts.error("The proxy session is in progress")}}handleSelectAction(e,t,s){return(0,M.isWorkspaceMember)()?"collectionrun"===e?(1===B.size(s.runs)&&t===q.ACTION_TYPE_DELETE&&this.store.unselectItem(s.runs[0]),s.runs&&this.handleSelectCollectionRunAction(t,s)):"websockethistory"===e?(1===B.size(s.websockethistory)&&t===q.ACTION_TYPE_DELETE&&this.store.unselectItem(s.websockethistory[0]),s.websockethistory&&this.handleSelectWebSocketHistoryAction(t,s)):"ecitemhistory"===e?(1===B.size(s.ecitemhistory)&&t===q.ACTION_TYPE_DELETE&&this.store.unselectItem(s.ecitemhistory[0]),s.ecitemhistory&&this.handleSelectECHistoryAction(t,s)):"request"===e?(1===B.size(s.requests)&&t===q.ACTION_TYPE_DELETE&&this.store.unselectItem(s.requests[0]),this.handleSelectHistoryAction(t,s)):"proxyhistory"===e?(1===B.size(s.proxyhistory)&&t===q.ACTION_TYPE_DELETE&&this.store.unselectItem(s.proxyhistory[0]),s.proxyhistory&&this.handleproxyHistoryAction(t,s)):void("all"===e&&(s.runs&&this.handleSelectCollectionRunAction(t,s),s.requests&&this.handleSelectHistoryAction(t,s),s.websockethistory&&this.handleSelectWebSocketHistoryAction(t,s),s.ecitemhistory&&this.handleSelectECHistoryAction(t,s),s.proxyhistory&&this.handleproxyHistoryAction(t,s))):(0,M.canJoinWorkspace)()?pm.mediator.trigger("openUnjoinedWorkspaceModal"):(0,M.isLoggedIn)()?pm.toasts.error("You do not have permissions required to perform the action."):pm.mediator.trigger("showSignInModal",{type:"history",origin:`history_${t}`})}render(){const{isConsistentlyOffline:e}=(0,b.resolveStoreInstance)(h.default);if(e&&this.store.loading)return i.createElement(k.default,{origin:"sidebar",entity:"history"});const t=(0,b.resolveStoreInstance)(y.default),s=(0,b.resolveStoreInstance)(h.default),o=(0,b.resolveStoreInstance)(d.default),r=(0,b.resolveStoreInstance)(c.default),n=(0,b.resolveStoreInstance)(u.default),a=t&&t.enableHistoryResponseSaving,l=t&&t.isUpdating;return i.createElement(E.default,{store:this.store,enableHistoryResponseSaving:a,isHistorySettingUpdating:l,initializing:o.isHydrating||r.isHydrating||!n.id,isLoggedIn:o.isLoggedIn,isSocketConnected:s.isSocketConnected,workspace:n.id,onSelectAction:this.handleSelectAction,onDeleteMultiple:this.handleDeleteMultiple,onSelect:this.handleItemSelect,onSaveCurrentRequest:this.handleAddToCollection,onToggleHistoryResponseSaving:this.handleToggleHistoryResponseSaving,ref:"history"})}})||o)||o},"./runtime-repl/history/HistorySidebarController.js":function(e,t,s){s.r(t),s.d(t,{default:function(){return E}});var o=s("../../node_modules/mobx/lib/mobx.module.js"),i=s("./js/modules/services/PermissionRemoteFetchService.js"),r=s("./js/stores/StoreManager.js"),n=s("./js/stores/ActiveWorkspaceStore.js"),a=s("./runtime-repl/extensible-collection/history/datastores/ECItemHistoryStore.js"),l=s("./runtime-repl/request-websocket/history/datastores/WebSocketHistoryStore.js"),c=s("./runtime-repl/history/datastores/HistoryListStore.js"),d=s("./runtime-repl/history/datastores/HistorySidebarStore.js"),h=s("./js/stores/SyncStatusStore.js"),u=s("./runtime-repl/request-websocket/history/services/WebSocketHistoryService.js"),p=s("./runtime-repl/history/HistoryService.js"),m=s("./runtime-repl/extensible-collection/api/HistorySDK.ts"),y=s("./integrations/proxy/services/ProxyHistoryService.js"),S=s("./api-dev/interfaces/APIInterface.js"),b=s("./runtime-repl/history/datastores/controllers/HistoryResponseController.js"),g=s("./js/modules/sync-helpers/create-changeset.js"),f=s("./js/models/sync/services/SyncIncomingHandler.js"),v=s("./runtime-repl/runner/SyncService.js"),I=s("./node_modules/lodash/lodash.js");class E{async didCreate(){let e;this.store=(0,r.resolveStoreInstance)(d.default),this.store.setSearchQuery(""),(0,r.resolveStoreInstance)(h.default).onSyncAvailable({timeout:5e3}).then((()=>{e=(0,S.getAllAPIs)()})),this.wsHistoryStore=(0,r.resolveStoreInstance)(l.default),this.ecItemHistoryStore=(0,r.resolveStoreInstance)(a.default),this.httpHistoryStore=(0,r.resolveStoreInstance)(c.default),this.currentWorkspace=(0,r.resolveStoreInstance)(n.default).id;const t=await(0,i.fetchViewHistory)(this.currentWorkspace),s=(0,v.fetchMoreRunsInActiveWorkspace)();if(!t[this.currentWorkspace].allowed)return Promise.resolve();(0,r.resolveStoreInstance)(h.default).onSyncAvailable({timeout:5e3}).then((()=>p.default.subscribeToRealtimeEvents(this.currentWorkspace))).then((e=>{if(!e)return Promise.reject(new Error("Subscription not found"));this.httpSubscription=e,this.httpSubscription.subscribe((({data:e})=>{(0,o.transaction)((()=>{I.forEach(e,(e=>{if(!e)return;const{id:t,value:s,op:o}=e;let i;switch(o){case"create":i=(0,g.default)("history","create",{instance:I.merge(s,{id:t,workspace:this.currentWorkspace,isPartial:!0}),modelId:s.id,owner:s.owner}),(0,f.processIncomingChangeset)(i).catch((e=>{pm.logger.warn("HistorySidebarController~didCreate: Could not create history",e)}));case"delete":return this.httpHistoryStore.remove(t),b.default.delete({history:t});case"deleteAll":return this.httpHistoryStore.removeAll(),b.default.clear()}}))}))}))})).catch((e=>{pm.logger.error("HistorySidebarController~didCreate: Error in subscribing to HTTP history's realtime events",e)})),(0,r.resolveStoreInstance)(h.default).onSyncAvailable({timeout:5e3}).then((()=>u.default.subscribeToRealtimeEvents(this.currentWorkspace))).then((e=>{if(!e)return Promise.reject(new Error("Subscription not found"));this.subscription=e,this.subscription.subscribe((({data:e})=>{(0,o.transaction)((()=>{I.forEach(e,(e=>{if(!e)return;const{id:t,value:s,op:o}=e;switch(o){case"create":return this.wsHistoryStore.add(I.assign({id:t,workspace:this.currentWorkspace},s));case"delete":return this.wsHistoryStore.remove(t);case"deleteAll":return this.wsHistoryStore.removeAll()}}))}))}))})).catch((e=>{pm.logger.error("HistorySidebarController~didCreate: Error in subscribing to WebSocket history's realtime events",e)})),(0,r.resolveStoreInstance)(h.default).onSyncAvailable({timeout:5e3}).then((()=>m.default.subscribeToRealtimeEvents(this.currentWorkspace))).then((e=>{if(!e)return Promise.reject(new Error("Subscription not found"));this.ecHistorySubscription=e,this.ecHistorySubscription.subscribe((e=>{const{data:t}=e;(0,o.transaction)((()=>{I.forEach(t,(e=>{if(!e)return;const{id:t,value:s,op:o}=e;switch(o){case"HISTORY_CREATE":return this.ecItemHistoryStore.add(I.assign({id:t,workspace:this.currentWorkspace},s));case"HISTORY_DELETE":return this.ecItemHistoryStore.remove(t);case"HISTORY_DELETE_ALL":return this.ecItemHistoryStore.removeAll()}}))}))}))})).catch((e=>{pm.logger.error("HistorySidebarController~didCreate: Error in subscribing to Extensible Item's history realtime events",e)})),await y.default.subscribeSessionEvents(),await s(),await e.catch((e=>{pm.logger.error("HistorySidebarController~didCreate - Error while fetching API details",e)}))}async beforeDestroy(){this.store=null,this.wsHistoryStore=null,this.subscription&&u.default.unsubscribeFromRealtimeEvents(this.currentWorkspace).catch((e=>pm.logger.error("WebSocketWorkbenchController~beforeDestroy: Error in unsubscribing from WebSocket history's realtime events",e))),this.httpSubscription&&p.default.unsubscribeFromRealtimeEvents(this.currentWorkspace).catch((e=>pm.logger.error("HTTPWorkbenchController~beforeDestroy: Error in unsubscribing from HTTP history's realtime events",e))),this.subscription=null,this.httpSubscription=null,this.currentWorkspace=null,await y.default.unsubscribeSessionEvents()}}},"./runtime-repl/history/HistorySidebarErrorState.js":function(e,t,s){s.r(t),s.d(t,{default:function(){return r}});var o=s("../../node_modules/react/index.js"),i=s("./js/components/base/Buttons.js");function r(e){return o.createElement("div",{className:"history-sidebar-list-error"},o.createElement("h4",null,"Couldn't load history"),o.createElement("p",null,"Something went wrong while trying to load history items. Check your internet and try again."),o.createElement(i.Button,{type:"secondary",onClick:e.onRetry},"Retry"))}},"./runtime-repl/history/HistorySidebarList.js":function(e,t,s){s.r(t),s.d(t,{default:function(){return D}});var o,i=s("../../node_modules/react/index.js"),r=s("../../node_modules/mobx-react/dist/mobx-react.module.js"),n=s("./node_modules/react-window/dist/index.esm.js"),a=s("./node_modules/react-virtualized-auto-sizer/dist/index.esm.js"),l=s("../../node_modules/@postman/aether/esmLib/src/components/Spinner/Spinner.js"),c=s("../../node_modules/@postman/aether/esmLib/src/components/Illustration/illustrations/NoPermission.js"),d=s("../../node_modules/@postman/aether-icons/esmLib/src/Icon/Icon.js"),h=s("../../node_modules/@postman/aether-icons/esmLib/src/design-system-icons/icon-state-locked-stroke.js"),u=s("./js/components/base/Buttons.js"),p=s("./js/utils/PluralizeHelper.js"),m=s("./runtime-repl/request-websocket/history/sidebar/components/WebSocketHistorySidebarListItem.js"),y=s("./runtime-repl/extensible-collection/history/components/ECHistorySidebarListItem.js"),S=s("./js/stores/ui/sidebar/RequesterSidebarStore.js"),b=s("./js/stores/StoreManager.js"),g=s("./runtime-repl/history/datastores/HistorySidebarStore.js"),f=s("./js/stores/CurrentUserStore.js"),v=s("./runtime-repl/history/HistorySidebarListEmptyItem.js"),I=s("./appsdk/sidebar/SidebarEmptyState/SidebarEmptyState.js"),E=s("./runtime-repl/history/HistoryListItem.js"),w=s("./runtime-repl/history/HistoryInfoHeader.js"),T=s("./runtime-repl/history/HistoryListMetaItem.js"),C=s("./runtime-repl/history/HistoryListErrorItem.js"),_=s("./runtime-repl/history/HistoryListCollectionRunItem.js"),O=s("./runtime-repl/history/HistorySidebarErrorState.js"),A=s("./appsdk/sidebar/SidebarLoadingState/SidebarLoadingState.js"),j=s("./integrations/proxy/components/ProxyHistorySidebarListItem.js"),R=s("./node_modules/lodash/lodash.js");function k(){return k=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&(e[o]=s[o])}return e},k.apply(this,arguments)}let D=(0,r.observer)(o=class extends i.Component{constructor(e){super(e),this.store=(0,b.resolveStoreInstance)(g.default),this.requesterSidebarStore=(0,b.resolveStoreInstance)(S.default),this.handleToggleGroup=this.handleToggleGroup.bind(this),this.getListItem=this.getListItem.bind(this),this.getItemSize=this.getItemSize.bind(this),this.handleClearCachedHeight=this.handleClearCachedHeight.bind(this),this.observeSizeChange=this.observeSizeChange.bind(this),this.unobserveSizeChange=this.unobserveSizeChange.bind(this),this.handleItemsRender=this.handleItemsRender.bind(this),this.handleItemsRenderDebounced=R.debounce(this.handleItemsRender,1e3),this.handleListScroll=this.handleListScroll.bind(this),this.handleListScrollDebounced=R.debounce(this.handleListScroll,300),this.handleJumpToTop=this.handleJumpToTop.bind(this),this.handleRefresh=this.handleRefresh.bind(this),this.isFromMultiSelectedItems=this.isFromMultiSelectedItems.bind(this),this.isMultipleItemsSelected=this.isMultipleItemsSelected.bind(this),this.heightSet={},this.resizeObserver=new ResizeObserver((e=>{for(const t of e){if(!(t&&t.target&&t.target.dataset))return;const{index:e}=t.target.dataset;this.heightSet[e]=t.target.offsetHeight}this.handleClearCachedHeight(0)}))}componentDidMount(){this.props.initializing||this.store.load()}componentDidUpdate(e){this.props.initializing||(e.initializing?this.store.load():(this.props.workspace!==e.workspace||this.props.isLoggedIn&&!e.isLoggedIn)&&(this.store.load(),this.listRef&&this.listRef.scrollTo(0),this.store.setScrollOffset(0)))}observeSizeChange(e){this.resizeObserver&&this.resizeObserver.observe(e)}unobserveSizeChange(e,t){this.resizeObserver&&this.resizeObserver.unobserve(e),delete this.heightSet[t]}handleClearCachedHeight(e){this.listRef.resetAfterIndex(e)}handleToggleGroup(e){if(this.store.isItemCollapsed(e))return this.store.expandItem(e);this.store.collapseItem(e)}getItemSize(e){const t=R.get(this.store,["historyItems",e]);return"meta"===t.type||"error"===t.type?28:this.heightSet[e]||28}isMultipleItemsSelected(){return R.size(this.store.getSelectedItems())>1}isFromMultiSelectedItems(e){return!!this.isMultipleItemsSelected()&&!!this.store.isItemSelected(e)}getListItem(e){const t=R.get(this.store,["historyItems",e.index]);return t?"loading"===t.type?i.createElement("div",{className:"history-list__loading",style:e.style,key:t.key},i.createElement(l.default,null)):"error"===t.type?i.createElement("div",{className:"history-list__error",style:e.style},i.createElement(C.default,{key:t.name,onRetry:()=>"load-error"===t.key?this.store.load(!0):"load-more-error"===t.key?this.store.loadMore():void 0})):"meta"===t.type?i.createElement("div",{className:"history-list__meta",style:e.style},i.createElement(T.default,{name:t.name,key:t.name,onSelect:this.props.onSelect,onSelectAction:this.props.onSelectAction.bind(this,"all"),items:t.items,disableRequestSpecificActions:t.disableRequestSpecificActions})):"collectionrun"===t.type?i.createElement("div",{className:"history-list__collection-run",style:e.style},i.createElement(_.default,k({},t,{name:t.name,hideActions:R.size(this.store.getSelectedItems())>1,key:t.id,selected:this.store.isItemSelected(t.id),onSelect:this.props.onSelect,onSelectAction:this.props.onSelectAction.bind(this,"collectionrun"),observeSizeChange:this.observeSizeChange,unobserveSizeChange:this.unobserveSizeChange,index:e.index}))):"websockethistory"===t.type?i.createElement("div",{className:"history-list__websocket",style:e.style},i.createElement(m.default,k({},t,{key:t.id,isSelected:this.store.isItemSelected(t.id),onSelect:this.props.onSelect,onSelectAction:this.props.onSelectAction.bind(this,"websockethistory"),observeSizeChange:this.observeSizeChange,unobserveSizeChange:this.unobserveSizeChange,index:e.index}))):"ecitemhistory"===t.type?i.createElement("div",{className:"history-list__extensibleitem",style:e.style},i.createElement(y.default,k({},t,{key:t.id,isSelected:this.store.isItemSelected(t.id),onSelect:this.props.onSelect,onSelectAction:this.props.onSelectAction.bind(this,t.type),observeSizeChange:this.observeSizeChange,unobserveSizeChange:this.unobserveSizeChange,index:e.index}))):"proxyhistory"===t.type?i.createElement("div",{className:"history-list__proxy",style:e.style},i.createElement(j.default,{name:t.name,source:t.source,owner:t.owner,id:t.id,createdAt:t.createdAt,state:t.state,key:t.id,selected:this.store.isItemSelected(t.id),hideActions:this.isFromMultiSelectedItems(t.id),onSelect:this.props.onSelect,onSelectAction:this.props.onSelectAction.bind(this,"proxyhistory"),observeSizeChange:this.observeSizeChange,unobserveSizeChange:this.unobserveSizeChange,index:e.index})):i.createElement("div",{className:"history-list__item",style:e.style},i.createElement(E.default,k({},t,{hideActions:this.isFromMultiSelectedItems(t.id),key:t.id,selected:this.store.isItemSelected(t.id),onSelect:this.props.onSelect,onSelectAction:this.props.onSelectAction.bind(this,"request"),observeSizeChange:this.observeSizeChange,unobserveSizeChange:this.unobserveSizeChange,viewLargeBody:this.props.viewLargeBody,index:e.index}))):null}getNotification(){return this.store.showReloadNotification?i.createElement("div",{className:"history-sidebar-list__notification"},i.createElement(u.Button,{type:"primary",size:"small",className:"history-sidebar-list__refresh",onClick:this.handleRefresh},i.createElement(d.default,{name:"icon-action-refresh-stroke",color:"content-color-primary",size:"small",className:"pm-icon"}),"Refresh")):this.store.newHistoryIds.size?i.createElement("div",{className:"history-sidebar-list__notification"},i.createElement(u.Button,{type:"primary",size:"small",className:"history-sidebar-list__more-on-top",onClick:this.handleJumpToTop},i.createElement(d.default,{name:"icon-direction-up",color:"content-color-primary",size:"small",className:"pm-icon"}),i.createElement("span",null,this.store.newHistoryIds.size," ","new"," ",p.default.pluralize({count:this.store.newHistoryIds.size,singular:"item",plural:"items"})))):null}handleListScroll({scrollOffset:e}){0===e&&this.store.newHistoryIds.size&&this.store.showNewHistory(),this.store.setScrollOffset(e)}handleItemsRender(e){this.store.scrolledToEnd||this.store.loadingMore||this.requesterSidebarStore.query||e.overscanStopIndex===e.visibleStopIndex&&this.store.loadMore()}handleJumpToTop(){this.listRef&&this.listRef.scrollTo(0)}handleRefresh(){this.listRef&&this.listRef.scrollTo(0),this.store.load(!0)}render(){const e=(0,b.resolveStoreInstance)(f.default).isCurrentUserPartner,t=e=>i.createElement(r.Observer,null,this.getListItem.bind(this,e)),s=({height:e,width:s})=>i.createElement(r.Observer,null,(()=>i.createElement(n.VariableSizeList,{height:e,itemCount:this.store.historyItems.length,itemSize:this.getItemSize,width:s,ref:e=>{this.listRef=e},overscanCount:10,onItemsRendered:this.handleItemsRenderDebounced,onScroll:this.handleListScrollDebounced},t)));return R.isEmpty(this.store.historyItems)?this.props.initializing||this.store.loading?i.createElement("div",{className:"history-sidebar-list"},i.createElement(A.default,{hasHierarchy:!0})):this.store.loadError?"You don't have permission to view history in this workspace"===this.store.loadError.message?i.createElement("div",{className:"history-sidebar-list-permission-error"},i.createElement(I.default,{illustration:i.createElement(c.default,null),title:"You don't have permission to view history",message:"Only team members can view history of this workspace"})):i.createElement("div",{className:"history-sidebar-list"},i.createElement(O.default,{onRetry:()=>this.store.load(!0)})):i.createElement("div",{className:"history-sidebar-list"},i.createElement(v.default,{query:this.store.searchQuery})):i.createElement("div",{className:"history-sidebar-list",ref:"history"},e&&i.createElement(w.default,{icon:h.default,message:"The history below is only visible to you."}),this.getNotification(),i.createElement(a.default,null,s))}})||o},"./runtime-repl/history/HistorySidebarListEmptyItem.js":function(e,t,s){s.r(t),s.d(t,{default:function(){return h}});var o,i=s("../../node_modules/react/index.js"),r=s("../../node_modules/mobx-react/dist/mobx-react.module.js"),n=s("../../node_modules/@postman/aether/esmLib/src/components/Illustration/illustrations/NoHistory.js"),a=s("./js/constants/AppUrlConstants.js"),l=s("./js/external-navigation/ExternalNavigationService.js"),c=s("./appsdk/sidebar/SidebarEmptyState/SidebarEmptyState.js"),d=s("./appsdk/sidebar/SidebarNoResultsFound/SidebarNoResultsFound.js");let h=(0,r.observer)(o=class extends i.Component{constructor(e){super(e),this.handleShowMeHow=this.handleShowMeHow.bind(this)}handleShowMeHow(){(0,l.openExternalLink)(a.SEND_FIRST_REQUEST_DOCS,"_blank")}render(){return this.props.query?i.createElement(d.default,{searchQuery:this.props.query,illustration:i.createElement(n.default,null)}):i.createElement(c.default,{illustration:i.createElement(n.default,null),title:"You haven't sent any requests.",message:"Any request you send in this workspace will appear here.",action:{label:"Show me how",handler:this.handleShowMeHow}})}})||o},"./runtime-repl/history/HistorySidebarMenu.js":function(e,t,s){s.r(t),s.d(t,{default:function(){return O}});var o,i=s("../../node_modules/react/index.js"),r=s("./node_modules/classnames/index.js"),n=s.n(r),a=s("../../node_modules/mobx-react/dist/mobx-react.module.js"),l=s("../../node_modules/@postman/aether/esmLib/src/components/Text/Text.js"),c=s("../../node_modules/@postman/aether/esmLib/src/components/Spinner/Spinner.js"),d=s("../../node_modules/@postman/aether-icons/esmLib/src/Icon/Icon.js"),h=s("./js/components/base/Buttons.js"),u=s("./js/components/base/ToggleSwitch.js"),p=s("./js/components/base/Dropdowns.js"),m=s("./js/components/base/Tooltips.js"),y=s("./runtime-repl/_common/ToastHelpers.js"),S=s("./runtime-repl/history/HistoryActionsConstants.js"),b=s("./runtime-repl/runner/RunnerHelper.js"),g=s("./collaboration/workspace/model/ActiveWorkspacePermissionStore.ts"),f=s("./js/stores/StoreManager.js"),v=s("./js/stores/OnlineStatusStore.js"),I=s("./js/containers/apps/requester/sidebar/SidebarListActions.js"),E=s("./runtime-repl/_common/DisabledTooltipConstants.js"),w=s("./collaboration/workspace/types/PermissionTypes.ts"),T=s("./runtime-repl/history/HistoryActionsTooltipConstants.js"),C=s("./runtime-repl/history/HistoryItemActionsDropdown.js"),_=s("./node_modules/lodash/lodash.js");let O=(0,a.observer)(o=class extends i.Component{constructor(e){super(e),this.state={dropdownOpen:!1,showResponseToggleTooltip:!1,loading:!1},this.handleDeleteClick=this.handleDeleteClick.bind(this),this.handleDropdownToggle=this.handleDropdownToggle.bind(this),this.handleDropdownActionSelect=this.handleDropdownActionSelect.bind(this),this.handleAddToCollectionClick=this.handleAddToCollectionClick.bind(this),this.handleDeleteSelected=this.handleDeleteSelected.bind(this),this.handleSearchChange=this.handleSearchChange.bind(this),this.handleActionsDropdownSelect=this.handleActionsDropdownSelect.bind(this),this.handleSaveResponseToggle=this.handleSaveResponseToggle.bind(this),this.showResponseToggleTooltip=this.showResponseToggleTooltip.bind(this),this.hideResponseToggleTooltip=this.hideResponseToggleTooltip.bind(this),this.disableRequestItemOptions=this.disableRequestItemOptions.bind(this)}handleAddToCollectionClick(e){e.stopPropagation(),this.props.onSelectAction(S.ACTION_TYPE_SAVE,{requests:this.props.historySidebar.getSelectedItems(),from:"history_multiple"})}handleDeleteClick(){pm.mediator.trigger("showDeleteHistoryModal",(async()=>{try{this.props.onDeleteMultiple&&await this.props.onDeleteMultiple("all")}catch(e){pm.logger.error("Could not delete history",e),pm.toasts.error("Could not delete history")}}),{identifier:"all"})}handleDropdownToggle(e){e!==this.state.dropdownOpen&&this.setState({dropdownOpen:e})}handleDropdownActionSelect(e){return e===S.ACTION_TYPE_DELETE?(0,f.resolveStoreInstance)(v.default).userCanSave?void pm.mediator.trigger("showDeleteHistoryModal",(()=>{this.props.onDeleteMultiple("selected")}),{identifier:"selected"}):(0,y.showOfflineActionDisabledToast)():e===S.ACTION_TYPE_DOWNLOAD?(this.setState({loading:!0}),void(0,b.exportRuns)(this.props.historySidebar.getSelectedItems()).finally((()=>{this.setState({loading:!1})}))):void this.props.onSelectAction(e,{requests:this.props.historySidebar.getSelectedItems(),from:"history_multiple"})}handleActionsDropdownSelect(e){if("history-sidebar--clear-all"===e)this.handleDeleteClick()}handleDeleteSelected(){this.handleDropdownActionSelect(S.ACTION_TYPE_DELETE)}disableRequestItemOptions(){const e=_.filter(this.props.historySidebar.historyItems,(e=>this.props.historySidebar.selectedItems.has(e.id)&&"request"===e.type));return _.isEmpty(e)}showResponseToggleTooltip(){this.setState({showResponseToggleTooltip:!0})}hideResponseToggleTooltip(){this.setState({showResponseToggleTooltip:!1})}handleSaveResponseToggle(e){e&&e.stopPropagation(),this.props.onToggleHistoryResponseSaving&&this.props.onToggleHistoryResponseSaving()}handleSearchChange(e){this.props.historySidebar.setSearchQuery(e)}getToggleSaveResponseClasses(e){return n()({"dropdown-menu-item history-sidebar-menu__actions-save-response-toggle":!0,"is-disabled":e})}getDeleteHistoryTooltip(e,t){return e?t?T.ACTION_TYPE_DELETE_REQUESTS_TOOLTIP:E.DISABLED_TOOLTIP_NO_PERMISSION:E.DISABLED_TOOLTIP_IS_OFFLINE}render(){const e=this.props.historySidebar.selectedItems.size,{userCanSave:t}=(0,f.resolveStoreInstance)(v.default),s=(0,f.resolveStoreInstance)(g.default),o=s&&s.permissions,r=_.get(o,w.WORKSPACE_PERMISSIONS.REMOVE_HISTORY_FROM_WORKSPACE,!0),n=!t||!r,a=!_.get(o,w.WORKSPACE_PERMISSIONS.UPDATE_WORKSPACE_META,!0);return e>1?i.createElement("div",{className:"history-sidebar-menu multiple-request-selected"},i.createElement("div",{className:"history-sidebar-menu__left"},i.createElement(l.default,{type:"body-small",color:"content-color-primary"},e," ","items selected")),i.createElement("div",{className:"history-sidebar-menu__right"},i.createElement("div",{className:"history-sidebar-menu__actions-delete-history-wrapper"},i.createElement(h.Button,{disabled:!t||!r,className:"history-sidebar-list-item__button__delete",type:"icon",onClick:this.handleDeleteSelected,tooltip:this.getDeleteHistoryTooltip(t,r)},i.createElement(d.default,{name:"icon-action-delete-stroke",size:"large",className:"history-sidebar-list-item__actions__delete pm-icon pm-icon-normal"})),this.state.loading?i.createElement("div",{className:"history-sidebar-menu__actions-spinner-wrapper"},i.createElement(c.default,null)):i.createElement(C.default,{count:e,onSelect:this.handleDropdownActionSelect,onToggle:this.handleDropdownToggle,disableRequestSpecificActions:this.disableRequestItemOptions()})))):i.createElement("div",{className:"history-sidebar-menu"},i.createElement(I.default,{className:"history-sidebar__filter",onSearch:this.handleSearchChange,onActionsDropdownSelect:this.handleActionsDropdownSelect,searchQuery:this.props.historySidebar.searchQuery,moreActions:i.createElement(p.DropdownMenu,{className:"history-sidebar__header-actions-dropdown--menu"},!_.isEmpty(this.props.historySidebar.historyItems)&&i.createElement(p.MenuItem,{className:"history-sidebar__header-actions-dropdown--menu-item history-sidebar-menu__actions-delete-history-wrapper",key:"history-sidebar--clear-all",refKey:"history-sidebar--clear-all",disabled:n,disabledText:t?E.DISABLED_TOOLTIP_NO_PERMISSION:"You need to be online to clear history."},i.createElement("span",null,"Clear all")),i.createElement("div",{className:this.getToggleSaveResponseClasses(a||this.props.isHistorySettingUpdating),onClick:a?void 0:this.handleSaveResponseToggle,ref:e=>{this.saveResponseToggleContainerRef=e},onMouseEnter:this.showResponseToggleTooltip,onMouseLeave:this.hideResponseToggleTooltip},this.props.isHistorySettingUpdating?this.props.enableHistoryResponseSaving?"Disabling...":"Enabling...":"Save Responses",i.createElement(u.default,{isActive:this.props.enableHistoryResponseSaving,activeLabel:"",inactiveLabel:"",disabled:a||this.props.isHistorySettingUpdating}),i.createElement(m.Tooltip,{className:"history-sidebar-menu--save-response__tooltip",show:this.state.showResponseToggleTooltip,target:this.saveResponseToggleContainerRef},i.createElement(m.TooltipBody,null,a?"You dont have permission to take this action.":"When turned off, the response headers and body won't be saved, though the response code, time, size, and language will be saved for reporting purposes."))))}))}})||o},"./runtime-repl/history/datastores/HistorySidebarStore.js":function(e,t,s){s.r(t),s.d(t,{default:function(){return X}});var o,i,r,n,a,l,c,d,h,u,p,m,y,S,b,g,f,v,I,E,w,T,C=s("../../node_modules/mobx/lib/mobx.module.js"),_=s("./node_modules/moment/moment.js"),O=s.n(_),A=s("./runtime-repl/request-websocket/history/services/WebSocketHistoryService.js"),j=s("./runtime-repl/extensible-collection/api/HistorySDK.ts"),R=s("./integrations/proxy/services/ProxyHistoryService.js"),k=s("./js/modules/services/SyncRemoteFetcherService.js"),D=s("./js/modules/pipelines/user-action.js"),x=s("./js/modules/model-event.js"),N=s("./js/modules/services/PermissionRemoteFetchService.js"),H=s("./js/constants/WorkspaceVisibilityConstants.js"),P=s("./js/stores/ListCacheStore.js"),L=s("./js/stores/CurrentUserStore.js"),M=s("./js/stores/SyncStatusStore.js"),q=s("./runtime-repl/runner/RunnerRun/RunnerRunStore.js"),W=s("./js/stores/ActiveWorkspaceStore.js"),B=s("./runtime-repl/extensible-collection/history/datastores/ECItemHistoryStore.js"),z=s("./runtime-repl/request-websocket/history/datastores/WebSocketHistoryStore.js"),F=s("./integrations/proxy/stores/HistorySidebarProxyStore.js"),U=s("./js/stores/StoreManager.js"),V=s("./runtime-repl/history/datastores/HistoryListStore.js"),Y=s("./integrations/proxy/helpers/constants.ts"),K=s("./node_modules/lodash/lodash.js");function Q(e,t,s,o){s&&Object.defineProperty(e,t,{enumerable:s.enumerable,configurable:s.configurable,writable:s.writable,value:s.initializer?s.initializer.call(o):void 0})}function $(e,t,s,o,i){var r={};return Object.keys(o).forEach((function(e){r[e]=o[e]})),r.enumerable=!!r.enumerable,r.configurable=!!r.configurable,("value"in r||r.initializer)&&(r.writable=!0),r=s.slice().reverse().reduce((function(s,o){return o(e,t,s)||s}),r),i&&void 0!==r.initializer&&(r.value=r.initializer?r.initializer.call(i):void 0,r.initializer=void 0),void 0===r.initializer&&(Object.defineProperty(e,t,r),r=null),r}const G=50;let X=(o=C.action.bound,i=C.action.bound,r=C.action.bound,n=C.action.bound,a=C.action.bound,l=C.action.bound,c=C.action.bound,d=C.action.bound,u=$((h=class{getModelEventListeners(){if(this.modelEvents)return this.modelEvents.namespace?K.assign({[this.modelEvents.namespace]:this.defaultEventListeners},this.modelEvents.customEventListeners):void 0}constructor(){this.defaultEventListeners={},this.modelEvents={namespace:"history",customEventListeners:{history:{created:e=>{this.addHistory(e.id,e.workspace)}}}},Q(this,"selectedItems",u,this),Q(this,"pageCount",p,this),Q(this,"collapsedItems",m,this),Q(this,"visibleHistoryIds",y,this),Q(this,"newHistoryIds",S,this),Q(this,"loading",b,this),Q(this,"loadingMore",g,this),Q(this,"loadError",f,this),Q(this,"loadMoreError",v,this),Q(this,"lowestCursor",I,this),Q(this,"scrolledToEnd",E,this),Q(this,"showReloadNotification",w,this),Q(this,"searchQuery",T,this),this.historyStore=(0,U.resolveStoreInstance)(V.default),this.websocketHistoryStore=(0,U.resolveStoreInstance)(z.default),this.ecItemHistoryStore=(0,U.resolveStoreInstance)(B.default),this.activeWorkspaceStore=(0,U.resolveStoreInstance)(W.default),this.collectionRunStore=(0,U.resolveStoreInstance)(q.default),this.syncStatusStore=(0,U.resolveStoreInstance)(M.default),this.currentUserStore=(0,U.resolveStoreInstance)(L.default),this.listCacheStore=(0,U.resolveStoreInstance)(P.default),this.proxyHistoryStore=(0,U.resolveStoreInstance)(F.default),(0,C.reaction)((()=>this.syncStatusStore.isSocketConnected),(e=>{if(e&&!this.loading&&!this.loadError){const e=K.get(this.historyItems,[0,"items",0]);if(!e)return;const t=this.historyStore.find(e)||{};t.cursor&&t.workspace&&this.fetchHistoryFromServer({sinceId:t.cursor,workspace:t.workspace,count:20}).then((e=>!K.isEmpty(e)&&this.setValue("showReloadNotification",!0))).catch((()=>this.setValue("showReloadNotification",!0)))}})),(0,C.reaction)((()=>this.activeWorkspaceStore.visibilityStatus),(()=>{this.load(!0)})),this.loadedWorkspace=null,this.scrollOffset=0}get historyListCache(){return this.listCacheStore.find(`workspace:${this.activeWorkspaceStore.id}:history`)}setSearchQuery(e){this.searchQuery=e}collapseItem(e){!this.collapsedItems.has(e)&&this.collapsedItems.set(e,!0)}expandItem(e){this.collapsedItems.has(e)&&this.collapsedItems.delete(e)}isItemCollapsed(e){return this.collapsedItems.has(e)}get historyItems(){const e=this.getDateGroups(this.truncatedByPageSize,"createdAt");return this.loadMoreError&&e.push({type:"error",name:"Load more error",key:"load-more-error"}),this.loading&&e.push({type:"loading",name:"Loading",key:"loading"}),this.loadError&&e.length&&e.unshift({type:"error",name:"Load error",key:"load-error"}),e}get truncatedByPageSize(){return K.take(this.sortedByDateCreated,this.pageCount*G+K.size(this.websocketHistoryWithType)+K.size(this.ecHistoryWithType))}get sortedByDateCreated(){return K.orderBy(this.historyAndRuns,["createdAt"],["desc"])}get historyAndRuns(){return K.union(this.historyWithType,this.runsWithType,this.websocketHistoryWithType,this.ecHistoryWithType,this.proxyHistoryWithType)}get historyWithType(){return K.map(this.filteredBySearchQuery,(e=>(e.type="request",e)),[])}get filteredBySearchQuery(){if(!this.searchQuery.trim())return this.workspaceHistory;const e=this.searchQuery.toLowerCase();return K.filter(this.workspaceHistory,(t=>K.includes(t.url&&K.toLower(t.url),e)))}get workspaceHistory(){return this.historyStore.historyInActiveWorkspace.filter((e=>this.visibleHistoryIds.has(e.id)))}get runsWithType(){return K.map(this.runsFilteredBySearchQuery,(e=>(e.type="collectionrun",e)),[])}get runsFilteredBySearchQuery(){if(!this.searchQuery.trim())return this.collectionRunStore.collectionRunsInActiveWorkspace;const e=this.searchQuery.toLowerCase();return K.filter(this.collectionRunStore.collectionRunsInActiveWorkspace,(t=>K.includes(t.name&&K.toLower(t.name),e)))}get websocketHistoryWithType(){return K.map(this.websocketHistoryFilteredBySearchQuery,(e=>(e.type="websockethistory",e)),[])}get websocketHistoryFilteredBySearchQuery(){if(!this.searchQuery.trim())return this.websocketHistoryStore.websocketHistoryInActiveWorkspace;const e=this.searchQuery.toLowerCase();return K.filter(this.websocketHistoryStore.websocketHistoryInActiveWorkspace,(t=>K.includes(t.url&&K.toLower(t.url),e)))}get ecHistoryWithType(){return K.map(this.ecHistoryFilteredBySearchQuery,(e=>(e.type="ecitemhistory",e)),[])}get ecHistoryFilteredBySearchQuery(){if(!this.searchQuery.trim())return this.ecItemHistoryStore.ecHistoryInActiveWorkspace;const e=this.searchQuery.toLowerCase();return K.filter(this.ecItemHistoryStore.ecHistoryInActiveWorkspace,(t=>K.includes(t.url&&K.toLower(t.url),e)))}get proxyHistoryWithType(){return K.map(this.proxyFilteredBySearchQuery,(e=>(e.type="proxyhistory",e)),[])}get proxyFilteredBySearchQuery(){if(!this.searchQuery.trim())return this.proxyHistoryStore.ProxyHistoryInActiveWorkspace;const e=K.toLower(this.searchQuery);return K.filter(this.proxyHistoryStore.ProxyHistoryInActiveWorkspace,(t=>K.includes(K.toLower(t.name),e)))}getVisibleItems(){return K.reduce(this.historyItems,((e,t)=>("meta"!==t.type&&e.push({id:t.id,type:t.type}),e)),[])}selectItem(e){this.selectedItems.has(e)||this.selectedItems.set(e,!0)}unselectItem(e){this.selectedItems.has(e)&&this.selectedItems.delete(e)}resetSelection(e){this.selectedItems.clear(),!e||e instanceof Array?K.forEach(e,(e=>{this.selectItem(e)})):pm.logger.warn("resetSelection needs an Array of history ids.")}getNextItem(){const e=this.getVisibleItems(),t=K.last(this.getSelectedItems()),s=K.findIndex(e,(({id:e})=>e===t));return s+1===K.size(e)?K.last(e):K.inRange(s+1,0,K.size(e))?e[s+1]:K.head(e)}getPrevItem(){const e=this.getVisibleItems(),t=K.last(this.getSelectedItems()),s=K.findIndex(e,(({id:e})=>e===t));return 0===s?K.head(e):K.inRange(s-1,0,K.size(e))?e[s-1]:K.last(e)}isItemSelected(e){return this.selectedItems.has(e)}itemExists(e){return this.historyStore.has(e)}getSelectedItems(){return(0,C.keys)(this.selectedItems)}getDateGroups(e,t,s="MMMM D"){const o=K.groupBy(e,(e=>K.isFunction(e[t])?[]:O()(e[t]).format("YYYY MM DD"))),i=K.map(o,((e,t)=>({name:t,items:e}))),r=K.sortBy(i,(e=>-O()(e.name,"YYYY MM DD").unix())),n=K.map(r,(e=>{const t=O()(e.name,"YYYY MM DD").calendar(null,{lastDay:"[Yesterday]",sameDay:"[Today]",nextDay:s,lastWeek:s,nextWeek:s,sameElse:s}),o={name:t,type:"meta",disableRequestSpecificActions:K.isEmpty(K.filter(e.items,(e=>"request"===e.type))),items:K.map(e.items,(e=>({id:e.id,type:e.type})))};if(this.collapsedItems.has(t))return[o];return[o,...K.map(e.items,(e=>(e.parent=t,e)))]}));return K.flatMap(n)}setValue(e,t){this[e]=t}setNewHistoryIds(e){this.newHistoryIds.set(e,!0)}setVisibleHistoryIds(e,t){t?this.visibleHistoryIds.replace(e.map((e=>[e,!0]))):this.visibleHistoryIds.merge(e.map((e=>[e,!0]))),this.visibleHistoryIds.size>G*this.pageCount&&(this.pageCount+=1)}addHistory(e,t){const s=t!==this.activeWorkspaceStore.id,o=this.visibleHistoryIds.has(e);s||o||(0!==this.scrollOffset?this.setNewHistoryIds(e):this.visibleHistoryIds.set(e,!0))}setScrollOffset(e){this.scrollOffset!==e&&(this.scrollOffset=e)}showNewHistory(){const e=[];this.newHistoryIds.forEach(((t,s)=>e.push(s))),this.setVisibleHistoryIds(e),this.pageCount*G<this.visibleHistoryIds.size&&this.setValue("pageCount",this.pageCount+1),this.newHistoryIds.clear()}load(e=!1){const t=this.activeWorkspaceStore.id;if(t){if(t!==this.loadedWorkspace&&(this.setValue("loading",!0),this.setValue("loadingMore",!1),this.setValue("loadError",null),this.setValue("loadMoreError",null),this.setValue("lowestCursor",null),this.setValue("pageCount",1),this.setValue("scrolledToEnd",!1),this.visibleHistoryIds.clear(),this.newHistoryIds.clear(),this.loadedWorkspace=t),!this.currentUserStore.isLoggedIn&&this.activeWorkspaceStore.visibilityStatus!==H.VISIBILITY.public)return this.setVisibleHistoryIds(K.map(this.historyStore.historyInActiveWorkspace,(e=>e.id))),this.setValue("loadError",null),void this.setValue("loading",!1);this.setValue("loadError",null),this.setValue("loading",!0),this.setValue("showReloadNotification",!1),this.syncStatusStore.onSyncAvailable({timeout:1e4}).then((()=>{(0,N.fetchViewHistory)(t).then((s=>s[t].allowed?Promise.allSettled([this.loadHTTPHistory(e),this.loadWSHistory(),this.loadECHistory(),this.loadProxyHistory()]):Promise.reject(new Error("You don't have permission to view history in this workspace")))).catch((e=>{this.setValue("loadError",e)})).finally((()=>{this.setValue("loading",!1)}))})).catch((()=>{this.setVisibleHistoryIds(this.historyStore.historyInActiveWorkspace.map((e=>e.id))),this.setValue("loadError",!0),this.setValue("loading",!1)}))}}loadHTTPHistory(e){const t=this.activeWorkspaceStore.id;return this.fetchHistoryFromServer({workspace:t}).then((s=>this.processServerResponse(s,t,e))).catch((e=>{this.setVisibleHistoryIds(K.map(this.historyStore.historyInActiveWorkspace,(e=>e.id)),!0),this.setValue("loadError",e)}))}loadWSHistory(){const e=this.activeWorkspaceStore.id;return A.default.fetchHistoryList({workspaceId:e}).then((({data:t})=>{(0,C.transaction)((()=>{K.forEach(t,(t=>(0,U.resolveStoreInstance)(z.default).createOrUpdate(K.assign(t,{workspace:e}))))}))})).catch((e=>{this.setValue("loadError",e)}))}loadECHistory(){const e=this.activeWorkspaceStore.id;return j.default.fetchHistoryList(e).then((({data:t})=>{(0,C.transaction)((()=>{K.forEach(t,(t=>{(0,U.resolveStoreInstance)(B.default).createOrUpdate(K.assign(t,{workspace:e}))}))}))})).catch((e=>{pm.logger.error(e),this.setValue("loadError",e)}))}loadProxyHistory(){const e=this.activeWorkspaceStore.id;return R.default.getProxyHistoryList({workspaceId:e}).then((e=>{(0,C.transaction)((()=>{K.forEach(e,(e=>{K.get(e,"state")===Y.SESSION_STATES.STOPPED&&this.proxyHistoryStore.add(e)}))}))})).catch((e=>{this.setValue("loadError",e)}))}loadMore(){if(this.setValue("loadingMore",!0),this.pageCount*G<this.visibleHistoryIds.size)return this.setValue("pageCount",this.pageCount+1),void this.setValue("loadingMore",!1);if(!(this.currentUserStore.isLoggedIn||this.activeWorkspaceStore.visibilityStatus===H.VISIBILITY.public)||!this.historyListCache||!this.lowestCursor)return void this.setValue("loadingMore",!1);const e=this.activeWorkspaceStore.id,t=this.historyListCache.getRange(this.lowestCursor-1);if(t){const e=this.historyStore.historyInActiveWorkspace.reduce(((e,s)=>(s.cursor<this.lowestCursor&&s.cursor>=t[1]&&e.push(s.id),e)),[]);if(this.setValue("lowestCursor",t[1]),e.length)return this.setVisibleHistoryIds(e),void this.setValue("loadingMore",!1)}this.syncStatusStore.isSocketConnected&&(this.setValue("loadMoreError",null),this.fetchHistoryFromServer({maxId:this.lowestCursor-1,workspace:e}).then((t=>this.processServerResponse(t,e))).catch((e=>{this.setValue("loadMoreError",e)})).finally((()=>{this.setValue("loadingMore",!1)})))}fetchHistoryFromServer({maxId:e,sinceId:t,meta:s=!0,workspace:o,count:i=50}){const r={};return t?r.since_cursor=t:e&&(r.max_cursor=e),k.default.remoteFetch("history","find",{meta:s,...r,workspace:o,count:i,format:"object"})}processServerResponse(e,t,s){if(!e)return;const o=(e||[]).map((e=>({...e.data,archived:K.get(e,"meta.archived",!1)})));if(!o.length)return void this.setValue("scrolledToEnd",!0);o.length<G&&this.setValue("scrolledToEnd",!0);const i=K.last(o),r=this.historyListCache&&this.historyListCache.getRange(i),n=o.map((e=>e.id));let a=i.cursor;return r&&(this.historyStore.historyInActiveWorkspace.forEach((e=>{e.cursor<i.cursor&&e.cursor>r[1]&&n.push(e.id)})),a=r[1]),this.setValue("lowestCursor",a),this.setVisibleHistoryIds(n,s),(0,D.default)((0,x.createEvent)("processHistoryRequestList","history",{workspace:t,requests:o,checkForExistence:!0}))}}).prototype,"selectedItems",[C.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return C.observable.map()}}),p=$(h.prototype,"pageCount",[C.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),m=$(h.prototype,"collapsedItems",[C.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return C.observable.map()}}),y=$(h.prototype,"visibleHistoryIds",[C.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return C.observable.map()}}),S=$(h.prototype,"newHistoryIds",[C.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return C.observable.map()}}),b=$(h.prototype,"loading",[C.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),g=$(h.prototype,"loadingMore",[C.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),f=$(h.prototype,"loadError",[C.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=$(h.prototype,"loadMoreError",[C.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=$(h.prototype,"lowestCursor",[C.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=$(h.prototype,"scrolledToEnd",[C.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),w=$(h.prototype,"showReloadNotification",[C.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),T=$(h.prototype,"searchQuery",[C.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),$(h.prototype,"historyListCache",[C.computed],Object.getOwnPropertyDescriptor(h.prototype,"historyListCache"),h.prototype),$(h.prototype,"setSearchQuery",[C.action],Object.getOwnPropertyDescriptor(h.prototype,"setSearchQuery"),h.prototype),$(h.prototype,"collapseItem",[C.action],Object.getOwnPropertyDescriptor(h.prototype,"collapseItem"),h.prototype),$(h.prototype,"expandItem",[C.action],Object.getOwnPropertyDescriptor(h.prototype,"expandItem"),h.prototype),$(h.prototype,"historyItems",[C.computed],Object.getOwnPropertyDescriptor(h.prototype,"historyItems"),h.prototype),$(h.prototype,"truncatedByPageSize",[C.computed],Object.getOwnPropertyDescriptor(h.prototype,"truncatedByPageSize"),h.prototype),$(h.prototype,"sortedByDateCreated",[C.computed],Object.getOwnPropertyDescriptor(h.prototype,"sortedByDateCreated"),h.prototype),$(h.prototype,"historyAndRuns",[C.computed],Object.getOwnPropertyDescriptor(h.prototype,"historyAndRuns"),h.prototype),$(h.prototype,"historyWithType",[C.computed],Object.getOwnPropertyDescriptor(h.prototype,"historyWithType"),h.prototype),$(h.prototype,"filteredBySearchQuery",[C.computed],Object.getOwnPropertyDescriptor(h.prototype,"filteredBySearchQuery"),h.prototype),$(h.prototype,"workspaceHistory",[C.computed],Object.getOwnPropertyDescriptor(h.prototype,"workspaceHistory"),h.prototype),$(h.prototype,"runsFilteredBySearchQuery",[C.computed],Object.getOwnPropertyDescriptor(h.prototype,"runsFilteredBySearchQuery"),h.prototype),$(h.prototype,"websocketHistoryFilteredBySearchQuery",[C.computed],Object.getOwnPropertyDescriptor(h.prototype,"websocketHistoryFilteredBySearchQuery"),h.prototype),$(h.prototype,"ecHistoryFilteredBySearchQuery",[C.computed],Object.getOwnPropertyDescriptor(h.prototype,"ecHistoryFilteredBySearchQuery"),h.prototype),$(h.prototype,"proxyFilteredBySearchQuery",[C.computed],Object.getOwnPropertyDescriptor(h.prototype,"proxyFilteredBySearchQuery"),h.prototype),$(h.prototype,"selectItem",[C.action],Object.getOwnPropertyDescriptor(h.prototype,"selectItem"),h.prototype),$(h.prototype,"unselectItem",[C.action],Object.getOwnPropertyDescriptor(h.prototype,"unselectItem"),h.prototype),$(h.prototype,"resetSelection",[C.action],Object.getOwnPropertyDescriptor(h.prototype,"resetSelection"),h.prototype),$(h.prototype,"setValue",[C.action],Object.getOwnPropertyDescriptor(h.prototype,"setValue"),h.prototype),$(h.prototype,"setNewHistoryIds",[C.action],Object.getOwnPropertyDescriptor(h.prototype,"setNewHistoryIds"),h.prototype),$(h.prototype,"setVisibleHistoryIds",[C.action],Object.getOwnPropertyDescriptor(h.prototype,"setVisibleHistoryIds"),h.prototype),$(h.prototype,"addHistory",[C.action],Object.getOwnPropertyDescriptor(h.prototype,"addHistory"),h.prototype),$(h.prototype,"setScrollOffset",[o],Object.getOwnPropertyDescriptor(h.prototype,"setScrollOffset"),h.prototype),$(h.prototype,"showNewHistory",[i],Object.getOwnPropertyDescriptor(h.prototype,"showNewHistory"),h.prototype),$(h.prototype,"load",[r],Object.getOwnPropertyDescriptor(h.prototype,"load"),h.prototype),$(h.prototype,"loadHTTPHistory",[n],Object.getOwnPropertyDescriptor(h.prototype,"loadHTTPHistory"),h.prototype),$(h.prototype,"loadWSHistory",[a],Object.getOwnPropertyDescriptor(h.prototype,"loadWSHistory"),h.prototype),$(h.prototype,"loadECHistory",[l],Object.getOwnPropertyDescriptor(h.prototype,"loadECHistory"),h.prototype),$(h.prototype,"loadProxyHistory",[c],Object.getOwnPropertyDescriptor(h.prototype,"loadProxyHistory"),h.prototype),$(h.prototype,"loadMore",[d],Object.getOwnPropertyDescriptor(h.prototype,"loadMore"),h.prototype),h)},"./runtime-repl/request-websocket/base/api/WebSocketRequestInterface.js":function(e,t,s){s.r(t),s.d(t,{deleteAllWebSocketHistory:function(){return u},deleteOneOrManyWebSocketHistory:function(){return h},openWebSocketHistoryTab:function(){return d}});var o=s("./js/services/NavigationService.js"),i=s("./js/stores/StoreManager.js"),r=s("./collaboration/workspace/model/ActiveWorkspaceBaseStore.ts"),n=s("./runtime-repl/request-websocket/history/datastores/WebSocketHistoryStore.js"),a=s("./runtime-repl/request-websocket/history/services/WebSocketHistoryService.js"),l=s("./runtime-repl/request-websocket/raw/configurations/RawWebSocketRequest.ts"),c=s("./node_modules/lodash/lodash.js");function d(e,t={preview:!0}){return o.default.transitionTo(l.default.openHistoryIdentifier,{echid:e},{},{tabOptions:{preview:t.preview,forceNew:t.forceNew}})}function h(e){var t;c.isString(e)&&(e=[e]),null!==(t=e)&&void 0!==t&&t.length&&a.default.deleteHistory((0,i.resolveStoreInstance)(r.default).id,e).then((()=>(0,i.resolveStoreInstance)(n.default).remove(e))).catch((e=>{pm.logger.error("WebSocketRequestInterface~deleteOneOrManyWebSocketHistory: Error in deleting websocket history",e)}))}function u(){var e;const t=(0,i.resolveStoreInstance)(n.default);null!==(e=t.websocketHistoryInActiveWorkspace)&&void 0!==e&&e.length&&a.default.deleteHistory((0,i.resolveStoreInstance)(r.default).id).then((()=>t.remove())).catch((e=>{pm.logger.error("WebSocketRequestInterface~deleteAllWebSocketHistory: Error in deleting all websocket history",e)}))}},"./runtime-repl/request-websocket/history/services/WebSocketHistoryService.js":function(e,t,s){s.r(t);var o=s("./node_modules/rxjs/_esm5/internal/operators/filter.js"),i=s("./js/modules/services/RemoteSyncRequestService.js"),r=s("./js/modules/sync-timeline-helpers/RealtimeSyncMessagesService.js"),n=s("./js/stores/StoreManager.js"),a=s("./js/stores/SyncStatusStore.js"),l=s("./node_modules/lodash/lodash.js");async function c(){return(0,n.resolveStoreInstance)(a.default).onSyncAvailable({timeout:5e3})}const d=200,h={async createHistory(e,t){await c();const s=await i.default.request("/ws/proxy",{method:"post",data:{service:"websocket",method:"post",path:`/workspaces/${e}/history`,body:t}});if(!s)throw new Error("WebSocketHistoryService~createHistory: Response not available");if(s.status!==d)throw new Error("WebSocketHistoryService~createHistory: Non 200 response status code",s.status);const o=l.get(s,"body.id");if(!o)throw new Error("WebSocketHistoryService~createHistory:History ID not received.");return{id:o}},async addMessagesToHistory(e,t,s){await c();const o=await i.default.request("/ws/proxy",{method:"post",data:{service:"websocket",method:"post",path:`/workspaces/${e}/history/${t}/messages`,body:s}});if(!o)throw new Error("WebSocketHistoryService~addMessagesToHistory: Response not available");if(o.status!==d)throw new Error("WebSocketHistoryService~addMessagesToHistory: Non 200 response status code")},async fetchHistoryList({workspaceId:e,nextCursor:t,limit:s=50,dir:o="desc"}){let r=`?dir=${o}`;t&&(r=`${r}&cursor=${t}`),s&&(r=`${r}&limit=${s}`),await c();const n=await i.default.request("/ws/proxy",{method:"post",data:{service:"websocket",method:"get",path:`/workspaces/${e}/history${r}`}});if(!n)throw new Error("WebSocketHistoryService~fetchHistoryList: Response not available");if(n.status!==d)throw new Error("WebSocketHistoryService~fetchHistoryList: Non 200 response status code",n.status);const{data:a,meta:h}=l.get(n,"body",{});if(!a||!h)throw new Error("WebSocketHistoryService~fetchHistoryList: Incorrect response structure.");return{data:a,meta:h}},async fetchHistoryMeta(e,t){await c();const s=await i.default.request("/ws/proxy",{method:"post",data:{service:"websocket",method:"get",path:`/workspaces/${e}/history/${t}`}});if(!s)throw new Error("WebSocketHistoryService~fetchHistoryMeta: Response not available");if(s.status!==d)throw new Error("WebSocketHistoryService~fetchHistoryMeta: Non 200 response status code",s.status);return s.body},async fetchHistoryMessages(e,t){await c();const s=await i.default.request("/ws/proxy",{method:"post",data:{service:"websocket",method:"get",path:`/workspaces/${e}/history/${t}/messages`}});if(!s)throw new Error("WebSocketHistoryService~fetchHistoryMessages: Response not available");if(s.status!==d)throw new Error("WebSocketHistoryService~fetchHistoryMessages: Non 200 response status code",s.status);const{messages:o}=l.get(s,"body",{});if(!o)throw new Error("WebSocketHistoryService~fetchHistoryMessages: Incorrect response structure.");return o},async deleteHistory(e,t){l.isString(t)&&(t=[t]),await c();const s=await i.default.request("/ws/proxy",{method:"post",data:{service:"websocket",method:"delete",path:`/workspaces/${e}/history`,body:{ids:t}}});if(!s)throw new Error("WebSocketHistoryService~deleteHistory: Response not available");if(s.status!==d)throw new Error("WebSocketHistoryService~deleteHistory: Non 200 response status code",s.status)},async subscribeToRealtimeEvents(e){await c();const t=await i.default.request("/ws/proxy",{method:"post",data:{service:"websocket",method:"post",path:`/workspaces/${e}/history/subscribe`}});if(!t)throw new Error("WebSocketHistoryService~subscribeToRealtimeEvents: Response not available");if(t.status!==d)throw new Error("WebSocketHistoryService~subscribeToRealtimeEvents: Non 200 response status code",t.status);const{subscription:s}=t.body||{};return(0,r.getRealtimeMessagesObservable)().pipe((0,o.filter)((e=>e&&e.sub===s)))},async unsubscribeFromRealtimeEvents(e){await c();const t=await i.default.request("/ws/proxy",{method:"post",data:{service:"websocket",method:"post",path:`/workspaces/${e}/history/unsubscribe`}});if(!t)throw new Error("WebSocketHistoryService~unsubscribeFromRealtimeEvents: Response not available");if(t.status!==d)throw new Error("WebSocketHistoryService~unsubscribeFromRealtimeEvents: Non 200 response status code",t.status)}};t.default=h},"./runtime-repl/request-websocket/history/sidebar/components/WebSocketHistorySidebarListItem.js":function(e,t,s){s.r(t),s.d(t,{default:function(){return C}});var o,i=s("../../node_modules/react/index.js"),r=s("../../node_modules/react-dom/index.js"),n=s("./node_modules/moment/moment.js"),a=s.n(n),l=s("./node_modules/classnames/index.js"),c=s.n(l),d=s("../../node_modules/@postman/aether/esmLib/src/components/Text/Text.js"),h=s("../../node_modules/@postman/aether/esmLib/src/components/Button/Button.js"),u=s("../../node_modules/@postman/aether-icons/esmLib/src/Icon/Icon.js"),p=s("../../node_modules/@postman/aether-icons/esmLib/src/design-system-icons/icon-entity-websocket-stroke.js"),m=s("../../node_modules/mobx-react/dist/mobx-react.module.js"),y=s("./js/components/base/Avatar.js"),S=s("./js/components/base/Tooltips.js"),b=s("./js/containers/apps/requester/sidebar/SidebarListItem.js"),g=s("./js/stores/OnlineStatusStore.js"),f=s("./js/stores/PermissionStore.js"),v=s("./runtime-repl/history/HistoryActionsConstants.js"),I=s("./runtime-repl/_common/DisabledTooltipConstants.js"),E=s("./js/stores/StoreManager.js"),w=s("./js/stores/CurrentUserStore.js"),T=s("./runtime-repl/request-websocket/raw/configurations/RawWebSocketRequest.ts");let C=(0,m.observer)(o=class extends i.Component{constructor(e){super(e),this.state={isTooltipVisible:!1},this.userAvatar=i.createRef(),this.handleSelect=this.handleSelect.bind(this),this.handleAction=this.handleAction.bind(this),this.handleDelete=this.handleDelete.bind(this),this.showTooltip=this.showTooltip.bind(this),this.hideTooltip=this.hideTooltip.bind(this),this.getLeftAlignedComponents=this.getLeftAlignedComponents.bind(this),this.getRightAlignedComponents=this.getRightAlignedComponents.bind(this)}componentDidMount(){this.selfNode=(0,r.findDOMNode)(this),this.props.observeSizeChange&&this.props.observeSizeChange(this.selfNode)}componentWillUpdate(e){if(!this.props.selected&&e.selected){const e=(0,r.findDOMNode)(this);e&&e.scrollIntoViewIfNeeded&&e.scrollIntoViewIfNeeded()}}componentWillUnmount(){this.props.unobserveSizeChange&&this.props.unobserveSizeChange(this.selfNode,this.props.index)}getClasses(){return c()({"history-sidebar-list-item":!0,"history-sidebar-list-item__websocket-history":!0,"is-selected":this.props.selected})}getTooltipText(e,t){return e?t?I.DISABLED_TOOLTIP_IS_OFFLINE:I.DISABLED_TOOLTIP_NO_PERMISSION:"Delete history"}getLeftAlignedComponents(e){var t;if(!e)return i.createElement("div",{className:"history-sidebar__indent"});const s=(0,E.resolveStoreInstance)(w.default),o=c()({"history-sidebar-list-item-updatedBy":!0,hovered:e}),r=s.isCurrentUserPartner?null===(t=s.partnerMembersByIds)||void 0===t?void 0:t[this.props.owner]:s.teamMembers.get(String(this.props.owner)),n=r&&(r.name||r.username);return i.createElement("div",{className:o,onMouseOver:this.showTooltip,onMouseLeave:this.hideTooltip},this.props.owner&&"0"!==this.props.owner?i.createElement(y.default,{ref:this.userAvatar,size:"small",userId:this.props.owner}):i.createElement(u.default,{name:"icon-descriptive-user-stroke",color:"content-color-secondary"}),this.userAvatar.current&&i.createElement(S.Tooltip,{immediate:!0,show:this.state.isTooltipVisible,target:this.userAvatar.current,placement:"right"},i.createElement(S.TooltipBody,null,i.createElement("div",{className:"history-sidebar-list-item-avatar-tooltip"},i.createElement(d.default,{type:"body-medium"},n),i.createElement(d.default,{type:"body-medium"},a()(this.props.createdAt).format("DD MMM YYYY, h:mm A"))))))}getRightAlignedComponents(e){const t=c()({"sidebar-list-item__right-section-actions":!0,hovered:e});if(!e)return null;const s=(0,E.resolveStoreInstance)(f.default),{userCanSave:o}=(0,E.resolveStoreInstance)(g.default),r=o&&s.can("delete","history");return i.createElement("div",{className:t},i.createElement(h.default,{type:"tertiary",icon:"icon-action-delete-stroke",onClick:this.handleDelete,isDisabled:!r,tooltip:this.getTooltipText(!r,!o)}))}showTooltip(){this.setState({isTooltipVisible:!0})}hideTooltip(){this.setState({isTooltipVisible:!1})}handleSelect(e){e.stopPropagation();const t={ctrlKey:e.ctrlKey,metaKey:e.metaKey,shiftKey:e.shiftKey};this.props.onSelect&&this.props.onSelect({id:this.props.id,type:"websockethistory"},t)}handleAction(e){this.props.onSelectAction(e,{websockethistory:[this.props.id]})}handleDelete(e){e.stopPropagation(),this.handleAction(v.ACTION_TYPE_DELETE)}render(){return i.createElement("div",{"data-index":this.props.index},i.createElement(b.default,{text:this.props.url,icon:i.createElement(p.default,{color:"content-color-brand"}),isSelected:this.props.isSelected,onClick:this.handleSelect,className:this.getClasses(),leftMetaComponent:this.getLeftAlignedComponents,rightMetaComponent:this.getRightAlignedComponents,routeConfig:{routeIdentifier:T.default.openHistoryIdentifier,routeParams:{echid:this.props.id},isNonLink:!0}}))}})||o},"./growth/activation/experiment/grw-468/bucketing.ts":function(e,t,s){s.r(t),s.d(t,{bootstrapGRW468Experiment:function(){return a},onBucketingEligibleUser:function(){return l},onReachingEligibleRequestsThresholdForFirstTime:function(){return c}});var o=s("./appsdk/sidebar/SidebarService.ts"),i=s("./growth/foundation/public/amplitude/AmplitudeService.js"),r=s("./growth/activation/experiment/grw-468/store.ts"),n=function(e,t,s,o){return new(s||(s=Promise))((function(i,r){function n(e){try{l(o.next(e))}catch(e){r(e)}}function a(e){try{l(o.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(n,a)}l((o=o.apply(e,t||[])).next())}))};const a=e=>n(void 0,void 0,void 0,(function*(){e&&(r.grw468Store.isHydrated||(yield r.grw468Store.hydrate()),r.grw468Store.hasErrored||r.grw468Store.handleBucketingUser())})),l=({experimentId:e,variationId:t,hasUserDismissedBanner:s,isUserInVariant:r})=>{if((0,i.ampliIdentifyExperimentV2)({experimentId:e,variationId:t}),r){if(s)return;o.default.setActiveTab("history")}},c=e=>{i.Ampli.workspaceSidebarHistoryCreateCollectionBannerRequestsThresholdReached({threshold:e})}},"./growth/activation/experiment/grw-468/components/CollectionFromHistoryRequests.styles.tsx":function(e,t,s){s.r(t),s.d(t,{ActionItems:function(){return p},Body:function(){return l},Container:function(){return n},Header:function(){return a},HistoryRequestsContainer:function(){return d},IconContainer:function(){return h},StyledIcon:function(){return u},SubHeading:function(){return c}});var o=s("../../node_modules/styled-components/dist/styled-components.browser.esm.js"),i=s("../../node_modules/@postman/aether/esmLib/src/components/Flex/Flex.js"),r=s("../../node_modules/@postman/aether/esmLib/src/components/Text/Text.js");const n=(0,o.default)(i.default).attrs({direction:"column"})`
  background-color: var(--background-color-tertiary);
  padding: var(--spacing-zero) var(--spacing-m);
`,a=o.default.div`
  display: flex;
  flex-direction: row;
  align-items: center;
  justify-content: space-between;
  padding: var(--spacing-s) var(--spacing-zero);
  min-height: 20px;
  &:hover {
    cursor: pointer;
  }
`,l=(0,o.default)(i.default)`
  padding: var(--spacing-zero) var(--spacing-xs);
`,c=(0,o.default)(r.default).attrs({type:"para",color:"content-color-secondary"})`
  padding: var(--spacing-xs) var(--spacing-zero) var(--spacing-s)
    var(--spacing-zero);
`,d=o.default.div`
  padding: 2px 0px;
`,h=(0,o.default)(i.default)`
  background: var(--background-color-info);
  border-radius: var(--border-radius-default);
  padding: 2.67px;
`,u=o.default.div`
  width: var(--size-xs);
  height: var(--size-xs);
`,p=(0,o.default)(i.default).attrs({direction:"row",alignItems:"center",gap:"spacing-xs"})`
  padding: var(--spacing-m) var(--spacing-zero) var(--spacing-l)
    var(--spacing-zero);
`},"./growth/activation/experiment/grw-468/components/CollectionFromHistoryRequests.tsx":function(e,t,s){s.r(t),s.d(t,{CollectionFromHistoryRequests:function(){return _}});var o=s("../../node_modules/react/index.js"),i=s("./runtime-repl/collection/CollectionModalTabsConstants.js"),r=s("./runtime-repl/collection/_api/CollectionInterface.js"),n=s("./appsdk/sidebar/SidebarService.ts"),a=s("./growth/foundation/public/amplitude/AmplitudeService.js"),l=s("./growth/foundation/public/features/Checklist/components/CustomHooks/usePrevious.ts"),c=s("../../node_modules/@postman/aether/esmLib/src/components/Toast/ToastManager.js"),d=s("../../node_modules/@postman/aether/esmLib/src/components/Flex/Flex.js"),h=s("../../node_modules/@postman/aether/esmLib/src/components/Text/Text.js"),u=s("../../node_modules/@postman/aether/esmLib/src/components/Button/Button.js"),p=s("../../node_modules/@postman/aether-icons/esmLib/src/design-system-icons/icon-descriptive-suggestion-stroke.js"),m=s("../../node_modules/@postman/aether-icons/esmLib/src/design-system-icons/icon-direction-down.js"),y=s("../../node_modules/@postman/aether-icons/esmLib/src/design-system-icons/icon-direction-up.js"),S=s("./growth/common/utilities/logExperimentError.ts"),b=s("./growth/activation/experiment/grw-468/constants.ts"),g=s("./growth/activation/experiment/grw-468/operations.ts"),f=s("./growth/activation/experiment/grw-468/store.ts"),v=s("./growth/activation/experiment/grw-468/components/CollectionFromHistoryRequests.styles.tsx"),I=s("./growth/activation/experiment/grw-468/components/HistoryRequest.tsx"),E=s("./node_modules/lodash/lodash.js"),w=function(e,t,s,o){return new(s||(s=Promise))((function(i,r){function n(e){try{l(o.next(e))}catch(e){r(e)}}function a(e){try{l(o.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(n,a)}l((o=o.apply(e,t||[])).next())}))};const T={type:"outline",text:"Create Collection"},C={type:"tertiary",text:"No, Thanks"},_=e=>{const{currentBucket:t}=e,[s,_]=(0,o.useState)(!0),[O,A]=(0,o.useState)(!1),[j,R]=(0,o.useState)((()=>new Set)),k=(0,l.default)(t),D=(0,l.default)(j),{addToast:x}=(0,c.default)();(0,o.useEffect)((()=>{a.Ampli.workspaceSidebarHistoryCreateCollectionBannerViewed()}),[]),(0,o.useEffect)((()=>{const e=(0,g.getSelectedRequestsInANewBucket)(k,D,t);R(e)}),[t]);const N=e=>{const t=new Set(j);t.has(e)?t.delete(e):t.add(e),R(t)};return t?o.createElement(v.Container,null,o.createElement(v.Header,{onClick:()=>{a.Ampli.workspaceSidebarHistoryCreateCollectionBannerToggleDropdownClicked(Object.assign(Object.assign({},(0,a.getAmpliCTAProperties)({type:"other",text:"toggle"})),{is_banner_expanded:!!s})),_(!s)}},o.createElement(d.default,{direction:"row",alignItems:"center",gap:"spacing-s"},o.createElement(v.IconContainer,null,o.createElement(p.default,{color:"content-color-info"})),o.createElement(h.default,{type:"para",color:"content-color-primary"},b.bannerHeader)),o.createElement(v.StyledIcon,{"data-testid":"toggle-dropdown-icon"},s?o.createElement(m.default,null):o.createElement(y.default,null))),!s&&o.createElement(v.Body,{direction:"column"},o.createElement(v.SubHeading,null,b.bannerSubHeader),o.createElement(v.HistoryRequestsContainer,null,t.requests.map((e=>o.createElement(I.default,{isChecked:j&&j.has(`${e.method}-${e.url}`),request:e,key:`${e.method}-${e.url}`,onSelect:N})))),o.createElement(v.ActionItems,null,o.createElement(u.default,Object.assign({},T,{isDisabled:0===j.size,size:"small",isLoading:O,onClick:()=>w(void 0,void 0,void 0,(function*(){A(!0),a.Ampli.workspaceSidebarHistoryCreateCollectionBannerCreateCollectionClicked(Object.assign(Object.assign({},(0,a.getAmpliCTAProperties)(T)),{suggested_requests_count:E.size(null==t?void 0:t.requests),selected_requests_count:E.size(j)}));try{if(!t)throw new Error("No bucket found to save.");const e=yield((e,t)=>w(void 0,void 0,void 0,(function*(){try{return yield(0,g.createCollectionFromHistoryItems)(e.hostname||"New Collection",e.requests.filter((e=>t.has(`${e.method}-${e.url}`))))}catch(e){throw new Error("Something went wrong on creating collection.")}})))(t,j);(e=>{A(!1),f.grw468Store.handleBannerDismiss(),n.default.setActiveTab("collection"),e&&(0,r.openCollectionInTab)(null==e?void 0:e.uid,{focusContext:i.COLLECTION_DESCRIPTION}),x({status:"success",title:"New Collection created."})})(e)}catch(e){(0,S.logExperimentError)({error:e,experimentId:"GRW-468",fileName:"CollectionFromHistoryRequests",methodName:"onCreateCollectionBtnClick",description:"Something went wrong on creating collection from bucket."}),A(!1),x({type:"error",title:"Something went wrong on creating collection."})}}))})),!O&&o.createElement(u.default,Object.assign({},C,{onClick:()=>{f.grw468Store.handleBannerDismiss(),a.Ampli.workspaceSidebarHistoryCreateCollectionBannerNoThanksClicked((0,a.getAmpliCTAProperties)(C))}}))))):null}},"./growth/activation/experiment/grw-468/components/HistoryRequest.tsx":function(e,t,s){s.r(t);var o=s("../../node_modules/react/index.js"),i=s("../../node_modules/@postman/aether/esmLib/src/components/Flex/Flex.js"),r=s("../../node_modules/@postman/aether/esmLib/src/components/Text/Text.js"),n=s("../../node_modules/@postman/aether/esmLib/src/components/CheckBox/Checkbox.js"),a=s("../../node_modules/styled-components/dist/styled-components.browser.esm.js"),l=s("./runtime-repl/request-http/RequestIcon.js");const c=a.default.div`
  display: flex;
  flex-direction: row;
  justify-content: flex-start;
  padding: var(--spacing-xs) var(--spacing-zero);
  gap: 10px;
  align-items: center;
  &:hover {
    cursor: pointer;
  }
`,d=(0,a.default)(i.default)`
  justify-content: flex-end;
  align-items: center;
  height: var(--size-xs);
  min-width: var(--size-s);
`,h=(0,a.default)(r.default).attrs({color:"content-color-primary"})`
  height: 20px;
  text-overflow: ellipsis;
  overflow: hidden;
  word-break: break-all;
  white-space: nowrap;
`;t.default=({isChecked:e,request:t,onSelect:s})=>o.createElement(c,{onClick:()=>s(`${t.method}-${t.url}`)},o.createElement(n.default,{isChecked:e}),o.createElement(d,null,o.createElement(l.default,{method:t.method})),o.createElement(h,null,t.url))},"./growth/activation/experiment/grw-468/constants.ts":function(e,t,s){s.r(t),s.d(t,{bannerHeader:function(){return r},bannerSubHeader:function(){return n},eligibleRequestCountThreshold:function(){return a},maximumRequestsCount:function(){return l}});var o,i=s("./growth/activation/stores/GrowthActivationExperimentStore.ts");const r="Organize your requests",n="Create a collection to organize, access, and reuse these requests more easily.",a=(null===(o=null===i.activationExperimentStore||void 0===i.activationExperimentStore?void 0:i.activationExperimentStore.createCollectionFromHistoryRequests)||void 0===o?void 0:o.eligibleRequestsThreshold)||5,l=10},"./growth/activation/experiment/grw-468/container.tsx":function(e,t,s){s.r(t),s.d(t,{CollectionFromHistoryRequestsSafe:function(){return c}});var o=s("../../node_modules/mobx-react/dist/mobx-react.module.js"),i=s("../../node_modules/react/index.js"),r=s("./growth/foundation/public/amplitude/AmplitudeService.js"),n=s("./growth/common/utilities/ExperimentErrorBoundary.tsx"),a=s("./growth/activation/experiment/grw-468/components/CollectionFromHistoryRequests.tsx"),l=s("./growth/activation/experiment/grw-468/store.ts");const c=(0,o.observer)((()=>l.grw468Store.shouldSeeSuggestCollectionBanner?i.createElement(n.default,{componentName:"CollectionFromHistoryRequestsSafe",experimentId:"GRW-468",onComponentError:()=>{l.grw468Store.handleBannerDismiss(),null===r.Ampli||void 0===r.Ampli||r.Ampli.experimentUxFlowFailed({error_description:"GRW-468 - User did not see the suggestion banner - component crashed"})}},i.createElement(a.CollectionFromHistoryRequests,{currentBucket:l.grw468Store.currentBucket})):null))},"./growth/activation/experiment/grw-468/ies.ts":function(e,t,s){s.r(t),s.d(t,{INTERACTION_EVENTS_DEFAULT_QUERY:function(){return a},getPersistedFlagsFromIES:function(){return l},persistUserBannerDismissalFlagInIES:function(){return c},persistUserReachingThresholdFlagInIES:function(){return d}});var o=s("./growth/activation/constants/InteractionEventConstants.ts"),i=s("./growth/foundation/public/InteractionStoreService.js"),r=s("./js/services/CurrentUserDetailsService.js"),n=function(e,t,s,o){return new(s||(s=Promise))((function(i,r){function n(e){try{l(o.next(e))}catch(e){r(e)}}function a(e){try{l(o.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(n,a)}l((o=o.apply(e,t||[])).next())}))};const a={entityType:o.USER,resourceId:o.GRW_468_COLLECTION_FROM_HISTORY,resourceType:o.EXPERIMENT},l=()=>n(void 0,void 0,void 0,(function*(){try{return yield(0,i.readInteractionEvent)(Object.assign(Object.assign({},a),{entityId:null===r.default||void 0===r.default?void 0:r.default.userId}))}catch(e){return Promise.reject(e)}})),c=({hasReachedThresholdOnce:e})=>n(void 0,void 0,void 0,(function*(){const t=Object.assign(Object.assign({},a),{entityId:null===r.default||void 0===r.default?void 0:r.default.userId,data:{hasReachedThresholdOnce:e,hasUserDismissedBanner:!0}});yield(0,i.writeInteractionEvent)(t)})),d=({hasUserDismissedBanner:e})=>n(void 0,void 0,void 0,(function*(){const t=Object.assign(Object.assign({},a),{entityId:null===r.default||void 0===r.default?void 0:r.default.userId,data:{hasUserDismissedBanner:e,hasReachedThresholdOnce:!0}});yield(0,i.writeInteractionEvent)(t)}))},"./growth/activation/experiment/grw-468/index.ts":function(e,t,s){s.r(t),s.d(t,{CollectionFromHistoryRequestsSafe:function(){return o.CollectionFromHistoryRequestsSafe},bootstrapGRW468Experiment:function(){return i.bootstrapGRW468Experiment}});var o=s("./growth/activation/experiment/grw-468/container.tsx"),i=s("./growth/activation/experiment/grw-468/bucketing.ts")},"./growth/activation/experiment/grw-468/operations.ts":function(e,t,s){s.r(t),s.d(t,{createCollectionFromHistoryItems:function(){return y},getSelectedRequestsInANewBucket:function(){return S},getSuggestedCollectionToSave:function(){return m}});var o=s("./runtime-repl/collection/_api/CollectionInterfaceV2.ts"),i=s("./runtime-repl/history/_api/HistoryInterface.js"),r=s("./js/services/CurrentUserDetailsService.js"),n=s("./js/stores/ActiveWorkspaceStore.js"),a=s("./js/stores/StoreManager.js"),l=s("./js/utils/util.js"),c=s("./growth/activation/experiment/grw-468/constants.ts"),d=s("./growth/activation/experiment/grw-468/utilities.ts"),h=s("./node_modules/lodash/lodash.js"),u=function(e,t,s,o){return new(s||(s=Promise))((function(i,r){function n(e){try{l(o.next(e))}catch(e){r(e)}}function a(e){try{l(o.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(n,a)}l((o=o.apply(e,t||[])).next())}))};const p=e=>u(void 0,void 0,void 0,(function*(){if(!e||0===e.length)return[];const t=(e=>{const t=e.sort(((e,t)=>new Date(e.createdAt).getTime()-new Date(t.createdAt).getTime())),s=new Map;return t.map(((e,t)=>Object.assign(Object.assign({},e),{originalOrderInHistory:t}))).forEach((e=>{const t=`${e.url}-${e.method}`;if(s.has(t)){const o=s.get(t);o&&e.originalOrderInHistory>o.originalOrderInHistory&&(s.delete(t),s.set(t,e))}else s.set(t,e)})),Array.from(s.values())})(e),s=t[t.length-1];yield(0,d.waitForHistoryResponseToLoad)(s);const o=yield(0,i.convertHistoryToRequests)(t.map((e=>e.id)),{populateIfPartial:!0,populateResponse:!0,retainId:!0}),r=new Map;return o.forEach(((e,s)=>{const{historyresponses:o,url:i,method:n}=e;if(!o||0===o.length||!i||!n)return;const{responseCode:a}=o[0],{code:l}=a;if(l>=200&&l<=300){const o=`${i}-${n}`;r.has(o)||r.set(o,Object.assign(Object.assign({},e),{orderInHistory:t[s].originalOrderInHistory}))}})),Array.from(r.values())})),m=e=>u(void 0,void 0,void 0,(function*(){var t,s;if(!e||0===e.length||e.length<c.eligibleRequestCountThreshold)return;const o=(e=>{const t=[];return e.forEach((e=>{const{url:s}=e,o=(0,d.getHostName)(s)||"API Hostname",i=t.find((e=>e.hostname===o));if(i){if(void 0!==i.requests.find((t=>(0,d.getPathName)(e.url)===(0,d.getPathName)(t.url)&&e.method===t.method)))return void(i.mostRecentOrderInBucket=Math.max(i.mostRecentOrderInBucket,e.orderInHistory));i.requestsCount++,i.requests.push(e),i.requestsIds.push(e.id),i.mostRecentOrderInBucket=e.orderInHistory}else t.push({hostname:o,requestsCount:1,requests:[e],requestsIds:[e.id],mostRecentOrderInBucket:e.orderInHistory})})),t})(yield p(e)).filter((e=>e.requestsCount>=c.eligibleRequestCountThreshold)),i=h.maxBy(o,"mostRecentOrderInBucket"),r=(null!==(s=null===(t=null==i?void 0:i.requests)||void 0===t?void 0:t.slice(-c.maximumRequestsCount))&&void 0!==s?s:[]).reverse();return i?Object.assign(Object.assign({},i),{requests:r,requestsIds:r.map((e=>e.id)),mostRecentOrderInBucket:r[0].orderInHistory}):void 0})),y=(e,t)=>u(void 0,void 0,void 0,(function*(){if(!t||0===t.length)throw new Error("No history requests to create a collection from");const s=(0,a.resolveStoreInstance)(n.default).id,i=((e,t)=>{const s=l.default.guid(),o=r.default.userId,i=t.map((e=>({id:l.default.guid(),name:e.url,owner:o,collection:s,method:e.method,url:e.url,dataMode:e.dataMode,auth:e.auth,headerData:e.headerData,pathVariableData:e.pathVariableData,queryParams:e.queryParams,dataOptions:e.dataOptions,data:e.data}))),n=i.reduce(((e,{id:t})=>void 0!==t?e.concat(t):e),[]);return{id:s,name:e||"New Collection",owner:o,requests:i,description:"",order:n}})(e,t),c=yield(0,o.createCollection)(i,s,{analyticsOptions:{origin:"history/grw-468-sidebar-suggested-requests-banner"}});if(!c)throw new Error("Collection was not created successfully");return c})),S=(e,t,s)=>{const o=new Set,i=null==e?void 0:e.requests.map((e=>`${e.method}-${e.url}`));return null===s||null==s||s.requests.forEach((r=>{const n=`${r.method}-${r.url}`,a=null==t?void 0:t.has(n),l=e&&e.hostname===(null==s?void 0:s.hostname)&&(null==i?void 0:i.includes(n));(a||!l)&&o.add(n)})),o}},"./growth/activation/experiment/grw-468/store.ts":function(e,t,s){s.r(t),s.d(t,{GRW468StoreClass:function(){return b},grw468Store:function(){return g}});var o=s("../../node_modules/mobx/lib/mobx.module.js"),i=s("./collaboration/workspace/types/WorkspaceTypes.ts"),r=s("./js/stores/ActiveWorkspaceStore.js"),n=s("./js/stores/StoreManager.js"),a=s("./runtime-repl/collection/_api/CollectionInterface.js"),l=s("./runtime-repl/collection/_api/CollectionStoreV2.js"),c=s("./growth/common/utilities/logExperimentError.ts"),d=s("./growth/activation/stores/GrowthActivationExperimentStore.ts"),h=s("./growth/activation/experiment/grw-468/bucketing.ts"),u=s("./growth/activation/experiment/grw-468/constants.ts"),p=s("./growth/activation/experiment/grw-468/ies.ts"),m=s("./growth/activation/experiment/grw-468/operations.ts"),y=function(e,t,s,o){var i,r=arguments.length,n=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,s,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(n=(r<3?i(n):r>3?i(t,s,n):i(t,s))||n);return r>3&&n&&Object.defineProperty(t,s,n),n},S=function(e,t,s,o){return new(s||(s=Promise))((function(i,r){function n(e){try{l(o.next(e))}catch(e){r(e)}}function a(e){try{l(o.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(n,a)}l((o=o.apply(e,t||[])).next())}))};class b{constructor(){this.isHydrated=!1,this.hasUserDismissedBanner=!1,this.hasReachedThresholdOnce=!1,this.doesTheUserHaveNoCollections=!1,this.currentBucket=null,this.reachedThreshold=!1,this.hasErrored=!1,this.initBucketCalculation=()=>{try{if(!this.shouldBucketUser||this.hasUserDismissedBanner)return;const e=(0,n.resolveStoreInstance)(r.default);this.disposeReactionToHistoryChange=(0,o.reaction)((()=>null==e?void 0:e.history),(e=>S(this,void 0,void 0,(function*(){if(e.length<u.eligibleRequestCountThreshold)return void(this.currentBucket&&(this.currentBucket=null));const t=yield(0,m.getSuggestedCollectionToSave)(e);t&&!this.reachedThreshold&&this.handleUserReachingThreshold(),this.setCurrentBucket(t)}))),{fireImmediately:!0})}catch(e){this.hasErrored=!0,this.currentBucket=null,this.disposeReactionToHistoryChange&&this.disposeReactionToHistoryChange(),(0,c.logExperimentError)({fileName:"GRW468Store",methodName:"initBucketCalculation",description:"Could not get suggested collection to save",experimentId:"GRW-468",error:e})}},this.setCurrentBucket=e=>{this.currentBucket=e||null},this.cleanupStore=()=>{this.currentBucket=null,this.disposeReactionToHistoryChange&&this.disposeReactionToHistoryChange(),this.disposeReactionToCollectionCreation&&this.disposeReactionToCollectionCreation()},this.handleBucketingUser=()=>{const{experimentId:e,variationId:t}=d.activationExperimentStore.createCollectionFromHistoryRequests;(0,h.onBucketingEligibleUser)({experimentId:e,variationId:t,hasUserDismissedBanner:this.hasUserDismissedBanner,isUserInVariant:this.isUserInVariant}),this.isExperimentRunning||this.cleanupStore()},this.handleUserReachingThreshold=()=>{if(!this.hasReachedThresholdOnce){const{eligibleRequestsThreshold:e}=d.activationExperimentStore.createCollectionFromHistoryRequests;(0,h.onReachingEligibleRequestsThresholdForFirstTime)(e),this.hasReachedThresholdOnce=!0,(0,p.persistUserReachingThresholdFlagInIES)({hasUserDismissedBanner:this.hasUserDismissedBanner})}this.reachedThreshold=!0,this.isUserInVariant||this.cleanupStore()},this.handleBannerDismiss=()=>{this.hasUserDismissedBanner=!0,(0,p.persistUserBannerDismissalFlagInIES)({hasReachedThresholdOnce:this.hasReachedThresholdOnce}),this.cleanupStore()}}hydrate(){return S(this,void 0,void 0,(function*(){try{const e=yield(0,p.getPersistedFlagsFromIES)();this.hasUserDismissedBanner=(null==e?void 0:e.hasUserDismissedBanner)||!1,this.hasReachedThresholdOnce=(null==e?void 0:e.hasReachedThresholdOnce)||!1,this.isHydrated=!0}catch(e){this.hasErrored=!0,this.isHydrated=!0,this.hasUserDismissedBanner=!0,this.hasReachedThresholdOnce=!0,(0,c.logExperimentError)({fileName:"GRW468Store",methodName:"hydrate",description:"IES errored while hydrating store",experimentId:"GRW-468",error:e})}const e=(0,n.resolveStoreInstance)(r.default);try{const t=yield(0,a.getCollectionsInWorkspace)(e.id);this.doesTheUserHaveNoCollections=0===(null==t?void 0:t.length)}catch(e){this.hasErrored=!0,(0,c.logExperimentError)({fileName:"GRW468Store",methodName:"hydrate",description:"Could not get collections in workspace",experimentId:"GRW-468",error:e})}if(!this.hasUserDismissedBanner){const t=yield(0,l.subscribePartial)(e.id);try{this.disposeReactionToCollectionCreation=(0,o.reaction)((()=>t.list),(e=>{0!==e.length&&(this.doesTheUserHaveNoCollections=!1,this.handleBannerDismiss(),t.unsubscribe(),this.disposeReactionToCollectionCreation&&this.disposeReactionToCollectionCreation())}))}catch(e){this.hasErrored=!0,t.unsubscribe(),this.disposeReactionToCollectionCreation&&this.disposeReactionToCollectionCreation(),(0,c.logExperimentError)({fileName:"GRW468Store",methodName:"hydrateUIEventSub",description:"failed to listen new collection creation",experimentId:"GRW-468",error:e})}}this.initBucketCalculation()}))}get isExperimentRunning(){var e;return["control","variation"].includes(null===(e=null===d.activationExperimentStore||void 0===d.activationExperimentStore?void 0:d.activationExperimentStore.createCollectionFromHistoryRequests)||void 0===e?void 0:e.variationId)}get shouldBucketUser(){var e;const t=this.isExperimentRunning;if(!t)return!1;const s=(null===(e=(0,n.resolveStoreInstance)(r.default))||void 0===e?void 0:e.type)===i.VISIBILITY_STATUS.personal;return t&&s&&this.doesTheUserHaveNoCollections&&!this.hasErrored}get isUserInVariant(){var e;const t=this.shouldBucketUser,s=null===(e=null===d.activationExperimentStore||void 0===d.activationExperimentStore?void 0:d.activationExperimentStore.createCollectionFromHistoryRequests)||void 0===e?void 0:e.isEnabled;return t&&s}get doesUserHaveAValidBucket(){return null!==this.currentBucket}get shouldSeeSuggestCollectionBanner(){return this.isUserInVariant&&!this.hasUserDismissedBanner&&this.doesUserHaveAValidBucket&&!this.hasErrored}}y([o.observable],b.prototype,"isHydrated",void 0),y([o.observable],b.prototype,"hasUserDismissedBanner",void 0),y([o.observable],b.prototype,"hasReachedThresholdOnce",void 0),y([o.observable],b.prototype,"doesTheUserHaveNoCollections",void 0),y([o.observable],b.prototype,"currentBucket",void 0),y([o.observable],b.prototype,"reachedThreshold",void 0),y([o.observable],b.prototype,"hasErrored",void 0),y([o.action],b.prototype,"hydrate",null),y([o.action],b.prototype,"initBucketCalculation",void 0),y([o.action],b.prototype,"setCurrentBucket",void 0),y([o.action],b.prototype,"cleanupStore",void 0),y([o.action],b.prototype,"handleBucketingUser",void 0),y([o.action],b.prototype,"handleUserReachingThreshold",void 0),y([o.action],b.prototype,"handleBannerDismiss",void 0),y([o.computed],b.prototype,"isExperimentRunning",null),y([o.computed],b.prototype,"shouldBucketUser",null),y([o.computed],b.prototype,"isUserInVariant",null),y([o.computed],b.prototype,"doesUserHaveAValidBucket",null),y([o.computed],b.prototype,"shouldSeeSuggestCollectionBanner",null);const g=new b},"./growth/activation/experiment/grw-468/utilities.ts":function(e,t,s){s.r(t),s.d(t,{getHostName:function(){return r},getPathName:function(){return i},waitForHistoryResponseToLoad:function(){return n}});var o=function(e,t,s,o){return new(s||(s=Promise))((function(i,r){function n(e){try{l(o.next(e))}catch(e){r(e)}}function a(e){try{l(o.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(n,a)}l((o=o.apply(e,t||[])).next())}))};const i=e=>{if(!e||!e.includes("/")||1===e.length)return e;let t="";try{t=new URL(e).pathname}catch(s){const o=e.split("/");o.shift(),t=`/${o.join("/")}`}return t.replace(/\/+$/,"")||"/"},r=e=>{try{const t=new URL(e);return`${t.protocol?`${t.protocol}//`:""}${t.host}`.replace(/\/+$/,"")}catch(t){const[s="http:",o=""]=e.split("//"),i=`${s}//${o.split("/")[0]}`;return i.split("/")?i.split("/")[0]:i}},n=e=>o(void 0,void 0,void 0,(function*(){if(e.cursor)return null;let t,s;const o=pm.eventBus.channel("sync-changeset-events"),i=new Promise((t=>{s=o.subscribe((o=>{var i,r;"sent-to-server"!==o.name&&t(null);const{changeset:n}=o.data,a=(null===(r=null===(i=null==n?void 0:n.data)||void 0===i?void 0:i.parent)||void 0===r?void 0:r.modelId)===e.id,l="historyresponse"===(null==n?void 0:n.model)&&"import"===(null==n?void 0:n.action)&&a,c="history"===(null==n?void 0:n.model)&&"destroy"===(null==n?void 0:n.action);if(l){const{code:e}=n.data.instance.responseCode;s&&s(),t(e)}else c&&(s&&s(),t(null))}))})),r=new Promise((e=>{t=setTimeout((()=>{e(null)}),3e3)})),n=yield Promise.race([i,r]);return t&&clearTimeout(t),s&&s(),n}))},"./growth/common/utilities/ExperimentErrorBoundary.tsx":function(e,t,s){s.r(t);var o=s("../../node_modules/react/index.js"),i=s("./growth/common/utilities/logExperimentError.ts");class r extends o.Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(e,t){const{experimentId:s,componentName:o,onComponentError:r}=this.props;(0,i.logExperimentError)({error:e,fileName:o,methodName:"componentDidCatch",experimentId:s,fromErrorBoundary:!0,additionalContext:{componentName:o,errorInfo:t}}),r&&r(e,t)}render(){return this.state.hasError?null:this.props.children}}t.default=r},"./growth/foundation/public/features/Checklist/components/CustomHooks/usePrevious.ts":function(e,t,s){s.r(t);var o=s("../../node_modules/react/index.js");t.default=e=>{const t=(0,o.useRef)();return(0,o.useEffect)((()=>{t.current=e}),[e]),t.current}}}]);