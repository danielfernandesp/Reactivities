(self.webpackChunk_postman_app_renderer=self.webpackChunk_postman_app_renderer||[]).push([[22],{"./apinetwork/services/PublicProfileService.js":function(e,t,o){"use strict";o.r(t);var s=o("./js/utils/PostmanGatewayService.js");t.default={getPublicEntities:function({publisherType:e,publisherId:t,entityType:o,type:i,limit:n,offset:a}){return s.default.request("/ws/proxy",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({service:"publishing",method:"get",path:`/v1/api/networkentity/${e}/${t}?entityType=${o}&type=${i}&limit=${n}&offset=${a}&sort=latest&flattenAPIVersions=true`})})},getTemplateByPublisher:function({publisherType:e,publisherId:t,limit:o}){return s.default.request("/ws/proxy",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({service:"publishing",method:"get",path:`/v1/api/template/${e}/${t}?limit=${o}&sort=latest`})})},getApiNetworkByTeam:function({teamId:e,limit:t}){return s.default.request("/ws/proxy",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({service:"publishing",method:"get",path:`/v1/api/apinetwork/team/${e}?limit=${t}&sort=latest`})})},updateNetworkEntity:function({entityId:e,body:t}){return s.default.request("/ws/proxy",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({service:"publishing",method:"put",path:`/v1/api/networkentity/${e}`,body:t})})},fetchPermissions:e=>s.default.request("/ws/proxy",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:"/api/permissions/check",service:"acs",method:"post",body:{checks:e}})}),fetchProfileMetaData:function({id:e,profileType:t,referrer:o}){return s.default.request("/ws/proxy",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:`/v1/api/${t}/${e}${o?"?referrer="+o:""}`,service:"publishing",method:"get"})})},fetchProfileMeta:function({id:e,profileType:t,referrer:o}){return s.default.request("/ws/proxy",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:`/v1/api/${t}/${e}/meta${o?"?referrer="+o:""}`,service:"publishing",method:"get"})})},fetchCounts:function(e={}){let t=`/v1/api/networkentity/count?publisherType=${e.publisherType}&publisherId=${e.publisherId}&flattenAPIVersions=true`;return s.default.request("/ws/proxy",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({service:"publishing",method:"get",path:t})})},getTemplate:function(e={}){let t=`/v1/api/template/review?publishedId=${e.publishedId}`;return s.default.request("/ws/proxy",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({service:"publishing",method:"get",path:t})})},getApiNetwork:function(e={}){let t=`/v1/api/apinetwork?publishedId=${e.publishedId}`;return s.default.request("/ws/proxy",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({service:"publishing",method:"get",path:t})})},removeApiNetwork:function(e={}){let t=`/v1/api/apinetwork/${e.id}`;return s.default.request("/ws/proxy",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({service:"publishing",method:"delete",path:t})})},removeTemplate:function(e={}){let t=`/v1/api/template/${e.id}`;return s.default.request("/ws/proxy",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({service:"publishing",method:"delete",path:t})})},getPublisherHomeEntities:function({publisherType:e,publisherId:t,limit:o}){return s.default.request("/ws/proxy",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({service:"publishing",method:"get",path:`/v1/api/networkentity/${e}/${t}/home?limit=${o}&sort=latest&flattenAPIVersions=true`})})},async getNetworkEntity(e){const t=await s.default.request("/ws/proxy",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({service:"publishing",method:"get",path:`/v1/api/networkentity/${e}`})},{returnRawResponse:!0});return t.ok?t.json():Promise.reject(await t.json())}}},"./documentation/components/DocumentationIntersectionObserver/index.js":function(e,t,o){"use strict";o.r(t),o.d(t,{IntersectionObserverContext:function(){return s.IntersectionObserverContext},useIntersectionObserver:function(){return s.useIntersectionObserver}});var s=o("./documentation/components/DocumentationIntersectionObserver/DocumentationIntersectionObserver.js");t.default=s.default},"./documentation/components/DocumentationPublishView/ColorPicker.js":function(e,t,o){"use strict";o.r(t),o.d(t,{default:function(){return a}});var s=o("../../node_modules/react/index.js"),i=o("./js/components/base/Inputs.js"),n=o("./documentation/utils/utils.js");function a(e){const{colorHex:t,onColorChange:o,isColorInvalid:a,pristineColorHex:l}=e,r=(0,n.formatInputHex)(t),d={background:a?(0,n.formatInputHex)(l):r};return s.createElement("div",{className:"color-picker"},s.createElement(i.Input,{inputStyle:"box",onChange:o,value:r,className:"color-picker--input",error:a}),a&&s.createElement("div",{className:"color-picker--warning"},s.createElement("span",null,"Please enter a valid hexcode.")),s.createElement("div",{className:"color-picker--preview "+(a?"color-picker--preview--invalid":""),style:d}))}},"./documentation/components/DocumentationPublishView/CustomDomainHelperText.js":function(e,t,o){"use strict";o.r(t),o.d(t,{default:function(){return p}});var s=o("../../node_modules/react/index.js"),i=o("./node_modules/prop-types/index.js"),n=o.n(i),a=o("../../node_modules/@postman/aether/esmLib/src/components/Banner/Banner.js"),l=o("../../node_modules/@postman/aether/esmLib/src/components/Button/Button.js"),r=o("./js/components/messaging/Alert.js"),d=o("./js/services/NavigationService.js"),c=o("./js/components/base/LoadingIndicator.js"),u=o("./js/modules/services/AnalyticsService.js"),h=o("./documentation/constants.js"),m=o("./node_modules/lodash/lodash.js");function p(e){let{publishedDomainIndex:t,selectedDomainIndex:o,customDomains:i,domainUpstreamViewPermission:n,domainUpstreamViewPermissionLoading:p}=e;if(!i||Number(o)<0)return null;let g=i[o],b=m.get(g,"publishData.owner"),y=m.get(g,"publishData.collectionId"),v=m.get(g,"id"),E=`${pm.artemisUrl}/documentation/${b}-${y}`,f=`${pm.dashboardUrl}/settings/domains/${v}`,C={unavailableDefault:s.createElement(r.default,{type:"error",isDismissable:!1,message:"Someone else on your team has already published a documentation with this domain. Ask them to unpublish their documentation before publishing yours."}),unavailableOwner:s.createElement(r.default,{type:"error",isDismissable:!1,message:`<a href='${E}'>Another published documentation</a> &nbsp;is already using this custom domain. Please unpublish that before attempting to publish another documentation using this domain.`,onMessageLinkClick:()=>d.default.openURL(`${E}`,{target:"_blank"})}),unverified:s.createElement(a.default,{className:"url--helper-text--unverified",type:"global",status:"warning",primaryAction:s.createElement(l.default,{type:"outline",text:"Verify Domain",onClick:()=>(u.default.addEventV2({category:h.DOCUMENTATION_ANALYTICS.CATEGORY,action:"verify_custom_domain",label:h.DOCUMENTATION_ANALYTICS.LABEL.PUBLISH_SETTINGS_TAB,entityType:"domain",entityId:v}),d.default.openURL(`${f}`,{target:"_blank"}))})},"Verify this domain to update documentation link with the custom URL. Your documentation will be published on the default Postman domain until this domain is verified.")};if(p)return s.createElement(c.default,null);if(g){let e=g.upstream,o=i[t];if(e&&v!==m.get(o,"id"))return n?C.unavailableOwner:C.unavailableDefault;if(!m.get(g,"verified"))return C.unverified}return null}p.propTypes={publishedDomainIndex:n().number.isRequired,selectedDomainIndex:n().number.isRequired,customDomains:n().array.isRequired,domainUpstreamViewPermission:n().bool,domainUpstreamViewPermissionLoading:n().bool}},"./documentation/components/DocumentationPublishView/DocumentationPublishFlows/ColorPickerPage.js":function(e,t,o){"use strict";o.r(t),o.d(t,{default:function(){return d}});var s=o("../../node_modules/@postman/aether/esmLib/src/components/Flex/Flex.js"),i=o("./node_modules/classnames/index.js"),n=o.n(i),a=o("../../node_modules/react/index.js"),l=o("./js/components/base/Inputs.js"),r=o("./documentation/utils/utils.js");function d(e){const{colorHex:t,onColorChange:o,isColorInvalid:i,pristineColorHex:d}=e,c=(0,r.formatInputHex)(t),u={background:i?(0,r.formatInputHex)(d):c};return a.createElement(s.default,{direction:"column",gap:"spacing-xs"},a.createElement(s.default,{alignItems:"center",className:"color-picker",gap:"spacing-m",border:{border:"border-width-default"},borderRadius:"border-radius-default"},a.createElement("div",{className:"color-picker--preview "+(i?"color-picker--preview--invalid":""),style:u}),a.createElement(l.Input,{inputStyle:"box",onChange:o,value:c,className:"color-picker--input",error:i})),a.createElement("div",{className:"color-picker--warning"},a.createElement("span",{className:n()({"color-picker--warning--hidden":!i})},"Enter a valid hexcode.")))}},"./documentation/components/DocumentationPublishView/DocumentationPublishFlows/LogoInput.js":function(e,t,o){"use strict";o.r(t),o.d(t,{FileInput:function(){return v},default:function(){return E}});var s=o("../../node_modules/react/index.js"),i=o("./node_modules/react-image-crop/dist/ReactCrop.min.js"),n=o.n(i),a=o("./node_modules/classnames/index.js"),l=o.n(a),r=o("./node_modules/prop-types/index.js"),d=o.n(r),c=o("./js/components/base/Buttons.js"),u=o("./js/modules/services/AnalyticsService.js"),h=o("./documentation/constants.js");const m="documentation-logo-upload",p="Couldn't upload. Please upload a file less than 2 MB.",g="Unsupported file. Try uploading a PNG or JPG.",b=".jpg, .jpeg, .png",y={objectFit:"contain"};function v(e){const{handleSelect:t,handleDrop:o,id:i}=e;return s.createElement("div",{className:`${m}__input`},s.createElement("div",{className:`${m}__input-prompt-drag`},"Drag and drop an image here"),s.createElement("div",{className:`${m}__input-prompt`},"or"),s.createElement("input",{accept:b,id:i,type:"file",onChange:o}),s.createElement("div",{className:`${m}__input-prompt`},s.createElement(c.Button,{className:`${m}__input-button`,type:"secondary"},s.createElement("input",{accept:b,id:i,type:"file",onChange:t}),s.createElement("label",{htmlFor:i},"Select an image"))))}v.propTypes={handleSelect:d().func,handleDrop:d().func,id:d().string.isRequired};class E extends s.Component{constructor(e){super(e),this.state={file:null,fileMeta:{},crop:this.props.crop},this.canvasRef=s.createRef(),this.handleChange=this.handleChange.bind(this),this.handleCropChange=this.handleCropChange.bind(this),this.handleCropComplete=this.handleCropComplete.bind(this)}handleCropComplete(e,t){const o=this.canvasRef.current,{file:s}=this.state,{width:i,height:n}=this.state.fileMeta;if(t){o.width=t.width/100*i,o.height=t.height/100*n;const e=o.getContext("2d"),a=new Image;a.src=s,a.onload=()=>{e.drawImage(a,t.x/100*i,t.y/100*n,t.width/100*i,t.height/100*n,0,0,t.width/100*i,t.height/100*n),o.toBlob((e=>{const t=new File([e],this.state.fileMeta.name,{type:this.state.fileMeta.type});this.props.onChange(this.state.fileMeta,t)}),this.state.fileMeta.type)}}}handleChange(e){try{let t=new FileReader,o=e.target.files[0];if(e.target.files[0].size>2e6)throw new Error(p);t.onloadend=()=>{if(!(e=>["data:image/jpg","data:image/jpeg","data:image/png"].some((t=>e.startsWith(t))))(t.result))return void this.props.onError(g);const e=new Image;e.src=t.result,e.onload=()=>{this.setState({file:t.result,fileMeta:{size:o.size,name:o.name,type:o.type,width:e.naturalWidth,height:e.naturalHeight}})}},t.readAsDataURL(o)}catch(e){return void this.props.onError(e.message===p?p:g)}}handleCropChange(e){this.setState({crop:e})}render(){const{className:e,isImageUploading:t}=this.props,{crop:o,file:i}=this.state;return s.createElement("div",{className:l()(m,e)},i?s.createElement(s.Fragment,null,s.createElement(n(),{keepSelection:!0,crop:{...o},disabled:t,minWidth:140,minHeight:48,src:i,onChange:this.handleCropChange,onComplete:this.handleCropComplete,imageStyle:y}),s.createElement("canvas",{ref:this.canvasRef,style:{display:"none"}})):s.createElement(v,{handleSelect:e=>{var t;this.handleChange(e),u.default.addEventV2({category:h.DOCUMENTATION_ANALYTICS.CATEGORY,action:"upload_success_logo",label:"select",entityType:h.DOCUMENTATION_ENTITY.COLLECTION,entityId:null===(t=this.props.modelDetails)||void 0===t?void 0:t.modelId})},handleDrop:e=>{var t;this.handleChange(e),u.default.addEventV2({category:h.DOCUMENTATION_ANALYTICS.CATEGORY,action:"upload_success_logo",label:"dropzone",entityType:h.DOCUMENTATION_ENTITY.COLLECTION,entityId:null===(t=this.props.modelDetails)||void 0===t?void 0:t.modelId})},id:"upload-user-image"}))}}E.defaultProps={crop:{width:100,height:100,unit:"%"}},E.propTypes={className:d().string,imageURI:d().string,isImageUploading:d().bool}},"./documentation/components/DocumentationPublishView/DocumentationPublishFlows/LogoUploadModal.js":function(e,t,o){"use strict";o.r(t),o.d(t,{LogoUploadModal:function(){return b}});var s=o("../../node_modules/react/index.js"),i=o("../../node_modules/@postman/aether/esmLib/src/components/Modal/Modal.js"),n=o("../../node_modules/@postman/aether/esmLib/src/components/Text/Text.js"),a=o("../../node_modules/@postman/aether/esmLib/src/components/Flex/Flex.js"),l=o("../../node_modules/@postman/aether/esmLib/src/components/Button/Button.js"),r=o("./documentation/components/DocumentationPublishView/DocumentationPublishFlows/LogoInput.js"),d=o("./node_modules/prop-types/index.js"),c=o.n(d),u=o("./documentation/utils/utils.js"),h=o("./js/modules/services/AnalyticsService.js"),m=o("./documentation/constants.js"),p=o("./node_modules/lodash/lodash.js");const g={isImageUploading:!1,fileMeta:{},actualFile:null};class b extends s.Component{constructor(e){super(e),this.state=g,this.onConfirm=this.onConfirm.bind(this),this.handleClose=this.handleClose.bind(this),this.onChange=this.onChange.bind(this),this.onError=this.onError.bind(this)}async uploadImage(e,t){let o=null;try{const i=this.state.actualFile;o=await(0,u.uploadFile)(e,i),p.isFunction(this.props.handleImageUploaded)&&this.props.handleImageUploaded(o),i&&(i.value=null);try{var s;const o={...t,fileId:null==e?void 0:e.fileId,path:null==e||null===(s=e.fields)||void 0===s?void 0:s.key};(0,u.storeFileMetadata)({...o,...this.props.modelDetails})}catch(e){pm.logger.error("LogoUploadModal~uploadImage Error while storing file meta data",e)}}catch(e){pm.logger.error("LogoUploadModal~uploadImage Error while uploading file",e),pm.toasts.error("Unable to upload file. Please try again")}}async getUploadURL(e){try{const t=await(0,u.getPresignedURL)({...e,...this.props.modelDetails});null!=t&&t.fields&&await this.uploadImage(t,e)}catch(e){pm.logger.error("LogoUploadModal~getUploadURL Error while getting presigned URL",e),pm.toasts.error("Unable to upload file. Please try again")}}async onConfirm(){this.setState({isImageUploading:!0});try{var e,t,o;await this.getUploadURL(this.state.fileMeta),h.default.addEventV2({category:m.DOCUMENTATION_ANALYTICS.CATEGORY,action:"upload_image_confirm_logo",label:"success",entityType:m.DOCUMENTATION_ENTITY.COLLECTION,entityId:null===(e=this.props.modelDetails)||void 0===e?void 0:e.modelId}),h.default.addEventV2({category:m.DOCUMENTATION_ANALYTICS.CATEGORY,action:"upload_success_logo_mem",label:null===(t=this.state.fileMeta)||void 0===t?void 0:t.size,entityType:m.DOCUMENTATION_ENTITY.COLLECTION,entityId:null===(o=this.props.modelDetails)||void 0===o?void 0:o.modelId})}catch(e){var s;pm.logger.error("LogoUploadModal~onConfirm Error while getting upload URL",e),pm.toasts.error("Unable to upload file. Please try again"),h.default.addEventV2({category:m.DOCUMENTATION_ANALYTICS.CATEGORY,action:"upload_image_confirm_logo",label:"fail",entityType:m.DOCUMENTATION_ENTITY.COLLECTION,entityId:null===(s=this.props.modelDetails)||void 0===s?void 0:s.modelId})}finally{this.setState({isImageUploading:!1}),this.props.onClose()}}onChange(e,t){this.setState({fileMeta:e,actualFile:t})}onError(e){pm.toasts.error(e)}handleClose(){try{var e;this.props.onClose(),h.default.addEventV2({category:m.DOCUMENTATION_ANALYTICS.CATEGORY,action:"close_upload_window_logo",entityType:m.DOCUMENTATION_ENTITY.COLLECTION,entityId:null===(e=this.props.modelDetails)||void 0===e?void 0:e.modelId})}catch(e){pm.logger.error("LogoUploadModal~handleClose: Unable to close modal",e)}}render(){const{isImageUploading:e,actualFile:t}=this.state;return s.createElement(i.Modal,{isOpen:this.props.isOpen,onClose:this.handleClose,size:"small"},s.createElement(i.ModalHeader,{heading:this.props.title}),s.createElement(i.ModalContent,null,s.createElement(n.default,{type:"para",color:"content-color-primary"},"Only JPG, JPEG, and PNG files are supported. Maximum 2 MB."),s.createElement(r.default,{isImageUploading:e,ref:"imageInput",onChange:this.onChange,onError:this.onError,modelDetails:this.props.modelDetails})),s.createElement(i.ModalFooter,null,s.createElement(a.default,{justifyContent:"flex-end",grow:1,shrink:1,gap:"spacing-m"},s.createElement(l.default,{type:"secondary",onClick:this.handleClose,isDisabled:e,text:"Cancel"}),s.createElement(l.default,{type:"primary",onClick:this.onConfirm,isDisabled:!t,isLoading:e,text:"Upload"}))))}}b.propTypes={handleImageUploaded:c().func,isOpen:c().bool,onClose:c().func},t.default=b},"./documentation/components/DocumentationPublishView/DocumentationPublishFlows/PublishLogo.js":function(e,t,o){"use strict";o.r(t),o.d(t,{default:function(){return f}});var s=o("../../node_modules/react/index.js"),i=o("./documentation/constants.js"),n=o("./documentation/components/DocumentationPublishView/DocumentationPublishFlows/LogoUploadModal.js"),a=o("../../node_modules/@postman/aether/esmLib/src/components/Heading/Heading.js"),l=o("../../node_modules/@postman/aether/esmLib/src/components/Flex/Flex.js"),r=o("../../node_modules/@postman/aether/esmLib/src/components/Menu/Menu.js"),d=o("../../node_modules/@postman/aether/esmLib/src/components/Menu/MenuButton.js"),c=o("../../node_modules/@postman/aether/esmLib/src/components/Button/Button.js"),u=o("../../node_modules/@postman/aether/esmLib/src/components/Menu/MenuList.js"),h=o("../../node_modules/@postman/aether/esmLib/src/components/Menu/MenuItem.js"),m=o("../../node_modules/@postman/aether/esmLib/src/components/Text/Text.js"),p=o("../../node_modules/@postman/aether/esmLib/src/components/Modal/Modal.js"),g=o("../../node_modules/@postman/aether/esmLib/src/components/ButtonGroup/ButtonGroup.js"),b=o("../../node_modules/styled-components/dist/styled-components.browser.esm.js"),y=o("./js/modules/services/AnalyticsService.js"),v=o("./node_modules/lodash/lodash.js");const E=b.default.div`
  width: 64px;
  height: 64px;
  margin-top: var(--spacing-s);
  padding: var(--spacing-s);
  border: var(--border-width-default) var(--border-style-solid) var(--border-color-default);
  border-radius: var(--border-radius-default);
  display: flex;
  align-items: center;
  justify-content: center;
  background-color: ${e=>"#"+e.backgroundColor};
`;class f extends s.Component{constructor(e){super(e),this.state={showImageUploadModal:!1,showDeleteConfirmationModal:!1,isLightThemeImageModalSelected:!1,isLightThemeImageDeleteModalSelected:!1},this.handleDeleteLogo=this.handleDeleteLogo.bind(this),this.handleNewLogoUpload=this.handleNewLogoUpload.bind(this),this.handleConfirmDeleteLogo=this.handleConfirmDeleteLogo.bind(this),this.isDeleteDisabled=this.isDeleteDisabled.bind(this)}isDeleteDisabled(e){return e===i.DOCUMENTATION_PUBLISHING.DEFAULT_DOCUMENTATION_LOGO_URL||e===this.props.teamLogoUrl}handleDeleteLogo(e){try{var t;this.setState({showDeleteConfirmationModal:!0,isLightThemeImageDeleteModalSelected:e===i.DOCUMENTATION_THEMES.LIGHT}),y.default.addEventV2({category:i.DOCUMENTATION_ANALYTICS.CATEGORY,action:"delete_initiate_logo",entityType:i.DOCUMENTATION_ENTITY.COLLECTION,entityId:null===(t=this.props.modelDetails)||void 0===t?void 0:t.modelId})}catch(e){pm.logger.error("PublishLogo~handleDeleteLogo: Error deleting logo",e)}}handleConfirmDeleteLogo(){try{var e;const t=this.state.isLightThemeImageDeleteModalSelected?i.DOCUMENTATION_THEMES.LIGHT:i.DOCUMENTATION_THEMES.DARK;v.isFunction(this.props.onDeleteLogo)&&this.props.onDeleteLogo(t,this.props.isRequestedSettings),this.setState({showDeleteConfirmationModal:!1}),y.default.addEventV2({category:i.DOCUMENTATION_ANALYTICS.CATEGORY,action:"delete_confirm_logo",entityType:i.DOCUMENTATION_ENTITY.COLLECTION,entityId:null===(e=this.props.modelDetails)||void 0===e?void 0:e.modelId})}catch(e){pm.logger.error("PublishLogo~handleConfirmDeleteLogo: Error confirming deletion of logo",e)}}handleNewLogoUpload(e){v.isFunction(this.props.onNewLogoUpload)&&this.props.onNewLogoUpload(e,this.props.isRequestedSettings,this.state.isLightThemeImageModalSelected)}render(){const{customColorsLight:e,lightThemeLogoUrl:t,customColorsDark:o,darkThemeLogoUrl:b,modelDetails:v}=this.props,{showImageUploadModal:f,showDeleteConfirmationModal:C}=this.state;return s.createElement("div",{className:"styling--logo"},s.createElement(a.default,{type:"h6",text:"Logo"}),s.createElement(l.default,{alignItems:"center",gap:"spacing-l"},s.createElement(l.default,{direction:"column",alignItems:"center"},s.createElement(E,{backgroundColor:e["top-bar"]},s.createElement("img",{src:t,height:"48",width:"48",className:"styling--logo--image"})),s.createElement("div",{className:"styling--logo--menu"},s.createElement(r.default,null,s.createElement(d.default,null,s.createElement(c.default,{icon:"icon-action-edit-stroke",type:"tertiary"})),s.createElement(u.default,{placement:"bottom-start"},s.createElement(h.default,{onClick:()=>{var e;this.setState({showImageUploadModal:!0,isLightThemeImageModalSelected:!0}),y.default.addEventV2({category:i.DOCUMENTATION_ANALYTICS.CATEGORY,action:"upload_image_initiate_logo",entityType:i.DOCUMENTATION_ENTITY.COLLECTION,entityId:null===(e=this.props.modelDetails)||void 0===e?void 0:e.modelId})}},s.createElement(l.default,{gap:"spacing-xs",alignItems:"center"},s.createElement(m.default,null,"Upload"))),s.createElement(h.default,{isDisabled:this.isDeleteDisabled(t),onClick:()=>this.handleDeleteLogo(i.DOCUMENTATION_THEMES.LIGHT)},s.createElement(l.default,{gap:"spacing-xs",alignItems:"center"},s.createElement(m.default,{color:this.isDeleteDisabled(t)?"content-color-error":"base-color-error"},"Delete"))))))),s.createElement(l.default,{direction:"column",alignItems:"center"},s.createElement(E,{backgroundColor:o["top-bar"]},s.createElement("img",{src:b,height:"48",width:"48",className:"styling--logo--image"})),s.createElement("div",{className:"styling--logo--menu"},s.createElement(r.default,null,s.createElement(d.default,null,s.createElement(c.default,{icon:"icon-action-edit-stroke",type:"tertiary"})),s.createElement(u.default,{placement:"bottom-start"},s.createElement(h.default,{onClick:()=>{this.setState({showImageUploadModal:!0,isLightThemeImageModalSelected:!1})}},s.createElement(l.default,{gap:"spacing-xs",alignItems:"center"},s.createElement(m.default,null,"Upload"))),s.createElement(h.default,{isDisabled:this.isDeleteDisabled(b),onClick:()=>this.handleDeleteLogo(i.DOCUMENTATION_THEMES.DARK)},s.createElement(l.default,{gap:"spacing-xs",alignItems:"center"},s.createElement(m.default,{color:this.isDeleteDisabled(b)?"content-color-error":"base-color-error"},"Delete")))))))),f&&s.createElement(n.default,{isOpen:!0,handleImageUploaded:e=>{this.handleNewLogoUpload(e)},onClose:()=>{this.setState({showImageUploadModal:!1})},title:"Upload logo",modelDetails:v}),s.createElement(p.Modal,{isOpen:C,size:"small"},s.createElement(p.ModalHeader,{heading:"Delete logo?",hideCloseButton:!0}),s.createElement(p.ModalContent,null,s.createElement(m.default,{type:"para",color:"content-color-primary"},"Are you sure you want to delete the logo? It can't be recovered once it is deleted.")),s.createElement(p.ModalFooter,null,s.createElement(l.default,{justifyContent:"flex-end",grow:1,shrink:1},s.createElement(g.default,null,s.createElement(c.default,{type:"secondary",text:"Cancel",onClick:()=>this.setState({showDeleteConfirmationModal:!1})}),s.createElement(c.default,{type:"destructive",text:"Delete",onClick:this.handleConfirmDeleteLogo}))))))}}},"./documentation/components/DocumentationPublishView/DocumentationPublishFlows/PublishSettingsPage.js":function(e,t,o){"use strict";o.r(t),o.d(t,{PublishSettingsPage:function(){return z}});var s,i=o("../../node_modules/react/index.js"),n=o("./node_modules/prop-types/index.js"),a=o.n(n),l=o("../../node_modules/mobx-react/dist/mobx-react.module.js"),r=o("../../node_modules/mobx/lib/mobx.module.js"),d=o("./node_modules/classnames/index.js"),c=o.n(d),u=o("./node_modules/querystring-browser/querystring.js"),h=o.n(u),m=o("./node_modules/lodash/lodash.js"),p=o.n(m),g=o("../../node_modules/@postman/aether/esmLib/src/components/Banner/Banner.js"),b=o("../../node_modules/@postman/aether/esmLib/src/components/Text/Text.js"),y=o("../../node_modules/@postman/aether/esmLib/src/components/Heading/Heading.js"),v=o("../../node_modules/@postman/aether/esmLib/src/components/Dropdown/FilterSelect/FilterSelectContainer.js"),E=o("../../node_modules/@postman/aether/esmLib/src/components/Dropdown/SingleSelect/SingleSelect.js"),f=o("../../node_modules/@postman/aether/esmLib/src/components/Label/Label.js"),C=o("../../node_modules/@postman/aether/esmLib/src/components/Flex/Flex.js"),w=o("../../node_modules/@postman/aether/esmLib/src/components/Tag/Tag.js"),T=o("../../node_modules/@postman/aether/esmLib/src/components/Tooltip/Tooltip.js"),D=o("../../node_modules/@postman/aether/esmLib/src/components/RadioGroup/RadioGroup.js"),S=o("../../node_modules/@postman/aether/esmLib/src/components/Radio/Radio.js"),I=o("../../node_modules/@postman/aether/esmLib/src/components/Button/Button.js"),N=o("../../node_modules/@postman/aether/esmLib/src/components/TextInput/TextInput.js"),L=o("../../node_modules/@postman/aether/esmLib/src/components/TextArea/TextArea.js"),k=o("../../node_modules/@postman/aether-icons/esmLib/src/design-system-icons/icon-state-info-stroke-small.js"),O=o("../../node_modules/@postman/aether-icons/esmLib/src/design-system-icons/icon-action-refresh-stroke.js"),P=o("./js/stores/StoreManager.js"),R=o("./js/stores/CurrentUserStore.js"),_=o("./documentation/utils/utils.js"),x=o("./documentation/components/DocumentationPublishView/DocumentationPublishFlows/PublishedViewPreviewPage.js"),A=o("./documentation/components/DocumentationPublishView/CustomDomainHelperText.js"),q=o("./appsdk/components/link/Link.js"),U=o("./documentation/constants.js"),M=o("./documentation/utils/publish.js"),j=o("./documentation/services/DocumentationService.js"),B=o("./documentation/components/DocumentationPublishView/ShareToWorkspace/index.js"),V=o("./js/modules/services/AnalyticsService.js"),F=o("./documentation/components/DocumentationPublishView/DocumentationPublishFlows/PublishLogo.js"),W=o("./documentation/components/DocumentationPublishView/DocumentationPublishFlows/ColorPickerPage.js"),H=o("./documentation/components/DocumentationPublishView/DocumentationPublishFlows/SidebarNavigationPage.js"),Y=o("./documentation/hocs/withErrorBoundary.js");const G="no-custom-domain",$="no-environment";let z=(0,l.observer)(s=class extends i.Component{constructor(e){var t,o,s,i,n,a,l,r,d,c,u,h,m,g,b,y,v,E;super(e),this.getEnvironmentMenuItems=()=>{let e=this.props.availableEnvironments;if(e&&Array.isArray(e)){let t=e.map((e=>({label:e.name,value:e.owner+"-"+e.id})));return t.unshift({label:"No Environment",value:$}),t}return[{label:"No Environment",value:$}]};const f=(null===(t=this.props.publishedStylingLight)||void 0===t?void 0:t.documentationLayout)||"classic-double-column",C=(null===(o=this.props.requestedStylingLight)||void 0===o?void 0:o.documentationLayout)||"classic-double-column";this.state={selectedDomain:p().findIndex(this.props.availableCustomDomains,{id:this.props.publishedCustomDomain}),selectedTheme:{label:null===(s=U.THEME_MENU_OPTIONS.find((e=>e.value===this.props.defaultTheme)))||void 0===s?void 0:s.label,value:this.props.defaultTheme},requestedSelectedTheme:{label:null===(i=U.THEME_MENU_OPTIONS.find((e=>e.value===this.props.requestedDefaultTheme)))||void 0===i?void 0:i.label,value:this.props.requestedDefaultTheme},publishedDomainId:p().findIndex(this.props.availableCustomDomains,{id:this.props.publishedCustomDomain}),selectedEnvironment:p().findIndex(this.props.availableEnvironments,{id:this.props.publishedEnvironment,owner:this.props.publishedEnvironmentOwner}),selectedEnvironmentDetails:p().find(this.props.availableEnvironments,{id:this.props.publishedEnvironment,owner:this.props.publishedEnvironmentOwner}),selectedVersions:p().isEmpty(this.props.publishedVersions)?U.DOCUMENTATION_LATEST_VERSION_PAGE:this.props.publishedVersions,versionsDropdownPlaceholder:this.getVersionDropdownPlaceholder(Object.keys(this.props.publishedVersions).length,p().get(this.props.publishedVersions,"0"))||"CURRENT",customColorsLight:this.props.publishedStylingLight.customColor||{"right-sidebar":U.THEME_DEFAULT_COLORS.LIGHT["right-sidebar"],"top-bar":U.THEME_DEFAULT_COLORS.LIGHT["top-bar"],highlight:U.THEME_DEFAULT_COLORS.LIGHT.highlight},customColorsDark:this.props.publishedStylingDark.customColor||{"right-sidebar":U.THEME_DEFAULT_COLORS.DARK["right-sidebar"],"top-bar":U.THEME_DEFAULT_COLORS.DARK["top-bar"],highlight:U.THEME_DEFAULT_COLORS.DARK.highlight},activeSidebarItem:"#content",documentationLayout:f,domainUpstreamViewPermission:null,domainUpstreamViewPermissionLoading:!1,selectedDomainUnavailable:!1,triggerShare:!1,isSharing:!1,isColorInvalidLight:{"right-sidebar":!1,"top-bar":!1,highlight:!1},isColorInvalidDark:{"right-sidebar":!1,"top-bar":!1,highlight:!1},seoTitle:null!==(n=this.props.seoTitle)&&void 0!==n?n:"",seoDescription:null!==(a=this.props.seoDescription)&&void 0!==a?a:"",noteToCommunityManager:this.props.noteToCommunityManager,selectedRequestedDomain:p().findIndex(this.props.availableCustomDomains,{id:this.props.requestedCustomDomain}),requestedDomainId:p().findIndex(this.props.availableCustomDomains,{id:this.props.requestedCustomDomain}),selectedRequestedEnvironment:p().findIndex(this.props.availableEnvironments,{id:this.props.requestedEnvironment,owner:this.props.requestedEnvironmentOwner}),selectedRequestedEnvironmentDetails:p().find(this.props.availableEnvironments,{id:this.props.requestedEnvironment,owner:this.props.requestedEnvironmentOwner}),selectedRequestedVersions:p().isEmpty(this.props.requestedVersions)?U.DOCUMENTATION_LATEST_VERSION_PAGE:this.props.requestedVersions,requestedVersionsDropdownPlaceholder:this.props.requestedVersions&&this.getVersionDropdownPlaceholder(Object.keys(this.props.requestedVersions).length,p().get(this.props.requestedVersions,"0"))||"CURRENT",requestedCustomColorsLight:(null===(l=this.props.requestedStylingLight)||void 0===l?void 0:l.customColor)||{"right-sidebar":U.THEME_DEFAULT_COLORS.LIGHT["right-sidebar"],"top-bar":U.THEME_DEFAULT_COLORS.LIGHT["top-bar"],highlight:U.THEME_DEFAULT_COLORS.LIGHT.highlight},requestedCustomColorsDark:(null===(r=this.props.requestedStylingDark)||void 0===r?void 0:r.customColor)||{"right-sidebar":U.THEME_DEFAULT_COLORS.DARK["right-sidebar"],"top-bar":U.THEME_DEFAULT_COLORS.DARK["top-bar"],highlight:U.THEME_DEFAULT_COLORS.DARK.highlight},requestedDocumentationLayout:C,isRequestedColorInvalidLight:{"right-sidebar":!1,"top-bar":!1,highlight:!1},isRequestedColorInvalidDark:{"right-sidebar":!1,"top-bar":!1,highlight:!1},isLightThemeImageModal:!1,darkThemeLogoUrl:null===(d=this.props.publishedStylingDark)||void 0===d?void 0:d.logoUrl,lightThemeLogoUrl:null===(c=this.props.publishedStylingLight)||void 0===c?void 0:c.logoUrl,requestedLightThemeLogoUrl:null===(u=this.props.requestedStylingLight)||void 0===u?void 0:u.logoUrl,requestedDarkThemeLogoUrl:null===(h=this.props.requestedStylingDark)||void 0===h?void 0:h.logoUrl,requestedSeoTitle:null!==(m=this.props.requestedSeoTitle)&&void 0!==m?m:"",requestedSeoDescription:null!==(g=this.props.requestedSeoDescription)&&void 0!==g?g:"",isCustomLogoLightTheme:(null===(b=this.props.publishedStylingLight)||void 0===b?void 0:b.isCustomLogo)||!1,isCustomLogoDarkTheme:(null===(y=this.props.publishedStylingDark)||void 0===y?void 0:y.isCustomLogo)||!1,isRequestedCustomLogoLightTheme:(null===(v=this.props.requestedStylingLight)||void 0===v?void 0:v.isCustomLogo)||!1,isRequestedCustomLogoDarkTheme:(null===(E=this.props.requestedStylingDark)||void 0===E?void 0:E.isCustomLogo)||!1},this.handleVersionSelect=this.handleVersionSelect.bind(this),this.handleEnvironmentSelect=this.handleEnvironmentSelect.bind(this),this.handleCustomDomainSelect=this.handleCustomDomainSelect.bind(this),this.handlePublishButtonClick=this.handlePublishButtonClick.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleLayoutToggle=this.handleLayoutToggle.bind(this),this.handlePreview=this.handlePreview.bind(this),this.updatePreviewWindow=this.updatePreviewWindow.bind(this),this.constructPreviewUrl=this.constructPreviewUrl.bind(this),this.getVersionsForPreview=this.getVersionsForPreview.bind(this),this.onShareComplete=this.onShareComplete.bind(this),this.handleSeoTitle=this.handleSeoTitle.bind(this),this.handleSeoDescription=this.handleSeoDescription.bind(this),this.handleRequestedSeoDescription=this.handleRequestedSeoDescription.bind(this),this.handleRequestedSeoTitle=this.handleRequestedSeoTitle.bind(this),this.handleNoteToCommunityManager=this.handleNoteToCommunityManager.bind(this),this.handleRequestedVersionSelect=this.handleRequestedVersionSelect.bind(this),this.handleRequestedEnvironmentSelect=this.handleRequestedEnvironmentSelect.bind(this),this.handleThemeSelect=this.handleThemeSelect.bind(this),this.handleRequestedThemeSelect=this.handleRequestedThemeSelect.bind(this),this.handleRequestedCustomDomainSelect=this.handleRequestedCustomDomainSelect.bind(this),this.handleRequestPublishButtonClick=this.handleRequestPublishButtonClick.bind(this),this.handleApproveRequest=this.handleApproveRequest.bind(this),this.handleRequestedLayoutToggle=this.handleRequestedLayoutToggle.bind(this),this.updateRequestPreviewWindow=this.updateRequestPreviewWindow.bind(this),this.constructRequestPreviewUrl=this.constructRequestPreviewUrl.bind(this),this.getRequestedVersionsForPreview=this.getRequestedVersionsForPreview.bind(this),this.handleNewLogoUpload=this.handleNewLogoUpload.bind(this),this.handleDeleteLogo=this.handleDeleteLogo.bind(this),this.previewWindow=null}handleNoteToCommunityManager(e){this.setState({noteToCommunityManager:e})}handleSeoTitle(e){this.setState({seoTitle:e})}handleRequestedSeoTitle(e){this.setState({requestedSeoTitle:e})}handleSeoDescription(e,t){if(null===t||0===t)this.setState({seoDescription:e});else{const t=e.slice(0,320);this.setState({seoDescription:t})}}handleRequestedSeoDescription(e,t){if(null===t||0===t)this.setState({requestedSeoDescription:e});else{const t=e.slice(0,320);this.setState({requestedSeoDescription:t})}}handleCancel(){"function"==typeof this.props.cancelButtonCallback&&this.props.cancelButtonCallback()}handleApproveRequest(){const{approveRequestButtonCallback:e,collectionPublishRequestCode:t}=this.props;let o=this.getApprovePayload();"function"==typeof e&&e(o,t)}getApprovePayload(){var e,t;let{requestData:o}=this.props,s=p().get(o,"data.body.data[0]",{}),{modelId:i}=s,n=this.state.selectedRequestedEnvironment,a=p().get(this.props.availableEnvironments,[n],{}),{owner:l,id:r}=p().pick(a,["id","owner"]),d=l&&r?`${l}-${r}`:null,c=this.state.selectedRequestedDomain,u=p().get(this.props.availableCustomDomains,[c],null),h=p().get(u,"id",null),m=null===(e=this.state.selectedRequestedVersions)||void 0===e?void 0:e.map((e=>e.value)),g={...p().pick(this.state.requestedCustomColorsLight,["top-bar","right-sidebar","highlight"])},b={...p().pick(this.state.requestedCustomColorsDark,["top-bar","right-sidebar","highlight"])},y=null!==(t=this.props.tokenScanId)&&void 0!==t?t:null,v=this.formatCustomColorsForPublishing(g),E=this.formatCustomColorsForPublishing(b),f={metaTags:[{name:"description",value:this.state.requestedSeoDescription},{name:"title",value:p().isEqual(this.state.requestedSeoTitle,this.props.collectionName)?null:this.state.requestedSeoTitle}],appearance:{default:this.state.requestedSelectedTheme.value,themes:[{name:"dark",logo:this.state.isRequestedCustomLogoDarkTheme?this.state.requestedDarkThemeLogoUrl:null,colors:E},{name:"light",logo:this.state.isRequestedCustomLogoLightTheme?this.state.requestedLightThemeLogoUrl:null,colors:v}]}};l=l||null;let C=o&&{uid:i,environmentTemplateId:d,environmentOwner:l,customDomainId:h,customColor:v,versionTag:m,documentationLayout:this.state.requestedDocumentationLayout,customisation:f};return y&&(C.tokenScanId=y),C}handlePublishButtonClick(){if(this.props.isGovernance){const e=this.getPublishPayload();"function"==typeof this.props.publishButtonCallback&&this.props.publishButtonCallback(e)}else this.setState({triggerShare:!0,isSharing:!0})}getPublishPayload(){try{var e,t,o,s,i,n,a,l,r;let d=this.state.selectedEnvironment,c=p().get(this.props.availableEnvironments,[d],{}),{owner:u,id:h}=p().pick(c,["id","owner"]),m=u&&h?`${u}-${h}`:null,g=this.state.selectedDomain,b=p().get(this.props.availableCustomDomains,[g],null),y=p().get(b,"id",null),v=null===(e=this.state.selectedVersions)||void 0===e?void 0:e.map((e=>e.value)),E={...p().pick(this.state.customColorsLight,["top-bar","right-sidebar","highlight"])},f={...p().pick(this.state.customColorsDark,["top-bar","right-sidebar","highlight"])},C=this.formatCustomColorsForPublishing(E),w=this.formatCustomColorsForPublishing(f),T={metaTags:[{name:"description",value:this.state.seoDescription},{name:"title",value:p().isEqual(this.props.collectionName,this.state.seoTitle)?null:this.state.seoTitle}],appearance:{default:this.state.selectedTheme.value,themes:[{name:"dark",logo:this.state.isCustomLogoDarkTheme?this.state.darkThemeLogoUrl:null,colors:w},{name:"light",logo:this.state.isCustomLogoLightTheme?this.state.lightThemeLogoUrl:null,colors:C}]}};u=u||null;let D={versionTag:v,environmentTemplateId:m,environmentOwner:u,customDomainId:y,customColor:C,documentationLayout:this.state.documentationLayout,customisation:T};const S=(null===(t=this.props.publishedStylingLight)||void 0===t?void 0:t.customColor)||{"right-sidebar":U.THEME_DEFAULT_COLORS.LIGHT["right-sidebar"],"top-bar":U.THEME_DEFAULT_COLORS.LIGHT["top-bar"],highlight:U.THEME_DEFAULT_COLORS.LIGHT.highlight},I=(null===(o=this.props.publishedStylingDark)||void 0===o?void 0:o.customColor)||{"right-sidebar":U.THEME_DEFAULT_COLORS.DARK["right-sidebar"],"top-bar":U.THEME_DEFAULT_COLORS.DARK["top-bar"],highlight:U.THEME_DEFAULT_COLORS.DARK.highlight},N=this.props.defaultTheme||U.DOCUMENTATION_THEMES.LIGHT,L=null===(s=this.props.publishedStylingLight)||void 0===s?void 0:s.logoUrl,k=null===(i=this.props.publishedStylingDark)||void 0===i?void 0:i.logoUrl,O=null!==(n=this.props.seoTitle)&&void 0!==n?n:"",P=this.props.seoDescription||"",R={colorsLight:S,colorsDark:I,layout:(null===(a=this.props.publishedStylingLight)||void 0===a?void 0:a.documentationLayout)||"classic-double-column",theme:N,lightLogoUrl:L,darkLogoUrl:k,seoTitle:O,seoDescription:P},_={colorsLight:C,colorsDark:w,layout:D.documentationLayout,theme:null==D||null===(l=D.customisation)||void 0===l||null===(r=l.appearance)||void 0===r?void 0:r.default,lightLogoUrl:this.state.lightThemeLogoUrl,darkLogoUrl:this.state.darkThemeLogoUrl,seoTitle:this.state.seoTitle,seoDescription:this.state.seoDescription};let x=p().reduce(R,((e,t,o)=>p().isEqual(t,_[o])?e:e.concat(o)),[]);return x=x.join("_"),V.default.addEventV2({category:U.DOCUMENTATION_ANALYTICS.CATEGORY,action:this.props.isCollectionPublished?"republish_documentation":"publish_documentation",label:x.length?x:"",entityType:U.DOCUMENTATION_ENTITY.COLLECTION,entityId:this.props.collectionUid}),D}catch(e){pm.logger.error("PublishSettingsPage~getPublishPayload: Failed to publish",e)}}getRequestPublishPayload(){var e,t;let o=this.state.selectedRequestedEnvironment,s=p().get(this.props.availableEnvironments,[o],{}),{owner:i,id:n}=p().pick(s,["id","owner"]),a=i&&n?`${i}-${n}`:null,l=this.state.selectedRequestedDomain,r=p().get(this.props.availableCustomDomains,[l],null),d=p().get(r,"id",null),c=null===(e=this.state.selectedRequestedVersions)||void 0===e?void 0:e.map((e=>e.value)),u={...p().pick(this.state.requestedCustomColorsLight,["top-bar","right-sidebar","highlight"])},h={...p().pick(this.state.requestedCustomColorsDark,["top-bar","right-sidebar","highlight"])},m=null!==(t=this.props.tokenScanId)&&void 0!==t?t:null,g=this.formatCustomColorsForPublishing(u),b=this.formatCustomColorsForPublishing(h),y={metaTags:[{name:"description",value:this.state.requestedSeoDescription},{name:"title",value:p().isEqual(this.state.requestedSeoTitle,this.props.collectionName)?null:this.state.requestedSeoTitle}],appearance:{default:this.state.requestedSelectedTheme.value,themes:[{name:"dark",logo:this.state.isRequestedCustomLogoDarkTheme?this.state.requestedDarkThemeLogoUrl:null,colors:b},{name:"light",logo:this.state.isRequestedCustomLogoLightTheme?this.state.requestedLightThemeLogoUrl:null,colors:g}]}};i=i||null;let v={environmentTemplateId:a,environmentOwner:i,customDomainId:d,customColor:g,versionTag:c,documentationLayout:this.state.requestedDocumentationLayout,customisation:y};return m&&(v.tokenScanId=m),v}onShareComplete(e,t,o){this.setState({isSharing:!1,triggerShare:!1});let s=this.getPublishPayload();p().set(s,"shareToWorkspace",{workspaceId:t,shared:!e,isEnvironmentMoved:o}),"function"==typeof this.props.publishButtonCallback&&this.props.publishButtonCallback(s)}handleRequestPublishButtonClick(){let e=this.getRequestPublishPayload();"function"==typeof this.props.requestPublishButtonCallback&&this.props.requestPublishButtonCallback(e,this.state.noteToCommunityManager)}handleThemeSelect(e){this.setState({selectedTheme:e},(()=>{this.handlePreview()}))}handleRequestedThemeSelect(e){this.setState({requestedSelectedTheme:e},(()=>{this.handlePreview()}))}handleRequestedEnvironmentSelect(e){let{owner:t,collectionId:o}=(0,_.getOptionsFromCollectionUid)(e.value);this.setState({selectedRequestedEnvironment:p().findIndex(this.props.availableEnvironments,{owner:t,id:o}),selectedRequestedEnvironmentDetails:p().find(this.props.availableEnvironments,{owner:t,id:o})},(()=>{this.handlePreview()}))}handleEnvironmentSelect(e){let{owner:t,collectionId:o}=(0,_.getOptionsFromCollectionUid)(e.value);this.setState({selectedEnvironment:p().findIndex(this.props.availableEnvironments,{owner:t,id:o}),selectedEnvironmentDetails:p().find(this.props.availableEnvironments,{owner:t,id:o})},(()=>{this.handlePreview()}))}async handleRequestedCustomDomainSelect(e){let t,o,s=this.props.availableCustomDomains,i=p().findIndex(s,{id:e.value}),n=s[i],a=p().get(s,[this.state.requestedDomainId,"id"],void 0),l=p().get(n,"id")===a,r=null!==p().get(n,"upstream")&&!l,d=p().get(n,"publishData.owner"),c=p().get(n,"publishData.collectionId"),u=(0,P.resolveStoreInstance)(R.default);e.value===G&&(r=!1),this.setState({selectedRequestedDomain:i,selectedDomainUnavailable:r});try{r&&(this.setState({domainUpstreamViewPermissionLoading:!0}),t={objectId:`${d}-${c}`,objectType:"collection",entityId:u.id,entityType:"user",permission:U.PERMISSIONS.VIEW_COLLECTION},o=await(0,j.fetchPermissions)({permissionQuery:t}),this.setState({domainUpstreamViewPermission:p().get(o,"permissionQuery.allowed"),domainUpstreamViewPermissionLoading:!1}))}catch(e){pm.logger.error("PublishSettingsPage~handleRequestedCustomDomainSelect: Failed to fetch collection view permission",e)}}async handleCustomDomainSelect(e){let t,o,s=this.props.availableCustomDomains,i=p().findIndex(s,{id:null==e?void 0:e.value}),n=s[i],a=p().get(s,[this.state.publishedDomainId,"id"],void 0),l=p().get(n,"id")===a,r=null!==p().get(n,"upstream")&&!l,d=p().get(n,"publishData.owner"),c=p().get(n,"publishData.collectionId"),u=(0,P.resolveStoreInstance)(R.default);e.value===G&&(r=!1),this.setState({selectedDomain:i,selectedDomainUnavailable:r});try{r&&(this.setState({domainUpstreamViewPermissionLoading:!0}),t={objectId:`${d}-${c}`,objectType:"collection",entityId:u.id,entityType:"user",permission:U.PERMISSIONS.VIEW_COLLECTION},o=await(0,j.fetchPermissions)({permissionQuery:t}),this.setState({domainUpstreamViewPermission:p().get(o,"permissionQuery.allowed"),domainUpstreamViewPermissionLoading:!1}))}catch(e){pm.logger.error("PublishSettingsPage~handleCustomDomainSelect: Failed to fetch collection view permission",e)}}getVersionDropdownPlaceholder(e,t){switch(e){case 0:return"";case 1:return t.label;default:return`Multiple Versions(${e})`}}handleRequestedVersionSelect(e){if(!e.length)return;let t=e.length,o=e[0],s=this.getVersionDropdownPlaceholder(t,o);this.setState({selectedRequestedVersions:e,requestedVersionsDropdownPlaceholder:s},(()=>{this.handlePreview()}))}handleVersionSelect(e){if(!e.length)return;let t=e.length,o=e[0],s=this.getVersionDropdownPlaceholder(t,o);this.setState({selectedVersions:e,versionsDropdownPlaceholder:s},(()=>{this.handlePreview()}))}getRequestedCustomDomainMenuItems(){let e=this.props.availableCustomDomains,t=p().get(this.props.availableCustomDomains,[this.state.requestedDomainId,"id"],void 0);if(e&&Array.isArray(e)&&e.length>0){let o=e.map((e=>{let o=e.id===t,s=null!==e.upstream&&!o,i=e.verified?"":"(unverified)",n=s?"(unavailable)":i;return{label:`${e.fqdn} ${n}`,value:e.id}}));return o.unshift({label:"No custom domain",value:G}),o}return[{label:"No custom domain",value:G}]}getCustomDomainMenuItems(){let e=this.props.availableCustomDomains,t=p().get(this.props.availableCustomDomains,[this.state.publishedDomainId,"id"],void 0);if(e&&Array.isArray(e)&&e.length>0){let o=e.map((e=>{let o=e.id===t,s=null!==e.upstream&&!o,i=e.verified?"":"(unverified)",n=s?"(unavailable)":i;return{label:`${e.fqdn} ${n}`,value:e.id}}));return o.unshift({label:"No custom domain",value:G}),o}return[{label:"No custom domain",value:G}]}getCollectionVersions(){let e=this.props.availableVersions;if(e&&Array.isArray(e)&&e.length){return e.map((e=>({label:e.name,value:e.id})))}return[{label:"CURRENT",value:"latest"}]}isRequestedColorInvalidLight(){return this.state.isRequestedColorInvalidLight.highlight||this.state.isRequestedColorInvalidLight["right-sidebar"]||this.state.isRequestedColorInvalidLight["top-bar"]}isRequestedColorInvalidDark(){return this.state.isRequestedColorInvalidDark.highlight||this.state.isRequestedColorInvalidDark["right-sidebar"]||this.state.isRequestedColorInvalidDark["top-bar"]}isColorInvalidLight(){return this.state.isColorInvalidLight.highlight||this.state.isColorInvalidLight["right-sidebar"]||this.state.isColorInvalidLight["top-bar"]}isColorInvalidDark(){return this.state.isColorInvalidDark.highlight||this.state.isColorInvalidDark["right-sidebar"]||this.state.isColorInvalidDark["top-bar"]}getRequestedDefaultColorLight(e){return this.props.requestedStylingLight.customColor&&this.props.requestedStylingLight.customColor[e]?this.props.requestedStylingLight.customColor[e]:U.THEME_DEFAULT_COLORS.LIGHT[e]}getRequestedDefaultColorDark(e){return this.props.requestedStylingDark.customColor&&this.props.requestedStylingDark.customColor[e]?this.props.requestedStylingDark.customColor[e]:U.THEME_DEFAULT_COLORS.DARK[e]}getDefaultColorLight(e){return this.props.publishedStylingLight.customColor&&this.props.publishedStylingLight.customColor[e]?this.props.publishedStylingLight.customColor[e]:U.THEME_DEFAULT_COLORS.LIGHT[e]}getDefaultColorDark(e){return this.props.publishedStylingDark.customColor&&this.props.publishedStylingDark.customColor[e]?this.props.publishedStylingDark.customColor[e]:U.THEME_DEFAULT_COLORS.DARK[e]}handleRequestedCustomColorChangeLight(e,t,o){(0,_.isHexColor)(o)?this.state.isRequestedColorInvalidLight[t]&&this.setState({isRequestedColorInvalidLight:{...this.state.isRequestedColorInvalidLight,[t]:!1}}):this.setState({isRequestedColorInvalidLight:{...this.state.isRequestedColorInvalidLight,[t]:!0}}),o=o.slice(1),this.setState({requestedCustomColorsLight:{...e,[t]:o}},(()=>{this.handlePreview()}))}handleRequestedCustomColorChangeDark(e,t,o){(0,_.isHexColor)(o)?this.state.isRequestedColorInvalidDark[t]&&this.setState({isRequestedColorInvalidDark:{...this.state.isRequestedColorInvalidDark,[t]:!1}}):this.setState({isRequestedColorInvalidDark:{...this.state.isRequestedColorInvalidDark,[t]:!0}}),o=o.slice(1),this.setState({requestedCustomColorsDark:{...e,[t]:o}},(()=>{this.handlePreview()}))}handleCustomColorChangeLight(e,t,o){(0,_.isHexColor)(o)?this.state.isColorInvalidLight[t]&&this.setState({isColorInvalidLight:{...this.state.isColorInvalidLight,[t]:!1}}):this.setState({isColorInvalidLight:{...this.state.isColorInvalidLight,[t]:!0}}),o=o.slice(1),this.setState({customColorsLight:{...e,[t]:o}},(()=>{this.handlePreview()}))}handleCustomColorChangeDark(e,t,o){(0,_.isHexColor)(o)?this.state.isColorInvalidDark[t]&&this.setState({isColorInvalidDark:{...this.state.isColorInvalidDark,[t]:!1}}):this.setState({isColorInvalidDark:{...this.state.isColorInvalidDark,[t]:!0}}),o=o.slice(1),this.setState({customColorsDark:{...e,[t]:o}},(()=>{this.handlePreview()}))}handleRequestedLayoutToggle(e){this.setState({requestedDocumentationLayout:e},(()=>{this.handlePreview()}))}handleLayoutToggle(e){this.setState({documentationLayout:e},(()=>{this.handlePreview()}))}formatCustomColorsForPublishing(e){return e&&Object.keys(e).length?(Object.keys(e).forEach((t=>{e[t]=(0,_.sanitiseHexColor)(e[t])})),e):e}handlePreview(e){if("browser"===window.SDK_PLATFORM){if(this.previewWindow&&!this.previewWindow.closed&&(0,M.getPostMessageSupport)(this.previewWindow,pm.config.get("__WP_DOCUMENTATION_PREVIEW_URL__")))return!this.props.isGovernance||!this.props.isCollectionPublishRequested&&this.props.isCommunityManager?this.updatePreviewWindow(pm.config.get("__WP_DOCUMENTATION_PREVIEW_URL__")):this.updateRequestPreviewWindow(pm.config.get("__WP_DOCUMENTATION_PREVIEW_URL__"));if(e===U.DOCUMENTATION_PUBLISHING.USER_PREVIEW_REQUEST){let e=!this.props.isGovernance||!this.props.isCollectionPublishRequested&&this.props.isCommunityManager?this.constructPreviewUrl():this.constructRequestPreviewUrl();this.previewWindow=window.open(e,"Preview",`height=${window.innerHeight},width=${window.innerWidth}`),V.default.addEventV2({category:U.DOCUMENTATION_ANALYTICS.CATEGORY,action:"preview_documentation",label:U.DOCUMENTATION_ANALYTICS.LABEL.PUBLISH_SETTINGS_TAB,entityType:U.DOCUMENTATION_ENTITY.COLLECTION,entityId:this.props.collectionUid})}}}updateRequestPreviewWindow(e){let t=this.props.availableEnvironments[this.state.selectedRequestedEnvironment],o=p().isNil(t)?void 0:`${t.owner}-${t.id}`,{versionTag:s,apiName:i,version:n}=this.getRequestedVersionsForPreview(),a=this.state.requestedDocumentationLayout,l=this.state.requestedSelectedTheme.value,r=this.state.requestedCustomColorsLight["top-bar"],d=this.state.requestedCustomColorsLight.highlight,c=this.state.requestedCustomColorsLight["right-sidebar"],u=this.state.requestedCustomColorsDark["top-bar"],h=this.state.requestedCustomColorsDark.highlight,m=this.state.requestedCustomColorsDark["right-sidebar"],g=this.state.requestedLightThemeLogoUrl,b=this.state.requestedDarkThemeLogoUrl,y={versionTag:s.map((e=>e.value)).join(","),apiName:i.join(","),version:n,"top-bar":r,"right-sidebar":c,highlight:d,"top-bar-dark":u,"right-sidebar-dark":m,"highlight-dark":h,environment:o,documentationLayout:a,documentationTheme:l,logo:g,logoDark:b};return this.previewWindow.postMessage(JSON.stringify(y),e)}updatePreviewWindow(e){let t=this.props.availableEnvironments[this.state.selectedEnvironment],o=p().isNil(t)?void 0:`${t.owner}-${t.id}`,{versionTag:s,apiName:i,version:n}=this.getVersionsForPreview(),a=this.state.documentationLayout,l=this.state.selectedTheme.value,r=this.state.customColorsLight["top-bar"],d=this.state.customColorsLight.highlight,c=this.state.customColorsLight["right-sidebar"],u=this.state.customColorsDark["top-bar"],h=this.state.customColorsDark.highlight,m=this.state.customColorsDark["right-sidebar"],g=this.state.lightThemeLogoUrl,b=this.state.darkThemeLogoUrl,y={versionTag:s.map((e=>e.value)).join(","),apiName:i.join(","),version:n,"top-bar":r,"right-sidebar":c,highlight:d,"top-bar-dark":u,"right-sidebar-dark":m,"highlight-dark":h,environment:o,documentationLayout:a,documentationTheme:l,logo:g,logoDark:b};return this.previewWindow.postMessage(JSON.stringify(y),e)}constructRequestPreviewUrl(){let e=this.props.collectionUid,t=this.props.availableEnvironments[this.state.selectedRequestedEnvironment],o=p().isNil(t)?void 0:`${t.owner}-${t.id}`,{versionTag:s,apiName:i,version:n}=this.getRequestedVersionsForPreview(),a=this.state.requestedDocumentationLayout,l=this.state.requestedSelectedTheme.value,r=[...Object.keys(this.state.requestedCustomColorsLight).map((e=>h().stringify({[e]:this.state.requestedCustomColorsLight[e]}))),...Object.keys(this.state.requestedCustomColorsDark).map((e=>h().stringify({[`${e}-dark`]:this.state.requestedCustomColorsDark[e]})))].join("&"),d=this.state.requestedLightThemeLogoUrl,c=this.state.requestedDarkThemeLogoUrl,u={environment:o,versionTag:s.map((e=>e.value)).join(","),apiName:i.join(","),version:n,documentationLayout:a,documentationTheme:l,logo:d,logoDark:c},m=[h().stringify(u),r].join("&"),g=[pm.config.get("__WP_DOCUMENTATION_PREVIEW_URL__"),"preview",e].join("/");return g+=`?${m}`,g}constructPreviewUrl(){let e=this.props.collectionUid,t=this.props.availableEnvironments[this.state.selectedEnvironment],o=p().isNil(t)?void 0:`${t.owner}-${t.id}`,{versionTag:s,apiName:i,version:n}=this.getVersionsForPreview(),a=this.state.documentationLayout,l=this.state.selectedTheme.value,r=[...Object.keys(this.state.customColorsLight).map((e=>h().stringify({[e]:this.state.customColorsLight[e]}))),...Object.keys(this.state.customColorsDark).map((e=>h().stringify({[`${e}-dark`]:this.state.customColorsDark[e]})))].join("&"),d=this.state.lightThemeLogoUrl,c=this.state.darkThemeLogoUrl,u={environment:o,versionTag:s.map((e=>e.value)).join(","),apiName:i.join(","),version:n,documentationLayout:a,documentationTheme:l,logo:d,logoDark:c},m=[h().stringify(u),r].join("&"),g=[pm.config.get("__WP_DOCUMENTATION_PREVIEW_URL__"),"preview",e].join("/");return g+=`?${m}`,g}getRequestedVersionsForPreview(){var e;let t=this.state.selectedRequestedVersions,o=[],s=null===(e=t[0])||void 0===e?void 0:e.value;return t.forEach((e=>{o.push(null==e?void 0:e.label)})),{versionTag:t,apiName:o,version:s}}getVersionsForPreview(){var e;let t=this.state.selectedVersions,o=[],s=null===(e=t[0])||void 0===e?void 0:e.value;return t.forEach((e=>{o.push(null==e?void 0:e.label)})),{versionTag:t,apiName:o,version:s}}componentDidUpdate(e){let{availableEnvironments:t,availableCustomDomains:o,requestedEnvironment:s,publishedEnvironment:i,requestedEnvironmentOwner:n,publishedEnvironmentOwner:a,requestedCustomDomain:l,publishedCustomDomain:r}=this.props||{},d=e.availableEnvironments,c=e.availableCustomDomains;JSON.stringify(t)===JSON.stringify(d)&&JSON.stringify(o)===JSON.stringify(c)||this.setState({selectedRequestedEnvironment:p().findIndex(t,{id:s,owner:n}),selectedEnvironment:p().findIndex(t,{id:i,owner:a}),selectedRequestedEnvironmentDetails:p().find(t,{id:s,owner:n}),selectedEnvironmentDetails:p().find(t,{id:i,owner:a}),selectedRequestedDomain:p().findIndex(o,{id:l}),selectedDomain:p().findIndex(o,{id:r})},(()=>{this.handlePreview()}))}handleNewLogoUpload(e,t,o){if(t){if((this.state.requestedLightThemeLogoUrl===U.DOCUMENTATION_PUBLISHING.DEFAULT_DOCUMENTATION_LOGO_URL&&this.state.requestedDarkThemeLogoUrl===U.DOCUMENTATION_PUBLISHING.DEFAULT_DOCUMENTATION_LOGO_URL||this.state.requestedLightThemeLogoUrl===this.props.teamLogoUrl&&this.state.requestedDarkThemeLogoUrl===this.props.teamLogoUrl)&&o)return void this.setState({requestedLightThemeLogoUrl:e,requestedDarkThemeLogoUrl:e,isRequestedCustomLogoLightTheme:!0,isRequestedCustomLogoDarkTheme:!0},(()=>{this.handlePreview()}));o?this.setState({requestedLightThemeLogoUrl:e,isRequestedCustomLogoLightTheme:!0},(()=>{this.handlePreview()})):this.setState({requestedDarkThemeLogoUrl:e,isRequestedCustomLogoDarkTheme:!0},(()=>{this.handlePreview()}))}else{if((this.state.lightThemeLogoUrl===U.DOCUMENTATION_PUBLISHING.DEFAULT_DOCUMENTATION_LOGO_URL&&this.state.darkThemeLogoUrl===U.DOCUMENTATION_PUBLISHING.DEFAULT_DOCUMENTATION_LOGO_URL||this.state.lightThemeLogoUrl===this.props.teamLogoUrl&&this.state.darkThemeLogoUrl===this.props.teamLogoUrl)&&o)return void this.setState({lightThemeLogoUrl:e,darkThemeLogoUrl:e,isCustomLogoLightTheme:!0,isCustomLogoDarkTheme:!0},(()=>{this.handlePreview()}));o?this.setState({lightThemeLogoUrl:e,isCustomLogoLightTheme:!0},(()=>{this.handlePreview()})):this.setState({darkThemeLogoUrl:e,isCustomLogoDarkTheme:!0},(()=>{this.handlePreview()}))}}handleDeleteLogo(e,t){try{var o,s;if(e===U.DOCUMENTATION_THEMES.LIGHT)t?this.setState({requestedLightThemeLogoUrl:null!==(o=this.props.teamLogoUrl)&&void 0!==o?o:U.DOCUMENTATION_PUBLISHING.DEFAULT_DOCUMENTATION_LOGO_URL,isRequestedCustomLogoLightTheme:!1},(()=>{this.handlePreview()})):this.setState({lightThemeLogoUrl:null!==(s=this.props.teamLogoUrl)&&void 0!==s?s:U.DOCUMENTATION_PUBLISHING.DEFAULT_DOCUMENTATION_LOGO_URL,isCustomLogoLightTheme:!1},(()=>{this.handlePreview()}));else if(e===U.DOCUMENTATION_THEMES.DARK){var i,n;t?this.setState({requestedDarkThemeLogoUrl:null!==(i=this.props.teamLogoUrl)&&void 0!==i?i:U.DOCUMENTATION_PUBLISHING.DEFAULT_DOCUMENTATION_LOGO_URL,isRequestedCustomLogoDarkTheme:!1},(()=>{this.handlePreview()})):this.setState({darkThemeLogoUrl:null!==(n=this.props.teamLogoUrl)&&void 0!==n?n:U.DOCUMENTATION_PUBLISHING.DEFAULT_DOCUMENTATION_LOGO_URL,isCustomLogoDarkTheme:!1},(()=>{this.handlePreview()}))}}catch(e){pm.logger.error("PublishSettingsPage~handleDeleteLogo: Error while deleting logo",e)}}render(){const{isOffline:e,collectionUid:t,collectionName:o,workspaceId:s,teamLogoUrl:n,availableCustomDomains:a,isPublishing:l,isCollectionPublished:d,isRequesting:u,isGovernance:h,isCommunityManager:m,isCollectionPublishRequested:P,isRequestApproving:R,isLimitReachedForPublish:_,isRepeatSpammer:M}=this.props,{selectedRequestedDomain:j,selectedDomain:V,selectedRequestedVersions:Y,selectedVersions:G,selectedRequestedEnvironment:$,selectedEnvironment:z,selectedRequestedEnvironmentDetails:K,selectedEnvironmentDetails:J,selectedDomainUnavailable:Q,requestedDomainId:X,publishedDomainId:Z,isRequestedColorInvalidLight:ee,isRequestedColorInvalidDark:te,isColorInvalidLight:oe,isColorInvalidDark:se,activeSidebarItem:ie,triggerShare:ne,isSharing:ae,versionsDropdownPlaceholder:le,requestedVersionsDropdownPlaceholder:re,requestedDocumentationLayout:de,documentationLayout:ce,domainUpstreamViewPermission:ue,domainUpstreamViewPermissionLoading:he,noteToCommunityManager:me,selectedTheme:pe,requestedSelectedTheme:ge,lightThemeLogoUrl:be,darkThemeLogoUrl:ye,requestedLightThemeLogoUrl:ve,requestedDarkThemeLogoUrl:Ee,seoTitle:fe,requestedSeoTitle:Ce,seoDescription:we,requestedSeoDescription:Te}=this.state;let De=this.state.customColorsLight,Se=this.state.customColorsDark,Ie=this.state.requestedCustomColorsLight,Ne=this.state.requestedCustomColorsDark,Le=this.getEnvironmentMenuItems(),ke=(Boolean(this.props.requestedEnvironment),Boolean(this.props.publishedEnvironment),p().get(this.props.environments,"loading",!1)),Oe=this.getRequestedCustomDomainMenuItems(),Pe=this.getCustomDomainMenuItems(),Re=p().get(this.props.customDomains,"loading",!1),_e=this.getCollectionVersions(),xe=-1===this.state.selectedRequestedEnvironment,Ae=-1===this.state.selectedEnvironment,qe=-1===this.state.selectedRequestedDomain,Ue=-1===this.state.selectedDomain,Me=h&&!m,je=h?m&&_&&!d:_&&!d;return i.createElement("div",{className:"documentation-publish-settings-page-customisation","data-testid":"documentation-publish-settings-page-customisation"},!M&&je&&i.createElement("div",{className:"documentation-publish-settings--limit-reached-banner","data-testid":"documentation-publish-settings--limit-reached-banner-container"},i.createElement(g.default,{status:"warning","data-testid":"documentation-publish-settings--limit-reached-banner"},i.createElement(b.default,null,"You've reached your limit to publish documentation. You can unpublish existing documentation in your team or contact support to increase the limit."))),i.createElement("div",{className:"documentation-publish-settings"},i.createElement("div",{className:"documentation-publish-settings-left-sidebar","data-testid":"documentation-publish-settings-left-sidebar"},i.createElement(y.default,{type:"h1",text:h&&P||Me?"Request Collection Documentation Publish":"Publish Collection Documentation",className:"documentation-publish-settings-left-sidebar--page-name","data-testid":"documentation-publish-settings-left-sidebar--page-name"}),i.createElement("p",{className:"documentation-publish-settings-left-sidebar--collection-name","data-testid":"documentation-publish-settings-left-sidebar--collection-name"},o),i.createElement(H.default,{activeItem:ie,heading:"Publish Collection Documentation",handlePreview:this.handlePreview,options:[{label:"Content",hash:"#content"},{label:"URL",hash:"#url"},{label:"Appearance",hash:"#styling"},{label:"SEO",hash:"#seo"}],onClick:e=>{this.setState({activeSidebarItem:e.hash})}})),h&&P||Me?i.createElement(i.Fragment,null,i.createElement("div",{className:"documentation-publish-settings-main-content"},i.createElement("div",{className:"documentation-publish-settings-main-content--content",id:"content"},i.createElement(y.default,{type:"h4",text:"Content",className:"documentation-publish-settings-main-content--main-label"}),i.createElement("div",{className:"content--versions"},i.createElement("div",{className:"content--dropdown"},i.createElement(v.default,{className:"dropdown-content--dropdown-menu content--versions--dropdown",value:Y,options:_e,onChange:this.handleRequestedVersionSelect,inlineLabel:re,placeholder:"Select versions",label:"Version",isSearchable:!1,menuMaxHeight:160}),i.createElement("div",{className:"content--helper-text"},"Select one or more collection states to publish. Learn more about",i.createElement(q.default,{to:"https://go.pstmn.io/public-documentation-versioning",className:"documentation-default-link",rel:"noopener noreferrer",target:"_blank"},i.createElement(b.default,{className:"documentation-default-link__text",type:"link-default",isExternal:!0},"versions"))))),i.createElement("div",{className:"content--environment"},i.createElement("div",{className:"content--dropdown"},i.createElement(E.default,{label:"Environment",className:c()({"documentation-dropdown":!0,"documentation-dropdown--publish-page":!0,"documentation-dropdown--empty":xe}),isDisabled:ke,options:Le,onChange:this.handleRequestedEnvironmentSelect,value:Le[$+1],isSearchable:!1,isClearable:!1,triggerWidth:392,menuWidth:392,menuMaxHeight:160}),i.createElement("div",{className:"content--helper-text"},"Select environment variables and values to publish along with the collection. Learn more about",i.createElement(q.default,{to:"https://learning.postman.com/docs/sending-requests/managing-environments/",rel:"noopener noreferrer",target:"_blank"},i.createElement(b.default,{type:"link-default",isExternal:!0},"managing your environment")))))),i.createElement("div",{className:"documentation-publish-settings-main-content--url",id:"url"},i.createElement(y.default,{type:"h4",text:"URL",className:"documentation-publish-settings-main-content--main-label url--heading"}),i.createElement("div",{className:"url--custom-domains"},i.createElement("div",{className:"content--dropdown"},i.createElement(E.default,{label:i.createElement(f.default,{text:"Custom Domain",fieldType:"optional"}),className:c()({"documentation-dropdown":!0,"documentation-dropdown--publish-page":!0,"documentation-dropdown--empty":qe}),isDisabled:Re,options:Oe,onChange:this.handleRequestedCustomDomainSelect,value:Oe[j+1],isSearchable:!1,isClearable:!1,triggerWidth:392,menuWidth:392,menuMaxHeight:160}),i.createElement("div",{className:"content--helper-text"},"Add a domain where you want to publish the collection documentation.")),i.createElement(A.default,{publishedDomainIndex:X,selectedDomainIndex:j,customDomains:a,domainUpstreamViewPermission:ue,domainUpstreamViewPermissionLoading:he}))),i.createElement("div",{className:"documentation-publish-settings-main-content--styling",id:"styling"},i.createElement(C.default,{alignItems:"center",gap:"spacing-s",className:"documentation-publish-settings-main-content--main-label"},i.createElement(y.default,{type:"h4",text:"Appearance"}),i.createElement(w.default,{text:"NEW",color:"purple"})),i.createElement(C.default,{alignItems:"flex-start",gap:"spacing-xxxl"},i.createElement(C.default,{direction:"column"},i.createElement("div",{className:"styling--layout"},i.createElement(C.default,{alignItems:"center",gap:"spacing-xs"},i.createElement(y.default,{type:"h6",text:"Default Layout"}),i.createElement(T.default,{content:"Your document will open in the selected layout by default. However, users can switch between layouts.",placement:"right"},i.createElement(k.default,null))),i.createElement("div",{className:"documentation-publish-settings-main-content--styling--layout\n                        plugin__workspace-view-switcher__wrapper\n                        plugin__workspace-view-switcher"},i.createElement(D.default,{direction:"column",value:de,onChange:this.handleRequestedLayoutToggle},i.createElement(S.default,{value:"classic-single-column",label:"Single column"}),i.createElement(S.default,{value:"classic-double-column",label:"Double column"})))),i.createElement("div",{className:"styling--theme"},i.createElement(C.default,{direction:"column",gap:"spacing-xs"},i.createElement(C.default,{alignItems:"center",gap:"spacing-xs"},i.createElement(y.default,{type:"h6",text:"Default Theme"}),i.createElement(T.default,{content:"Your document will open in the selected theme by default. However, users can switch between themes.",placement:"right"},i.createElement(k.default,null))),i.createElement(E.default,{options:U.THEME_MENU_OPTIONS,onChange:this.handleRequestedThemeSelect,value:ge,isSearchable:!1,isClearable:!1,triggerWidth:200,menuWidth:200}))),i.createElement(F.default,{onDeleteLogo:this.handleDeleteLogo,onNewLogoUpload:this.handleNewLogoUpload,isRequestedSettings:!0,customColorsLight:Ie,customColorsDark:Ne,lightThemeLogoUrl:ve,darkThemeLogoUrl:Ee,teamLogoUrl:n,modelDetails:{model:"public-documentation-logo",modelId:t}}),i.createElement("div",{className:"styling--colors"},i.createElement(C.default,{alignItems:"center",gap:"spacing-xs",className:"styling--colors--heading"},i.createElement(y.default,{type:"h6",text:"Colors"}),(!p().isEqual((0,r.toJS)(Ie),U.THEME_DEFAULT_COLORS.LIGHT)||!p().isEqual((0,r.toJS)(Ne),U.THEME_DEFAULT_COLORS.DARK))&&i.createElement(I.default,{onClick:()=>{this.setState({requestedCustomColorsLight:U.THEME_DEFAULT_COLORS.LIGHT,requestedCustomColorsDark:U.THEME_DEFAULT_COLORS.DARK,isRequestedColorInvalidLight:U.IS_COLOR_INVALID_STATE,isRequestedColorInvalidDark:U.IS_COLOR_INVALID_STATE})},type:"tertiary",icon:i.createElement(O.default,null),tooltip:i.createElement(T.default,{content:"Reset colors to default.",placement:"right"}),className:"styling--colors--heading--refresh"})),i.createElement(C.default,{direction:"column"},i.createElement(C.default,{alignItems:"center",padding:"spacing-zero spacing-l spacing-s spacing-l"},i.createElement(b.default,{type:"para",color:"content-color-secondary",className:"styling--colors--top-header"}),i.createElement(b.default,{type:"para",color:"content-color-secondary",className:"styling--colors--top-header"},"Light theme"),i.createElement(b.default,{type:"para",color:"content-color-secondary",className:"styling--colors--top-header"},"Dark theme")),i.createElement(C.default,{alignItems:"center",gap:"spacing-l"},i.createElement(b.default,{type:"body-small",color:"content-color-secondary",className:"styling--colors--header"},"Header background"),i.createElement(W.default,{colorHex:Ie["top-bar"],pristineColorHex:this.getRequestedDefaultColorLight("top-bar"),onColorChange:e=>{this.handleRequestedCustomColorChangeLight(Ie,"top-bar",e)},isColorInvalid:ee["top-bar"]}),i.createElement(W.default,{colorHex:Ne["top-bar"],pristineColorHex:this.getRequestedDefaultColorDark("top-bar"),onColorChange:e=>{this.handleRequestedCustomColorChangeDark(Ne,"top-bar",e)},isColorInvalid:te["top-bar"]})),i.createElement(C.default,{alignItems:"center",gap:"spacing-l"},i.createElement(b.default,{type:"body-small",color:"content-color-secondary",className:"styling--colors--code"},"Code background"),i.createElement(W.default,{colorHex:Ie["right-sidebar"],pristineColorHex:this.getRequestedDefaultColorLight("right-sidebar"),onColorChange:e=>{this.handleRequestedCustomColorChangeLight(Ie,"right-sidebar",e)},isColorInvalid:ee["right-sidebar"]}),i.createElement(W.default,{colorHex:Ne["right-sidebar"],pristineColorHex:this.getRequestedDefaultColorDark("right-sidebar"),onColorChange:e=>{this.handleRequestedCustomColorChangeDark(Ne,"right-sidebar",e)},isColorInvalid:te["right-sidebar"]})),i.createElement(C.default,{alignItems:"center",gap:"spacing-l"},i.createElement(b.default,{type:"body-small",color:"content-color-secondary",className:"styling--colors--highlight"},"Highlight"),i.createElement(W.default,{colorHex:Ie.highlight,pristineColorHex:this.getRequestedDefaultColorLight("highlight"),onColorChange:e=>{this.handleRequestedCustomColorChangeLight(Ie,"highlight",e)},isColorInvalid:ee.highlight}),i.createElement(W.default,{colorHex:Ne.highlight,pristineColorHex:this.getRequestedDefaultColorDark("highlight"),onColorChange:e=>{this.handleRequestedCustomColorChangeDark(Ne,"highlight",e)},isColorInvalid:te.highlight}))))),i.createElement(C.default,{direction:"column",gap:"spacing-xs",padding:"spacing-l",className:"styling--colors--container-preview"},i.createElement(C.default,{justifyContent:"flex-end",className:"styling--colors--container-preview--default"},i.createElement(w.default,{text:"DEFAULT",color:"blue",className:c()({"styling--colors--container-preview--default--tag":ge.value!==U.DOCUMENTATION_THEMES.LIGHT})})),i.createElement(x.default,{documentationLayout:de,highlightColor:ee.highlight?this.getRequestedDefaultColorLight("highlight"):Ie.highlight,sidebarColor:ee["right-sidebar"]?this.getRequestedDefaultColorLight("right-sidebar"):Ie["right-sidebar"],topBarColor:ee["top-bar"]?this.getRequestedDefaultColorLight("top-bar"):Ie["top-bar"],teamLogoUrl:ve,theme:"light"}),i.createElement(C.default,{justifyContent:"flex-end",className:"styling--colors--container-preview--default"},i.createElement(w.default,{text:"DEFAULT",color:"blue",className:c()({"styling--colors--container-preview--default--tag":ge.value!==U.DOCUMENTATION_THEMES.DARK})})),i.createElement(x.default,{documentationLayout:de,highlightColor:te.highlight?this.getRequestedDefaultColorDark("highlight"):Ne.highlight,sidebarColor:te["right-sidebar"]?this.getRequestedDefaultColorDark("right-sidebar"):Ne["right-sidebar"],topBarColor:te["top-bar"]?this.getRequestedDefaultColorDark("top-bar"):Ne["top-bar"],teamLogoUrl:Ee,theme:"dark"})))),i.createElement("div",{className:"documentation-publish-settings-main-content--seo",id:"seo"},i.createElement(y.default,{type:"h4",text:"SEO",className:"documentation-publish-settings-main-content--main-label seo--heading"}),i.createElement("div",{className:"seo--title"},i.createElement("div",{className:"content--dropdown"},i.createElement(C.default,{direction:"column",gap:"spacing-xs"},i.createElement(C.default,{justifyContent:"space-between"},i.createElement(C.default,{alignItems:"center",gap:"spacing-xs"},i.createElement(y.default,{type:"h6",text:"Title"}),i.createElement(T.default,{content:"Use less than 60 characters for titles to avoid truncation by search engines.",placement:"right"},i.createElement(k.default,null))),i.createElement(b.default,{color:"content-color-secondary"},`${null==Ce?void 0:Ce.length}/120`)),i.createElement(N.default,{placeholder:"Collection name will be used by default when no title is entered.",value:null!=Ce?Ce:"",onChange:e=>this.handleRequestedSeoTitle(e.target.value),width:"392px",maxLength:120})),i.createElement("div",{className:"content--helper-text"},"Add a title tag to indicate the content of your document that appears in relevant search queries and browser tabs."))),i.createElement("div",{className:"seo--description"},i.createElement("div",{className:"content--dropdown"},i.createElement(C.default,{direction:"column",gap:"spacing-xs"},i.createElement(C.default,{justifyContent:"space-between"},i.createElement(C.default,{alignItems:"center",gap:"spacing-xs"},i.createElement(y.default,{type:"h6",text:"Description"}),i.createElement(T.default,{content:"Use less than 160 characters for descriptions to avoid truncation by search engines.",placement:"right"},i.createElement(k.default,null))),i.createElement(b.default,{color:"content-color-secondary"},`${null==Te?void 0:Te.length}/320`)),i.createElement(C.default,{width:"392px"},i.createElement(L.default,{placeholder:"Add relevant keywords as descriptions to help users find your document. By default, the documentation content will be displayed in markdown format.",value:null!=Te?Te:"",onChange:(e,{charLimit:t})=>this.handleRequestedSeoDescription(e.target.value,t),maxLength:320}))),i.createElement("div",{className:"content--helper-text"},"Add a description tag to provide brief information about your document to let users know what it contains.")))),i.createElement("hr",null),!m&&i.createElement("div",{className:"documentation-publish-settings-main-content--governance",id:"governance"},i.createElement("div",{className:"governance--textarea"},i.createElement(C.default,{direction:"column",width:"392px",gap:"spacing-s"},i.createElement(L.default,{label:i.createElement(f.default,{text:"Include a note for the Community Manager"}),value:me,onChange:e=>this.handleNoteToCommunityManager(e.target.value),placeholder:"A small note on why you want to publish this collection documentation."})),i.createElement("div",{className:"governance--helper-text"},"Once a Community Manager approves your request, ",o," documentation will be made public."))),i.createElement("div",{className:"documentation-publish-settings-main-content--ctas"},i.createElement("div",{className:"documentation-publish-settings-main-content--ctas--buttons"},Me?i.createElement(I.default,{type:"primary",size:"medium",className:"publish-button",onClick:this.handleRequestPublishButtonClick,isLoading:u,isDisabled:Q||u||this.isRequestedColorInvalidLight()||this.isRequestedColorInvalidDark()||e,text:P?"Update Request":"Request to Publish"}):i.createElement(I.default,{type:"primary",size:"medium",className:"publish-button",onClick:this.handleApproveRequest,isLoading:R||ae,isDisabled:Q||R||ae||this.isRequestedColorInvalidLight()||this.isRequestedColorInvalidDark()||e||M||_&&!d,text:"Save and Approve",tooltip:_&&!d&&i.createElement(T.default,{content:"Youve reached your limit to publish documentation",placement:"top"})}),i.createElement(I.default,{type:"secondary",size:"medium",className:"publish-doc-cancel-button",onClick:this.handleCancel,text:"Cancel"})),i.createElement("div",{className:"content--helper-text"},!Me&&"Completing this step will make your collection available at a public URL.")))):i.createElement(i.Fragment,null,i.createElement("div",{className:"documentation-publish-settings-main-content"},i.createElement("div",{className:"documentation-publish-settings-main-content--content",id:"content"},i.createElement(y.default,{type:"h4",text:"Content",className:"documentation-publish-settings-main-content--main-label"}),i.createElement("div",{className:"content--versions"},i.createElement("div",{className:"content--dropdown"},i.createElement(v.default,{className:"dropdown-content--dropdown-menu content--versions--dropdown",value:G,options:_e,onChange:this.handleVersionSelect,inlineLabel:le,placeholder:"Select versions",label:"Version",isSearchable:!1,menuMaxHeight:160}),i.createElement("div",{className:"content--helper-text"},"Select one or more collection states to publish. Learn more about",i.createElement(q.default,{to:"https://go.pstmn.io/public-documentation-versioning",className:"documentation-default-link",rel:"noopener noreferrer",target:"_blank"},i.createElement(b.default,{className:"documentation-default-link__text",type:"link-default",isExternal:!0},"versions"))))),i.createElement("div",{className:"content--environment"},i.createElement("div",{className:"content--dropdown"},i.createElement(E.default,{label:"Environment",className:c()({"documentation-dropdown":!0,"documentation-dropdown--publish-page":!0,"documentation-dropdown--empty":Ae}),isDisabled:ke,options:Le,onChange:this.handleEnvironmentSelect,value:Le[z+1],isSearchable:!1,isClearable:!1,triggerWidth:392,menuWidth:392,menuMaxHeight:160}),i.createElement("div",{className:"content--helper-text"},"Select environment variables and values to publish along with the collection. Learn more about",i.createElement(q.default,{to:"https://learning.postman.com/docs/sending-requests/managing-environments/",rel:"noopener noreferrer",target:"_blank"},i.createElement(b.default,{type:"link-default",isExternal:!0},"managing your environment")))))),i.createElement("div",{className:"documentation-publish-settings-main-content--url",id:"url"},i.createElement(y.default,{type:"h4",text:"URL",className:"documentation-publish-settings-main-content--main-label url--heading"}),i.createElement("div",{className:"url--custom-domains"},i.createElement("div",{className:"content--dropdown"},i.createElement(E.default,{className:c()({"documentation-dropdown":!0,"documentation-dropdown--publish-page":!0,"documentation-dropdown--empty":Ue}),label:i.createElement(f.default,{text:"Custom Domain",fieldType:"optional"}),isDisabled:Re,options:Pe,onChange:this.handleCustomDomainSelect,value:Pe[V+1],isSearchable:!1,isClearable:!1,triggerWidth:392,menuWidth:392,menuMaxHeight:160}),i.createElement("div",{className:"content--helper-text"},"Add a domain where you want to publish the collection documentation.")),i.createElement(A.default,{publishedDomainIndex:Z,selectedDomainIndex:V,customDomains:a,domainUpstreamViewPermission:ue,domainUpstreamViewPermissionLoading:he}))),i.createElement("div",{className:"documentation-publish-settings-main-content--styling",id:"styling"},i.createElement(C.default,{alignItems:"center",gap:"spacing-s",className:"documentation-publish-settings-main-content--main-label"},i.createElement(y.default,{type:"h4",text:"Appearance"}),i.createElement(w.default,{text:"NEW",color:"purple"})),i.createElement(C.default,{alignItems:"flex-start",gap:"spacing-xxxl"},i.createElement(C.default,{direction:"column"},i.createElement("div",{className:"styling--layout"},i.createElement(C.default,{alignItems:"center",gap:"spacing-xs"},i.createElement(y.default,{type:"h6",text:"Default Layout"}),i.createElement(T.default,{content:"Your document will open in the selected layout by default. However, users can switch between layouts.",placement:"right"},i.createElement(k.default,null))),i.createElement("div",{className:"documentation-publish-settings-main-content--styling--layout\n                        plugin__workspace-view-switcher__wrapper\n                        plugin__workspace-view-switcher"},i.createElement(D.default,{direction:"column",value:ce,onChange:this.handleLayoutToggle},i.createElement(S.default,{value:"classic-single-column",label:"Single column"}),i.createElement(S.default,{value:"classic-double-column",label:"Double column"})))),i.createElement("div",{className:"styling--theme"},i.createElement(C.default,{direction:"column",gap:"spacing-xs"},i.createElement(C.default,{alignItems:"center",gap:"spacing-xs"},i.createElement(y.default,{type:"h6",text:"Default Theme"}),i.createElement(T.default,{content:"Your document will open in the selected theme by default. However, users can switch between themes.",placement:"right"},i.createElement(k.default,null))),i.createElement(E.default,{options:U.THEME_MENU_OPTIONS,onChange:this.handleThemeSelect,value:pe,isSearchable:!1,isClearable:!1,triggerWidth:200,menuWidth:200}))),i.createElement(F.default,{onDeleteLogo:this.handleDeleteLogo,onNewLogoUpload:this.handleNewLogoUpload,isRequestedSettings:!1,customColorsLight:De,customColorsDark:Se,lightThemeLogoUrl:be,darkThemeLogoUrl:ye,teamLogoUrl:n,modelDetails:{model:"public-documentation-logo",modelId:t}}),i.createElement("div",{className:"styling--colors"},i.createElement(C.default,{alignItems:"center",gap:"spacing-xs",className:"styling--colors--heading"},i.createElement(y.default,{type:"h6",text:"Colors"}),(!p().isEqual((0,r.toJS)(De),U.THEME_DEFAULT_COLORS.LIGHT)||!p().isEqual((0,r.toJS)(Se),U.THEME_DEFAULT_COLORS.DARK))&&i.createElement(I.default,{onClick:()=>{this.setState({customColorsLight:U.THEME_DEFAULT_COLORS.LIGHT,customColorsDark:U.THEME_DEFAULT_COLORS.DARK,isColorInvalidLight:U.IS_COLOR_INVALID_STATE,isColorInvalidDark:U.IS_COLOR_INVALID_STATE})},type:"tertiary",icon:i.createElement(O.default,null),tooltip:i.createElement(T.default,{content:"Reset colors to default.",placement:"right"}),className:"styling--colors--heading--refresh"})),i.createElement(C.default,{direction:"column"},i.createElement(C.default,{alignItems:"center",padding:"spacing-zero spacing-l spacing-s spacing-l"},i.createElement(b.default,{type:"para",color:"content-color-secondary",className:"styling--colors--top-header"}),i.createElement(b.default,{type:"para",color:"content-color-secondary",className:"styling--colors--top-header"},"Light theme"),i.createElement(b.default,{type:"para",color:"content-color-secondary",className:"styling--colors--top-header"},"Dark theme")),i.createElement(C.default,{alignItems:"center",gap:"spacing-l"},i.createElement(b.default,{type:"body-small",color:"content-color-secondary",className:"styling--colors--header"},"Header background"),i.createElement(W.default,{colorHex:De["top-bar"],pristineColorHex:this.getDefaultColorLight("top-bar"),onColorChange:e=>{this.handleCustomColorChangeLight(De,"top-bar",e)},isColorInvalid:oe["top-bar"]}),i.createElement(W.default,{colorHex:Se["top-bar"],pristineColorHex:this.getDefaultColorDark("top-bar"),onColorChange:e=>{this.handleCustomColorChangeDark(Se,"top-bar",e)},isColorInvalid:se["top-bar"]})),i.createElement(C.default,{alignItems:"center",gap:"spacing-l"},i.createElement(b.default,{type:"body-small",color:"content-color-secondary",className:"styling--colors--code"},"Code background"),i.createElement(W.default,{colorHex:De["right-sidebar"],pristineColorHex:this.getDefaultColorLight("right-sidebar"),onColorChange:e=>{this.handleCustomColorChangeLight(De,"right-sidebar",e)},isColorInvalid:oe["right-sidebar"]}),i.createElement(W.default,{colorHex:Se["right-sidebar"],pristineColorHex:this.getDefaultColorDark("right-sidebar"),onColorChange:e=>{this.handleCustomColorChangeDark(Se,"right-sidebar",e)},isColorInvalid:se["right-sidebar"]})),i.createElement(C.default,{alignItems:"center",gap:"spacing-l"},i.createElement(b.default,{type:"body-small",color:"content-color-secondary",className:"styling--colors--highlight"},"Highlight"),i.createElement(W.default,{colorHex:De.highlight,pristineColorHex:this.getDefaultColorLight("highlight"),onColorChange:e=>{this.handleCustomColorChangeLight(De,"highlight",e)},isColorInvalid:oe.highlight}),i.createElement(W.default,{colorHex:Se.highlight,pristineColorHex:this.getDefaultColorDark("highlight"),onColorChange:e=>{this.handleCustomColorChangeDark(Se,"highlight",e)},isColorInvalid:se.highlight}))))),i.createElement(C.default,{direction:"column",gap:"spacing-xl",padding:"spacing-l",className:"styling--colors--container-preview"},i.createElement(C.default,{justifyContent:"flex-end",className:"styling--colors--container-preview--default"},i.createElement(w.default,{text:"DEFAULT",color:"blue",className:c()({"styling--colors--container-preview--default--tag":pe.value!==U.DOCUMENTATION_THEMES.LIGHT})})),i.createElement(x.default,{documentationLayout:ce,highlightColor:oe.highlight?this.getDefaultColorLight("highlight"):De.highlight,sidebarColor:oe["right-sidebar"]?this.getDefaultColorLight("right-sidebar"):De["right-sidebar"],topBarColor:oe["top-bar"]?this.getDefaultColorLight("top-bar"):De["top-bar"],teamLogoUrl:be,theme:"light"}),i.createElement(C.default,{justifyContent:"flex-end",className:"styling--colors--container-preview--default"},i.createElement(w.default,{text:"DEFAULT",color:"blue",className:c()({"styling--colors--container-preview--default--tag":pe.value!==U.DOCUMENTATION_THEMES.DARK})})),i.createElement(x.default,{documentationLayout:ce,highlightColor:se.highlight?this.getDefaultColorDark("highlight"):Se.highlight,sidebarColor:se["right-sidebar"]?this.getDefaultColorDark("right-sidebar"):Se["right-sidebar"],topBarColor:se["top-bar"]?this.getDefaultColorDark("top-bar"):Se["top-bar"],teamLogoUrl:ye,theme:"dark"})))),i.createElement("div",{className:"documentation-publish-settings-main-content--seo",id:"seo"},i.createElement(y.default,{type:"h4",text:"SEO",className:"documentation-publish-settings-main-content--main-label seo--heading"}),i.createElement("div",{className:"seo--title"},i.createElement("div",{className:"content--dropdown"},i.createElement(C.default,{direction:"column",gap:"spacing-xs"},i.createElement(C.default,{justifyContent:"space-between"},i.createElement(C.default,{alignItems:"center",gap:"spacing-xs"},i.createElement(y.default,{type:"h6",text:"Title"}),i.createElement(T.default,{content:"Use less than 60 characters for titles to avoid truncation by search engines.",placement:"right"},i.createElement(k.default,null))),i.createElement(b.default,{color:"content-color-secondary"},`${null==fe?void 0:fe.length}/120`)),i.createElement(N.default,{placeholder:"Collection name will be used by default when no title is entered.",value:null!=fe?fe:"",onChange:e=>this.handleSeoTitle(e.target.value),width:"392px",maxLength:120})),i.createElement("div",{className:"content--helper-text"},"Add a title tag to indicate the content of your document that appears in relevant search queries and browser tabs."))),i.createElement("div",{className:"seo--description"},i.createElement("div",{className:"content--dropdown"},i.createElement(C.default,{direction:"column",gap:"spacing-xs"},i.createElement(C.default,{justifyContent:"space-between"},i.createElement(C.default,{alignItems:"center",gap:"spacing-xs"},i.createElement(y.default,{type:"h6",text:"Description"}),i.createElement(T.default,{content:"Use less than 160 characters for descriptions to avoid truncation by search engines.",placement:"right"},i.createElement(k.default,null))),i.createElement(b.default,{color:"content-color-secondary"},`${null==we?void 0:we.length}/320`)),i.createElement(C.default,{width:"392px"},i.createElement(L.default,{placeholder:"Add relevant keywords as descriptions to help users find your document. By default, the documentation content will be displayed in markdown format.",value:null!=we?we:"",onChange:(e,{charLimit:t})=>this.handleSeoDescription(e.target.value,t),maxLength:320}))),i.createElement("div",{className:"content--helper-text"},"Add a description tag to provide brief information about your document to let users know what it contains.")))),!h&&i.createElement(B.default,{triggerShare:ne,collectionUid:t,collectionName:o,onShareComplete:this.onShareComplete,workspaceId:s,selectedEnvironment:J}),i.createElement("hr",null),Me&&i.createElement("div",{className:"documentation-publish-settings-main-content--governance",id:"governance"},i.createElement("div",{className:"governance--textarea"},i.createElement(C.default,{direction:"column",width:"392px",gap:"spacing-s"},i.createElement(L.default,{label:i.createElement(f.default,{text:"Include a note for the Community Manager"}),value:me,onChange:e=>this.handleNoteToCommunityManager(e.target.value),placeholder:"A small note on why you want to publish this collection documentation."})),i.createElement("div",{className:"governance--helper-text"},"Once a Community Manager approves your request, ",o," documentation will be made public."))),i.createElement("div",{className:"documentation-publish-settings-main-content--ctas"},i.createElement("div",{className:"documentation-publish-settings-main-content--ctas--buttons"},Me?i.createElement(I.default,{type:"primary",size:"medium",className:"publish-button",onClick:this.handleRequestPublishButtonClick,isLoading:u,isDisabled:Q||u||this.isColorInvalidLight()||this.isColorInvalidDark()||e,text:P?"Update Request":"Request to Publish"}):i.createElement(I.default,{type:"primary",size:"medium",className:"publish-button",onClick:this.handlePublishButtonClick,isLoading:l||ae,isDisabled:Q||l||ae||this.isColorInvalidLight()||this.isColorInvalidDark()||e||M||_&&!d,text:d?"Save and republish":"Publish",tooltip:M?i.createElement(T.default,{content:"We've temporarily blocked you from publishing documents as your content did not meet our community standards. Please try again later or contact support.",placement:"top"}):_&&!d?i.createElement(T.default,{content:"Youve reached your limit to publish documentation",placement:"top"}):""}),i.createElement(I.default,{type:"secondary",size:"medium",className:"publish-doc-cancel-button",onClick:this.handleCancel,text:"Cancel"})),i.createElement("div",{className:"content--helper-text"},"Completing this step will make your collection available at a public URL."))))))}})||s;z.propTypes={publishButtonCallback:a().func.isRequired,cancelButtonCallback:a().func.isRequired,collectionName:a().string.isRequired,workspaceId:a().string.isRequired,availableVersions:a().array,availableEnvironments:a().array,availableCustomDomains:a().array,publishedStylingLight:a().object,publishedVersions:a().object,publishedEnvironment:a().string,publishedEnvironmentOwner:a().string,publishedCustomDomain:a().number,teamLogoUrl:a().string,isOffline:a().bool},z.defaultProps={availableVersions:[{key:"latest",label:"CURRENT"}]},t.default=(0,Y.withErrorBoundary)(z,U.DOCUMENTATION_ERROR_TYPE.PUBLISH_FLOW.TITLE,U.DOCUMENTATION_ERROR_TYPE.PUBLISH_FLOW.MESSAGE,{addIllustration:!0,containerStyles:{minHeight:"300px",justifyContent:"center",alignItems:"center"}})},"./documentation/components/DocumentationPublishView/DocumentationPublishFlows/PublishedStatusPage.js":function(e,t,o){"use strict";o.r(t),o.d(t,{PublishedStatusPage:function(){return j}});var s,i=o("../../node_modules/react/index.js"),n=o("./node_modules/prop-types/index.js"),a=o.n(n),l=o("../../node_modules/mobx-react/dist/mobx-react.module.js"),r=o("./node_modules/classnames/index.js"),d=o.n(r),c=o("../../node_modules/@postman/aether/esmLib/src/components/Banner/Banner.js"),u=o("../../node_modules/@postman/aether/esmLib/src/components/Text/Text.js"),h=o("../../node_modules/@postman/aether/esmLib/src/components/Flex/Flex.js"),m=o("../../node_modules/@postman/aether/esmLib/src/components/Heading/Heading.js"),p=o("../../node_modules/@postman/aether/esmLib/src/components/Badge/Badge.js"),g=o("../../node_modules/@postman/aether/esmLib/src/components/Button/Button.js"),b=o("../../node_modules/@postman/aether/esmLib/src/components/Tooltip/Tooltip.js"),y=o("../../node_modules/@postman/aether/esmLib/src/components/Modal/Modal.js"),v=o("../../node_modules/@postman/aether/esmLib/src/components/Table/Table.js"),E=o("../../node_modules/@postman/aether/esmLib/src/components/TextArea/TextArea.js"),f=o("../../node_modules/@postman/aether/esmLib/src/components/Label/Label.js"),C=o("../../node_modules/@postman/aether/esmLib/src/components/Tag/Tag.js"),w=o("./node_modules/querystring-browser/querystring.js"),T=o.n(w),D=o("../../node_modules/@postman/aether-icons/esmLib/src/design-system-icons/icon-direction-back small.js"),S=o("../../node_modules/@postman/aether-icons/esmLib/src/design-system-icons/icon-descriptive-quote-stroke.js"),I=o("../../node_modules/@postman/aether-icons/esmLib/src/design-system-icons/icon-action-lock-stroke-small.js"),N=o("./documentation/components/DocumentationPublishView/DocumentationPublishFlows/PublishedViewPreviewPage.js"),L=o("./appsdk/components/link/Link.js"),k=o("./js/services/NavigationService.js"),O=o("./js/components/base/Modals.js"),P=o("./apinetwork/services/PublicProfileService.js"),R=o("./documentation/constants.js"),_=o("./iam/src/common/styled-components/CopyButton.js"),x=o("./js/utils/ClipboardHelper.js"),A=o("./js/modules/services/AnalyticsService.js"),q=o("./documentation/hocs/withErrorBoundary.js"),U=o("./documentation/components/DocumentationPublishView/PublishedViewPreview.js"),M=o("./node_modules/lodash/lodash.js");let j=(0,l.observer)(s=class extends i.Component{constructor(e){super(e),this.handleEditSettings=()=>{const{editSettingsButtonCallback:e}=this.props;"function"==typeof e&&e(),A.default.addEventV2({category:R.DOCUMENTATION_ANALYTICS.CATEGORY,action:"edit_settings",label:R.DOCUMENTATION_ANALYTICS.LABEL.PUBLISHED_STATUS_TAB,entityType:R.DOCUMENTATION_ENTITY.COLLECTION,entityId:this.props.collectionUid})},this.handleUnpublish=()=>{const{unPublishButtonCallback:e}=this.props;"function"==typeof e&&e(),A.default.addEventV2({category:R.DOCUMENTATION_ANALYTICS.CATEGORY,action:"unpublish_documentation",label:R.DOCUMENTATION_ANALYTICS.LABEL.PUBLISHED_STATUS_TAB,entityType:R.DOCUMENTATION_ENTITY.COLLECTION,entityId:this.props.collectionUid})},this.handleApproveRequest=()=>{const{approveRequestButtonCallback:e,collectionPublishRequestCode:t}=this.props;let o=this.getRequestPayload();"function"==typeof e&&e(o,t),A.default.addEventV2({category:R.DOCUMENTATION_ANALYTICS.CATEGORY,action:"approve_request",label:this.props.isViewOnlyStatusPage?R.DOCUMENTATION_ANALYTICS.LABEL.PRIVATE_WORKSPACE:R.DOCUMENTATION_ANALYTICS.LABEL.PUBLIC_WORKSPACE,entityType:R.DOCUMENTATION_ENTITY.COLLECTION,entityId:this.props.collectionUid})},this.handleDenyRequest=()=>{this.setState({showDenyConfirmationModal:!1});const{denyRequestButtonCallback:e,collectionPublishRequestCode:t}=this.props;"function"==typeof e&&e(this.state.denyRequestNote,t),A.default.addEventV2({category:R.DOCUMENTATION_ANALYTICS.CATEGORY,action:"deny_request",label:this.props.isViewOnlyStatusPage?R.DOCUMENTATION_ANALYTICS.LABEL.PRIVATE_WORKSPACE:R.DOCUMENTATION_ANALYTICS.LABEL.PUBLIC_WORKSPACE,entityType:R.DOCUMENTATION_ENTITY.COLLECTION,entityId:this.props.collectionUid})},this.handleRetractRequest=()=>{this.setState({showRetractConfirmationModal:!1});const{retractRequestButtonCallback:e,collectionPublishRequestCode:t}=this.props;"function"==typeof e&&e(t),A.default.addEventV2({category:R.DOCUMENTATION_ANALYTICS.CATEGORY,action:"retract_request_status",label:this.props.isViewOnlyStatusPage?R.DOCUMENTATION_ANALYTICS.LABEL.PRIVATE_WORKSPACE:R.DOCUMENTATION_ANALYTICS.LABEL.PUBLIC_WORKSPACE,entityType:R.DOCUMENTATION_ENTITY.COLLECTION,entityId:this.props.collectionUid})},this.state={showCollectionDiscovery:!1,collectionType:null,apinetworkData:{},modalOpen:!1,modalLoading:!1,showRetractConfirmationModal:!1,showDenyConfirmationModal:!1,denyRequestNote:"",showBanner:!0,showTokenFailureBanner:!0,showNoTokensBanner:!0,showExposedTokensModal:!1,isFetchingScanAgainResult:!1},this.handleModalToggle=this.handleModalToggle.bind(this),this.handleRemoveFromPublicAPINetwork=this.handleRemoveFromPublicAPINetwork.bind(this),this.handleCopyButtonClick=this.handleCopyButtonClick.bind(this),this.handleDismissBanner=this.handleDismissBanner.bind(this),this.handleDismissNoTokensBanner=this.handleDismissNoTokensBanner.bind(this),this.handleDismissTokenFailureBanner=this.handleDismissTokenFailureBanner.bind(this),this.showExposedTokensModal=this.showExposedTokensModal.bind(this),this.hideExposedTokensModal=this.hideExposedTokensModal.bind(this),this.handleScanAgain=this.handleScanAgain.bind(this),this.handlePreview=this.handlePreview.bind(this),this.constructPreviewUrl=this.constructPreviewUrl.bind(this),this.constructRequestPreviewUrl=this.constructRequestPreviewUrl.bind(this),this.getVersionsForPreview=this.getVersionsForPreview.bind(this)}getVersionsForPreview(e){try{var t;let o=e,s=[],i=null===(t=o[0])||void 0===t?void 0:t.versionTagId;return o.forEach((e=>{s.push(null==e?void 0:e.apiName)})),{versionTag:o,apiName:s,version:i}}catch(e){pm.logger.error("PublishedStatusPage~getVersionsForPreview: Error getting versions for preview",e)}}constructRequestPreviewUrl(){try{var e,t,o,s,i,n,a,l,r,d,c,u,h;let{requestData:m}=this.props,p=M.get(m,"data.body.data[0]",{}),{modelId:g}=p,{environmentTemplateId:b,customColor:y,versions:v,documentationLayout:E,customisation:f}=p.metadata,C=f?null==f||null===(e=f.appearance)||void 0===e?void 0:e.default:void 0,w=f?null==f||null===(t=f.appearance)||void 0===t||null===(o=t.themes)||void 0===o||null===(s=o.find((e=>"light"===e.name)))||void 0===s?void 0:s.logo:this.props.teamLogoUrl,D=f?null==f||null===(i=f.appearance)||void 0===i||null===(n=i.themes)||void 0===n||null===(a=n.find((e=>"dark"===e.name)))||void 0===a?void 0:a.logo:void 0,S=f?null==f||null===(l=f.appearance)||void 0===l||null===(r=l.themes)||void 0===r||null===(d=r.find((e=>"light"===e.name)))||void 0===d?void 0:d.colors:y,I=f?null==f||null===(c=f.appearance)||void 0===c||null===(u=c.themes)||void 0===u||null===(h=u.find((e=>"dark"===e.name)))||void 0===h?void 0:h.colors:void 0,N=g,L=null!=b?b:void 0,{versionTag:k,apiName:O,version:P}=this.getVersionsForPreview(v),R=(f?[...Object.keys(S).map((e=>T().stringify({[e]:S[e]}))),...Object.keys(I).map((e=>T().stringify({[`${e}-dark`]:I[e]})))]:[...Object.keys(S).map((e=>T().stringify({[e]:S[e]})))]).join("&"),_={environment:L,versionTag:k.map((e=>e.versionTagId)).join(","),apiName:O.join(","),version:P,documentationLayout:E,documentationTheme:C,logo:w,logoDark:D},x=[T().stringify(_),R].join("&"),A=[pm.config.get("__WP_DOCUMENTATION_PREVIEW_URL__"),"preview",N].join("/");return A+=`?${x}`,A}catch(e){pm.logger.error("PublishedStatusPage~constructRequestPreviewUrl: Error constructing preview url",e)}}constructPreviewUrl(){try{var e,t,o,s,i,n,a,l,r,d,c,u,h;let{publishedData:m}=this.props,p=M.get(m,"data.body.collections[0]",{}),{collectionId:g}=p,{environmentTemplateId:b,customColor:y,versions:v,documentationLayout:E,customisation:f,owner:C}=p,w=f?null==f||null===(e=f.appearance)||void 0===e?void 0:e.default:void 0,D=f?null==f||null===(t=f.appearance)||void 0===t||null===(o=t.themes)||void 0===o||null===(s=o.find((e=>"light"===e.name)))||void 0===s?void 0:s.logo:this.props.teamLogoUrl,S=f?null==f||null===(i=f.appearance)||void 0===i||null===(n=i.themes)||void 0===n||null===(a=n.find((e=>"dark"===e.name)))||void 0===a?void 0:a.logo:void 0,I=f?null==f||null===(l=f.appearance)||void 0===l||null===(r=l.themes)||void 0===r||null===(d=r.find((e=>"light"===e.name)))||void 0===d?void 0:d.colors:y,N=f?null==f||null===(c=f.appearance)||void 0===c||null===(u=c.themes)||void 0===u||null===(h=u.find((e=>"dark"===e.name)))||void 0===h?void 0:h.colors:void 0,L=`${C}-${g}`,k=null!=b?b:void 0,{versionTag:O,apiName:P,version:R}=this.getVersionsForPreview(v),_=(f?[...Object.keys(I).map((e=>T().stringify({[e]:I[e]}))),...Object.keys(N).map((e=>T().stringify({[`${e}-dark`]:N[e]})))]:[...Object.keys(I).map((e=>T().stringify({[e]:I[e]})))]).join("&"),x={environment:k,versionTag:O.map((e=>e.versionTagId)).join(","),apiName:P.join(","),version:R,documentationLayout:E,documentationTheme:w,logo:D,logoDark:S},A=[T().stringify(x),_].join("&"),q=[pm.config.get("__WP_DOCUMENTATION_PREVIEW_URL__"),"preview",L].join("/");return q+=`?${A}`,q}catch(e){pm.logger.error("PublishedStatusPage~constructPreviewUrl: Error constructing preview url",e)}}handlePreview(e){try{if("browser"!==window.SDK_PLATFORM)return;if(e===R.DOCUMENTATION_PUBLISHING.USER_PREVIEW_REQUEST){let e=this.props.isGovernance&&this.props.isCollectionPublishRequested?this.constructRequestPreviewUrl():this.constructPreviewUrl();this.previewWindow=window.open(e,"Preview",`height=${window.innerHeight},width=${window.innerWidth}`),A.default.addEventV2({category:R.DOCUMENTATION_ANALYTICS.CATEGORY,action:"preview_documentation",label:R.DOCUMENTATION_ANALYTICS.LABEL.PUBLISHED_STATUS_TAB,entityType:R.DOCUMENTATION_ENTITY.COLLECTION,entityId:this.props.collectionUid})}}catch(e){pm.logger.error("PublishedStatusPage~handlePreview: Error handling preview",e)}}async componentDidMount(){const{publishedId:e}=this.props;try{const t=await Promise.all([P.default.getApiNetwork({publishedId:e}),P.default.getTemplate({publishedId:e})]),o=M.get(t,"0.body.data[0]"),s=M.get(t,"1.body.data[0]");o?this.setState({showCollectionDiscovery:!0,collectionType:"apinetwork",apinetworkData:o}):s&&this.setState({showCollectionDiscovery:!0,collectionType:"template",apinetworkData:s})}catch(e){pm.logger.error("PublishedStatusPage~componentDidMount - Error while fetching apinetwork data",e)}}getRequestedVersionNames(){let e=this.props.requestedVersions;return(Array.isArray(e)&&e.map((e=>e.label))||[]).join(", ")}getVersionNames(){let e=this.props.publishedVersions;return(Array.isArray(e)&&e.map((e=>e.label))||[]).join(", ")}handleModalToggle(){this.setState((e=>({modalOpen:!e.modalOpen})))}getRequestPayload(){var e,t,o,s,i,n,a,l;let{requestData:r}=this.props,d=M.get(r,"data.body.data[0]",{}),{modelId:c}=d,{environmentTemplateId:u,environmentOwner:h,customDomainId:m,customColor:p,versionTag:g,documentationLayout:b,customisation:y}=d.metadata,v=y?null===(e=y)||void 0===e||null===(t=e.appearance)||void 0===t||null===(o=t.themes)||void 0===o||null===(s=o.find((e=>e.name===R.DOCUMENTATION_THEMES.LIGHT)))||void 0===s?void 0:s.colors:p,E=this.props.requestedSeoDescription,f=M.isEmpty(this.props.collectionName)?this.props.requestedCollectionName:this.props.collectionName,C=M.isEqual(this.props.requestedSeoTitle,f)?null:this.props.requestedSeoTitle,w=null===(i=this.props.requestedStylingLight)||void 0===i?void 0:i.logoUrl,T=null===(n=this.props.requestedStylingDark)||void 0===n?void 0:n.logoUrl,D=null===(a=this.props.requestedStylingLight)||void 0===a?void 0:a.isCustomLogo,S=null===(l=this.props.requestedStylingDark)||void 0===l?void 0:l.isCustomLogo;y||(y={metaTags:[{name:"description",value:E},{name:"title",value:C}],appearance:{default:R.DOCUMENTATION_THEMES.LIGHT,themes:[{name:"dark",logo:S?T:null,colors:R.THEME_DEFAULT_COLORS.DARK},{name:"light",logo:D?w:null,colors:v}]}});let I=r&&{uid:c,environmentTemplateId:u,environmentOwner:h,customDomainId:m,customColor:v,versionTag:g,documentationLayout:b,customisation:y};const N=this.props.tokenScanId?this.props.tokenScanId:null;return N?{...I,tokenScanId:N}:I}async handleRemoveFromPublicAPINetwork(){this.setState({modalLoading:!0});try{const{collectionType:e,apinetworkData:t}=this.state,o=M.get(t,"id","");"apinetwork"===e?await P.default.removeApiNetwork({id:o}):await P.default.removeTemplate({id:o}),this.setState({modalLoading:!1,showCollectionDiscovery:!1,collectionType:"",apinetworkData:{},modalOpen:!1}),pm.toasts.success("Successfully removed collection from Public API Network")}catch(e){pm.toasts.error("Could not remove collection from Public API Network"),pm.logger.error("PublishedStatusPage~handleRemoveFromPublicAPINetwork - Error while removing collection",e),this.setState({modalLoading:!1})}}handleDenyRequestNote(e){this.setState({denyRequestNote:e})}handleDismissBanner(){this.setState({showBanner:!1})}handleDismissNoTokensBanner(){this.setState({showNoTokensBanner:!1})}handleDismissTokenFailureBanner(){this.setState({showTokenFailureBanner:!1})}showExposedTokensModal(){this.setState({showExposedTokensModal:!0})}hideExposedTokensModal(){this.setState({showExposedTokensModal:!1})}async handleScanAgain(){this.setState({isFetchingScanAgainResult:!0});let e=this.getRequestPayload();try{"function"==typeof this.props.requestPublishButtonCallback&&await this.props.requestPublishButtonCallback(e,this.props.noteToCommunityManager,!0)}catch(e){pm.logger.error("PublishedStatusPage~handleScanAgain: Unable to scan again",e)}finally{this.setState({isFetchingScanAgainResult:!1})}}handleCopyButtonClick(){const{publishedUrl:e}=this.props;x.default.copy(e),pm.toasts.success("Published documentation's URL copied to clipboard successfully.")}render(){var e,t,o,s;const{isOffline:n,isUnpublishing:a,collectionName:l,requestedCollectionName:r,teamLogoUrl:w,requestedEnvironment:T,publishedEnvironment:P,publishedUrl:x,isCollectionPublishRequested:q,noteToCommunityManager:j,isCommunityManager:B,isGovernance:V,isRequestRetracting:F,isRequestDenying:W,isRequestApproving:H,isViewOnlyStatusPage:Y,isLimitReachedForPublish:G,isCollectionPublished:$,exposedTokensData:z,tokenScanId:K,tokenScanStatus:J,isFetchingScanData:Q,fetchScanData:X,seoTitle:Z,requestedSeoTitle:ee,seoDescription:te,requestedSeoDescription:oe,isCustomisationPublish:se}=this.props,{collectionType:ie,modalOpen:ne,modalLoading:ae,showBanner:le,showNoTokensBanner:re,showTokenFailureBanner:de,isFetchingScanAgainResult:ce}=this.state;let ue=M.get(this.props.publishedStylingLight,"documentationLayout"),he=M.get(this.props.requestedStylingLight,"documentationLayout"),me=M.get(this.props.requestedStylingLight,"customColor",{}),pe=M.get(this.props.requestedStylingDark,"customColor",{}),ge=null===(e=this.props.requestedStylingLight)||void 0===e?void 0:e.logoUrl,be=null===(t=this.props.requestedStylingDark)||void 0===t?void 0:t.logoUrl,ye=M.get(this.props.publishedStylingLight,"customColor",{}),ve=M.get(this.props.publishedStylingDark,"customColor",{}),Ee=null===(o=this.props.publishedStylingDark)||void 0===o?void 0:o.logoUrl,fe=null===(s=this.props.publishedStylingLight)||void 0===s?void 0:s.logoUrl,Ce=M.get(this.state.apinetworkData,"publicURL",""),we=M.get(this.state.apinetworkData,"team")?M.get(this.state.apinetworkData,"team.publicURL",""):M.get(this.state.apinetworkData,"publishedBy.publicURL","");return i.createElement("div",{className:"documentation-publish-status-page-customisation"},i.createElement("div",{"data-testid":"documentation-published-status",className:"documentation-published-status"},V&&q&&B&&G&&!$&&i.createElement("div",{className:"documentation-published-status-body--limit-reached-banner"},i.createElement(c.default,{status:"warning"},i.createElement(u.default,null,"You've reached your limit to publish documentation. You can unpublish existing documentation in your team or contact support to increase the limit."))),!Y&&i.createElement(L.default,{to:{routeIdentifier:"documentation.openWithWsSelect",routeParams:{collectionUid:this.props.collectionUid}},className:"documentation-published-breadcrumbs"},i.createElement(h.default,{alignItems:"center",gap:"spacing-xs","data-testid":"documentation-published-status__breadcrumb"},i.createElement(D.default,null),i.createElement(u.default,{type:"para","data-testid":"documentation-published-status__breadcrumb__text"},M.isEmpty(this.props.collectionName)?this.props.requestedCollectionName:this.props.collectionName))),V&&q?i.createElement(i.Fragment,null,i.createElement("div",{className:"documentation-published-status-header"},i.createElement(h.default,{alignItems:"center",gap:"spacing-s"},i.createElement(m.default,{type:"h2",text:"Publication Settings"}),i.createElement(p.default,{status:"neutral",text:"in review"})),i.createElement("div",{className:"documentation-published-status-header--buttons"},"browser"===window.SDK_PLATFORM&&!Y&&q&&i.createElement(g.default,{type:"outline",size:"medium",className:"edit-settings-button",onClick:()=>{this.handlePreview(R.DOCUMENTATION_PUBLISHING.USER_PREVIEW_REQUEST)},text:"Preview"}),i.createElement(g.default,{type:"outline",size:"medium",className:"edit-settings-button",isDisabled:a||Y,onClick:this.handleEditSettings,text:"Edit Settings",tooltip:(a||Y)&&i.createElement(b.default,{content:"You do not have access to the underlying collection.",placement:"top"})}),q?!B&&i.createElement(i.Fragment,null,i.createElement(g.default,{type:"outline",size:"medium",className:"unpublish-button",isDisabled:F||n,isLoading:F,onClick:()=>{this.setState({showRetractConfirmationModal:!0})},text:"Withdraw request"}),i.createElement(y.Modal,{isOpen:this.state.showRetractConfirmationModal,onClose:()=>this.setState({showRetractConfirmationModal:!1})},i.createElement(y.ModalHeader,{heading:"Withdraw Request?"}),i.createElement(y.ModalContent,null,"Are you sure you want to withdraw the request to publish this collection's documentation?"),i.createElement(y.ModalFooter,null,i.createElement(h.default,{justifyContent:"flex-end",grow:1,shrink:1,gap:"spacing-s"},i.createElement(g.default,{type:"secondary",text:"Cancel",onClick:()=>this.setState({showRetractConfirmationModal:!1})}),i.createElement(g.default,{type:"destructive",text:"Confirm",onClick:()=>{this.handleRetractRequest()}}))))):i.createElement(g.default,{type:"outline",size:"medium",className:`unpublish-button ${(V&&!B||a||n)&&"unpublish-button--disabled"}`,isDisabled:V&&!B||a||n,tooltip:V&&!B&&"Only community manager can unpublish this documentation.",isLoading:a,onClick:this.handleUnpublish,text:"Unpublish"}))),i.createElement("hr",null),i.createElement("div",{className:"documentation-published-status-body"},Y&&le&&!K&&i.createElement("div",{className:"documentation-published-status-body--private-collection-banner"},i.createElement(c.default,{status:"warning",onDismiss:this.handleDismissBanner},"You don't have access to the underlying collection.")),i.createElement("div",{"data-testid":"documentation-published-status-body--token-banners",className:"documentation-published-status-body--token-banners"},!K||"IN_PROGRESS"!==J&&"STARTING"!==J?"SUCCESSFUL"===J?z.length>0?i.createElement(c.default,{"data-testid":"documentation-published-status-body--token-banners--warning-complete",status:"warning",primaryAction:i.createElement(g.default,{type:"outline",text:"View Secrets",onClick:this.showExposedTokensModal,"data-testid":"documentation-published-status-body--token-banners--warning-complete-view-secrets"}),title:"Secret scanning complete",secondaryAction:!Y&&i.createElement(g.default,{type:"monochrome-plain",text:"Scan Again",onClick:this.handleScanAgain,isLoading:ce,tooltip:"Restart secret scanning if you have made changes to the collection.","data-testid":"documentation-published-status-body--token-banners--warning-complete-scan-again"})},"Secret scanner detected ",z.length," exposed ",z.length>1?"secrets":"secret",". Once the request to publish is approved, these secrets will be visible to anyone with the URL to access the documentation."):re&&i.createElement(c.default,{"data-testid":"documentation-published-status-body--token-banners--success-complete",title:"Secret scanning complete",status:"success",onDismiss:this.handleDismissNoTokensBanner,secondaryAction:!Y&&i.createElement(g.default,{type:"monochrome-plain",text:"Scan Again",onClick:this.handleScanAgain,isLoading:ce,tooltip:"Restart secret scanning if you have made changes to the collection.","data-testid":"documentation-published-status-body--token-banners--success-complete-scan-again"})},"The collection has no exposed secrets."):"FAILURE"===J&&de&&i.createElement(c.default,{"data-testid":"documentation-published-status-body--token-banners--failure",status:"error",title:"Secret scanning failed",onDismiss:this.handleDismissTokenFailureBanner,primaryAction:!Y&&i.createElement(g.default,{"data-testid":"documentation-published-status-body--token-banners--failed-restart",type:"outline",text:"Restart",isLoading:ce,onClick:this.handleScanAgain})},Y?"":"Restart secret scanning to ensure there are no exposed secrets. The scan result will show up soon."):i.createElement(c.default,{"data-testid":"documentation-published-status-body--token-banners--warning-progress",status:"warning",title:"Secret scanning in progress",primaryAction:i.createElement(g.default,{type:"outline",text:"Refresh",isLoading:Q,onClick:()=>X(),"data-testid":"documentation-published-status-body--token-banners--warning-progress-refresh"})},"We're scanning this collection now to ensure there are no exposed secrets. Refresh in some time to see the report."),i.createElement(y.Modal,{isOpen:this.state.showExposedTokensModal,onClose:()=>this.hideExposedTokensModal(),size:"small","data-testid":"documentation-published-status-body--token-scan-modal"},i.createElement(y.ModalHeader,{"data-testid":"documentation-published-status-body--token-scan-modal-header",heading:"Exposed Secrets"}),i.createElement(y.ModalContent,null,i.createElement(c.default,{status:"warning"},"We've listed ",z.length," exposed ",z.length>1?"secrets":"secret"," based on the",i.createElement(L.default,{to:"https://learning.postman.com/docs/administration/token-scanner/",target:"_blank"},i.createElement(u.default,{type:"link-default"},"secret formats supported by Postman")),". Please check the collection for other undetected secrets before publishing its documentation."),i.createElement(v.default,{data:z,columns:[{Header:"Secret name",accessor:"tokenType",cellWidth:"144px"},{Header:"Secret value",accessor:"obfuscatedToken",cellWidth:"144px"},{Header:"Occurrence",accessor:"occurrences",cellWidth:"92px"}],bodyMaxHeight:"183px","data-testid":"documentation-published-status-body--token-scan-modal-content--table"})),!Y&&i.createElement(y.ModalFooter,null,i.createElement(h.default,{justifyContent:"flex-end",grow:1,shrink:1,gap:"spacing-s"},i.createElement(g.default,{type:"secondary",text:"Cancel",onClick:()=>this.hideExposedTokensModal()}),i.createElement(g.default,{type:"primary",text:"View in Collection",onClick:()=>{var e,t;k.default.transitionTo("build.collection",{cid:null===(e=this.props)||void 0===e?void 0:e.collectionUid,wid:null===(t=this.props)||void 0===t?void 0:t.workspaceId}),this.hideExposedTokensModal()}}))))),(B||!M.isEmpty(j))&&i.createElement(h.default,{direction:"column",gap:"spacing-s",className:"documentation-published-status-body--note",border:{border:"border-width-default"},borderRadius:"border-radius-default",padding:"spacing-xl"},i.createElement(u.default,{color:"content-color-primary",typographyStyle:{fontSize:"text-size-m",fontWeight:"text-weight-bold",lineHeight:"line-height-m",fontFamily:"text-family-default"}},B?`Review request to publish ${M.isEmpty(l)?r:l} documentation`:`You have requested to publish ${M.isEmpty(l)?r:l} documentation.`),M.isEmpty(j)?i.createElement(u.default,{type:"para"},"The requester hasnt added any notes for this request. Reach out to them to know more."):i.createElement(i.Fragment,null,i.createElement(u.default,{color:"content-color-secondary",typographyStyle:{fontSize:"text-size-m",fontWeight:"text-weight-bold",lineHeight:"line-height-m",fontFamily:"text-family-default"}},B?"Requester notes":"Request notes"),i.createElement(h.default,{gap:"spacing-m",className:"documentation-published-status-body--content--note-to-cm"},i.createElement(i.Fragment,null,i.createElement(S.default,{color:"content-color-info"}),i.createElement(u.default,{type:"para"},j)))),q&&B&&i.createElement(h.default,{justifyContent:"flex-end",gap:"spacing-m",padding:"spacing-m spacing-zero spacing-zero spacing-zero"},i.createElement(g.default,{type:"primary",size:"medium",className:"approve-button",isDisabled:H||n||G&&!$,isLoading:H,onClick:this.handleApproveRequest,text:"Approve",tooltip:G&&!$&&i.createElement(b.default,{content:"Youve reached your limit to publish documentation",placement:"top"})}),i.createElement(g.default,{type:"secondary",size:"medium",className:"deny-button",isDisabled:W||n,isLoading:W,onClick:()=>{this.setState({showDenyConfirmationModal:!0})},text:"Deny"}),i.createElement(y.Modal,{isOpen:this.state.showDenyConfirmationModal,onClose:()=>this.setState({showDenyConfirmationModal:!1})},i.createElement(y.ModalHeader,{heading:"Deny Request?"}),i.createElement(y.ModalContent,null,"Are you sure you want to deny the request to publish this collection's documentation?"),i.createElement(h.default,{direction:"column",gap:"spacing-s",padding:"spacing-xl"},i.createElement(E.default,{label:i.createElement(f.default,{text:"Add a note"}),rows:3,value:this.state.denyRequestNote,onChange:e=>this.handleDenyRequestNote(e.target.value),placeholder:"Enter the reason to deny the publish request."})),i.createElement(y.ModalFooter,null,i.createElement(h.default,{justifyContent:"flex-end",grow:1,shrink:1,gap:"spacing-s"},i.createElement(g.default,{type:"secondary",text:"Cancel",onClick:()=>this.setState({showDenyConfirmationModal:!1})}),i.createElement(g.default,{type:"destructive",text:"Confirm",onClick:()=>{this.handleDenyRequest()}})))))),i.createElement("div",{className:"documentation-published-status-body--content"},i.createElement(h.default,{alignItems:"center",gap:"spacing-xs"},i.createElement(m.default,{text:"Collection details",type:"h4",className:"documentation-published-status-body--label"}),Y&&B&&i.createElement(b.default,{content:"You do not have access to the underlying collection.",placement:"right"},i.createElement(I.default,null))),i.createElement(h.default,{direction:"column",gap:"spacing-xs",className:"documentation-published-status-body--content--collection-name"},i.createElement(m.default,{text:"Collection name",type:"h6",className:"documentation-published-status-body--label"}),i.createElement(u.default,{className:"documentation-published-status-body--content--collection-name--value",type:"para"},M.isEmpty(l)?r:l)),i.createElement(h.default,{direction:"column",gap:"spacing-xs",className:"documentation-published-status-body--content--versions"},i.createElement(m.default,{text:"Versions",type:"h6",className:"documentation-published-status-body--label"}),i.createElement(u.default,{className:"documentation-published-status-body--content--versions--value",type:"para"},this.getRequestedVersionNames())),i.createElement(h.default,{direction:"column",gap:"spacing-xs",className:"documentation-published-status-body--environment"},i.createElement(m.default,{text:"Environment",type:"h6",className:"documentation-published-status-body--label"}),i.createElement(u.default,{className:"documentation-published-status-body--content--environment",type:"para"},T)),i.createElement(h.default,{direction:"column",gap:"spacing-xs",className:"documentation-published-status-body--seo"},i.createElement(m.default,{text:"SEO",type:"h6",className:"documentation-published-status-body--label"}),i.createElement(u.default,{className:"documentation-published-status-body--content--seo-heading",type:"body-medium"},"Title"),i.createElement(u.default,{className:"documentation-published-status-body--content--seo",type:"para"},M.isEmpty(ee)?M.isEmpty(this.props.collectionName)?this.props.requestedCollectionName:this.props.collectionName:ee),i.createElement(u.default,{className:"documentation-published-status-body--content--seo-heading",type:"body-medium"},"Description"),i.createElement(u.default,{color:M.isEmpty(oe)&&"content-color-tertiary",className:"documentation-published-status-body--content--seo",type:"para"},M.isEmpty(oe)?"The requester hasnt added a description tag. By default, the documentation content will be displayed in markdown format.":oe))),i.createElement("div",{className:"documentation-published-status-body--styling"},i.createElement(m.default,{text:"Styling",type:"h6",className:"documentation-published-status-body--label"}),i.createElement(h.default,{gap:"spacing-xl",padding:"spacing-l",className:"documentation-published-status-body--container-preview"},i.createElement(h.default,{direction:"column",gap:"spacing-xs",className:"documentation-published-status-body--container-preview--wrapper"},i.createElement(h.default,{justifyContent:"flex-end",className:"documentation-published-status-body--container-preview--default"},i.createElement(C.default,{text:"DEFAULT",color:"blue",className:d()({"documentation-published-status-body--container-preview--default--tag":this.props.requestedDefaultTheme!==R.DOCUMENTATION_THEMES.LIGHT})})),i.createElement(N.default,{documentationLayout:he,highlightColor:me.highlight,sidebarColor:me["right-sidebar"],topBarColor:me["top-bar"],teamLogoUrl:ge,theme:"light"})),i.createElement(h.default,{direction:"column",gap:"spacing-xs",className:"documentation-published-status-body--container-preview--wrapper"},i.createElement(h.default,{justifyContent:"flex-end",className:"documentation-published-status-body--container-preview--default"},i.createElement(C.default,{text:"DEFAULT",color:"blue",className:d()({"documentation-published-status-body--container-preview--default--tag":this.props.requestedDefaultTheme!==R.DOCUMENTATION_THEMES.DARK})})),i.createElement(N.default,{documentationLayout:he,highlightColor:pe.highlight,sidebarColor:pe["right-sidebar"],topBarColor:pe["top-bar"],teamLogoUrl:be,theme:"dark"})))),this.state.showCollectionDiscovery&&i.createElement("div",{className:"documentation-published-status-body--collection-discovery"},i.createElement("div",{className:"documentation-published-status-body--heading"},i.createElement(m.default,{type:"h2",text:"Collection Discovery"}),i.createElement(g.default,{onClick:this.handleModalToggle,type:"text",text:"Remove from Public API Network"})),i.createElement("div",{className:"documentation-published-status-body--collection-discovery__section"},i.createElement(m.default,{type:"h4",text:"template"===ie?"Postman templates":"Postman API Network"}),i.createElement(u.default,{type:"body-medium",color:"content-color-primary"},"Your listing is published on the Public API Network at"," ",i.createElement("br",null),i.createElement(L.default,{to:Ce,target:"_blank"},Ce))),i.createElement("div",{className:"documentation-published-status-body--collection-discovery__section"},i.createElement(m.default,{type:"h4",text:"Publisher Profile"}),i.createElement(u.default,{type:"body-medium",color:"content-color-primary"},"Your public profile is ",i.createElement(L.default,{to:we,target:"_blank"},we),". All your published work can be found here")))),i.createElement(O.Modal,{isOpen:ne,onRequestClose:this.handleModalToggle,className:"documentation-published-status-modal"},i.createElement(O.ModalHeader,null,"Remove from Public API Network"),i.createElement(O.ModalContent,null,i.createElement(u.default,{type:"body-large",color:"content-color-primary"},"Are you sure you want to remove this collection from the Public API network? ",i.createElement("br",null),"This collection would still be available through the published documentation but not discoverable through the API Network.")),i.createElement(O.ModalFooter,null,i.createElement(g.default,{type:"primary",className:"documentation-published-status-modal__remove-btn",onClick:this.handleRemoveFromPublicAPINetwork,isDisabled:ae,text:"Remove from Public API Network"}),i.createElement(g.default,{type:"secondary",onClick:this.handleModalToggle,isDisabled:ae,text:"Cancel"})))):i.createElement(i.Fragment,null,i.createElement("div",{className:"documentation-published-status-header","data-testid":"documentation-published-status-header"},i.createElement(h.default,{alignItems:"center",gap:"spacing-s","data-testid":"documentation-published-status-header__heading"},i.createElement(m.default,{type:"h2",text:"Publication Settings","data-testid":"documentation-published-status-header__heading__text"}),i.createElement(p.default,{status:"success",text:"published","data-testid":"documentation-published-status-header__heading__badge"})),i.createElement("div",{className:"documentation-published-status-header--buttons","data-testid":"documentation-published-status-header--buttons"},i.createElement(g.default,{type:"outline",size:"medium",className:"edit-settings-button",isDisabled:a||Y,onClick:this.handleEditSettings,text:"Edit Settings",tooltip:(a||Y)&&i.createElement(b.default,{content:"You do not have access to the underlying collection.",placement:"top"}),"data-testid":"documentation-published-status-header--buttons__edit-settings"}),i.createElement(g.default,{type:"outline",size:"medium",className:`unpublish-button ${(V&&!B||a||n)&&"unpublish-button--disabled"}`,isDisabled:a||n||V&&!B,tooltip:V&&!B&&"Only community manager can unpublish this documentation.",isLoading:a,onClick:this.handleUnpublish,text:"Unpublish","data-testid":"documentation-published-status-header--buttons__unpublish"}))),i.createElement("hr",null),i.createElement("div",{className:"documentation-published-status-body","data-testid":"documentation-published-status-body"},i.createElement("div",{className:"documentation-published-status-body--content","data-testid":"documentation-published-status-body--content"},i.createElement(m.default,{text:"Collection details",type:"h4",className:"documentation-published-status-body--label","data-testid":"documentation-published-status-body--content--collection-details"}),i.createElement("div",{className:"documentation-published-status-body--url","data-testid":"documentation-published-status-body--url"},i.createElement(m.default,{text:"URL for published documentation",type:"h6",className:"documentation-published-status-body--label","data-testid":"documentation-published-status-body--url--heading"}),i.createElement(h.default,{alignItems:"center","data-testid":"documentation-published-status-body--url--link"},i.createElement(L.default,{to:x,onClick:()=>{A.default.addEventV2({category:R.DOCUMENTATION_ANALYTICS.CATEGORY,action:"click_published_url",label:R.DOCUMENTATION_ANALYTICS.LABEL.PUBLISHED_STATUS_TAB,entityType:R.DOCUMENTATION_ENTITY.COLLECTION,entityId:this.props.collectionUid})},target:"_blank"},x),i.createElement("span",{className:"documentation-published-status-body--copy-to-clipboard","data-testid":"documentation-published-status-body--copy-to-clipboard"},i.createElement(_.default,{type:"muted-plain",icon:"icon-action-copy-stroke",onClick:this.handleCopyButtonClick,tooltip:"Copy to clipboard"})))),i.createElement(h.default,{direction:"column",gap:"spacing-xs",className:"documentation-published-status-body--content--collection-name","data-testid":"documentation-published-status-body--content--collection-name"},i.createElement(m.default,{text:"Collection name",type:"h6",className:"documentation-published-status-body--label","data-testid":"documentation-published-status-body--content--collection-name--heading"}),i.createElement(u.default,{className:"documentation-published-status-body--content--collection-name--value",type:"para","data-testid":"documentation-published-status-body--content--collection-name--text"},l)),i.createElement(h.default,{direction:"column",gap:"spacing-xs",className:"documentation-published-status-body--content--versions","data-testid":"documentation-published-status-body--content--versions"},i.createElement(m.default,{text:"Versions",type:"h6",className:"documentation-published-status-body--label","data-testid":"documentation-published-status-body--content--versions--heading"}),i.createElement(u.default,{className:"documentation-published-status-body--content--versions--value",type:"para","data-testid":"documentation-published-status-body--content--versions--text"},this.getVersionNames())),i.createElement(h.default,{direction:"column",gap:"spacing-xs",className:"documentation-published-status-body--environment","data-testid":"documentation-published-status-body--environment"},i.createElement(m.default,{text:"Environment",type:"h6",className:"documentation-published-status-body--label","data-testid":"documentation-published-status-body--environment--heading"}),i.createElement(u.default,{className:"documentation-published-status-body--content--environment",type:"para","data-testid":"documentation-published-status-body--environment--text"},P)),i.createElement(h.default,{direction:"column",gap:"spacing-xs",className:"documentation-published-status-body--seo","data-testid":"documentation-published-status-body--seo"},i.createElement(m.default,{text:"SEO",type:"h6",className:"documentation-published-status-body--label","data-testid":"documentation-published-status-body--seo--heading"}),i.createElement(u.default,{className:"documentation-published-status-body--content--seo-heading",type:"body-medium","data-testid":"documentation-published-status-body--seo--title-heading"},"Title"),i.createElement(u.default,{className:"documentation-published-status-body--content--seo",type:"para","data-testid":"documentation-published-status-body--seo--title-text"},M.isEmpty(Z)?M.isEmpty(this.props.collectionName)?this.props.requestedCollectionName:this.props.collectionName:Z),i.createElement(u.default,{className:"documentation-published-status-body--content--seo-heading",type:"body-medium","data-testid":"documentation-published-status-body--seo--description-heading"},"Description"),i.createElement(u.default,{color:M.isEmpty(te)&&"content-color-tertiary",className:"documentation-published-status-body--content--seo",type:"para","data-testid":"documentation-published-status-body--seo--description-text"},M.isEmpty(te)?"You havet added a description tag. By default, the documentation content will be displayed in markdown format.":te))),i.createElement("div",{className:"documentation-published-status-body--styling","data-testid":"documentation-published-status-body--styling"},i.createElement(m.default,{text:"Styling",type:"h6",className:"documentation-published-status-body--label","data-testid":"documentation-published-status-body--styling--heading"}),se?i.createElement(h.default,{gap:"spacing-xl",padding:"spacing-l",className:"documentation-published-status-body--container-preview"},i.createElement(h.default,{direction:"column",gap:"spacing-xs",className:"documentation-published-status-body--container-preview--wrapper"},i.createElement(h.default,{justifyContent:"flex-end",className:"documentation-published-status-body--container-preview--default"},i.createElement(C.default,{text:"DEFAULT",color:"blue",className:d()({"documentation-published-status-body--container-preview--default--tag":this.props.defaultTheme!==R.DOCUMENTATION_THEMES.LIGHT}),"data-testid":this.props.defaultTheme===R.DOCUMENTATION_THEMES.LIGHT&&"documentation-published-status-body--container-preview--default--tag--light"})),i.createElement(N.default,{documentationLayout:ue,highlightColor:ye.highlight,sidebarColor:ye["right-sidebar"],topBarColor:ye["top-bar"],teamLogoUrl:fe,theme:"light"})),i.createElement(h.default,{direction:"column",gap:"spacing-xs",className:"documentation-published-status-body--container-preview--wrapper"},i.createElement(h.default,{justifyContent:"flex-end",className:"documentation-published-status-body--container-preview--default"},i.createElement(C.default,{text:"DEFAULT",color:"blue",className:d()({"documentation-published-status-body--container-preview--default--tag":this.props.defaultTheme!==R.DOCUMENTATION_THEMES.DARK}),"data-testid":this.props.defaultTheme===R.DOCUMENTATION_THEMES.DARK&&"documentation-published-status-body--container-preview--default--tag--dark"})),i.createElement(N.default,{documentationLayout:ue,highlightColor:ve.highlight,sidebarColor:ve["right-sidebar"],topBarColor:ve["top-bar"],teamLogoUrl:Ee,theme:"dark"}))):i.createElement(h.default,{gap:"spacing-xl",padding:"spacing-l",className:"documentation-published-status-body--container-preview"},i.createElement(U.default,{documentationLayout:ue,highlightColor:ye.highlight,sidebarColor:ye["right-sidebar"],topBarColor:ye["top-bar"],teamLogoUrl:fe}))),this.state.showCollectionDiscovery&&i.createElement("div",{className:"documentation-published-status-body--collection-discovery"},i.createElement("div",{className:"documentation-published-status-body--heading"},i.createElement(m.default,{type:"h2",text:"Collection Discovery"}),i.createElement(g.default,{onClick:this.handleModalToggle,type:"text",text:"Remove from Public API Network"})),i.createElement("div",{className:"documentation-published-status-body--collection-discovery__section"},i.createElement(m.default,{type:"h4",text:"template"===ie?"Postman templates":"Postman API Network"}),i.createElement(u.default,{type:"body-medium",color:"content-color-primary"},"Your listing is published on the Public API Network at"," ",i.createElement("br",null),i.createElement(L.default,{to:Ce,target:"_blank"},Ce))),i.createElement("div",{className:"documentation-published-status-body--collection-discovery__section"},i.createElement(m.default,{type:"h4",text:"Publisher Profile"}),i.createElement(u.default,{type:"body-medium",color:"content-color-primary"},"Your public profile is ",i.createElement(L.default,{to:we,target:"_blank"},we),". All your published work can be found here")))),i.createElement(O.Modal,{isOpen:ne,onRequestClose:this.handleModalToggle,className:"documentation-published-status-modal"},i.createElement(O.ModalHeader,null,"Remove from Public API Network"),i.createElement(O.ModalContent,null,i.createElement(u.default,{type:"body-large",color:"content-color-primary"},"Are you sure you want to remove this collection from the Public API network? ",i.createElement("br",null),"This collection would still be available through the published documentation but not discoverable through the API Network.")),i.createElement(O.ModalFooter,null,i.createElement(g.default,{type:"primary",className:"documentation-published-status-modal__remove-btn",onClick:this.handleRemoveFromPublicAPINetwork,isDisabled:ae,text:"Remove from Public API Network"}),i.createElement(g.default,{type:"secondary",onClick:this.handleModalToggle,isDisabled:ae,text:"Cancel"}))))))}})||s;j.propTypes={unPublishButtonCallback:a().func.isRequired,editSettingsButtonCallback:a().func.isRequired,collectionName:a().string.isRequired,collectionUid:a().string.isRequired,publishedUrl:a().string,publishedId:a().string.isRequired,publishedOwner:a().string.isRequired,publishedStylingLight:a().object.isRequired,publishedStylingDark:a().object.isRequired,publishedVersions:a().array.isRequired,publishedEnvironment:a().string,teamLogoUrl:a().string.isRequired,isOffline:a().bool.isRequired},t.default=(0,q.withErrorBoundary)(j,R.DOCUMENTATION_ERROR_TYPE.PUBLISH_FLOW.TITLE,R.DOCUMENTATION_ERROR_TYPE.PUBLISH_FLOW.MESSAGE,{addIllustration:!0,containerStyles:{minHeight:"300px",justifyContent:"center",alignItems:"center"}})},"./documentation/components/DocumentationPublishView/DocumentationPublishFlows/PublishedViewPreviewPage.js":function(e,t,o){"use strict";o.r(t),o.d(t,{default:function(){return a}});var s=o("../../node_modules/react/index.js"),i=o("./documentation/utils/utils.js"),n=o("./documentation/constants.js");function a(e){const{documentationLayout:t}=e;switch(t){case"classic-double-column":default:return s.createElement(l,e);case"classic-single-column":return s.createElement(r,e)}}function l(e){let{highlightColor:t,topBarColor:o,sidebarColor:a,teamLogoUrl:l,theme:r}=e,d=30,c=12,u=20,h={opacity:1},m={strokeWidth:.5,strokeOpacity:.1};return l=l||n.DOCUMENTATION_PUBLISHING.DEFAULT_DOCUMENTATION_LOGO_URL,s.createElement("svg",{id:"documenter-preview-double-col",class:"documenter-preview-single-col","data-testid":"documenter-preview-double-col--published-view-page",height:"229px"},s.createElement("rect",{x:"0",y:"0",width:"100%",height:229,stroke:"#d8d8d8",style:{strokeWidth:1}}),s.createElement("rect",{x:"0",y:"0",width:"100%",height:d,fill:(0,i.formatInputHex)(o),stroke:"#000000",style:m}),s.createElement("image",{xlinkHref:l,preserveAspectRatio:"xMinYMin",x:"10",y:"5",width:"57",height:"20"}),s.createElement("rect",{x:"83%",y:"7",width:"15%",height:"16",rx:"3",ry:"3",fill:"#000000",style:{opacity:.1}}),s.createElement("rect",{x:"0",y:d,width:"100%",height:c,fill:"light"===r?"#ffffff":"#212121",stroke:"#000000",style:m}),s.createElement("rect",{x:"10",y:"34",width:u,height:4,rx:"3",ry:"3",fill:"light"===r?"#D9D9D9":"#3B3B3B",style:h}),s.createElement("rect",{x:34,y:"34",width:u,height:4,rx:"3",ry:"3",fill:(0,i.formatInputHex)(t),style:h}),s.createElement("rect",{x:74,y:"34",width:u,height:4,rx:"3",ry:"3",fill:"light"===r?"#D9D9D9":"#3B3B3B",style:h}),s.createElement("rect",{x:98,y:"34",width:u,height:4,rx:"3",ry:"3",fill:(0,i.formatInputHex)(t),style:h}),s.createElement("rect",{x:138,y:"34",width:u,height:4,rx:"3",ry:"3",fill:"light"===r?"#D9D9D9":"#3B3B3B",style:h}),s.createElement("rect",{x:162,y:"34",width:u,height:4,rx:"3",ry:"3",fill:(0,i.formatInputHex)(t),style:h}),s.createElement("rect",{x:"0",y:42,width:"80",height:187,fill:"light"===r?"#f9f9f9":"#212121"}),s.createElement("rect",{x:"10",y:58,width:"60",height:"4",rx:"3",ry:"3",fill:"light"===r?"#e6e6e6":"#6B6B6B"}),s.createElement("rect",{x:"10",y:74,width:"60",height:"4",rx:"3",ry:"3",fill:"light"===r?"#e6e6e6":"#6B6B6B"}),s.createElement("rect",{x:"10",y:90,width:"60",height:"4",rx:"3",ry:"3",fill:"light"===r?"#e6e6e6":"#6B6B6B"}),s.createElement("rect",{x:"10",y:106,width:"4",height:"4",strokeWidth:"2",stroke:(0,i.formatInputHex)(t),fill:"transparent"}),s.createElement("rect",{x:"18",y:106,width:"52",height:"4",rx:"3",ry:"3",fill:"light"===r?"#e6e6e6":"#6B6B6B"}),s.createElement("rect",{x:"10",y:122,width:"4",height:"4",strokeWidth:"2",stroke:(0,i.formatInputHex)(t),fill:"transparent"}),s.createElement("rect",{x:"18",y:122,width:"52",height:"4",rx:"3",ry:"3",fill:"light"===r?"#e6e6e6":"#6B6B6B"}),s.createElement("rect",{x:"10",y:138,width:"4",height:"4",strokeWidth:"2",stroke:(0,i.formatInputHex)(t),fill:"transparent"}),s.createElement("rect",{x:"18",y:138,width:"40",height:"4",rx:"3",ry:"3",fill:"light"===r?"#e6e6e6":"#6B6B6B"}),s.createElement("rect",{x:"10",y:154,width:"4",height:"4",strokeWidth:"2",stroke:(0,i.formatInputHex)(t),fill:"transparent"}),s.createElement("rect",{x:"18",y:154,width:"52",height:"4",rx:"3",ry:"3",fill:"light"===r?"#e6e6e6":"#6B6B6B"}),s.createElement("rect",{x:"80",y:42,width:"140",height:187,fill:"light"===r?"#ffffff":"#212121"}),s.createElement("rect",{x:"100",y:58,width:"64",height:"6",rx:"3",ry:"3",fill:"light"===r?"#e6e6e6":"#A6A6A6"}),s.createElement("rect",{x:"100",y:76,width:"90",height:"4",rx:"3",ry:"3",fill:"light"===r?"#e6e6e6":"#6B6B6B"}),s.createElement("rect",{x:"100",y:88,width:"90",height:"4",rx:"3",ry:"3",fill:"light"===r?"#e6e6e6":"#6B6B6B"}),s.createElement("rect",{x:"100",y:104,width:"90",height:"4",rx:"3",ry:"3",fill:"light"===r?"#e6e6e6":"#6B6B6B"}),s.createElement("rect",{x:"220",y:42,width:"140",height:187,fill:(0,i.formatInputHex)(a)}),s.createElement("rect",{x:"240",y:58,width:"64",height:"6",rx:"3",ry:"3",fill:"#6B6B6B"}),s.createElement("rect",{x:"240",y:76,width:"90",height:"4",rx:"3",ry:"3",fill:"#6B6B6B"}),s.createElement("rect",{x:"240",y:88,width:"90",height:"4",rx:"3",ry:"3",fill:"#6B6B6B"}),s.createElement("rect",{x:"240",y:104,width:"90",height:"4",rx:"3",ry:"3",fill:"#6B6B6B"}))}function r(e){let{highlightColor:t,topBarColor:o,sidebarColor:a,teamLogoUrl:l,theme:r}=e,d=30,c=12,u=20,h={opacity:1},m={strokeWidth:.5,strokeOpacity:.1},p=93;return l=l||n.DOCUMENTATION_PUBLISHING.DEFAULT_DOCUMENTATION_LOGO_URL,s.createElement("svg",{id:"documenter-preview-single-col","data-testid":"documenter-preview-single-col--published-view-page",class:"documenter-preview-single-col",height:"229px"},s.createElement("rect",{x:"0",y:"0",width:"100%",height:229,stroke:"#d8d8d8",style:{strokeWidth:1}}),s.createElement("rect",{x:"0",y:"0",width:"100%",height:d,fill:(0,i.formatInputHex)(o),stroke:"#000000",style:m}),s.createElement("image",{xlinkHref:l,preserveAspectRatio:"xMinYMin",x:"10",y:"5",width:"57",height:"20"}),s.createElement("rect",{x:"83%",y:"7",width:"15%",height:"16",rx:"3",ry:"3",fill:"#000000",style:{opacity:.1}}),s.createElement("rect",{x:"0",y:d,width:"100%",height:c,fill:"light"===r?"#ffffff":"#212121",stroke:"#000000",style:m}),s.createElement("rect",{x:"10",y:"34",width:u,height:4,rx:"3",ry:"3",fill:"light"===r?"#D9D9D9":"#3B3B3B",style:h}),s.createElement("rect",{x:34,y:"34",width:u,height:4,rx:"3",ry:"3",fill:(0,i.formatInputHex)(t),style:h}),s.createElement("rect",{x:74,y:"34",width:u,height:4,rx:"3",ry:"3",fill:"light"===r?"#D9D9D9":"#3B3B3B",style:h}),s.createElement("rect",{x:98,y:"34",width:u,height:4,rx:"3",ry:"3",fill:(0,i.formatInputHex)(t),style:h}),s.createElement("rect",{x:138,y:"34",width:u,height:4,rx:"3",ry:"3",fill:"light"===r?"#D9D9D9":"#3B3B3B",style:h}),s.createElement("rect",{x:162,y:"34",width:u,height:4,rx:"3",ry:"3",fill:(0,i.formatInputHex)(t),style:h}),s.createElement("rect",{x:"0",y:42,width:"80",height:187,fill:"light"===r?"#f9f9f9":"#212121"}),s.createElement("rect",{x:"10",y:58,width:"60",height:"4",rx:"3",ry:"3",fill:"light"===r?"#e6e6e6":"#6B6B6B"}),s.createElement("rect",{x:"10",y:74,width:"60",height:"4",rx:"3",ry:"3",fill:"light"===r?"#e6e6e6":"#6B6B6B"}),s.createElement("rect",{x:"10",y:90,width:"60",height:"4",rx:"3",ry:"3",fill:"light"===r?"#e6e6e6":"#6B6B6B"}),s.createElement("rect",{x:"10",y:106,width:"4",height:"4",strokeWidth:"2",stroke:(0,i.formatInputHex)(t),fill:"transparent"}),s.createElement("rect",{x:"18",y:106,width:"52",height:"4",rx:"3",ry:"3",fill:"light"===r?"#e6e6e6":"#6B6B6B"}),s.createElement("rect",{x:"10",y:122,width:"4",height:"4",strokeWidth:"2",stroke:(0,i.formatInputHex)(t),fill:"transparent"}),s.createElement("rect",{x:"18",y:122,width:"52",height:"4",rx:"3",ry:"3",fill:"light"===r?"#e6e6e6":"#6B6B6B"}),s.createElement("rect",{x:"10",y:138,width:"4",height:"4",strokeWidth:"2",stroke:(0,i.formatInputHex)(t),fill:"transparent"}),s.createElement("rect",{x:"18",y:138,width:"40",height:"4",rx:"3",ry:"3",fill:"light"===r?"#e6e6e6":"#6B6B6B"}),s.createElement("rect",{x:"10",y:154,width:"4",height:"4",strokeWidth:"2",stroke:(0,i.formatInputHex)(t),fill:"transparent"}),s.createElement("rect",{x:"18",y:154,width:"52",height:"4",rx:"3",ry:"3",fill:"light"===r?"#e6e6e6":"#6B6B6B"}),s.createElement("rect",{x:"80",y:42,width:"280",height:p,fill:"light"===r?"#ffffff":"#212121"}),s.createElement("rect",{x:"140",y:58,width:"64",height:"6",rx:"3",ry:"3",fill:"light"===r?"#e6e6e6":"#A6A6A6"}),s.createElement("rect",{x:"140",y:76,width:"160",height:"4",rx:"3",ry:"3",fill:"light"===r?"#e6e6e6":"#6B6B6B"}),s.createElement("rect",{x:"140",y:88,width:"160",height:"4",rx:"3",ry:"3",fill:"light"===r?"#e6e6e6":"#6B6B6B"}),s.createElement("rect",{x:"140",y:104,width:"160",height:"4",rx:"3",ry:"3",fill:"light"===r?"#e6e6e6":"#6B6B6B"}),s.createElement("rect",{x:"80",y:135,width:"280",height:p,fill:(0,i.formatInputHex)(a)}),s.createElement("rect",{x:"140",y:151,width:"64",height:"6",rx:"3",ry:"3",fill:"#6B6B6B"}),s.createElement("rect",{x:"140",y:169,width:"160",height:"4",rx:"3",ry:"3",fill:"#6B6B6B"}),s.createElement("rect",{x:"140",y:181,width:"160",height:"4",rx:"3",ry:"3",fill:"#6B6B6B"}),s.createElement("rect",{x:"140",y:197,width:"160",height:"4",rx:"3",ry:"3",fill:"#6B6B6B"}))}},"./documentation/components/DocumentationPublishView/DocumentationPublishFlows/SidebarNavigationPage.js":function(e,t,o){"use strict";o.r(t),o.d(t,{default:function(){return u}});var s=o("./node_modules/lodash/lodash.js"),i=o.n(s),n=o("../../node_modules/react/index.js"),a=o("./node_modules/classnames/index.js"),l=o.n(a),r=o("../../node_modules/@postman/aether/esmLib/src/components/Text/Text.js"),d=o("../../node_modules/@postman/aether/esmLib/src/components/Tooltip/Tooltip.js"),c=o("./documentation/constants.js");function u(e){const{options:t,className:o}=e,[s,a]=(0,n.useState)(!1),u=(0,n.useRef)();return n.createElement(n.Fragment,null,n.createElement("div",{className:l()("pm-sidebar-navigation",o),"data-testid":"sidebar-navigation-page"},n.createElement("ul",null,Array.isArray(t)&&t.map(((t,o)=>{const s=e.activeItem===i().get(t,"hash");return n.createElement("li",{className:l()({"active-item":s}),key:o,"data-testid":"sidebar-navigation-page-items"},n.createElement("a",{className:l()("pm-sidebar-navigation__item",{"pm-sidebar-navigation__item--active":s}),"data-testid":"sidebar-navigation-page-item-links",href:t.hash,onClick:()=>{!function(e,t){"function"==typeof t.onClick&&t.onClick(e)}(t,e)}},t.label))}))),"browser"===window.SDK_PLATFORM&&n.createElement("div",{className:"preview-documentation",ref:u,onMouseOver:()=>{a(!0)},onMouseOut:()=>{a(!1)},onClick:()=>{"function"==typeof e.handlePreview&&e.handlePreview(c.DOCUMENTATION_PUBLISHING.USER_PREVIEW_REQUEST)}},n.createElement(r.default,{type:"link-default",isExternal:!0,className:"preview-label","data-testid":"sidebar-navigation-page-preview-documentation"},"Preview Documentation "))),n.createElement(d.default,{placement:"right",isOpen:s,triggerRef:u.current,content:"Opens a live preview of the documentation in another window, which reloads on any change."}))}},"./documentation/components/DocumentationPublishView/DocumentationSelectDropdown.js":function(e,t,o){"use strict";o.r(t),o.d(t,{default:function(){return h}});var s=o("../../node_modules/react/index.js"),i=o("./js/components/base/Inputs.js"),n=o("./js/components/base/Dropdowns.js"),a=o("./js/components/base/Buttons.js"),l=o("./js/components/base/FuzzySearchInput.js"),r=o("./js/components/base/LoadingIndicator.js"),d=o("./node_modules/classnames/index.js"),c=o.n(d),u=o("./node_modules/lodash/lodash.js");class h extends s.Component{constructor(e){super(e),this.state={searchQuery:"",searchResults:[]},this.handleFuzzySearch=this.handleFuzzySearch.bind(this),this.getClasses=this.getClasses.bind(this)}handleFuzzySearch(e,t){this.setState({searchQuery:e,searchResults:t})}handleSelect(e,t){let o={};o=t?{...this.props.selectedItems,[e]:u.find(this.props.items,{id:e})}:u.omitBy(this.props.selectedItems,{id:e}),u.isFunction(this.props.onSelect)&&this.props.onSelect(o)}getClasses(){return c()({"select-dropdown-container":!0,applied:this.props.isFilterApplied,selected:!this.props.isFilterApplied&&this.props.isSelected})}render(){let e=this.state.searchQuery?this.state.searchResults:this.props.items;return s.createElement("div",{className:c()("select-dropdown-container",this.props.className)},s.createElement(n.Dropdown,{className:this.getClasses()},s.createElement(n.DropdownButton,null,s.createElement(a.Button,{type:"text",className:"select-dropdown-btn"},this.props.dropDownPlaceholder)),s.createElement(n.DropdownMenu,null,s.createElement("div",{className:"select-dropdown"},this.props.displaySearch&&s.createElement(l.default,{searchQuery:this.state.searchQuery,placeholder:this.props.searchPlaceholder,onChange:this.handleFuzzySearch,items:this.props.items,searchFields:this.props.searchFields}),s.createElement("div",{className:c()({"select-dropdown-list":!0,isLoading:this.props.isLoading})},this.props.isLoading?s.createElement(r.default,null):e&&e.length?u.map(e,(e=>s.createElement("div",{key:e.id,className:"select-dropdown-item",onClick:this.handleSelect.bind(this,e.id,!this.props.selectedItems[e.id])},s.createElement("span",{className:"select-dropdown-item-text",title:e.name},e.name),s.createElement(i.Checkbox,{onChange:this.handleSelect.bind(this,e.id),className:"select-dropdown-item-checkbox",checked:this.props.selectedItems[e.id]})))):s.createElement("div",{className:"select-dropdown-item"},"No results found"))))))}}},"./documentation/components/DocumentationPublishView/PublishSettings.js":function(e,t,o){"use strict";o.r(t),o.d(t,{default:function(){return F}});var s,i=o("../../node_modules/react/index.js"),n=o("./node_modules/prop-types/index.js"),a=o.n(n),l=o("../../node_modules/mobx-react/dist/mobx-react.module.js"),r=o("./node_modules/classnames/index.js"),d=o.n(r),c=o("./node_modules/querystring-browser/querystring.js"),u=o.n(c),h=o("../../packages/documentation/documentation-core/index.js"),m=o("./documentation/components/DocumentationPublishView/DocumentationSelectDropdown.js"),p=o("./documentation/components/DocumentationPublishView/ColorPicker.js"),g=o("./documentation/components/DocumentationPublishView/SidebarNavigation.js"),b=o("./documentation/utils/utils.js"),y=o("./documentation/components/DocumentationPublishView/PublishedViewPreview.js"),v=o("./documentation/components/DocumentationPublishView/CustomDomainHelperText.js"),E=o("./appsdk/components/link/Link.js"),f=o("../../node_modules/@postman/aether/esmLib/src/components/Banner/Banner.js"),C=o("../../node_modules/@postman/aether/esmLib/src/components/Text/Text.js"),w=o("../../node_modules/@postman/aether/esmLib/src/components/Tab/Tabs.js"),T=o("../../node_modules/@postman/aether/esmLib/src/components/Tab/TabList.js"),D=o("../../node_modules/@postman/aether/esmLib/src/components/Tab/Tab.js"),S=o("../../node_modules/@postman/aether/esmLib/src/components/Flex/Flex.js"),I=o("../../node_modules/@postman/aether/esmLib/src/components/TextArea/TextArea.js"),N=o("../../node_modules/@postman/aether/esmLib/src/components/Label/Label.js"),L=o("../../node_modules/@postman/aether/esmLib/src/components/Button/Button.js"),k=o("../../node_modules/@postman/aether/esmLib/src/components/Tooltip/Tooltip.js"),O=o("../../node_modules/@postman/aether/esmLib/src/components/Modal/Modal.js"),P=(o("./js/components/base/LoadingIndicator.js"),o("./documentation/constants.js")),R=o("./documentation/utils/publish.js"),_=o("./documentation/services/DocumentationService.js"),x=o("./js/stores/StoreManager.js"),A=o("./js/stores/CurrentUserStore.js"),q=o("./documentation/components/DocumentationPublishView/ShareToWorkspace/index.js"),U=o("./js/modules/services/AnalyticsService.js"),M=o("./node_modules/lodash/lodash.js");const j="no-custom-domain",B="no-environment",V={"right-sidebar":"303030","top-bar":"FFFFFF",highlight:"EF5B25"};let F=(0,l.observer)(s=class extends i.Component{constructor(e){super(e),this.handleRetractRequest=()=>{this.setState({showRetractConfirmationModal:!1});const{retractRequestButtonCallback:e,collectionPublishRequestCode:t}=this.props;"function"==typeof e&&e(t),U.default.addEventV2({category:P.DOCUMENTATION_ANALYTICS.CATEGORY,action:"retract_request_settings",label:this.props.isViewOnlyStatusPage?P.DOCUMENTATION_ANALYTICS.LABEL.PRIVATE_WORKSPACE:P.DOCUMENTATION_ANALYTICS.LABEL.PUBLIC_WORKSPACE,entityType:P.DOCUMENTATION_ENTITY.COLLECTION,entityId:this.props.collectionUid})},this.getEnvironmentMenuItems=()=>{let e=this.props.availableEnvironments;if(e&&Array.isArray(e)){let t=e.map((e=>({name:e.name,id:e.owner+"-"+e.id})));return t.unshift({name:"No Environment",id:B}),t}return[{name:"No Environment",id:B},{}]};const t=this.props.publishedStyling.documentationLayout||"classic-double-column",o=this.props.requestedStyling.documentationLayout||"classic-double-column";this.state={selectedDomain:M.findIndex(this.props.availableCustomDomains,{id:this.props.publishedCustomDomain}),publishedDomainId:M.findIndex(this.props.availableCustomDomains,{id:this.props.publishedCustomDomain}),selectedEnvironment:M.findIndex(this.props.availableEnvironments,{id:this.props.publishedEnvironment,owner:this.props.publishedEnvironmentOwner}),selectedEnvironmentDetails:M.find(this.props.availableEnvironments,{id:this.props.publishedEnvironment,owner:this.props.publishedEnvironmentOwner}),selectedVersions:M.isEmpty(this.props.publishedVersions)?{latest:P.DOCUMENTATION_LATEST_VERSION}:this.props.publishedVersions,versionsDropdownPlaceholder:this.getVersionDropdownPlaceholder(Object.keys(this.props.publishedVersions).length,M.get(this.props.publishedVersions,"0"))||"CURRENT",customColors:this.props.publishedStyling.customColor||{"right-sidebar":V["right-sidebar"],"top-bar":V["top-bar"],highlight:V.highlight},activeSidebarItem:"#content",documentationLayout:t,documentationLayoutActiveTabIndex:"classic-double-column"===t?0:1,domainUpstreamViewPermission:null,domainUpstreamViewPermissionLoading:!1,selectedDomainUnavailable:!1,triggerShare:!1,isSharing:!1,isColorInvalid:{"right-sidebar":!1,"top-bar":!1,highlight:!1},showRetractConfirmationModal:!1,noteToCommunityManager:this.props.noteToCommunityManager,selectedRequestedDomain:M.findIndex(this.props.availableCustomDomains,{id:this.props.requestedCustomDomain}),requestedDomainId:M.findIndex(this.props.availableCustomDomains,{id:this.props.requestedCustomDomain}),selectedRequestedEnvironment:M.findIndex(this.props.availableEnvironments,{id:this.props.requestedEnvironment,owner:this.props.requestedEnvironmentOwner}),selectedRequestedEnvironmentDetails:M.find(this.props.availableEnvironments,{id:this.props.requestedEnvironment,owner:this.props.requestedEnvironmentOwner}),selectedRequestedVersions:M.isEmpty(this.props.requestedVersions)?{latest:P.DOCUMENTATION_LATEST_VERSION}:this.props.requestedVersions,requestedVersionsDropdownPlaceholder:this.getVersionDropdownPlaceholder(Object.keys(this.props.requestedVersions).length,M.get(this.props.requestedVersions,"0"))||"CURRENT",requestedCustomColors:this.props.requestedStyling.customColor||{"right-sidebar":V["right-sidebar"],"top-bar":V["top-bar"],highlight:V.highlight},requestedDocumentationLayout:o,requestedDocumentationLayoutActiveTabIndex:"classic-double-column"===o?0:1,isRequestedColorInvalid:{"right-sidebar":!1,"top-bar":!1,highlight:!1}},this.handleVersionSelect=this.handleVersionSelect.bind(this),this.handleEnvironmentSelect=this.handleEnvironmentSelect.bind(this),this.handleCustomDomainSelect=this.handleCustomDomainSelect.bind(this),this.handlePublishButtonClick=this.handlePublishButtonClick.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleLayoutToggle=this.handleLayoutToggle.bind(this),this.handlePreview=this.handlePreview.bind(this),this.updatePreviewWindow=this.updatePreviewWindow.bind(this),this.constructPreviewUrl=this.constructPreviewUrl.bind(this),this.getVersionsForPreview=this.getVersionsForPreview.bind(this),this.onShareComplete=this.onShareComplete.bind(this),this.handleNoteToCommunityManager=this.handleNoteToCommunityManager.bind(this),this.handleRequestedVersionSelect=this.handleRequestedVersionSelect.bind(this),this.handleRequestedEnvironmentSelect=this.handleRequestedEnvironmentSelect.bind(this),this.handleRequestedCustomDomainSelect=this.handleRequestedCustomDomainSelect.bind(this),this.handleRequestPublishButtonClick=this.handleRequestPublishButtonClick.bind(this),this.handleApproveRequest=this.handleApproveRequest.bind(this),this.handleRequestedLayoutToggle=this.handleRequestedLayoutToggle.bind(this),this.updateRequestPreviewWindow=this.updateRequestPreviewWindow.bind(this),this.constructRequestPreviewUrl=this.constructRequestPreviewUrl.bind(this),this.getRequestedVersionsForPreview=this.getRequestedVersionsForPreview.bind(this),this.previewWindow=null}handleNoteToCommunityManager(e){this.setState({noteToCommunityManager:e})}handleCancel(){"function"==typeof this.props.cancelButtonCallback&&this.props.cancelButtonCallback()}handleApproveRequest(){const{approveRequestButtonCallback:e,collectionPublishRequestCode:t}=this.props;let o=this.getRequestPayload();"function"==typeof e&&e(o,t)}getRequestPayload(){var e;let{requestData:t}=this.props,o=M.get(t,"data.body.data[0]",{}),{modelId:s}=o,i=this.state.selectedRequestedEnvironment,n=M.get(this.props.availableEnvironments,[i],{}),{owner:a,id:l}=M.pick(n,["id","owner"]),r=a&&l?`${a}-${l}`:null,d=this.state.selectedRequestedDomain,c=M.get(this.props.availableCustomDomains,[d],null),u=M.get(c,"id",null),h=Object.keys(this.state.selectedRequestedVersions),m={...M.pick(this.state.requestedCustomColors,["top-bar","right-sidebar","highlight"])},p=null!==(e=this.props.tokenScanId)&&void 0!==e?e:null,g=this.formatCustomColorsForPublishing(m);a=a||null;let b=t&&{uid:s,environmentTemplateId:r,environmentOwner:a,customDomainId:u,customColor:g,versionTag:h,documentationLayout:this.state.requestedDocumentationLayout};return p&&(b.tokenScanId=p),b}handlePublishButtonClick(){if(this.props.isGovernance){const e=this.getPublishPayload();"function"==typeof this.props.publishButtonCallback&&this.props.publishButtonCallback(e)}else this.setState({triggerShare:!0,isSharing:!0})}getPublishPayload(){var e,t;let o=this.state.selectedEnvironment,s=M.get(this.props.availableEnvironments,[o],{}),{owner:i,id:n}=M.pick(s,["id","owner"]),a=i&&n?`${i}-${n}`:null,l=this.state.selectedDomain,r=M.get(this.props.availableCustomDomains,[l],null),d=M.get(r,"id",null),c=Object.keys(this.state.selectedVersions),u={...M.pick(this.state.customColors,["top-bar","right-sidebar","highlight"])};i=i||null;let h={versionTag:c,environmentTemplateId:a,environmentOwner:i,customDomainId:d,customColor:this.formatCustomColorsForPublishing(u),documentationLayout:this.state.documentationLayout};const m={...(null===(e=this.props.publishedStyling)||void 0===e?void 0:e.customColor)||{"right-sidebar":V["right-sidebar"],"top-bar":V["top-bar"],highlight:V.highlight},layout:(null===(t=this.props.publishedStyling)||void 0===t?void 0:t.documentationLayout)||"classic-double-column"},p={...h.customColor,layout:h.documentationLayout};let g=M.reduce(m,((e,t,o)=>M.isEqual(t,p[o])?e:e.concat(o)),[]);return g=g.join("_"),U.default.addEventV2({category:P.DOCUMENTATION_ANALYTICS.CATEGORY,action:this.props.isCollectionPublished?"republish_documentation":"publish_documentation",label:g.length?g:"",entityType:P.DOCUMENTATION_ENTITY.COLLECTION,entityId:this.props.collectionUid}),h}getRequestPublishPayload(){var e;let t=this.state.selectedRequestedEnvironment,o=M.get(this.props.availableEnvironments,[t],{}),{owner:s,id:i}=M.pick(o,["id","owner"]),n=s&&i?`${s}-${i}`:null,a=this.state.selectedRequestedDomain,l=M.get(this.props.availableCustomDomains,[a],null),r=M.get(l,"id",null),d=Object.keys(this.state.selectedRequestedVersions),c={...M.pick(this.state.requestedCustomColors,["top-bar","right-sidebar","highlight"])},u=null!==(e=this.props.tokenScanId)&&void 0!==e?e:null;s=s||null;let h={environmentTemplateId:n,environmentOwner:s,customDomainId:r,customColor:this.formatCustomColorsForPublishing(c),versionTag:d,documentationLayout:this.state.requestedDocumentationLayout};return u&&(h.tokenScanId=u),h}onShareComplete(e,t,o){this.setState({isSharing:!1,triggerShare:!1});let s=this.getPublishPayload();M.set(s,"shareToWorkspace",{workspaceId:t,shared:!e,isEnvironmentMoved:o}),"function"==typeof this.props.publishButtonCallback&&this.props.publishButtonCallback(s)}handleRequestPublishButtonClick(){let e=this.getRequestPublishPayload();"function"==typeof this.props.requestPublishButtonCallback&&this.props.requestPublishButtonCallback(e,this.state.noteToCommunityManager)}handleRequestedEnvironmentSelect(e){let{owner:t,collectionId:o}=(0,b.getOptionsFromCollectionUid)(e);this.setState({selectedRequestedEnvironment:M.findIndex(this.props.availableEnvironments,{owner:t,id:o}),selectedRequestedEnvironmentDetails:M.find(this.props.availableEnvironments,{owner:t,id:o})},(()=>{this.handlePreview()}))}handleEnvironmentSelect(e){let{owner:t,collectionId:o}=(0,b.getOptionsFromCollectionUid)(e);this.setState({selectedEnvironment:M.findIndex(this.props.availableEnvironments,{owner:t,id:o}),selectedEnvironmentDetails:M.find(this.props.availableEnvironments,{owner:t,id:o})},(()=>{this.handlePreview()}))}async handleRequestedCustomDomainSelect(e){let t,o,s=this.props.availableCustomDomains,i=M.findIndex(s,{id:e}),n=s[i],a=M.get(s,[this.state.requestedDomainId,"id"],void 0),l=M.get(n,"id")===a,r=null!==M.get(n,"upstream")&&!l,d=M.get(n,"publishData.owner"),c=M.get(n,"publishData.collectionId"),u=(0,x.resolveStoreInstance)(A.default);e===j&&(r=!1),this.setState({selectedRequestedDomain:i,selectedDomainUnavailable:r});try{r&&(this.setState({domainUpstreamViewPermissionLoading:!0}),t={objectId:`${d}-${c}`,objectType:"collection",entityId:u.id,entityType:"user",permission:P.PERMISSIONS.VIEW_COLLECTION},o=await(0,_.fetchPermissions)({permissionQuery:t}),this.setState({domainUpstreamViewPermission:M.get(o,"permissionQuery.allowed"),domainUpstreamViewPermissionLoading:!1}))}catch(e){pm.logger.error("PublishSettings~handleRequestedCustomDomainSelect: Failed to fetch collection view permission",e)}}async handleCustomDomainSelect(e){let t,o,s=this.props.availableCustomDomains,i=M.findIndex(s,{id:e}),n=s[i],a=M.get(s,[this.state.publishedDomainId,"id"],void 0),l=M.get(n,"id")===a,r=null!==M.get(n,"upstream")&&!l,d=M.get(n,"publishData.owner"),c=M.get(n,"publishData.collectionId"),u=(0,x.resolveStoreInstance)(A.default);e===j&&(r=!1),this.setState({selectedDomain:i,selectedDomainUnavailable:r});try{r&&(this.setState({domainUpstreamViewPermissionLoading:!0}),t={objectId:`${d}-${c}`,objectType:"collection",entityId:u.id,entityType:"user",permission:P.PERMISSIONS.VIEW_COLLECTION},o=await(0,_.fetchPermissions)({permissionQuery:t}),this.setState({domainUpstreamViewPermission:M.get(o,"permissionQuery.allowed"),domainUpstreamViewPermissionLoading:!1}))}catch(e){pm.logger.error("PublishSettings~handleCustomDomainSelect: Failed to fetch collection view permission",e)}}getVersionDropdownPlaceholder(e,t){switch(e){case 0:return"";case 1:return t;default:return`Multiple Versions(${e})`}}handleRequestedVersionSelect(e){let t=Object.keys(e);if(!t.length)return;let o=t.length,s=this.props.availableVersions,i=M.get(M.find(s,{id:t[0]}),"name",""),n=this.getVersionDropdownPlaceholder(o,i);this.setState({selectedRequestedVersions:e,versionsDropdownPlaceholder:n},(()=>{this.handlePreview()}))}handleVersionSelect(e){let t=Object.keys(e);if(!t.length)return;let o=t.length,s=this.props.availableVersions,i=M.get(M.find(s,{id:t[0]}),"name",""),n=this.getVersionDropdownPlaceholder(o,i);this.setState({selectedVersions:e,versionsDropdownPlaceholder:n},(()=>{this.handlePreview()}))}getRequestedCustomDomainMenuItems(){let e=this.props.availableCustomDomains,t=M.get(this.props.availableCustomDomains,[this.state.requestedDomainId,"id"],void 0);if(e&&Array.isArray(e)&&e.length){let o=e.map((e=>{let o=e.id===t,s=null!==e.upstream&&!o,i=e.verified?"":"(unverified)",n=s?"(unavailable)":i;return{name:`${e.fqdn} ${n}`,id:e.id}}));return o.unshift({name:"No custom domain",id:j}),o}return[{name:"No custom domain",id:j},{}]}getCustomDomainMenuItems(){let e=this.props.availableCustomDomains,t=M.get(this.props.availableCustomDomains,[this.state.publishedDomainId,"id"],void 0);if(e&&Array.isArray(e)&&e.length){let o=e.map((e=>{let o=e.id===t,s=null!==e.upstream&&!o,i=e.verified?"":"(unverified)",n=s?"(unavailable)":i;return{name:`${e.fqdn} ${n}`,id:e.id}}));return o.unshift({name:"No custom domain",id:j}),o}return[{name:"No custom domain",id:j},{}]}getCollectionVersions(){let e=this.props.availableVersions;if(e&&Array.isArray(e)&&e.length){return e.map((e=>({name:e.name,id:e.id})))}return[{name:"CURRENT",id:"latest"}]}isRequestedColorInvalid(){return this.state.isRequestedColorInvalid.highlight||this.state.isRequestedColorInvalid["right-sidebar"]||this.state.isRequestedColorInvalid["top-bar"]}isColorInvalid(){return this.state.isColorInvalid.highlight||this.state.isColorInvalid["right-sidebar"]||this.state.isColorInvalid["top-bar"]}getRequestedDefaultColor(e){return this.props.requestedStyling.customColor&&this.props.requestedStyling.customColor[e]?this.props.requestedStyling.customColor[e]:V[e]}getDefaultColor(e){return this.props.publishedStyling.customColor&&this.props.publishedStyling.customColor[e]?this.props.publishedStyling.customColor[e]:V[e]}handleRequestedCustomColorChange(e,t,o){(0,b.isHexColor)(o)?this.state.isRequestedColorInvalid[t]&&this.setState({isRequestedColorInvalid:{...this.state.isRequestedColorInvalid,[t]:!1}}):this.setState({isRequestedColorInvalid:{...this.state.isRequestedColorInvalid,[t]:!0}}),o=o.slice(1),this.setState({requestedCustomColors:{...e,[t]:o}},(()=>{this.handlePreview()}))}handleCustomColorChange(e,t,o){(0,b.isHexColor)(o)?this.state.isColorInvalid[t]&&this.setState({isColorInvalid:{...this.state.isColorInvalid,[t]:!1}}):this.setState({isColorInvalid:{...this.state.isColorInvalid,[t]:!0}}),o=o.slice(1),this.setState({customColors:{...e,[t]:o}},(()=>{this.handlePreview()}))}handleRequestedLayoutToggle(e){this.setState({requestedDocumentationLayout:0===e?"classic-double-column":"classic-single-column",requestedDocumentationLayoutActiveTabIndex:e},(()=>{this.handlePreview()}))}handleLayoutToggle(e){this.setState({documentationLayout:0===e?"classic-double-column":"classic-single-column",documentationLayoutActiveTabIndex:e},(()=>{this.handlePreview()}))}formatCustomColorsForPublishing(e){return e&&Object.keys(e).length?(Object.keys(e).forEach((t=>{e[t]=(0,b.sanitiseHexColor)(e[t])})),e):e}handlePreview(e){if("browser"===window.SDK_PLATFORM){if(this.previewWindow&&!this.previewWindow.closed&&(0,R.getPostMessageSupport)(this.previewWindow,pm.config.get("__WP_DOCUMENTATION_PREVIEW_URL__")))return this.props.isGovernance&&!this.props.isCommunityManager?this.updateRequestPreviewWindow:this.updatePreviewWindow(pm.config.get("__WP_DOCUMENTATION_PREVIEW_URL__"));if(e===P.DOCUMENTATION_PUBLISHING.USER_PREVIEW_REQUEST){let e=this.props.isGovernance&&!this.props.isCommunityManager?this.constructRequestPreviewUrl():this.constructPreviewUrl();this.previewWindow=window.open(e,"Preview",`height=${window.innerHeight},width=${window.innerWidth}`),U.default.addEventV2({category:P.DOCUMENTATION_ANALYTICS.CATEGORY,action:"preview_documentation",label:P.DOCUMENTATION_ANALYTICS.LABEL.PUBLISH_SETTINGS_TAB,entityType:P.DOCUMENTATION_ENTITY.COLLECTION,entityId:this.props.collectionUid})}}}updateRequestPreviewWindow(e){let t=this.props.availableEnvironments[this.state.selectedRequestedEnvironment],o=M.isNil(t)?void 0:`${t.owner}-${t.id}`,{versionTag:s,apiName:i,version:n}=this.getRequestedVersionsForPreview(),a=this.state.requestedDocumentationLayout,l=this.state.requestedCustomColors["top-bar"],r=this.state.requestedCustomColors.highlight,d=this.state.requestedCustomColors["right-sidebar"],c={versionTag:s.join(","),apiName:i.join(","),version:n,"top-bar":l,"right-sidebar":d,highlight:r,environment:o,documentationLayout:a};return this.previewWindow.postMessage(JSON.stringify(c),e)}updatePreviewWindow(e){let t=this.props.availableEnvironments[this.state.selectedEnvironment],o=M.isNil(t)?void 0:`${t.owner}-${t.id}`,{versionTag:s,apiName:i,version:n}=this.getVersionsForPreview(),a=this.state.documentationLayout,l=this.state.customColors["top-bar"],r=this.state.customColors.highlight,d=this.state.customColors["right-sidebar"],c={versionTag:s.join(","),apiName:i.join(","),version:n,"top-bar":l,"right-sidebar":d,highlight:r,environment:o,documentationLayout:a};return this.previewWindow.postMessage(JSON.stringify(c),e)}constructRequestPreviewUrl(){let e=this.props.collectionUid,t=this.props.availableEnvironments[this.state.selectedRequestedEnvironment],o=M.isNil(t)?void 0:`${t.owner}-${t.id}`,{versionTag:s,apiName:i,version:n}=this.getRequestedVersionsForPreview(),a=this.state.requestedDocumentationLayout,l=Object.keys(this.state.requestedCustomColors).map((e=>u().stringify({[e]:this.state.requestedCustomColors[e]}))).join("&"),r={environment:o,versionTag:s.join(","),apiName:i.join(","),version:n,documentationLayout:a},d=[u().stringify(r),l].join("&"),c=[pm.config.get("__WP_DOCUMENTATION_PREVIEW_URL__"),"preview",e].join("/");return c+=`?${d}`,c}constructPreviewUrl(){let e=this.props.collectionUid,t=this.props.availableEnvironments[this.state.selectedEnvironment],o=M.isNil(t)?void 0:`${t.owner}-${t.id}`,{versionTag:s,apiName:i,version:n}=this.getVersionsForPreview(),a=this.state.documentationLayout,l=Object.keys(this.state.customColors).map((e=>u().stringify({[e]:this.state.customColors[e]}))).join("&"),r={environment:o,versionTag:s.join(","),apiName:i.join(","),version:n,documentationLayout:a},d=[u().stringify(r),l].join("&"),c=[pm.config.get("__WP_DOCUMENTATION_PREVIEW_URL__"),"preview",e].join("/");return c+=`?${d}`,c}getRequestedVersionsForPreview(){let e=Object.keys(this.state.selectedRequestedVersions),t=[],o=e[0];return e.forEach((e=>{t.push(this.state.selectedRequestedVersions[e].name)})),{versionTag:e,apiName:t,version:o}}getVersionsForPreview(){let e=Object.keys(this.state.selectedVersions),t=[],o=e[0];return e.forEach((e=>{t.push(this.state.selectedVersions[e].name)})),{versionTag:e,apiName:t,version:o}}componentDidUpdate(e){let{availableEnvironments:t,availableCustomDomains:o,requestedEnvironment:s,publishedEnvironment:i,requestedEnvironmentOwner:n,publishedEnvironmentOwner:a,requestedCustomDomain:l,publishedCustomDomain:r}=this.props||{},d=e.availableEnvironments,c=e.availableCustomDomains;JSON.stringify(t)===JSON.stringify(d)&&JSON.stringify(o)===JSON.stringify(c)||this.setState({selectedRequestedEnvironment:M.findIndex(t,{id:s,owner:n}),selectedEnvironment:M.findIndex(t,{id:i,owner:a}),selectedRequestedEnvironmentDetails:M.find(t,{id:s,owner:n}),selectedEnvironmentDetails:M.find(t,{id:i,owner:a}),selectedRequestedDomain:M.findIndex(o,{id:l}),selectedDomain:M.findIndex(o,{id:r})},(()=>{this.handlePreview()}))}render(){const{isOffline:e,collectionUid:t,collectionName:o,workspaceId:s,teamLogoUrl:n,availableCustomDomains:a,isPublishing:l,isCollectionPublished:r,isRequesting:c,isGovernance:u,isCommunityManager:b,isCollectionPublishRequested:P,isRequestRetracting:R,isRequestApproving:_,isLimitReachedForPublish:x,isRepeatSpammer:A}=this.props,{selectedRequestedDomain:U,selectedDomain:j,selectedRequestedVersions:B,selectedVersions:V,selectedRequestedEnvironment:F,selectedEnvironment:W,selectedRequestedEnvironmentDetails:H,selectedEnvironmentDetails:Y,selectedDomainUnavailable:G,requestedDomainId:$,publishedDomainId:z,isRequestedColorInvalid:K,isColorInvalid:J,activeSidebarItem:Q,triggerShare:X,isSharing:Z,versionsDropdownPlaceholder:ee,requestedDocumentationLayout:te,documentationLayout:oe,domainUpstreamViewPermission:se,domainUpstreamViewPermissionLoading:ie,requestedDocumentationLayoutActiveTabIndex:ne,documentationLayoutActiveTabIndex:ae,noteToCommunityManager:le}=this.state;let re=this.state.customColors,de=this.state.requestedCustomColors,ce=this.getEnvironmentMenuItems(),ue=Boolean(this.props.requestedEnvironment),he=Boolean(this.props.publishedEnvironment),me=M.get(this.props.environments,"loading",!1),pe=this.getRequestedCustomDomainMenuItems(),ge=this.getCustomDomainMenuItems(),be=M.get(this.props.customDomains,"loading",!1),ye=this.getCollectionVersions(),ve=-1===this.state.selectedRequestedEnvironment,Ee=-1===this.state.selectedEnvironment,fe=-1===this.state.selectedRequestedDomain,Ce=-1===this.state.selectedDomain,we=u&&!b,Te=u?b&&x&&!r:x&&!r;return i.createElement("div",{className:"documentation-publish-settings-page-before-customisation"},!A&&Te&&i.createElement("div",{className:"documentation-publish-settings--limit-reached-banner"},i.createElement(f.default,{status:"warning"},i.createElement(C.default,null,"You've reached your limit to publish documentation. You can unpublish existing documentation in your team or contact support to increase the limit."))),i.createElement("div",{className:"documentation-publish-settings"},i.createElement("div",{className:"documentation-publish-settings-left-sidebar"},i.createElement("h1",{className:"documentation-publish-settings-left-sidebar--page-name"},u&&P||we?"Request Collection Documentation Publish":"Publish collection"),i.createElement("p",{className:"documentation-publish-settings-left-sidebar--collection-name"},o),i.createElement(g.default,{activeItem:Q,heading:"Publish collection",handlePreview:this.handlePreview,options:[{label:"Content",hash:"#content"},{label:"URL",hash:"#url"},{label:"Styling",hash:"#styling"}],onClick:e=>{this.setState({activeSidebarItem:e.hash})}})),u&&P||we?i.createElement(i.Fragment,null,i.createElement("div",{className:"documentation-publish-settings-main-content"},i.createElement("div",{className:"documentation-publish-settings-main-content--content",id:"content"},i.createElement("h4",{className:"documentation-publish-settings-main-content--main-label"},"Content"),i.createElement("div",{className:"content--versions"},i.createElement("p",{className:"documentation-publish-settings-main-content--sub-label"},"Version"),i.createElement("div",{className:"content--dropdown"},i.createElement(m.default,{className:"dropdown-content--dropdown-menu content--versions--dropdown",selectedItems:B,items:ye,onSelect:this.handleRequestedVersionSelect,dropDownPlaceholder:ee}),i.createElement("div",{className:"content--helper-text"},"Select one or more collection states to publish. ",i.createElement(E.default,{to:"https://go.pstmn.io/public-documentation-versioning",className:"documentation-default-link",rel:"noopener noreferrer",target:"_blank"},i.createElement(C.default,{className:"documentation-default-link__text"},"Learn more"))," about versions"))),i.createElement("div",{className:"content--environment"},i.createElement("p",{className:"documentation-publish-settings-main-content--sub-label"},"Environment"),i.createElement("div",{className:"content--dropdown"},i.createElement(h.DropdownComponent,{className:d()({"documentation-dropdown":!0,"documentation-dropdown--publish-page":!0,"documentation-dropdown--empty":ve}),disabled:me,dropdownType:"simple",dropdownStyle:"carat",dropdownItems:ce,onSelectItem:this.handleRequestedEnvironmentSelect,initialSelectedIndex:F+1,dropdownMenuClassName:"dropdown-content--dropdown-menu",dropdownButtonClassName:"dropdown-content--dropdown-button"+(ue?"--environment-button":"--no-environment-button"),alwaysDisplayDropdown:!0,showMenuItemTooltip:!0}),i.createElement("div",{className:"content--helper-text"},"Publish the selected environment variables and values along  with the collection.",i.createElement("a",{href:"https://learning.postman.com/docs/sending-requests/managing-environments/",rel:"noopener noreferrer",target:"_blank"},"Learn how"),"to manage your environments.")))),i.createElement("div",{className:"documentation-publish-settings-main-content--url",id:"url"},i.createElement("div",{className:"url--header-container"},i.createElement("h4",{className:"documentation-publish-settings-main-content--main-label url--heading"},"URL"),i.createElement("span",{className:"url--optional"},"(optional)")),i.createElement("div",{className:"url--custom-domains"},i.createElement("p",{className:"documentation-publish-settings-main-content--sub-label"},"Custom Domain"),i.createElement("div",{className:"content--dropdown"},i.createElement(h.DropdownComponent,{className:d()({"documentation-dropdown":!0,"documentation-dropdown--publish-page":!0,"documentation-dropdown--empty":fe}),dropdownType:"simple",dropdownStyle:"carat",disabled:be,dropdownItems:pe,onSelectItem:this.handleRequestedCustomDomainSelect,initialSelectedIndex:U+1,dropdownMenuClassName:"dropdown-content--dropdown-menu",dropdownButtonClassName:"dropdown-content--dropdown-button"+(ue?"--domain-button":"--no-domain-button"),alwaysDisplayDropdown:!0,showMenuItemTooltip:!0}),i.createElement("div",{className:"content--helper-text"},"The collection documentation will be published at the selected domain")),i.createElement(v.default,{publishedDomainIndex:$,selectedDomainIndex:U,customDomains:a,domainUpstreamViewPermission:se,domainUpstreamViewPermissionLoading:ie}))),i.createElement("div",{className:"documentation-publish-settings-main-content--styling",id:"styling"},i.createElement("h4",{className:"documentation-publish-settings-main-content--main-label"},"Styling"),i.createElement("div",{className:"styling--layout"},i.createElement("p",{className:"documentation-publish-settings-main-content--sub-label"},"Default layout"),i.createElement("div",{className:"documentation-publish-settings-main-content--styling--layout\n                    plugin__workspace-view-switcher__wrapper\n                    plugin__workspace-view-switcher"},i.createElement(w.default,{activeTabIndex:ne,onChange:this.handleRequestedLayoutToggle,type:"secondary"},i.createElement(T.default,null,i.createElement(D.default,{label:"Double Column"}),i.createElement(D.default,{label:"Single Column"}))))),i.createElement(y.default,{documentationLayout:te,highlightColor:K.highlight?this.getRequestedDefaultColor("highlight"):de.highlight,sidebarColor:K["right-sidebar"]?this.getRequestedDefaultColor("right-sidebar"):de["right-sidebar"],topBarColor:K["top-bar"]?this.getRequestedDefaultColor("top-bar"):de["top-bar"],teamLogoUrl:n}),i.createElement("div",{className:"styling--colors"},i.createElement("div",{className:"styling--colors--header"},i.createElement("p",{className:"documentation-publish-settings-main-content--sub-label"},"Header background color"),i.createElement(p.default,{colorHex:de["top-bar"],pristineColorHex:this.getRequestedDefaultColor("top-bar"),onColorChange:e=>{this.handleRequestedCustomColorChange(de,"top-bar",e)},isColorInvalid:K["top-bar"]})),i.createElement("div",{className:"styling--colors--code"},i.createElement("p",{className:"documentation-publish-settings-main-content--sub-label"},"Code background color"),i.createElement(p.default,{colorHex:de["right-sidebar"],pristineColorHex:this.getRequestedDefaultColor("right-sidebar"),onColorChange:e=>{this.handleRequestedCustomColorChange(de,"right-sidebar",e)},isColorInvalid:K["right-sidebar"]})),i.createElement("div",{className:"styling--colors--highlight"},i.createElement("p",{className:"documentation-publish-settings-main-content--sub-label"},"Highlight color"),i.createElement(p.default,{colorHex:de.highlight,pristineColorHex:this.getRequestedDefaultColor("highlight"),onColorChange:e=>{this.handleRequestedCustomColorChange(de,"highlight",e)},isColorInvalid:K.highlight})))),!b&&i.createElement("div",{className:"documentation-publish-settings-main-content--governance",id:"governance"},i.createElement("div",{className:"governance--textarea"},i.createElement(S.default,{direction:"column",width:"48%",gap:"spacing-s"},i.createElement(I.default,{label:i.createElement(N.default,{text:"Include a note for the Community Manager"}),value:le,onChange:e=>this.handleNoteToCommunityManager(e.target.value),placeholder:"Add a note to community manager"})),i.createElement("div",{className:"governance--helper-text"},"Let the Community Manager know why youd like this collection's documentation to be published."))),i.createElement("hr",null),i.createElement("div",{className:"documentation-publish-settings-main-content--ctas"},i.createElement("div",{className:"documentation-publish-settings-main-content--ctas--buttons"},we?i.createElement(L.default,{type:"primary",size:"medium",className:"publish-button",onClick:this.handleRequestPublishButtonClick,isLoading:c,isDisabled:G||c||this.isRequestedColorInvalid()||e,text:P?"Update Request":"Request Publish"}):i.createElement(L.default,{type:"primary",size:"medium",className:"publish-button",onClick:this.handleApproveRequest,isLoading:_||Z,isDisabled:G||_||Z||this.isRequestedColorInvalid()||e||A||x&&!r,text:"Save and Approve",tooltip:x&&!r&&i.createElement(k.default,{content:"Youve reached your limit to publish documentation",placement:"top"})}),i.createElement(L.default,{type:"secondary",size:"medium",className:"publish-doc-cancel-button",onClick:this.handleCancel,text:"Cancel"}),we&&P&&i.createElement(i.Fragment,null,i.createElement(L.default,{type:"destructive",size:"medium",className:"publish-button",isDisabled:R||e,isLoading:R,onClick:()=>{this.setState({showRetractConfirmationModal:!0})},text:"Withdraw request"}),i.createElement(O.Modal,{isOpen:this.state.showRetractConfirmationModal,onClose:()=>this.setState({showRetractConfirmationModal:!1})},i.createElement(O.ModalHeader,{heading:"Withdraw Request?"}),i.createElement(O.ModalContent,null,"Are you sure you want to withdraw the request to publish this collection's documentation?"),i.createElement(O.ModalFooter,null,i.createElement(S.default,{justifyContent:"flex-end",grow:1,shrink:1,gap:"spacing-s"},i.createElement(L.default,{type:"secondary",text:"Cancel",onClick:()=>this.setState({showRetractConfirmationModal:!1})}),i.createElement(L.default,{type:"destructive",text:"Confirm",onClick:()=>{this.handleRetractRequest()}})))))),i.createElement("div",{className:"content--helper-text"},we?"Community Manager will be notified of the changes.":"Completing this step will make your collection available at a public URL.")))):i.createElement(i.Fragment,null,i.createElement("div",{className:"documentation-publish-settings-main-content"},i.createElement("div",{className:"documentation-publish-settings-main-content--content",id:"content"},i.createElement("h4",{className:"documentation-publish-settings-main-content--main-label"},"Content"),i.createElement("div",{className:"content--versions"},i.createElement("p",{className:"documentation-publish-settings-main-content--sub-label"},"Version"),i.createElement("div",{className:"content--dropdown"},i.createElement(m.default,{className:"dropdown-content--dropdown-menu content--versions--dropdown",selectedItems:V,items:ye,onSelect:this.handleVersionSelect,dropDownPlaceholder:ee}),i.createElement("div",{className:"content--helper-text"},"Select one or more collection states to publish. ",i.createElement(E.default,{to:"https://go.pstmn.io/public-documentation-versioning",className:"documentation-default-link",rel:"noopener noreferrer",target:"_blank"},i.createElement(C.default,{className:"documentation-default-link__text"},"Learn more"))," about versions"))),i.createElement("div",{className:"content--environment"},i.createElement("p",{className:"documentation-publish-settings-main-content--sub-label"},"Environment"),i.createElement("div",{className:"content--dropdown"},i.createElement(h.DropdownComponent,{className:d()({"documentation-dropdown":!0,"documentation-dropdown--publish-page":!0,"documentation-dropdown--empty":Ee}),disabled:me,dropdownType:"simple",dropdownStyle:"carat",dropdownItems:ce,onSelectItem:this.handleEnvironmentSelect,initialSelectedIndex:W+1,dropdownMenuClassName:"dropdown-content--dropdown-menu",dropdownButtonClassName:"dropdown-content--dropdown-button"+(he?"--environment-button":"--no-environment-button"),alwaysDisplayDropdown:!0,showMenuItemTooltip:!0}),i.createElement("div",{className:"content--helper-text"},"Publish the selected environment variables and values along  with the collection.",i.createElement("a",{href:"https://learning.postman.com/docs/sending-requests/managing-environments/",rel:"noopener noreferrer",target:"_blank"},"Learn how"),"to manage your environments.")))),i.createElement("div",{className:"documentation-publish-settings-main-content--url",id:"url"},i.createElement("div",{className:"url--header-container"},i.createElement("h4",{className:"documentation-publish-settings-main-content--main-label url--heading"},"URL"),i.createElement("span",{className:"url--optional"},"(optional)")),i.createElement("div",{className:"url--custom-domains"},i.createElement("p",{className:"documentation-publish-settings-main-content--sub-label"},"Custom Domain"),i.createElement("div",{className:"content--dropdown"},i.createElement(h.DropdownComponent,{className:d()({"documentation-dropdown":!0,"documentation-dropdown--publish-page":!0,"documentation-dropdown--empty":Ce}),dropdownType:"simple",dropdownStyle:"carat",disabled:be,dropdownItems:ge,onSelectItem:this.handleCustomDomainSelect,initialSelectedIndex:j+1,dropdownMenuClassName:"dropdown-content--dropdown-menu",dropdownButtonClassName:"dropdown-content--dropdown-button"+(he?"--domain-button":"--no-domain-button"),alwaysDisplayDropdown:!0,showMenuItemTooltip:!0}),i.createElement("div",{className:"content--helper-text"},"The collection documentation will be published at the selected domain")),i.createElement(v.default,{publishedDomainIndex:z,selectedDomainIndex:j,customDomains:a,domainUpstreamViewPermission:se,domainUpstreamViewPermissionLoading:ie}))),i.createElement("div",{className:"documentation-publish-settings-main-content--styling",id:"styling"},i.createElement("h4",{className:"documentation-publish-settings-main-content--main-label"},"Styling"),i.createElement("div",{className:"styling--layout"},i.createElement("p",{className:"documentation-publish-settings-main-content--sub-label"},"Default layout"),i.createElement("div",{className:"documentation-publish-settings-main-content--styling--layout\n                    plugin__workspace-view-switcher__wrapper\n                    plugin__workspace-view-switcher"},i.createElement(w.default,{activeTabIndex:ae,onChange:this.handleLayoutToggle,type:"secondary"},i.createElement(T.default,null,i.createElement(D.default,{label:"Double Column"}),i.createElement(D.default,{label:"Single Column"}))))),i.createElement(y.default,{documentationLayout:oe,highlightColor:J.highlight?this.getDefaultColor("highlight"):re.highlight,sidebarColor:J["right-sidebar"]?this.getDefaultColor("right-sidebar"):re["right-sidebar"],topBarColor:J["top-bar"]?this.getDefaultColor("top-bar"):re["top-bar"],teamLogoUrl:n}),i.createElement("div",{className:"styling--colors"},i.createElement("div",{className:"styling--colors--header"},i.createElement("p",{className:"documentation-publish-settings-main-content--sub-label"},"Header background color"),i.createElement(p.default,{colorHex:re["top-bar"],pristineColorHex:this.getDefaultColor("top-bar"),onColorChange:e=>{this.handleCustomColorChange(re,"top-bar",e)},isColorInvalid:J["top-bar"]})),i.createElement("div",{className:"styling--colors--code"},i.createElement("p",{className:"documentation-publish-settings-main-content--sub-label"},"Code background color"),i.createElement(p.default,{colorHex:re["right-sidebar"],pristineColorHex:this.getDefaultColor("right-sidebar"),onColorChange:e=>{this.handleCustomColorChange(re,"right-sidebar",e)},isColorInvalid:J["right-sidebar"]})),i.createElement("div",{className:"styling--colors--highlight"},i.createElement("p",{className:"documentation-publish-settings-main-content--sub-label"},"Highlight color"),i.createElement(p.default,{colorHex:re.highlight,pristineColorHex:this.getDefaultColor("highlight"),onColorChange:e=>{this.handleCustomColorChange(re,"highlight",e)},isColorInvalid:J.highlight})))),!u&&i.createElement(q.default,{triggerShare:X,collectionUid:t,collectionName:o,onShareComplete:this.onShareComplete,workspaceId:s,selectedEnvironment:Y}),we&&i.createElement("div",{className:"documentation-publish-settings-main-content--governance",id:"governance"},i.createElement("div",{className:"governance--textarea"},i.createElement(S.default,{direction:"column",width:"48%",gap:"spacing-s"},i.createElement(I.default,{label:i.createElement(N.default,{text:"Include a note for the Community Manager"}),value:le,onChange:e=>this.handleNoteToCommunityManager(e.target.value),placeholder:"Add a note to community manager"})),i.createElement("div",{className:"governance--helper-text"},"Let the Community Manager know why youd like this collections documentation to be published."))),i.createElement("hr",null),i.createElement("div",{className:"documentation-publish-settings-main-content--ctas"},i.createElement("div",{className:"documentation-publish-settings-main-content--ctas--buttons"},we?i.createElement(L.default,{type:"primary",size:"medium",className:"publish-button",onClick:this.handleRequestPublishButtonClick,isLoading:c,isDisabled:G||c||this.isColorInvalid()||e,text:P?"Update Request":"Request Publish"}):i.createElement(L.default,{type:"primary",size:"medium",className:"publish-button",onClick:this.handlePublishButtonClick,isLoading:l||Z,isDisabled:G||l||Z||this.isColorInvalid()||e||A||x&&!r,text:r?"Save and republish":"Publish",tooltip:A?i.createElement(k.default,{content:"We've temporarily blocked you from publishing documents as your content did not meet our community standards. Please try again later or contact support.",placement:"top"}):x&&!r?i.createElement(k.default,{content:"Youve reached your limit to publish documentation",placement:"top"}):""}),i.createElement(L.default,{type:"secondary",size:"medium",className:"publish-doc-cancel-button",onClick:this.handleCancel,text:"Cancel"}),we&&P&&i.createElement(L.default,{type:"destructive",size:"medium",className:"publish-button",isDisabled:R||e,isLoading:R,onClick:this.handleRetractRequest,text:"Withdraw request"})),i.createElement("div",{className:"content--helper-text"},"Completing this step will make your collection available at a public URL."))))))}})||s;F.propTypes={publishButtonCallback:a().func.isRequired,cancelButtonCallback:a().func.isRequired,collectionName:a().string.isRequired,workspaceId:a().string.isRequired,availableVersions:a().array,availableEnvironments:a().array,availableCustomDomains:a().array,publishedStyling:a().object,publishedVersions:a().object,publishedEnvironment:a().string,publishedEnvironmentOwner:a().string,publishedCustomDomain:a().number,teamLogoUrl:a().string,isOffline:a().bool},F.defaultProps={availableVersions:[{key:"latest",label:"CURRENT"}]}},"./documentation/components/DocumentationPublishView/PublishedStatus.js":function(e,t,o){"use strict";o.r(t),o.d(t,{default:function(){return k}});var s,i=o("../../node_modules/react/index.js"),n=o("./node_modules/prop-types/index.js"),a=o.n(n),l=o("../../node_modules/mobx-react/dist/mobx-react.module.js"),r=o("../../node_modules/@postman/aether/esmLib/src/components/Banner/Banner.js"),d=o("../../node_modules/@postman/aether/esmLib/src/components/Text/Text.js"),c=o("../../node_modules/@postman/aether/esmLib/src/components/Breadcrumb/Breadcrumb.js"),u=o("../../node_modules/@postman/aether/esmLib/src/components/Button/Button.js"),h=o("../../node_modules/@postman/aether/esmLib/src/components/Tooltip/Tooltip.js"),m=o("../../node_modules/@postman/aether/esmLib/src/components/Modal/Modal.js"),p=o("../../node_modules/@postman/aether/esmLib/src/components/Flex/Flex.js"),g=o("../../node_modules/@postman/aether/esmLib/src/components/TextArea/TextArea.js"),b=o("../../node_modules/@postman/aether/esmLib/src/components/Label/Label.js"),y=o("../../node_modules/@postman/aether/esmLib/src/components/Table/Table.js"),v=o("../../node_modules/@postman/aether/esmLib/src/components/Heading/Heading.js"),E=o("./documentation/components/DocumentationPublishView/PublishedViewPreview.js"),f=o("./appsdk/components/link/Link.js"),C=o("./js/services/NavigationService.js"),w=o("./js/components/base/Modals.js"),T=o("./apinetwork/services/PublicProfileService.js"),D=o("./documentation/constants.js"),S=o("./iam/src/common/styled-components/CopyButton.js"),I=o("./js/utils/ClipboardHelper.js"),N=o("./js/modules/services/AnalyticsService.js"),L=o("./node_modules/lodash/lodash.js");let k=(0,l.observer)(s=class extends i.Component{constructor(e){super(e),this.handleEditSettings=()=>{const{editSettingsButtonCallback:e}=this.props;"function"==typeof e&&e(),N.default.addEventV2({category:D.DOCUMENTATION_ANALYTICS.CATEGORY,action:"edit_settings",label:D.DOCUMENTATION_ANALYTICS.LABEL.PUBLISHED_STATUS_TAB,entityType:D.DOCUMENTATION_ENTITY.COLLECTION,entityId:this.props.collectionUid})},this.handleUnpublish=()=>{const{unPublishButtonCallback:e}=this.props;"function"==typeof e&&e(),N.default.addEventV2({category:D.DOCUMENTATION_ANALYTICS.CATEGORY,action:"unpublish_documentation",label:D.DOCUMENTATION_ANALYTICS.LABEL.PUBLISHED_STATUS_TAB,entityType:D.DOCUMENTATION_ENTITY.COLLECTION,entityId:this.props.collectionUid})},this.handleApproveRequest=()=>{const{approveRequestButtonCallback:e,collectionPublishRequestCode:t}=this.props;let o=this.getRequestPayload();"function"==typeof e&&e(o,t),N.default.addEventV2({category:D.DOCUMENTATION_ANALYTICS.CATEGORY,action:"approve_request",label:this.props.isViewOnlyStatusPage?D.DOCUMENTATION_ANALYTICS.LABEL.PRIVATE_WORKSPACE:D.DOCUMENTATION_ANALYTICS.LABEL.PUBLIC_WORKSPACE,entityType:D.DOCUMENTATION_ENTITY.COLLECTION,entityId:this.props.collectionUid})},this.handleDenyRequest=()=>{this.setState({showDenyConfirmationModal:!1});const{denyRequestButtonCallback:e,collectionPublishRequestCode:t}=this.props;"function"==typeof e&&e(this.state.denyRequestNote,t),N.default.addEventV2({category:D.DOCUMENTATION_ANALYTICS.CATEGORY,action:"deny_request",label:this.props.isViewOnlyStatusPage?D.DOCUMENTATION_ANALYTICS.LABEL.PRIVATE_WORKSPACE:D.DOCUMENTATION_ANALYTICS.LABEL.PUBLIC_WORKSPACE,entityType:D.DOCUMENTATION_ENTITY.COLLECTION,entityId:this.props.collectionUid})},this.handleRetractRequest=()=>{this.setState({showRetractConfirmationModal:!1});const{retractRequestButtonCallback:e,collectionPublishRequestCode:t}=this.props;"function"==typeof e&&e(t),N.default.addEventV2({category:D.DOCUMENTATION_ANALYTICS.CATEGORY,action:"retract_request_status",label:this.props.isViewOnlyStatusPage?D.DOCUMENTATION_ANALYTICS.LABEL.PRIVATE_WORKSPACE:D.DOCUMENTATION_ANALYTICS.LABEL.PUBLIC_WORKSPACE,entityType:D.DOCUMENTATION_ENTITY.COLLECTION,entityId:this.props.collectionUid})},this.state={showCollectionDiscovery:!1,collectionType:null,apinetworkData:{},modalOpen:!1,modalLoading:!1,showRetractConfirmationModal:!1,showDenyConfirmationModal:!1,denyRequestNote:"",showBanner:!0,showTokenFailureBanner:!0,showNoTokensBanner:!0,showExposedTokensModal:!1,isFetchingScanAgainResult:!1},this.handleModalToggle=this.handleModalToggle.bind(this),this.handleRemoveFromPublicAPINetwork=this.handleRemoveFromPublicAPINetwork.bind(this),this.handleCopyButtonClick=this.handleCopyButtonClick.bind(this),this.handleDismissBanner=this.handleDismissBanner.bind(this),this.handleDismissNoTokensBanner=this.handleDismissNoTokensBanner.bind(this),this.handleDismissTokenFailureBanner=this.handleDismissTokenFailureBanner.bind(this),this.showExposedTokensModal=this.showExposedTokensModal.bind(this),this.hideExposedTokensModal=this.hideExposedTokensModal.bind(this),this.handleScanAgain=this.handleScanAgain.bind(this)}async componentDidMount(){const{publishedId:e}=this.props;try{const t=await Promise.all([T.default.getApiNetwork({publishedId:e}),T.default.getTemplate({publishedId:e})]),o=L.get(t,"0.body.data[0]"),s=L.get(t,"1.body.data[0]");o?this.setState({showCollectionDiscovery:!0,collectionType:"apinetwork",apinetworkData:o}):s&&this.setState({showCollectionDiscovery:!0,collectionType:"template",apinetworkData:s})}catch(e){pm.logger.error("PublishedStatus~componentDidMount - Error while fetching apinetwork data",e)}}getRequestedVersionNames(){let e=this.props.requestedVersions;return(Array.isArray(e)&&e.map((e=>e.apiName))||[]).join(", ")}getVersionNames(){let e=this.props.publishedVersions;return(Array.isArray(e)&&e.map((e=>e.apiName))||[]).join(", ")}handleModalToggle(){this.setState((e=>({modalOpen:!e.modalOpen})))}getRequestPayload(){let{requestData:e}=this.props,t=L.get(e,"data.body.data[0]",{}),{modelId:o}=t,{environmentTemplateId:s,environmentOwner:i,customDomainId:n,customColor:a,versionTag:l,documentationLayout:r}=t.metadata,d=e&&{uid:o,environmentTemplateId:s,environmentOwner:i,customDomainId:n,customColor:a,versionTag:l,documentationLayout:r};const c=this.props.tokenScanId?this.props.tokenScanId:null;return c?{...d,tokenScanId:c}:d}async handleRemoveFromPublicAPINetwork(){this.setState({modalLoading:!0});try{const{collectionType:e,apinetworkData:t}=this.state,o=L.get(t,"id","");"apinetwork"===e?await T.default.removeApiNetwork({id:o}):await T.default.removeTemplate({id:o}),this.setState({modalLoading:!1,showCollectionDiscovery:!1,collectionType:"",apinetworkData:{},modalOpen:!1}),pm.toasts.success("Successfully removed collection from Public API Network")}catch(e){pm.toasts.error("Could not remove collection from Public API Network"),pm.logger.error("PublishedStatus~handleRemoveFromPublicAPINetwork - Error while removing collection",e),this.setState({modalLoading:!1})}}handleDenyRequestNote(e){this.setState({denyRequestNote:e})}handleDismissBanner(){this.setState({showBanner:!1})}handleDismissNoTokensBanner(){this.setState({showNoTokensBanner:!1})}handleDismissTokenFailureBanner(){this.setState({showTokenFailureBanner:!1})}showExposedTokensModal(){this.setState({showExposedTokensModal:!0})}hideExposedTokensModal(){this.setState({showExposedTokensModal:!1})}async handleScanAgain(){this.setState({isFetchingScanAgainResult:!0});let e=this.getRequestPayload();try{"function"==typeof this.props.requestPublishButtonCallback&&await this.props.requestPublishButtonCallback(e,this.props.noteToCommunityManager,!0)}catch(e){pm.logger.error("PublishedStatus~handleScanAgain: Unable to scan again",e)}finally{this.setState({isFetchingScanAgainResult:!1})}}handleCopyButtonClick(){const{publishedUrl:e}=this.props;I.default.copy(e),pm.toasts.success("Published documentation's URL copied to clipboard successfully.")}render(){const{isOffline:e,isUnpublishing:t,handleBreadcrumbClick:o,collectionName:s,requestedCollectionName:n,teamLogoUrl:a,requestedEnvironment:l,publishedEnvironment:T,publishedUrl:I,isCollectionPublishRequested:k,noteToCommunityManager:O,isCommunityManager:P,isGovernance:R,isRequestRetracting:_,isRequestDenying:x,isRequestApproving:A,isViewOnlyStatusPage:q,isLimitReachedForPublish:U,isCollectionPublished:M,exposedTokensData:j,tokenScanId:B,tokenScanStatus:V,isFetchingScanData:F,fetchScanData:W}=this.props,{collectionType:H,modalOpen:Y,modalLoading:G,showBanner:$,showNoTokensBanner:z,showTokenFailureBanner:K,isFetchingScanAgainResult:J}=this.state;let Q=L.get(this.props.publishedStyling,"documentationLayout"),X=L.get(this.props.requestedStyling,"documentationLayout"),Z=L.get(this.props.requestedStyling,"customColor",{}),ee=L.get(this.props.publishedStyling,"customColor",{}),te=L.get(this.state.apinetworkData,"publicURL",""),oe=L.get(this.state.apinetworkData,"team")?L.get(this.state.apinetworkData,"team.publicURL",""):L.get(this.state.apinetworkData,"publishedBy.publicURL",""),se=R&&k?"Requested Settings":"Publication settings",ie=[{id:this.props.collectionUid,name:L.isEmpty(this.props.collectionName)?this.props.requestedCollectionName:this.props.collectionName,type:D.DOCUMENTATION_ENTITY.COLLECTION,workspaceId:this.props.workspaceId},{id:this.props.collectionUid,name:D.DOCUMENTATION_TITLE,type:D.DOCUMENTATION_WORKBENCH_IDENTIFIER,workspaceId:this.props.workspaceId}];return ie.push({name:se}),i.createElement("div",{className:"documentation-publish-status-page-before-customisation"},i.createElement("div",{"data-testid":"documentation-published-status",className:"documentation-published-status"},R&&k&&P&&U&&!M&&i.createElement("div",{className:"documentation-published-status-body--limit-reached-banner"},i.createElement(r.default,{status:"warning"},i.createElement(d.default,null,"You've reached your limit to publish documentation. You can unpublish existing documentation in your team or contact support to increase the limit."))),i.createElement(c.Breadcrumb,{className:"documentation-published-breadcrumbs",onItemClick:o},ie.map((e=>i.createElement(c.BreadcrumbItem,{itemData:e,key:e.name},e.name)))),R&&k?i.createElement(i.Fragment,null,i.createElement("div",{className:"documentation-published-status-header"},i.createElement("div",null,i.createElement("h3",null,"Requested settings")),i.createElement("div",{className:"documentation-published-status-header--buttons"},i.createElement(u.default,{type:"outline",size:"medium",className:"edit-settings-button",isDisabled:t||q,onClick:this.handleEditSettings,text:"Edit Settings",tooltip:(t||q)&&i.createElement(h.default,{content:"You do not have access to the underlying collection.",placement:"top"})}),k?P?i.createElement(i.Fragment,null,i.createElement(u.default,{type:"primary",size:"medium",className:"approve-button",isDisabled:A||e||U&&!M,isLoading:A,onClick:this.handleApproveRequest,text:"Approve",tooltip:U&&!M&&i.createElement(h.default,{content:"Youve reached your limit to publish documentation",placement:"top"})}),i.createElement(u.default,{type:"secondary",size:"medium",className:"deny-button",isDisabled:x||e,isLoading:x,onClick:()=>{this.setState({showDenyConfirmationModal:!0})},text:"Deny"}),i.createElement(m.Modal,{isOpen:this.state.showDenyConfirmationModal,onClose:()=>this.setState({showDenyConfirmationModal:!1})},i.createElement(m.ModalHeader,{heading:"Deny Request?"}),i.createElement(m.ModalContent,null,"Are you sure you want to deny the request to publish this collection's documentation?"),i.createElement(p.default,{direction:"column",gap:"spacing-s",padding:"spacing-xl"},i.createElement(g.default,{label:i.createElement(b.default,{text:"Add a note"}),rows:3,value:this.state.denyRequestNote,onChange:e=>this.handleDenyRequestNote(e.target.value),placeholder:"Enter the reason to deny the publish request."})),i.createElement(m.ModalFooter,null,i.createElement(p.default,{justifyContent:"flex-end",grow:1,shrink:1,gap:"spacing-s"},i.createElement(u.default,{type:"secondary",text:"Cancel",onClick:()=>this.setState({showDenyConfirmationModal:!1})}),i.createElement(u.default,{type:"destructive",text:"Confirm",onClick:()=>{this.handleDenyRequest()}}))))):i.createElement(i.Fragment,null,i.createElement(u.default,{type:"destructive",size:"medium",className:"unpublish-button",isDisabled:_||e,isLoading:_,onClick:()=>{this.setState({showRetractConfirmationModal:!0})},text:"Withdraw request"}),i.createElement(m.Modal,{isOpen:this.state.showRetractConfirmationModal,onClose:()=>this.setState({showRetractConfirmationModal:!1})},i.createElement(m.ModalHeader,{heading:"Withdraw Request?"}),i.createElement(m.ModalContent,null,"Are you sure you want to withdraw the request to publish this collection's documentation?"),i.createElement(m.ModalFooter,null,i.createElement(p.default,{justifyContent:"flex-end",grow:1,shrink:1,gap:"spacing-s"},i.createElement(u.default,{type:"secondary",text:"Cancel",onClick:()=>this.setState({showRetractConfirmationModal:!1})}),i.createElement(u.default,{type:"destructive",text:"Confirm",onClick:()=>{this.handleRetractRequest()}}))))):i.createElement(u.default,{type:"destructive",size:"medium",className:`unpublish-button ${(R&&!P||t||e)&&"unpublish-button--disabled"}`,isDisabled:R&&!P||t||e,tooltip:R&&!P&&"Only community manager can unpublish this documentation.",isLoading:t,onClick:this.handleUnpublish,text:"Unpublish"}))),i.createElement("hr",null),i.createElement("div",{className:"documentation-published-status-body"},q&&$&&!B&&i.createElement("div",{className:"documentation-published-status-body--private-collection-banner"},i.createElement(r.default,{status:"warning",onDismiss:this.handleDismissBanner},"You don't have access to the underlying collection.")),!L.isEmpty(O)&&i.createElement("div",{className:"documentation-published-status-body--note"},i.createElement("h4",{className:"documentation-published-status-body--label"},"Note to the Community Manager"),i.createElement("p",{className:"documentation-published-status-body--content--note-to-cm"},O)),i.createElement("div",{"data-testid":"documentation-published-status-body--token-banners",className:"documentation-published-status-body--token-banners"},!B||"IN_PROGRESS"!==V&&"STARTING"!==V?"SUCCESSFUL"===V?j.length>0?i.createElement(r.default,{"data-testid":"documentation-published-status-body--token-banners--warning-complete",status:"warning",primaryAction:i.createElement(u.default,{type:"outline",text:"View Secrets",onClick:this.showExposedTokensModal,"data-testid":"documentation-published-status-body--token-banners--warning-complete-view-secrets"}),title:"Secret scanning complete",secondaryAction:!q&&i.createElement(u.default,{type:"monochrome-plain",text:"Scan Again",onClick:this.handleScanAgain,isLoading:J,tooltip:"Restart secret scanning if you have made changes to the collection.","data-testid":"documentation-published-status-body--token-banners--warning-complete-scan-again"})},"Secret scanner detected ",j.length," exposed ",j.length>1?"secrets":"secret",". Once the request to publish is approved, these secrets will be visible to anyone with the URL to access the documentation."):z&&i.createElement(r.default,{"data-testid":"documentation-published-status-body--token-banners--success-complete",title:"Secret scanning complete",status:"success",onDismiss:this.handleDismissNoTokensBanner,secondaryAction:!q&&i.createElement(u.default,{type:"monochrome-plain",text:"Scan Again",onClick:this.handleScanAgain,isLoading:J,tooltip:"Restart secret scanning if you have made changes to the collection.","data-testid":"documentation-published-status-body--token-banners--success-complete-scan-again"})},"The collection has no exposed secrets."):"FAILURE"===V&&K&&i.createElement(r.default,{"data-testid":"documentation-published-status-body--token-banners--failure",status:"error",title:"Secret scanning failed",onDismiss:this.handleDismissTokenFailureBanner,primaryAction:!q&&i.createElement(u.default,{"data-testid":"documentation-published-status-body--token-banners--failed-restart",type:"outline",text:"Restart",isLoading:J,onClick:this.handleScanAgain})},q?"":"Restart secret scanning to ensure there are no exposed secrets. The scan result will show up soon."):i.createElement(r.default,{"data-testid":"documentation-published-status-body--token-banners--warning-progress",status:"warning",title:"Secret scanning in progress",primaryAction:i.createElement(u.default,{type:"outline",text:"Refresh",isLoading:F,onClick:()=>W(),"data-testid":"documentation-published-status-body--token-banners--warning-progress-refresh"})},"We're scanning this collection now to ensure there are no exposed secrets. Refresh in some time to see the report."),i.createElement(m.Modal,{isOpen:this.state.showExposedTokensModal,onClose:()=>this.hideExposedTokensModal(),size:"small","data-testid":"documentation-published-status-body--token-scan-modal"},i.createElement(m.ModalHeader,{"data-testid":"documentation-published-status-body--token-scan-modal-header",heading:"Exposed Secrets"}),i.createElement(m.ModalContent,null,i.createElement(r.default,{status:"warning"},"We've listed ",j.length," exposed ",j.length>1?"secrets":"secret"," based on the",i.createElement(f.default,{to:"https://learning.postman.com/docs/administration/token-scanner/",target:"_blank"},i.createElement(d.default,{type:"link-default"},"secret formats supported by Postman")),". Please check the collection for other undetected secrets before publishing its documentation."),i.createElement(y.default,{data:j,columns:[{Header:"Secret name",accessor:"tokenType",cellWidth:"144px"},{Header:"Secret value",accessor:"obfuscatedToken",cellWidth:"144px"},{Header:"Occurrence",accessor:"occurrences",cellWidth:"92px"}],bodyMaxHeight:"183px","data-testid":"documentation-published-status-body--token-scan-modal-content--table"})),!q&&i.createElement(m.ModalFooter,null,i.createElement(p.default,{justifyContent:"flex-end",grow:1,shrink:1,gap:"spacing-s"},i.createElement(u.default,{type:"secondary",text:"Cancel",onClick:()=>this.hideExposedTokensModal()}),i.createElement(u.default,{type:"primary",text:"View in Collection",onClick:()=>{var e,t;C.default.transitionTo("build.collection",{cid:null===(e=this.props)||void 0===e?void 0:e.collectionUid,wid:null===(t=this.props)||void 0===t?void 0:t.workspaceId}),this.hideExposedTokensModal()}}))))),i.createElement("div",{className:"documentation-published-status-body--content"},i.createElement("h4",{className:"documentation-published-status-body--label"},"Collection Name"),i.createElement("p",{className:"documentation-published-status-body--content--collection-name"},L.isEmpty(s)?n:s),i.createElement("p",{className:"documentation-published-status-body--content--versions"},"Versions: ",this.getRequestedVersionNames())),i.createElement("div",{className:"documentation-published-status-body--environment"},i.createElement("h4",{className:"documentation-published-status-body--label"},"Environment"),i.createElement("span",{className:"documentation-published-status-body--content--environment"},l)),i.createElement("div",{className:"documentation-published-status-body--styling"},i.createElement("h4",{className:"documentation-published-status-body--label"},"Styling"),i.createElement(E.default,{documentationLayout:X,highlightColor:Z.highlight,sidebarColor:Z["right-sidebar"],topBarColor:Z["top-bar"],teamLogoUrl:a})),this.state.showCollectionDiscovery&&i.createElement("div",{className:"documentation-published-status-body--collection-discovery"},i.createElement("div",{className:"documentation-published-status-body--heading"},i.createElement(v.default,{type:"h2",text:"Collection Discovery"}),i.createElement(u.default,{onClick:this.handleModalToggle,type:"text",text:"Remove from Public API Network"})),i.createElement("div",{className:"documentation-published-status-body--collection-discovery__section"},i.createElement(v.default,{type:"h4",text:"template"===H?"Postman templates":"Postman API Network"}),i.createElement(d.default,{type:"body-medium",color:"content-color-primary"},"Your listing is published on the Public API Network at"," ",i.createElement("br",null),i.createElement(f.default,{to:te,target:"_blank"},te))),i.createElement("div",{className:"documentation-published-status-body--collection-discovery__section"},i.createElement(v.default,{type:"h4",text:"Publisher Profile"}),i.createElement(d.default,{type:"body-medium",color:"content-color-primary"},"Your public profile is ",i.createElement(f.default,{to:oe,target:"_blank"},oe),". All your published work can be found here")))),i.createElement(w.Modal,{isOpen:Y,onRequestClose:this.handleModalToggle,className:"documentation-published-status-modal"},i.createElement(w.ModalHeader,null,"Remove from Public API Network"),i.createElement(w.ModalContent,null,i.createElement(d.default,{type:"body-large",color:"content-color-primary"},"Are you sure you want to remove this collection from the Public API network? ",i.createElement("br",null),"This collection would still be available through the published documentation but not discoverable through the API Network.")),i.createElement(w.ModalFooter,null,i.createElement(u.default,{type:"primary",className:"documentation-published-status-modal__remove-btn",onClick:this.handleRemoveFromPublicAPINetwork,isDisabled:G,text:"Remove from Public API Network"}),i.createElement(u.default,{type:"secondary",onClick:this.handleModalToggle,isDisabled:G,text:"Cancel"})))):i.createElement(i.Fragment,null,i.createElement("div",{className:"documentation-published-status-header"},i.createElement("div",null,i.createElement("h3",null,"Publication settings")),i.createElement("div",{className:"documentation-published-status-header--buttons"},i.createElement(u.default,{type:"secondary",size:"medium",className:"edit-settings-button",isDisabled:t||q,onClick:this.handleEditSettings,text:"Edit Settings",tooltip:(t||q)&&i.createElement(h.default,{content:"You do not have access to the underlying collection.",placement:"top"})}),i.createElement(u.default,{type:"destructive",size:"medium",className:`unpublish-button ${(R&&!P||t||e)&&"unpublish-button--disabled"}`,isDisabled:t||e||R&&!P,tooltip:R&&!P&&"Only community manager can unpublish this documentation.",isLoading:t,onClick:this.handleUnpublish,text:"Unpublish"}))),i.createElement("hr",null),i.createElement("div",{className:"documentation-published-status-body"},i.createElement("div",{className:"documentation-published-status-body--content"},i.createElement("h4",{className:"documentation-published-status-body--label"},"Published Collection"),i.createElement("p",{className:"documentation-published-status-body--content--collection-name"},s),i.createElement("p",{className:"documentation-published-status-body--content--versions"},"Versions: ",this.getVersionNames())),i.createElement("div",{className:"documentation-published-status-body--environment"},i.createElement("h4",{className:"documentation-published-status-body--label"},"Environment"),i.createElement("span",{className:"documentation-published-status-body--content--environment"},T)),i.createElement("div",{className:"documentation-published-status-body--url"},i.createElement("h4",{className:"documentation-published-status-body--label"},"URL for published documentation"),i.createElement("span",null,i.createElement(f.default,{to:I,onClick:()=>{N.default.addEventV2({category:D.DOCUMENTATION_ANALYTICS.CATEGORY,action:"click_published_url",label:D.DOCUMENTATION_ANALYTICS.LABEL.PUBLISHED_STATUS_TAB,entityType:D.DOCUMENTATION_ENTITY.COLLECTION,entityId:this.props.collectionUid})},target:"_blank"},I),i.createElement("span",{className:"documentation-published-status-body--copy-to-clipboard"},i.createElement(S.default,{type:"muted-plain",icon:"icon-action-copy-stroke",onClick:this.handleCopyButtonClick,tooltip:"Copy to clipboard"})))),i.createElement("div",{className:"documentation-published-status-body--styling"},i.createElement("h4",{className:"documentation-published-status-body--label"},"Styling"),i.createElement(E.default,{documentationLayout:Q,highlightColor:ee.highlight,sidebarColor:ee["right-sidebar"],topBarColor:ee["top-bar"],teamLogoUrl:a})),this.state.showCollectionDiscovery&&i.createElement("div",{className:"documentation-published-status-body--collection-discovery"},i.createElement("div",{className:"documentation-published-status-body--heading"},i.createElement(v.default,{type:"h2",text:"Collection Discovery"}),i.createElement(u.default,{onClick:this.handleModalToggle,type:"text",text:"Remove from Public API Network"})),i.createElement("div",{className:"documentation-published-status-body--collection-discovery__section"},i.createElement(v.default,{type:"h4",text:"template"===H?"Postman templates":"Postman API Network"}),i.createElement(d.default,{type:"body-medium",color:"content-color-primary"},"Your listing is published on the Public API Network at"," ",i.createElement("br",null),i.createElement(f.default,{to:te,target:"_blank"},te))),i.createElement("div",{className:"documentation-published-status-body--collection-discovery__section"},i.createElement(v.default,{type:"h4",text:"Publisher Profile"}),i.createElement(d.default,{type:"body-medium",color:"content-color-primary"},"Your public profile is ",i.createElement(f.default,{to:oe,target:"_blank"},oe),". All your published work can be found here")))),i.createElement(w.Modal,{isOpen:Y,onRequestClose:this.handleModalToggle,className:"documentation-published-status-modal"},i.createElement(w.ModalHeader,null,"Remove from Public API Network"),i.createElement(w.ModalContent,null,i.createElement(d.default,{type:"body-large",color:"content-color-primary"},"Are you sure you want to remove this collection from the Public API network? ",i.createElement("br",null),"This collection would still be available through the published documentation but not discoverable through the API Network.")),i.createElement(w.ModalFooter,null,i.createElement(u.default,{type:"primary",className:"documentation-published-status-modal__remove-btn",onClick:this.handleRemoveFromPublicAPINetwork,isDisabled:G,text:"Remove from Public API Network"}),i.createElement(u.default,{type:"secondary",onClick:this.handleModalToggle,isDisabled:G,text:"Cancel"}))))))}})||s;k.propTypes={unPublishButtonCallback:a().func.isRequired,editSettingsButtonCallback:a().func.isRequired,handleBreadcrumbClick:a().func.isRequired,collectionName:a().string.isRequired,collectionUid:a().string.isRequired,publishedUrl:a().string,publishedId:a().string.isRequired,publishedOwner:a().string.isRequired,publishedStyling:a().object.isRequired,publishedVersions:a().array.isRequired,publishedEnvironment:a().string,teamLogoUrl:a().string.isRequired,isOffline:a().bool.isRequired}},"./documentation/components/DocumentationPublishView/PublishedViewPreview.js":function(e,t,o){"use strict";o.r(t),o.d(t,{default:function(){return a}});var s=o("../../node_modules/react/index.js"),i=o("./documentation/utils/utils.js"),n=o("./documentation/constants.js");function a(e){const{documentationLayout:t}=e;switch(t){case"classic-double-column":default:return s.createElement(l,e);case"classic-single-column":return s.createElement(r,e)}}function l(e){let{highlightColor:t,topBarColor:o,sidebarColor:a,teamLogoUrl:l}=e,r={opacity:.05},d={opacity:.1},c={opacity:.1};return l=l||n.DOCUMENTATION_PUBLISHING.DEFAULT_DOCUMENTATION_LOGO_URL,s.createElement("svg",{id:"documenter-preview-double-col","data-testid":"documenter-preview-single-col--published-view-double",width:"100%",height:"130px"},s.createElement("rect",{x:"0",y:"0",width:"100%",height:"170",stroke:"#d8d8d8",style:{strokeWidth:1}}),s.createElement("rect",{x:"0",y:30,width:"100%",height:"130",fill:"#ffffff"}),s.createElement("rect",{x:"0",y:30,width:"30%",height:"130",fill:"#303030",style:{opacity:.05}}),s.createElement("rect",{x:"2%",y:"40",width:"26%",height:"10",rx:"3",ry:"3",fill:"#000000",style:r}),s.createElement("rect",{x:"2%",y:"55",width:"15%",height:"10",rx:"3",ry:"3",fill:"#000000",style:r}),s.createElement("rect",{x:"2%",y:"80",width:"26%",height:"10",rx:"3",ry:"3",fill:"#000000",style:r}),s.createElement("rect",{x:"2%",y:"95",width:"15%",height:"10",rx:"3",ry:"3",fill:"#000000",style:r}),s.createElement("rect",{x:"32%",y:"40",width:"41%",height:"10",rx:"3",ry:"3",fill:"#000000",style:r}),s.createElement("rect",{x:"32%",y:"55",width:"15%",height:"10",rx:"3",ry:"3",fill:"#000000",style:r}),s.createElement("rect",{x:"32%",y:"80",width:"15%",height:"10",rx:"3",ry:"3",fill:(0,i.formatInputHex)(t)}),s.createElement("rect",{x:"75%",y:30,width:"25%",height:"130",fill:(0,i.formatInputHex)(a)}),s.createElement("rect",{x:"75%",y:"40",width:"25%",height:"20",fill:"#ffffff",style:d}),s.createElement("rect",{x:"75%",y:"80",width:"25%",height:"10",fill:"#ffffff",style:d}),s.createElement("rect",{x:"0",y:"0",width:"100%",height:30,fill:(0,i.formatInputHex)(o),stroke:"#000000",style:{strokeWidth:.5,strokeOpacity:.3}}),s.createElement("image",{xlinkHref:l,preserveAspectRatio:"xMinYMin",x:"10",y:"5",width:"57",height:"20"}),s.createElement("rect",{x:"83%",y:"7",width:"15%",height:"16",rx:"3",ry:"3",fill:"#000000",style:c}),s.createElement("rect",{x:"66%",y:"7",width:"15%",height:"16",rx:"3",ry:"3",fill:"#000000",style:c}))}function r(e){let{highlightColor:t,topBarColor:o,sidebarColor:a,teamLogoUrl:l}=e,r={opacity:.05},d={opacity:.1};return l=l||n.DOCUMENTATION_PUBLISHING.DEFAULT_DOCUMENTATION_LOGO_URL,s.createElement("svg",{id:"documenter-preview-single-col","data-testid":"documenter-preview-single-col--published-view-single",width:"100%",height:"130px"},s.createElement("rect",{x:"0",y:"0",width:"100%",height:"170",stroke:"#d8d8d8",style:{strokeWidth:1}}),s.createElement("rect",{x:"0",y:30,width:"100%",height:"130",fill:"#ffffff"}),s.createElement("rect",{x:"0",y:30,width:"30%",height:"130",fill:"#303030",style:{opacity:.05}}),s.createElement("rect",{x:"2%",y:"40",width:"26%",height:"10",rx:"3",ry:"3",fill:"#000000",style:r}),s.createElement("rect",{x:"2%",y:"55",width:"15%",height:"10",rx:"3",ry:"3",fill:"#000000",style:r}),s.createElement("rect",{x:"2%",y:"80",width:"26%",height:"10",rx:"3",ry:"3",fill:"#000000",style:r}),s.createElement("rect",{x:"2%",y:"95",width:"15%",height:"10",rx:"3",ry:"3",fill:"#000000",style:r}),s.createElement("rect",{x:"2%",y:"135",width:"15%",height:"10",rx:"3",ry:"3",fill:"#000000",style:r}),s.createElement("rect",{x:"37%",y:"40",width:"45%",height:"10",rx:"3",ry:"3",fill:"#000000",style:r}),s.createElement("rect",{x:"37%",y:"55",width:"35%",height:"10",rx:"3",ry:"3",fill:(0,i.formatInputHex)(t)}),s.createElement("rect",{x:"30%",y:"85",width:"70%",height:"50",fill:(0,i.formatInputHex)(a)}),s.createElement("rect",{x:"37%",y:"85",width:"56%",height:"50",rx:"3",ry:"3",fill:"#ffffff",style:{opacity:.1}}),s.createElement("rect",{x:"0",y:"0",width:"100%",height:30,fill:(0,i.formatInputHex)(o),stroke:"#000000",style:{strokeWidth:.5,strokeOpacity:.3}}),s.createElement("image",{xlinkHref:l,preserveAspectRatio:"xMinYMin",x:"10",y:"5",width:"57",height:"20"}),s.createElement("rect",{x:"83%",y:"7",width:"15%",height:"16",rx:"3",ry:"3",fill:"#000000",style:d}),s.createElement("rect",{x:"66%",y:"7",width:"15%",height:"16",rx:"3",ry:"3",fill:"#000000",style:d}))}},"./documentation/components/DocumentationPublishView/ShareToWorkspace/InputSelect.js":function(e,t,o){"use strict";o.r(t),o.d(t,{InputSelect:function(){return f}});var s=o("../../node_modules/react/index.js"),i=(o("../../node_modules/react-dom/index.js"),o("./js/components/base/Inputs.js")),n=o("./js/components/base/Buttons.js"),a=o("./node_modules/classnames/index.js"),l=o.n(a),r=o("./node_modules/prop-types/index.js"),d=o.n(r),c=o("../../node_modules/@postman/aether/esmLib/src/components/Spinner/Spinner.js"),u=o("../../node_modules/@postman/aether-icons/esmLib/src/Icon/Icon.js"),h=o("./js/stores/StoreManager.js"),m=o("./js/stores/CurrentUserStore.js"),p=o("./js/stores/FeatureFlagsStore.js"),g=o("./collaboration/services/PermissionService.js"),b=o("./js/components/base/Dropdowns.js"),y=o("./documentation/components/DocumentationIntersectionObserver/index.js"),v=o("./node_modules/lodash/lodash.js");let E="";class f extends s.Component{constructor(e){super(e),this.getFilteredListDebounce=v.debounce((e=>this.props.getFilteredList(e)),500),this.state={focusedItem:null,isOpen:!1,inputValue:e.getInputValue(e.selectedItem),selectedItem:e.selectedItem,permissions:[]},this.inputRef=s.createRef(),this.wrapperRef=s.createRef(),this.handleChange=this.handleChange.bind(this),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleToggleList=this.handleToggleList.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleFocus=this.handleFocus.bind(this),this.handleSelect=this.handleSelect.bind(this),this.handleClose=this.handleClose.bind(this),this.handleCreateWorkspace=this.handleCreateWorkspace.bind(this),this.fetchPermissions=this.fetchPermissions.bind(this)}componentDidMount(){this.fetchPermissions()}async fetchPermissions(){const e=(0,h.resolveStoreInstance)(m.default).teamId,t=(0,h.resolveStoreInstance)(p.default).get("workspace:isCommunityManagerEnabled");let o={};if(e&&t){const{manageWorkspaceVisibilityRequests:t}=await(0,g.fetchPermissions)(["manageWorkspaceVisibilityRequests"],e);o.manageWorkspaceVisibilityRequests=t}this.setState({permissions:o,isCommunityManagerEnabled:t})}renderOptions(){const{optionRenderer:e,getFilteredList:t}=this.props,{inputValue:o,selectedItem:i,focusedItem:n}=this.state;if(!E||!o||E!==o||this._visibleItems)return E=o,this._visibleItems=this.props.dropdownItems,v.chain(this._visibleItems).map((t=>{let o=e(t,E),a=t.id===(n&&n.id),r=t.id===(i&&i.id);if(o&&t.id)return s.createElement(b.MenuItem,{className:l()({item:!0,"is-focused":a,"is-selected":r},"share-to-public-workspace-dropdown-item"),disabled:t.disabled,key:t.id,refKey:t.id,onMouseEnter:()=>{this.handleMouseEnter(t)},onMouseLeave:()=>{this.handleMouseLeave()},onSelect:()=>{this.handleSelect(t.id)}},o)})).compact().value()}handleMouseEnter(e){this.focusOption(e)}handleMouseLeave(){this.focusOption(null)}handleCancel(){this.props.clearSelectedItem(),setTimeout((()=>{this.focus()}),0)}focus(){this.inputRef.current&&this.inputRef.current.focus()}blur(){this.inputRef.current&&(this.inputRef.current.blur(),this.props.resetEmptyFilterOnBlur&&!this.state.inputValue&&this.setState({inputValue:this.props.getInputValue(this.props.selectedItem)}),pm.mediator.trigger("focusBuilder"),this.props.onBlur&&this.props.onBlur())}handleOpen(){this.setState({isOpen:!0},this.focus)}handleToggleList(){this.state.isOpen?this.handleClose():this.handleOpen()}handleClose(){this.state.isOpen&&this.setState({isOpen:!1},this.blur)}handleSelect(e){let t=v.find(this._visibleItems,{id:e});t&&this.selectFocusedOption(t)}handleKeyDown(e){let t=this.state.focusedItem;switch(e.key){case"ArrowDown":e.preventDefault(),this.focusAdjacentOption("next");break;case"ArrowUp":e.preventDefault(),this.focusAdjacentOption("previous");break;case"Enter":e.preventDefault(),t&&this.handleSelect(t.id),this.handleClose();break;case"Escape":e.preventDefault()}}handleFocus(){this.props.openOnFocus&&this.setState({isOpen:!0}),this.props.onFocus&&this.props.onFocus()}getNextVisibleItem(e,t){if(v.every(e,{disableFocus:!0}))return null;let o,s=v.findIndex(e,{id:t&&t.id});return-1===s||s===e.length-1?(o=e[0],o.disableFocus?this.getNextVisibleItem(e,o):o):(o=e[s+1],o.disableFocus?this.getNextVisibleItem(e,o):o)}getPreviousVisibleItem(e,t){if(v.every(e,{disableFocus:!0}))return null;let o,s=v.findIndex(e,{id:t&&t.id});return-1===s||0===s?(o=v.last(e),o.disableFocus?this.getPreviousVisibleItem(e,o):o):(o=e[s-1],o.disableFocus?this.getPreviousVisibleItem(e,o):o)}focusOption(e){this.setState({focusedItem:e})}focusAdjacentOption(e){let t=this.state.focusedItem,o=this._visibleItems;"next"===e?t=this.getNextVisibleItem(o,t):"previous"===e&&(t=this.getPreviousVisibleItem(o,t)),this._scrollToFocusedOption=!0,this.setState({focusedItem:t})}selectFocusedOption(e){const t=e||this.state.focusedItem;this.props.onSelect&&this.props.onSelect(t),this.handleClose()}handleChange(e){this.setState({inputValue:e,isOpen:!0,focusedItem:null},(()=>{this.getFilteredListDebounce(e),this.props.onChange&&this.props.onChange(e)}))}UNSAFE_componentWillReceiveProps(e){this.props.selectedItem!==e.selectedItem&&this.setState({selectedItem:e.selectedItem,inputValue:e.getInputValue(e.selectedItem)})}getWrapperClasses(){return l()({[this.props.className]:!0,"input-select-wrapper":!0,"is-open":this.state.isOpen,"is-disabled":this.props.disabled})}handleCreateWorkspace(){this.props.handleCreateNewWorkspace(),this.handleClose()}renderMenu(){let e=this.renderOptions(),t=v.get(this.state.permissions,"manageWorkspaceVisibilityRequests"),o=!(0,h.resolveStoreInstance)(p.default).get("workspace:isCommunityManagerEnabled")&&!t;return s.createElement(y.default,null,(({rootRef:i})=>s.createElement("div",{className:"share-to-public-workspace-dropdown"},s.createElement(b.DropdownMenu,{disableCloseOnInputElementScroll:this.props.disableCloseOnInputElementScroll,fluid:!0,className:"share-to-public-workspace-dropdown-menu",parentClassName:`input-select-dropdown-menu ${this.props.menuClassName}`,targetRef:this.wrapperRef.current,onSelect:this.handleSelect,onClose:this.handleClose},s.createElement("div",{className:"share-to-public-workspace-dropdown-menu__list",ref:e=>{i(e)}},v.isEmpty(e)||this.props.displayEmptyDropdown?s.createElement("div",{className:"share-to-public-workspace-dropdown-menu__list__no-results"},o?"No workspaces found.":t?this.props.noSearchResultsPlaceholder:"No workspaces found. To create one, contact your team's Community Manager."):e),this.props.isFetchingWorkspaces&&s.createElement("div",{className:"share-to-public-workspace-dropdown-menu__spinner"},s.createElement(c.default,null)),s.createElement(n.Button,{disabled:!t,onClick:this.handleCreateWorkspace,className:"share-to-public-workspace-dropdown-menu__list__button",tooltip:!t&&"To create one, contact your team's Community Manager.",tooltipPlacement:"right"},"+ Create Workspace")))))}render(){const{placeholder:e,hideSearchGlass:t,hideCancelOnBlur:o,showToggleButton:a,selectAllOnFocus:l}=this.props;return s.createElement("div",{ref:this.wrapperRef,className:this.getWrapperClasses(),style:this.props.style},s.createElement(i.Input,{hideCancelOnBlur:o,hideSearchGlass:t,inputStyle:"search",placeholder:e||"Type to filter",query:this.state.inputValue,ref:this.inputRef,selectAllOnFocus:l,onCancel:this.handleCancel,onChange:this.handleChange,onFocus:this.handleFocus,onKeyDown:this.handleKeyDown,disabled:this.props.disabled}),a&&s.createElement(n.Button,{className:"dropdown-button",ref:"button",onClick:this.handleToggleList,disabled:this.props.disabled},s.createElement(u.default,{name:"icon-direction-down",className:"dropdown-caret"})),this.state.isOpen&&this.renderMenu(),s.createElement("div",null))}}f.defaultProps={closeOnBlur:!0,closeOnSelect:!0,hideCancelOnBlur:!0,selectAllOnFocus:!0,showToggleButton:!0,hideSearchGlass:!0,openOnFocus:!0,resetEmptyFilterOnBlur:!0,menuClassName:"",disableCloseOnInputElementScroll:!0,isFetchingWorkspaces:!1},f.propTypes={closeOnBlur:d().bool,closeOnSelect:d().bool,hideCancelOnBlur:d().bool,selectAllOnFocus:d().bool,showToggleButton:d().bool,hideSearchGlass:d().bool,resetEmptyFilterOnBlur:d().bool,menuClassName:d().string,onBlur:d().func,onFocus:d().func,openOnFocus:d().bool,optionRenderer:d().func.isRequired,getInputValue:d().func.isRequired,selectedItem:d().object.isRequired,getFilteredList:d().func.isRequired,disableCloseOnInputElementScroll:d().bool,isFetchingWorkspaces:d().bool}},"./documentation/components/DocumentationPublishView/ShareToWorkspace/ShareToWorkspaceDropdown.js":function(e,t,o){"use strict";o.r(t),o.d(t,{default:function(){return c}});var s=o("../../node_modules/react/index.js"),i=o("../../node_modules/styled-components/dist/styled-components.browser.esm.js"),n=(o("./node_modules/classnames/index.js"),o("./documentation/components/DocumentationPublishView/ShareToWorkspace/InputSelect.js")),a=(o("./js/modules/services/RemoteSyncRequestService.js"),o("./js/components/base/LoadingIndicator.js"));const l=i.default.div`
  display: flex;
  flex-direction: row;

  .input-select-wrapper {
    background-color: var(--background-color-secondary);

    .input {
      font-family: var(--text-family-default);
      font-weight: normal !important;
      font-size: var(--text-size-m);
      line-height: var(--line-height-m);
      color: var(--content-color-primary);
      align-items: center;
      display: flex;
    }
  }
`,r=i.default.div`
  span {
    margin-left: var(--spacing-s);
    vertical-align: top;
  }
`,d=(0,i.default)(a.default)`
  position: relative;
  left: 0;
  margin-left: var(--spacing-m);
  padding-bottom: var(--spacing-m);
`;class c extends s.Component{constructor(e){super(e),this.state={workspaces:this.props.dropdownItems,loading:!1}}getOption(e,t,o={}){const{name:i,id:n,component:a}=e;return s.createElement("div",{className:"item-wrapper"},s.createElement("div",{className:"item-label",title:i},a))}filterWorkspaces(e,t,o={}){let s={visibilityStatus:"public",limit:50,name:t||""};this.props.setFilter(t),this.props.fetchPublicWorkspaces(s)}render(){const e=this.props.selectedItem;let t=[];return this.state.workspaces.forEach(((e,o)=>{t[o]={...e,renderOption:s.createElement(r,null,s.createElement("span",null,e.name))}})),this.state.loading?s.createElement(d,null):s.createElement(l,null,s.createElement(n.InputSelect,{disabled:this.props.disabled,style:{width:"420px"},selectedItem:e,handleCreateNewWorkspace:this.props.handleCreateNewWorkspace,getInputValue:e=>e&&e.name||"",optionRenderer:this.getOption,dropdownItems:this.props.dropdownItems,getFilteredList:this.filterWorkspaces.bind(this,this.props.dropdownItems),ref:"inputSelect",onSelect:this.props.onSelectItem,menuClassName:"workspace-selector-menu",displayEmptyDropdown:this.props.displayEmptyDropdown,placeholder:"Search for a workspace",noSearchResultsPlaceholder:"No workspaces found.",clearSelectedItem:this.props.clearSelectedItem,isFetchingWorkspaces:this.props.isFetchingWorkspaces}))}}},"./documentation/components/DocumentationPublishView/ShareToWorkspace/WorkspaceListItem.js":function(e,t,o){"use strict";o.r(t);var s=o("../../node_modules/react/index.js"),i=o("./node_modules/classnames/index.js"),n=o.n(i),a=o("../../node_modules/@postman/aether/esmLib/src/components/Tooltip/Tooltip.js"),l=o("../../node_modules/@postman/aether-icons/esmLib/src/Icon/Icon.js"),r=(o("./js/components/base/Buttons.js"),o("./js/components/base/LoadingIndicator.js"),o("./documentation/components/DocumentationIntersectionObserver/DocumentationIntersectionObserver.js"));class d extends s.Component{constructor(e){super(e),this.container=(0,s.createRef)(),this.state={isLoading:!1}}componentDidMount(){this.props.register(this.props.workspaceId,{target:this.container.current,onEnter:this.handleViewportEnter.bind(this)})}componentWillUnmount(){this.props.deregister(this.props.workspaceId)}async handleViewportEnter(){await this.props.loadMore()}getItemClasses(){return n()({"doc-workspace-list-item":!0,"is-disabled":this.props.disabled})}getContextItem(){switch(this.props.context){case"shared":return s.createElement("div",null,s.createElement("span",{className:n()({"doc-workspace__shared":this.props.disabled})},s.createElement(a.default,{content:"The collection already exists in this workspace.",placement:"right"},s.createElement(l.default,{size:"small",name:"icon-state-info-stroke-small"}))));case"moveNotAllowed":return s.createElement("div",null,s.createElement("span",{className:n()({"doc-workspace__shared":this.props.disabled})},s.createElement(a.default,{content:"You dont have access to move collections to this workspace.",placement:"right"},s.createElement(l.default,{size:"small",name:"icon-state-info-stroke-small"}))))}}render(){return s.createElement("div",{className:this.getItemClasses(),ref:this.container},s.createElement(l.default,{name:"icon-state-published-stroke",color:"content-color-secondary",className:"doc-workspace-type-icon"}),s.createElement("div",{className:"doc-workspace-list-item__name"},this.props.text),this.getContextItem())}}t.default=(0,r.withIntersectionObserver)(d)},"./documentation/components/DocumentationPublishView/ShareToWorkspace/index.js":function(e,t,o){"use strict";o.r(t),o.d(t,{default:function(){return v}});var s=o("./node_modules/lodash/lodash.js"),i=o.n(s),n=o("../../node_modules/react/index.js"),a=o("./node_modules/prop-types/index.js"),l=o.n(a),r=o("../../node_modules/@postman/aether/esmLib/src/components/Banner/Banner.js"),d=o("./documentation/components/DocumentationPublishView/ShareToWorkspace/ShareToWorkspaceDropdown.js"),c=o("./js/stores/StoreManager.js"),u=o("./js/stores/CurrentUserStore.js"),h=o("./js/stores/SyncStatusStore.js"),m=o("./documentation/components/DocumentationPublishView/ShareToWorkspace/WorkspaceListItem.js"),p=o("./documentation/services/DocumentationService.js"),g=o("./js/services/CurrentUserDetailsService.js"),b=o("./collaboration/workspace/types/PermissionTypes.ts"),y=o("./documentation/constants.js");class v extends n.Component{constructor(e){super(e),this.state={publicWorkspaces:{},dropdownDisabled:!0,displayEmptyDropdownPlaceholder:!0,selectedWorkspace:{},isSharing:!1,publicWorkspacesListItems:[{}],workspaceListWithCollection:[],permissions:[],isFetchingWorkspaces:!1,canMoveEnvironment:!0,canMoveCollection:!1},this.handleWorkspaceSelect=this.handleWorkspaceSelect.bind(this),this.fetchPublicWorkspaces=this.fetchPublicWorkspaces.bind(this),this.handleShare=this.handleShare.bind(this),this.handleCreateNewWorkspace=this.handleCreateNewWorkspace.bind(this),this.handleCreatedPublicWorkspace=this.handleCreatedPublicWorkspace.bind(this),this.updateWorkspaceItems=this.updateWorkspaceItems.bind(this),this.clearSelectedItem=this.clearSelectedItem.bind(this)}async transformWorkspacesIntoDropdownList(e){let t=(0,c.resolveStoreInstance)(u.default),o=(t&&t.id,[]),s=[],a=[];if(Array.isArray(e.data))for(const[t,i]of e.data.entries()){let t=!!this.state.workspaceListWithCollection.find((e=>e.id===i.id)),l=this.state.permissions[i.id],r=t?"shared":l?"":"moveNotAllowed",d=""!==r,c={id:i.id,name:i.name,component:n.createElement(m.default,{text:i.name,context:r,workspaceId:i.id,loadMore:this.loadMore.bind(this,i.id,e.data.length,e.meta)}),disabled:d};t?s.push(c):l?o.push(c):a.push(c)}return o.push(...a),o.push(...s),i().isEmpty(o)?[{}]:o}async fetchPublicWorkspaces(e={visibilityStatus:"public",limit:50}){try{let t=await(0,p.fetchWorkspaces)(e),o=!t.data.length,s={};this.state.publicWorkspaces.data&&e.cursor?(s={...this.state.publicWorkspaces},s.meta=t.meta,s.data.push(...t.data)):s=t,this.setState({publicWorkspaces:s,dropdownDisabled:!1,displayEmptyDropdownPlaceholder:o}),await this.setWorkspacePermissions(this.state.publicWorkspaces.data);let i=await this.getWorkspaceItems();this.setState({publicWorkspacesListItems:i})}catch(e){throw pm.logger.error("ShareToWorkspace~fetchWorkspaces: Failed to fetch public workspaces",e),pm.toasts.error("Failed to load Public Workspaces. Please try again later"),this.setState({dropdownDisabled:!0}),e}}async loadMore(e,t,o){const s=i().findIndex(this.state.publicWorkspacesListItems,(t=>t.id===e));if(s&&t===s+1&&o.nextCursor){this.setState({isFetchingWorkspaces:!0});try{await this.fetchPublicWorkspaces({visibilityStatus:"public",cursor:o.nextCursor,limit:50,name:this.query?this.query:""})}catch(e){pm.logger.error("ShareToWorkspace~loadMore: Error occured while fetching public workspaces",e)}finally{this.setState({isFetchingWorkspaces:!1})}}}async checkEnvMovePermission(){if(!this.props.selectedEnvironment)return void this.setState({canMoveEnvironment:!0});let e={},t={},o=g.default.userId,{workspaceId:s}=this.props;e[s]={entityType:b.ENTITY_TYPE.USER,entityId:o,objectType:b.OBJECT_TYPE.WORKSPACE,objectId:s,permission:y.MOVE_REMOVE_PERMISSIONS.environment},t=await(0,p.fetchPermissions)(e),s&&t[s]&&t[s].allowed?this.setState({canMoveEnvironment:!0}):this.setState({selectedWorkspace:{},canMoveEnvironment:!1})}async checkCollectionMovePermission(){let e={},t={},o=g.default.userId,{workspaceId:s}=this.props;e[s]={entityType:b.ENTITY_TYPE.USER,entityId:o,objectType:b.OBJECT_TYPE.WORKSPACE,objectId:s,permission:y.MOVE_REMOVE_PERMISSIONS[y.DOCUMENTATION_ENTITY.COLLECTION]},t=await(0,p.fetchPermissions)(e),s&&t[s]&&t[s].allowed?this.setState({canMoveCollection:!0}):this.setState({canMoveCollection:!1})}async setWorkspacePermissions(e){const t=i().map(e,"id"),{permissions:o}=this.state,s=g.default.userId;let n={},a={};for(const e of t)o[e]||e===this.props.workspaceId||(n[e]={entityType:b.ENTITY_TYPE.USER,entityId:s,objectType:b.OBJECT_TYPE.WORKSPACE,objectId:e,permission:y.MOVE_ADD_PERMISSIONS.collection});try{i().isEmpty(n)||(a=await(0,p.fetchPermissions)(n))}catch(e){pm.logger.error("ShareToWorkspace~setWorkspacePermissions: Error occurred while fetching permissions",e)}this.setState((e=>({permissions:i().reduce(t,((t={},o)=>(e.permissions[o]||(t[o]=i().get(a,`${o}.allowed`,!1)),t)),e.permissions)})))}handleWorkspaceSelect(e){this.setState({selectedWorkspace:e})}handleCreateNewWorkspace(){pm.mediator.trigger("openCreateNewPublicWorkspaceModal",{handleCreatedPublicWorkspace:this.handleCreatedPublicWorkspace,collectionName:this.props.collectionName})}handleCreatedPublicWorkspace(e){this.updateWorkspaceItems(e),this.setState({selectedWorkspace:e})}setFilter(e){this.query=e}async getWorkspaceItems(){let{publicWorkspaces:e}=this.state;return!e.data||!e.data.length?[{}]:await this.transformWorkspacesIntoDropdownList(e)}updateWorkspaceItems(e){e&&this.setState((t=>({publicWorkspaces:[...t.publicWorkspaces.data,{...e,context:"",disabled:!1}]})))}clearSelectedItem(){this.setState({selectedWorkspace:{}})}async handleShare(){if(this.state.isSharing||i().isEmpty(this.state.selectedWorkspace))return this.props.onShareComplete();this.setState({isSharing:!0},(async()=>{try{let e=!1;if(await(0,c.resolveStoreInstance)(h.default).onSyncAvailable({timeout:1e4}),await(0,p.moveEntity)(this.state.selectedWorkspace.id,y.DOCUMENTATION_ENTITY.COLLECTION,this.props.collectionUid,this.props.workspaceId),this.props.selectedEnvironment&&this.props.selectedEnvironment.id&&this.props.selectedEnvironment.owner)try{await(0,c.resolveStoreInstance)(h.default).onSyncAvailable({timeout:1e4}),await(0,p.moveEntity)(this.state.selectedWorkspace.id,"environment",`${this.props.selectedEnvironment.owner}-${this.props.selectedEnvironment.id}`,this.props.workspaceId),e=!0}catch(e){pm.logger.error("ShareToWorkspace~handleShare : Failed to move environment to the workspace",e),pm.toasts.error("Failed to move the environment to the workspace. Please try again later.")}this.props.onShareComplete(null,this.state.selectedWorkspace.id,e)}catch(e){pm.logger.error("ShareToWorkspace~handleShare : Failed to share collection to the workspace",e),pm.toasts.error("Failed to move the collection to the workspace. Please try again later."),this.props.onShareComplete(e)}finally{this.setState({isSharing:!1})}}))}async componentDidMount(){await this.checkCollectionMovePermission(),await this.filterWorkspacesWithCollection(),await this.fetchPublicWorkspaces()}async filterWorkspacesWithCollection(){let e,t=[],{collectionUid:o}=this.props;try{do{let s=await(0,p.fetchWorkspaces)({limit:50,element:{type:"collection",id:o},visibilityStatus:"public",...e&&{cursor:e}});e=i().get(s,"meta.nextCursor"),t=i().unionBy(t,s.data,"id")}while(e)}catch(e){pm.logger.error("SharedWorkspaceList~filterWorkspacesWithCollection: Failed to fetch public workspaces",e),pm.toasts.error("Failed to load Public Workspaces. Please try again later")}this.setState({workspaceListWithCollection:t})}componentDidUpdate(e){!1===e.triggerShare&&!0===this.props.triggerShare&&this.handleShare(),e.selectedEnvironment!==this.props.selectedEnvironment&&this.checkEnvMovePermission()}render(){return n.createElement("div",{className:"share-to-workspace-container"},n.createElement("p",{className:"share-to-workspace-heading"},"Move to public workspace",n.createElement("span",{className:"share-to-workspace-optional"},"(optional)")),!this.state.canMoveCollection&&n.createElement(r.default,{title:"Insufficient permissions",status:"warning",className:"share-to-workspace-permissions-banner"},"You need to be an Editor in the current workspace to be able to move the collection."),this.state.canMoveCollection&&!this.state.canMoveEnvironment&&n.createElement(r.default,{title:"Insufficient permissions",status:"warning",className:"share-to-workspace-permissions-banner"},"You need to be an Editor in the current workspace to be able to move the environment."),n.createElement("h6",{className:"share-to-workspace-label"},"Select public workspace"),n.createElement("div",{className:"share-to-workspace-dropdown-and-text"},n.createElement("div",{className:"public-workspace-dropdown"},n.createElement(d.default,{disabled:this.state.dropdownDisabled||!this.state.canMoveCollection||!this.state.canMoveEnvironment,dropdownItems:this.state.publicWorkspacesListItems,onSelectItem:this.handleWorkspaceSelect,selectedItem:this.state.selectedWorkspace,handleCreateNewWorkspace:this.handleCreateNewWorkspace,displayEmptyDropdown:this.state.displayEmptyDropdownPlaceholder,clearSelectedItem:this.clearSelectedItem,fetchPublicWorkspaces:this.fetchPublicWorkspaces.bind(this),setFilter:this.setFilter.bind(this),isFetchingWorkspaces:this.state.isFetchingWorkspaces})),n.createElement("div",{className:"workspace-helper-text"},"This will make the collection (and environment, if selected) discoverable on the Public API Network along with its documentation.")))}}v.propTypes={collectionUid:l().string.isRequired,onShareComplete:l().func,triggerShare:l().bool}},"./documentation/components/DocumentationPublishView/SidebarNavigation.js":function(e,t,o){"use strict";o.r(t),o.d(t,{default:function(){return u}});var s=o("./node_modules/lodash/lodash.js"),i=o.n(s),n=o("../../node_modules/react/index.js"),a=o("./node_modules/classnames/index.js"),l=o.n(a),r=o("../../node_modules/@postman/aether-icons/esmLib/src/Icon/Icon.js"),d=o("./documentation/constants.js"),c=o("./js/components/base/Tooltips.js");function u(e){const{options:t,className:o}=e,[s,a]=(0,n.useState)(!1),u=(0,n.useRef)();return n.createElement(n.Fragment,null,n.createElement("div",{className:l()("pm-sidebar-navigation",o)},n.createElement("ul",null,Array.isArray(t)&&t.map(((t,o)=>{const s=e.activeItem===i().get(t,"hash");return n.createElement("li",{className:l()({"active-item":s}),key:o},n.createElement("a",{className:l()("pm-sidebar-navigation__item",{"pm-sidebar-navigation__item--active":s}),href:t.hash,onClick:()=>{!function(e,t){"function"==typeof t.onClick&&t.onClick(e)}(t,e)}},t.label))}))),"browser"===window.SDK_PLATFORM&&n.createElement("div",{className:"preview-documentation",ref:u,onMouseOver:()=>{a(!0)},onMouseOut:()=>{a(!1)},onClick:()=>{"function"==typeof e.handlePreview&&e.handlePreview(d.DOCUMENTATION_PUBLISHING.USER_PREVIEW_REQUEST)}},n.createElement(r.default,{name:"icon-action-view-stroke",color:"content-color-primary"}),n.createElement("span",{className:"preview-label"},"Preview Documentation"))),n.createElement(c.Tooltip,{target:u.current,immediate:!0,placement:"right",show:s},n.createElement(c.TooltipBody,null,"Opens a live preview of the documentation in another window, which reloads on any change.")))}},"./documentation/components/DocumentationPublishView/index.js":function(e,t,o){"use strict";o.r(t);var s,i=o("../../node_modules/react/index.js"),n=o("../../node_modules/mobx/lib/mobx.module.js"),a=o("../../node_modules/mobx-react/dist/mobx-react.module.js"),l=o("./node_modules/lodash/lodash.js"),r=o.n(l),d=o("./js/stores/StoreManager.js"),c=o("./js/stores/CurrentUserStore.js"),u=o("./js/stores/SyncStatusStore.js"),h=o("../../node_modules/@postman/aether/esmLib/src/components/Button/Button.js"),m=o("../../node_modules/@postman/aether/esmLib/src/components/Illustration/illustrations/NoReport.js"),p=o("../../node_modules/@postman/aether/esmLib/src/components/Toast/withToast.js"),g=o("../../node_modules/@postman/aether-icons/esmLib/src/design-system-icons/icon-action-openWeb-stroke.js"),b=o("./js/components/base/LoadingIndicator.js"),y=o("./documentation/utils/utils.js"),v=o("./documentation/components/DocumentationPublishView/PublishedStatus.js"),E=o("./documentation/components/DocumentationPublishView/DocumentationPublishFlows/PublishedStatusPage.js"),f=o("./documentation/components/DocumentationPublishView/PublishSettings.js"),C=o("./documentation/components/DocumentationPublishView/DocumentationPublishFlows/PublishSettingsPage.js"),w=o("./js/services/NavigationService.js"),T=o("./documentation/components/DocumentationError.js"),D=o("./documentation/services/DocumentationService.js"),S=o("./js/services/CurrentUserDetailsService.js"),I=o("./documentation/constants.js"),N=o("./billing/stores/PlanFeaturesStore.js"),L=o("./js/modules/services/AnalyticsService.js"),k=o("./documentation/hocs/withErrorBoundary.js");let O=(0,a.observer)(s=class extends i.Component{constructor(...e){super(...e),this.state={showPublishedStatusPage:!0,isPublished:null,isPublishing:null,isUnpublished:null,isUnpublishing:null,destinationWorkspaceId:null,isRequestApproving:null,isRequestApproved:null,isRequestDenying:null,isRequestDenied:null,isRequestRetracting:null,isRequestRetracted:null,isGovernanceEnabled:!1,isCustomisationEnabled:!1,isCommunityManager:!1,isGovernanceLoading:!0,isRequesting:null,isRequested:null,collectionWorkspaceId:null,respondedFrom:null,isCollectionApiExclusive:!1,hasError:!1,isFetchingScanData:!1},this.handleUnpublish=async()=>{const{addToast:e}=this.props;let t=r().get(this.props.controller,"params.collectionUid");try{this.setState({isUnpublishing:!0,isUnpublished:!1});let e=await(0,D.unpublishDocumentation)(t);this.setState({isUnpublishing:!1,isUnpublished:"success"===r().get(e,"body.status")})}catch(o){this.setState({isUnpublishing:!1}),e({status:"error",description:"Error unpublishing Collection"}),pm.logger.error(`DocumentationPublishView~handleUnpublish: Error unpublishing collection: ${t}`,o)}},this.handleRetractRequest=async e=>{const{addToast:t}=this.props;let o=r().get(this.props.controller,"params.collectionUid");try{this.setState({isRequestRetracting:!0,isRequestRetracted:!1}),await(0,D.retractRequest)(e),this.setState({isRequestRetracting:!1,isRequestRetracted:!0}),t({title:"Request to publish withdrawn",status:"success",description:"This request has been removed from the Community Managers' queue."}),w.default.transitionTo("documentation.openWithWsSelect",{collectionUid:o})}catch(e){this.setState({isRequestRetracting:!1}),t({title:"Something went wrong",status:"error",description:"There was an error in withdrawing the publish request for your Collection. Please try again."}),pm.logger.error(`DocumentationPublishView~handleRetractRequest: Error withdrawing publish request for collection: ${o}`,e)}},this.handleDenyRequest=async(e,t)=>{const{addToast:o}=this.props;let s=r().get(this.props.controller,"params.collectionUid"),i={notes:e};try{this.setState({isRequestDenying:!0,isRequestDenied:!1}),await(0,D.denyRequest)(i,t),this.setState({isRequestDenying:!1,isRequestDenied:!0});let e="Request to publish rejected",n=r().isEmpty(r().get(this.props.controller,"params.workspaceId"))||void 0===r().get(this.props.controller,"params.workspaceId")?this.state.collectionWorkspaceId:r().get(this.props.controller,"params.workspaceId"),a=this.state.isGovernanceEnabled&&!this.state.destinationWorkspaceId&&!n,l=["workspaces","documentation","links"];o({title:e,status:"success",description:"This request has been rejected and removed from Community Managers' queue."}),a?w.default.transitionTo(I.OPEN_MANAGE_PUBLIC_ELEMENTS_IDENTIFIER,{},{tab:l[1]}):w.default.transitionTo("documentation.openWithWsSelect",{collectionUid:s})}catch(e){this.setState({isRequestDenying:!1}),o({title:"Something went wrong",status:"error",description:"There was an error in denying the publish request for your Collection. Please try again."}),pm.logger.error(`DocumentationPublishView~handleDenyRequest: Error denying publish request for collection: ${s}`,e)}},this.handleApproveRequest=async(e,t)=>{const{addToast:o}=this.props;let s=r().get(this.props.controller,"params.collectionUid"),n=r().get(this.props.controller,"params.workspaceId"),{store:a}=this.props.controller,l={metadata:e};try{this.setState({isRequestApproving:!0,isRequestApproved:!1}),await(0,D.approveRequest)(l,t),await a.fetchRequestData(),await a._fetchPublishedData();let e=a.publishedData,d=r().get(e,"data.body.collections[0]",{}),c=(0,y.getPublishedUrl)(d),u={target:"_blank"};o({title:"Documentation published.",status:"success",description:i.createElement(i.Fragment,null,i.createElement(h.default,{onClick:()=>{w.default._openExternalURL(c,u),L.default.addEventV2({category:I.DOCUMENTATION_ANALYTICS.CATEGORY,action:"click_view_documentation_toast",entityType:I.DOCUMENTATION_ENTITY.COLLECTION,entityId:s})},icon:i.createElement(g.default,{color:"content-color-primary"}),type:"monochrome-plain",text:"View documentation."}))}),this.setState({isRequestApproving:!1,isRequestApproved:!0,showPublishedStatusPage:!0,respondedFrom:null}),w.default.transitionTo("documentation.publish",{collectionUid:s},{workspaceId:n})}catch(e){this.setState({isRequestApproving:!1}),o({title:"Something went wrong",status:"error",description:"There was an error in approving the publish request for your Collection. Please try again."}),pm.logger.error(`DocumentationPublishView~handleApproveRequest: Error approving publish request for collection: ${s}`,e)}},this.handleEditSettingsButtonClick=()=>{this.setState({showPublishedStatusPage:!1})},this.handleCancel=()=>{let e=this.getCollectionPublishStatus(),t=this.getCollectionRequestPublishStatus(),o=r().get(this.props.controller,"params.collectionUid");e||t?this.setState({showPublishedStatusPage:!0}):w.default.transitionTo("documentation.openWithWsSelect",{collectionUid:o})},this.handleRequestPublish=async(e,t="",o=!1)=>{const{addToast:s}=this.props;let i=r().get(this.props.controller,"params.collectionUid"),{store:n}=this.props.controller,a=r().isEmpty(r().get(this.props.controller,"params.workspaceId"))||void 0===r().get(this.props.controller,"params.workspaceId")?this.state.collectionWorkspaceId:r().get(this.props.controller,"params.workspaceId"),l=this.state.isGovernanceEnabled&&!this.state.destinationWorkspaceId&&!a,d={modelId:i,notes:t,metadata:e},c={modelId:i,notes:t,metadata:e};try{this.setState({isRequesting:!0,isRequested:!1});let e=await this.getCollectionRequestPublishStatus();if(e){let e=await this.getCollectionPublishRequestCode();await(0,D.updatePublishRequest)(c,e),L.default.addEventV2({category:I.DOCUMENTATION_ANALYTICS.CATEGORY,action:"update_request",label:l?I.DOCUMENTATION_ANALYTICS.LABEL.PRIVATE_WORKSPACE:I.DOCUMENTATION_ANALYTICS.LABEL.PUBLIC_WORKSPACE,entityType:I.DOCUMENTATION_ENTITY.COLLECTION,entityId:i})}else{let e=this.getCollectionPublishStatus();await(0,D.requestPublish)(d),L.default.addEventV2({category:I.DOCUMENTATION_ANALYTICS.CATEGORY,action:e?"request_publish_for_published":"request_publish_for_unpublished",label:l?I.DOCUMENTATION_ANALYTICS.LABEL.PRIVATE_WORKSPACE:I.DOCUMENTATION_ANALYTICS.LABEL.PUBLIC_WORKSPACE,entityType:I.DOCUMENTATION_ENTITY.COLLECTION,entityId:i})}await n.fetchRequestData(),this.setState({isRequesting:!1,isRequested:!0});let t=e?"Request updated successfully":"Request sent successfully";!o&&s({title:t,status:"success",description:e?"A community manager will review the updated request.":"A community manager will review the request."}),!o&&w.default.transitionTo("documentation.publish",{collectionUid:i},{workspaceId:a})}catch(e){this.setState({isRequesting:!1}),s({title:"Something went wrong",status:"error",description:"There was an error in requesting publish for your Collection. Please try again."}),pm.logger.error(`DocumentationPublishView~handleRequestPublish: Error requesting publish for collection: ${i}`,e)}},this.handlePublish=async e=>{const{addToast:t}=this.props;let o=r().get(this.props.controller,"params.collectionUid"),{store:s}=this.props.controller,n=r().get(e,"shareToWorkspace",{});e.uid=o;try{this.setState({isPublishing:!0,isPublished:!1}),await(0,D.publishDocumentation)(e),await s._fetchPublishedData(),await s.fetchRequestData();let a=s.publishedData,l=r().get(a,"data.body.collections[0]",{}),d=(0,y.getPublishedUrl)(l),c={target:"_blank"},{shared:u,workspaceId:m="",isEnvironmentMoved:p}=n;t({title:u&&m?p?"Collection and environment moved to the workspace and documentation published.":"Collection moved to the workspace and documentation published.":"Documentation published.",status:"success",description:i.createElement(i.Fragment,null,i.createElement(h.default,{onClick:()=>{w.default._openExternalURL(d,c),L.default.addEventV2({category:I.DOCUMENTATION_ANALYTICS.CATEGORY,action:"click_view_documentation_toast",entityType:I.DOCUMENTATION_ENTITY.COLLECTION,entityId:o})},icon:i.createElement(g.default,{color:"content-color-primary"}),type:"monochrome-plain",text:"View documentation."}))}),u&&m?(this.setState({destinationWorkspaceId:m}),w.default.transitionTo("documentation.publish",{collectionUid:o},{workspaceId:m})):this.setState({destinationWorkspaceId:r().get(this.props.controller,"params.workspaceId")}),this.setState({isPublishing:!1,isPublished:!0})}catch(e){this.setState({isPublishing:!1}),t({title:"Something went wrong",status:"error",description:"There was an error in publishing your collection documentation. Please try again."}),pm.logger.error(`DocumentationPublishView~handlePublish: Error publishing collection documentation: ${o}`,e)}},this.handlePublishedCollection=()=>{this.setState({showPublishedStatusPage:!0})}}handleUnpublishedCollection(){const{addToast:e}=this.props;e({status:"success",description:"Collection successfully unpublished"});let t=r().get(this.props.controller,"params.collectionUid"),o=r().isEmpty(r().get(this.props.controller,"params.workspaceId"))?this.state.collectionWorkspaceId:r().get(this.props.controller,"params.workspaceId"),s=["workspaces","documentation","links"];this.state.isGovernanceEnabled&&!this.state.destinationWorkspaceId&&!o?w.default.transitionTo(I.OPEN_MANAGE_PUBLIC_ELEMENTS_IDENTIFIER,{},{tab:s[1]}):w.default.transitionTo("documentation.openWithWsSelect",{collectionUid:t})}getCollectionPublishStatus(){let{store:e}=this.props.controller,{publishedData:t}=e;return Boolean(r().get(t,"data.body.collections.length"))}getCollectionRequestPublishStatus(){let{store:e}=this.props.controller,{requestData:t}=e,o=r().get((0,n.toJS)(t),"data",null);return Boolean("pending_approval"===r().get(o,"body.data[0].state"))}getCollectionPublishRequestCode(){let{store:e}=this.props.controller,{requestData:t}=e,o=r().get((0,n.toJS)(t),"data",null);return r().get(o,"body.data[0].code","")}resolvePublishedEnvironmentName(e,t){if(!e)return"";e=(0,y.handleLegacyEnvironmentId)(e);let o=t.find((t=>t.id===e));return r().get(o,"name")}getEnvironmentData(e){const t=r().chain(e).sortBy((e=>e.name.toLowerCase())).value(),o=[];return"function"==typeof t.forEach&&t.forEach((e=>{e&&o.push(r().pick(e,["owner","id","name"]))})),o}getPublishedVersionIds(e){if(this.state.isCustomisationEnabled)return Array.isArray(e)?e.map((e=>({value:e.versionTagId,label:e.apiName}))):[];{if(!e)return{};let t={};return"function"==typeof e.forEach&&e.forEach((e=>{t[e.versionTagId]={id:e.versionTagId,name:e.apiName}})),t}}handleBreadcrumbClick(e){return(0,y.openEntity)(r().get(e,"type"),r().get(e,"id"),r().get(e,"workspaceId"))}getInitialStyling(e,t){var o;let{customColor:s,documentationLayout:i}=e,n=!0,a=null==e||null===(o=e.customisation)||void 0===o?void 0:o.appearance,l=r().get((0,d.resolveStoreInstance)(c.default),"team.team_logo.is_default",!0),u=null;if(a){if(t===I.DOCUMENTATION_THEMES.LIGHT){var h;const e=null===(h=a.themes)||void 0===h?void 0:h.find((e=>e.name===I.DOCUMENTATION_THEMES.LIGHT));s=e.colors,u=e.logo}else if(t===I.DOCUMENTATION_THEMES.DARK){var m;const e=null===(m=a.themes)||void 0===m?void 0:m.find((e=>e.name===I.DOCUMENTATION_THEMES.DARK));s=e.colors,u=e.logo}}else t===I.DOCUMENTATION_THEMES.DARK&&(s=I.THEME_DEFAULT_COLORS.DARK);return r().isEmpty(u)&&(n=!1,u=l?I.DOCUMENTATION_PUBLISHING.DEFAULT_DOCUMENTATION_LOGO_URL:r().get((0,d.resolveStoreInstance)(c.default),"team.logo_url",I.DOCUMENTATION_PUBLISHING.DEFAULT_DOCUMENTATION_LOGO_URL)),{customColor:s,documentationLayout:i,logoUrl:u,isCustomLogo:n}}getInitialMetaTags(e){var t;let o=null==e||null===(t=e.customisation)||void 0===t?void 0:t.metaTags,s=null,i=null;var n,a;o&&(s=null==o||null===(n=o.find((e=>"title"===e.name)))||void 0===n?void 0:n.value,i=null==o||null===(a=o.find((e=>"description"===e.name)))||void 0===a?void 0:a.value);return{seoTitle:s,seoDescription:i}}async componentDidMount(){try{await N.default.onPlanFeaturesLoad();let e,t=r().get((0,n.toJS)(N.default.featureObject).features,"enable_publish_customisations.value",!1),o=r().get((0,n.toJS)(N.default.featureObject).features,"publish_documentation_governance_enabled.value",!1),s=r().get(this.props.controller,"params.collectionUid");try{const{apiId:e,isEntityApiExclusive:t}=await(0,y.getEntityExclusivityDetails)("collection",s);e&&t&&this.setState({isCollectionApiExclusive:!0})}catch(e){pm.logger.error("DocumentationPublishView~componentDidMount: Unable to get entity exclusivity details",e)}if(o){await this.fetchPublishPermission(),e=await(0,D.fetchWorkspaceForCollection)(s);try{r().isEmpty(e)||this.props.controller.store.getEnvironmentsAndApiForCollection(e)}catch(e){pm.logger.error("DocumentationPublishView~componentDidMount: Unable to get entity exclusivity details",e)}}this.setState({isGovernanceLoading:!1,isGovernanceEnabled:o,collectionWorkspaceId:e,isCustomisationEnabled:t});let i=r().get(this.props.controller,"params.respondedFrom",""),a=r().isEmpty(r().get(this.props.controller,"params.workspaceId"))||void 0===r().get(this.props.controller,"params.workspaceId")?e:r().get(this.props.controller,"params.workspaceId"),l=this.state.isGovernanceEnabled&&!this.state.destinationWorkspaceId&&!a;"email"!==i&&"notification"!==i||L.default.addEventV2({category:I.DOCUMENTATION_ANALYTICS.CATEGORY,action:"notification"===i?"respond_request_notification":"email"===i&&"respond_request_email",label:l?I.DOCUMENTATION_ANALYTICS.LABEL.PRIVATE_WORKSPACE:I.DOCUMENTATION_ANALYTICS.LABEL.PUBLIC_WORKSPACE,entityType:I.DOCUMENTATION_ENTITY.COLLECTION,entityId:s}),this.setState({respondedFrom:i})}catch(e){this.setState({isGovernanceLoading:!1,hasError:!0}),pm.logger.error("DocumentationPublishView~componentDidMount",e)}}async fetchPublishPermission(){let{userId:e,teamId:t}=S.default,o={objectId:t,objectType:"team",entityId:e,entityType:"user",permission:I.PERMISSIONS.MANAGE_PUBLISH_DOCUMENTATION};try{await(0,d.resolveStoreInstance)(u.default).onSyncAvailable();let e=await(0,D.fetchPermissions)({permissionQuery:o});this.setState({isCommunityManager:r().get(e,"permissionQuery.allowed")})}catch(e){pm.logger.error("DocumentationPublishView~fetchPublishPermission: Error fetching publish permission",e)}}async fetchTokenScanData(){try{var e,t;this.setState({isFetchingScanData:!0}),await(null===(e=this.props.controller)||void 0===e||null===(t=e.store)||void 0===t?void 0:t.fetchScanData())}catch(e){pm.logger.error("DocumentationPublishView~fetchTokenScanData: Unable to fetch scan data",e)}finally{this.setState({isFetchingScanData:!1})}}componentDidUpdate(e,t){let o=this.state.isPublished,s=this.state.isUnpublished,i=this.state.isRequested;o&&o!==t.showPublishedStatusPage&&this.handlePublishedCollection(),i&&i!==t.showPublishedStatusPage&&this.handlePublishedCollection(),s&&this.handleUnpublishedCollection()}render(){var e,t,o,s,a,l;let{store:u}=this.props.controller,{customDomains:h,publishedData:p,requestData:g,tokenScanData:w,tokenScanId:D,tokenScanStatus:S,versions:N,data:L,publishPermission:k,environments:O,isOffline:P,isLimitReachedForPublish:R,isRepeatSpammer:_}=u,x=this.getCollectionPublishStatus(),A=this.getCollectionRequestPublishStatus(),q=x&&!this.state.isCommunityManager&&!A,U=r().get(this.props.controller,"params.collectionUid"),M=r().isEmpty(r().get(this.props.controller,"params.workspaceId"))||void 0===r().get(this.props.controller,"params.workspaceId")?this.state.collectionWorkspaceId:r().get(this.props.controller,"params.workspaceId"),j=this.state.isGovernanceEnabled&&!this.state.destinationWorkspaceId&&!M,B=r().get(p,"data.body.collections[0]",{}),V=r().get(g,"data.body.data[0].metadata",{}),F=j?r().get(B,"collectionName",""):r().get(L,"name",""),W=this.state.isGovernanceEnabled&&r().get(g,"data.body.data[0].notes",""),H=this.getEnvironmentData(O),Y=(0,y.handleLegacyEnvironmentId)(r().get(B,"environmentTemplateId")),G=q?Y:(0,y.handleLegacyEnvironmentId)(r().get(V,"environmentTemplateId")),$=j?r().get(B,"environment.name"):this.resolvePublishedEnvironmentName(Y,H),z=q?$:r().get(V,"environment.name"),K=r().get(B,"customDomainId"),J=q?K:r().get(V,"customDomainId"),Q=r().get(V,"collection.name",""),X=this.getCollectionPublishRequestCode(),Z=this.getPublishedVersionIds(r().get(B,"versions")),ee=q?Z:this.getPublishedVersionIds(r().get(V,"versions")),te=r().pick(B,["customColor","documentationLayout"]),oe=this.getInitialStyling(B,I.DOCUMENTATION_THEMES.LIGHT),se=this.getInitialStyling(B,I.DOCUMENTATION_THEMES.DARK),ie=r().get(B,"customisation.appearance.default",I.DOCUMENTATION_THEMES.LIGHT),ne=q?te:r().pick(V,["customColor","documentationLayout"]),ae=q?oe:this.getInitialStyling(V,I.DOCUMENTATION_THEMES.LIGHT),le=q?se:this.getInitialStyling(V,I.DOCUMENTATION_THEMES.DARK),re=!r().isEmpty(r().get(B,"customisation")),de=q?r().get(B,"customisation.appearance.default",I.DOCUMENTATION_THEMES.LIGHT):r().get(V,"customisation.appearance.default",I.DOCUMENTATION_THEMES.LIGHT),ce=q?null===(e=this.getInitialMetaTags(B))||void 0===e?void 0:e.seoTitle:null===(t=this.getInitialMetaTags(V))||void 0===t?void 0:t.seoTitle,ue=q?null===(o=this.getInitialMetaTags(B))||void 0===o?void 0:o.seoDescription:null===(s=this.getInitialMetaTags(V))||void 0===s?void 0:s.seoDescription,he=null===(a=this.getInitialMetaTags(B))||void 0===a?void 0:a.seoTitle,me=null===(l=this.getInitialMetaTags(B))||void 0===l?void 0:l.seoDescription,pe=r().get(B,"environmentOwner"),ge=q?pe:r().get(V,"environmentOwner"),be=r().get((0,n.toJS)(w),"data.data",[]),ye=this.state.isUnpublishing,ve=this.state.isRequestRetracting,Ee=this.state.isRequestApproving,fe=this.state.isRequestDenying,Ce=this.state.isPublishing,we=this.state.isRequesting,Te=r().get(h,"data.body.domains"),De=(0,y.getPublishedUrl)(B),Se=r().get(k,"loading"),Ie=r().get(p,"loading",!0)||!F&&!j||Se&&!j,Ne=!!Se||r().get(k,"data"),Le="email"===this.state.respondedFrom||"notification"===this.state.respondedFrom||"managePublicElements"===this.state.respondedFrom,ke=I.DISABLE_API_EXCLUSIVE_PUBLISH_FLOW&&this.state.isCollectionApiExclusive,Oe=r().get((0,d.resolveStoreInstance)(c.default),"team.team_logo.is_default",!0)?I.DOCUMENTATION_PUBLISHING.DEFAULT_DOCUMENTATION_LOGO_URL:r().get((0,d.resolveStoreInstance)(c.default),"team.logo_url",I.DOCUMENTATION_PUBLISHING.DEFAULT_DOCUMENTATION_LOGO_URL),Pe=this.state.isCustomisationEnabled;return this.state.hasError?i.createElement("div",{className:"documentation documentation-publish-page-container"},i.createElement(T.default,{status:500,fullView:!0},i.createElement(m.default,null))):this.state.isGovernanceLoading?i.createElement("div",{className:"documentation documentation-publish-page-container"},i.createElement(b.default,null)):i.createElement("div",{className:"documentation documentation-publish-page-container"},!ke&&(Ne||this.state.isGovernanceEnabled&&this.state.isCommunityManager)?Ie||this.state.isGovernanceLoading?i.createElement(b.default,null):j&&Le&&!A?i.createElement(T.default,{status:404,title:"Couldn't find request",message:"This request might have been withdrawn.",fullView:!0},i.createElement(m.default,null)):(x||A)&&this.state.showPublishedStatusPage||j?Pe?i.createElement(E.default,{unPublishButtonCallback:this.handleUnpublish,denyRequestButtonCallback:this.handleDenyRequest,retractRequestButtonCallback:this.handleRetractRequest,approveRequestButtonCallback:this.handleApproveRequest,editSettingsButtonCallback:this.handleEditSettingsButtonClick,requestData:g,publishedData:p,collectionName:F,requestedCollectionName:Q,collectionUid:U,workspaceId:this.state.destinationWorkspaceId?this.state.destinationWorkspaceId:M,publishedUrl:De,publishedId:B.id,requestedOwner:V&&V.owner,publishedOwner:B.owner,requestedStylingLight:ae,requestedStylingDark:le,publishedStylingLight:oe,publishedStylingDark:se,requestedVersions:ee,publishedVersions:Z,requestedEnvironment:z||"No Environment",publishedEnvironment:$||"No Environment",isUnpublishing:ye,isRequestRetracting:ve,isRequestApproving:Ee,isRequestDenying:fe,teamLogoUrl:Oe,isOffline:P,isGovernance:this.state.isGovernanceEnabled,isCommunityManager:this.state.isCommunityManager,noteToCommunityManager:W,isCollectionPublishRequested:A,collectionPublishRequestCode:X,isViewOnlyStatusPage:j,isCollectionPublished:x,isLimitReachedForPublish:R,tokenScanId:D,exposedTokensData:be,tokenScanStatus:S,fetchScanData:r().debounce(this.fetchTokenScanData.bind(this),500),isFetchingScanData:this.state.isFetchingScanData,requestPublishButtonCallback:this.handleRequestPublish,defaultTheme:ie,requestedDefaultTheme:de,requestedSeoTitle:ce,requestedSeoDescription:ue,seoTitle:he,seoDescription:me,isCustomisationPublish:re}):i.createElement(v.default,{unPublishButtonCallback:this.handleUnpublish,denyRequestButtonCallback:this.handleDenyRequest,retractRequestButtonCallback:this.handleRetractRequest,approveRequestButtonCallback:this.handleApproveRequest,editSettingsButtonCallback:this.handleEditSettingsButtonClick,handleBreadcrumbClick:this.handleBreadcrumbClick,requestData:g,collectionName:F,requestedCollectionName:Q,collectionUid:U,workspaceId:this.state.destinationWorkspaceId?this.state.destinationWorkspaceId:M,publishedUrl:De,publishedId:B.id,requestedOwner:V&&V.owner,publishedOwner:B.owner,requestedStyling:ne,publishedStyling:te,requestedVersions:r().get(V,"versions"),publishedVersions:r().get(B,"versions"),requestedEnvironment:z||"No Environment",publishedEnvironment:$||"No Environment",isUnpublishing:ye,isRequestRetracting:ve,isRequestApproving:Ee,isRequestDenying:fe,teamLogoUrl:r().get((0,d.resolveStoreInstance)(c.default),"team.logo_url"),isOffline:P,isGovernance:this.state.isGovernanceEnabled,isCommunityManager:this.state.isCommunityManager,noteToCommunityManager:W,isCollectionPublishRequested:A,collectionPublishRequestCode:X,isViewOnlyStatusPage:j,isCollectionPublished:x,isLimitReachedForPublish:R,tokenScanId:D,exposedTokensData:be,tokenScanStatus:S,fetchScanData:r().debounce(this.fetchTokenScanData.bind(this),500),isFetchingScanData:this.state.isFetchingScanData,requestPublishButtonCallback:this.handleRequestPublish}):Pe?i.createElement(C.default,{customDomains:h,environments:O,publishButtonCallback:this.handlePublish,requestPublishButtonCallback:this.handleRequestPublish,approveRequestButtonCallback:this.handleApproveRequest,retractRequestButtonCallback:this.handleRetractRequest,cancelButtonCallback:this.handleCancel,collectionName:F,collectionUid:U,workspaceId:M,availableVersions:r().get(N,"data"),availableEnvironments:H,availableCustomDomains:Te,requestedStylingLight:ae,requestedStylingDark:le,publishedStylingLight:oe,publishedStylingDark:se,requestedVersions:ee,publishedVersions:Z,publishedId:B&&B.id,publishedCustomDomain:K,requestedCustomDomain:J,requestedEnvironment:G,publishedEnvironment:Y,requestedEnvironmentOwner:ge,publishedEnvironmentOwner:pe,isPublishing:Ce,isRequesting:we,isRequestApproving:Ee,requestData:g,isRequestRetracting:ve,isCollectionPublished:x,isCollectionPublishRequested:A,teamLogoUrl:Oe,isOffline:P,isGovernance:this.state.isGovernanceEnabled,isCommunityManager:this.state.isCommunityManager,noteToCommunityManager:W,collectionPublishRequestCode:X,isViewOnlyStatusPage:j,isLimitReachedForPublish:R,isRepeatSpammer:_,tokenScanId:D,defaultTheme:ie,requestedDefaultTheme:de,requestedSeoTitle:ce,requestedSeoDescription:ue,seoTitle:he,seoDescription:me}):i.createElement(f.default,{customDomains:h,environments:O,publishButtonCallback:this.handlePublish,requestPublishButtonCallback:this.handleRequestPublish,approveRequestButtonCallback:this.handleApproveRequest,retractRequestButtonCallback:this.handleRetractRequest,cancelButtonCallback:this.handleCancel,collectionName:F,collectionUid:U,workspaceId:M,availableVersions:r().get(N,"data"),availableEnvironments:H,availableCustomDomains:Te,requestedStyling:ne,publishedStyling:te,requestedVersions:ee,publishedVersions:Z,publishedId:B&&B.id,publishedCustomDomain:K,requestedCustomDomain:J,requestedEnvironment:G,publishedEnvironment:Y,requestedEnvironmentOwner:ge,publishedEnvironmentOwner:pe,isPublishing:Ce,isRequesting:we,isRequestApproving:Ee,requestData:g,isRequestRetracting:ve,isCollectionPublished:x,isCollectionPublishRequested:A,teamLogoUrl:r().get((0,d.resolveStoreInstance)(c.default),"team.logo_url"),isOffline:P,isGovernance:this.state.isGovernanceEnabled,isCommunityManager:this.state.isCommunityManager,noteToCommunityManager:W,collectionPublishRequestCode:X,isViewOnlyStatusPage:j,isLimitReachedForPublish:R,isRepeatSpammer:_,tokenScanId:D}):i.createElement(T.default,{status:403,fullView:!0},i.createElement(m.default,null)))}})||s;t.default=(0,p.default)((0,k.withErrorBoundary)(O,I.DOCUMENTATION_ERROR_TYPE.PUBLISH_FLOW.TITLE,I.DOCUMENTATION_ERROR_TYPE.PUBLISH_FLOW.MESSAGE,{addIllustration:!0,containerStyles:{minHeight:"300px",height:"100%",justifyContent:"center",alignItems:"center"}}))},"./documentation/controllers/DocumentationPublishController.js":function(e,t,o){"use strict";o.r(t),o.d(t,{default:function(){return l}});var s,i=o("../../node_modules/mobx/lib/mobx.module.js"),n=o("./appsdk/pages/BasePageController.js"),a=o("./documentation/stores/PublishDocumentationStore.js");let l=(s=class extends n.default{constructor(...e){super(...e),this.store=null}_setParams(e,t){this.params={...this.params,...e,...t}}didCreate({routeParams:e,queryParams:t}){this._setParams(e,t);let{collectionUid:o,workspaceId:s}=this.params;this.store=new a.default(s,o)}didActivate({routeParams:e,queryParams:t}){this._setParams(e,t);let{workspaceId:o,collectionUid:s}=this.params;this.store=new a.default(o,s)}willDestroy(){this.store&&this.store.cleanup()}},r=s.prototype,d="_setParams",c=[i.action],u=Object.getOwnPropertyDescriptor(s.prototype,"_setParams"),h=s.prototype,m={},Object.keys(u).forEach((function(e){m[e]=u[e]})),m.enumerable=!!m.enumerable,m.configurable=!!m.configurable,("value"in m||m.initializer)&&(m.writable=!0),m=c.slice().reverse().reduce((function(e,t){return t(r,d,e)||e}),m),h&&void 0!==m.initializer&&(m.value=m.initializer?m.initializer.call(h):void 0,m.initializer=void 0),void 0===m.initializer&&(Object.defineProperty(r,d,m),m=null),s);var r,d,c,u,h,m},"./documentation/stores/PublishDocumentationStore.js":function(e,t,o){"use strict";o.r(t),o.d(t,{default:function(){return O}});var s,i,n,a,l,r,d,c,u,h,m,p,g=o("../../node_modules/mobx/lib/mobx.module.js"),b=o("./js/stores/StoreManager.js"),y=o("./js/stores/SyncStatusStore.js"),v=o("./js/stores/CurrentUserStore.js"),E=o("./js/services/CurrentUserDetailsService.js"),f=o("./documentation/services/DocumentationService.js"),C=o("./documentation/constants.js"),w=o("./js/utils/uid-helper.js"),T=o("./documentation/utils/utils.js"),D=o("./runtime-repl/environment/_api/EnvironmentStoreV2.js"),S=o("./billing/stores/PlanFeaturesStore.js"),I=o("./node_modules/lodash/lodash.js");function N(e,t,o,s){o&&Object.defineProperty(e,t,{enumerable:o.enumerable,configurable:o.configurable,writable:o.writable,value:o.initializer?o.initializer.call(s):void 0})}function L(e,t,o,s,i){var n={};return Object.keys(s).forEach((function(e){n[e]=s[e]})),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=o.slice().reverse().reduce((function(o,s){return s(e,t,o)||o}),n),i&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(i):void 0,n.initializer=void 0),void 0===n.initializer&&(Object.defineProperty(e,t,n),n=null),n}const k=(e=!0)=>({data:null,loading:e,error:null});let O=(i=L((s=class{constructor(e,t){N(this,"data",i,this),N(this,"loading",n,this),N(this,"error",a,this),N(this,"isLimitReachedForPublish",l,this),N(this,"isRepeatSpammer",r,this),N(this,"publishedData",d,this),N(this,"requestData",c,this),N(this,"customDomains",u,this),N(this,"versions",h,this),N(this,"publishPermission",m,this),N(this,"tokenScanData",p,this),this._disposer=void 0,this.entityType="collection",this.entityUid=t,this.fetchData().then(this._subscribeToSync.bind(this)),this.workspaceId=e,this.collectionUid=t,this.environments=[],this.tokenScanId=null,this.tokenScanStatus="",this.getEnvironmentsAndApiForCollection(e),this._fetchPublishedData(),this.getPublishingData(),this.fetchRequestData(),this.isPublishLimitReached(),this.isPublisherSpamCheck()}async getEnvironmentsAndApiForCollection(e){await(0,b.resolveStoreInstance)(y.default).onSyncAvailable();try{const{apiId:t,isEntityApiExclusive:o}=await(0,T.getEntityExclusivityDetails)(this.entityType,this.entityUid);return this.environments=this.getEnvironments(e,o&&t),this.environments}catch(e){pm.logger.error(`PublishDocumentationStore~getEnvironmentsAndApiForCollection: Failed to fetch environments for ${this.entityType} ${this.entityUid}`,e)}}get entityId(){let{modelId:e}=(0,w.decomposeUID)(this.entityUid);return e}get owner(){let{owner:e}=(0,w.decomposeUID)(this.entityUid);return e}get isOffline(){return!(0,b.resolveStoreInstance)(y.default).isSocketConnected}cleanUp(){this._unsubscribeToSync()}_subscribeToSync(){}_unsubscribeToSync(){"function"==typeof this._disposer&&this._disposer()}async fetchData(e=C.DOCUMENTATION_LATEST_VERSION_STRING){this._updateStore({loading:!0});try{await(0,b.resolveStoreInstance)(y.default).onSyncAvailable();let t=(await(0,f.fetchData)(this.entityType,this.entityId,this.owner,{populate:!0,versionTag:this.entityType===C.DOCUMENTATION_ENTITY.COLLECTION?e:void 0})).body.data;this._updateStore({data:t,loading:!1,error:null})}catch(e){pm.logger.error(`Failed to fetch ${this.entityType} ${this.entityId}`,e),this._updateStore({data:null,loading:!1,error:e})}}_updateStore({data:e,loading:t,error:o},s=this.entityType,i=this.entityId){if(void 0!==e)if(s===this.entityType&&i===this.entityId)this.data?(0,T.mergeUpdates)(this.data,e):this.data=e;else if(s===C.DOCUMENTATION_ENTITY.FOLDER&&this.data){let t=this.data.folders.find((e=>e.id===i));(0,T.mergeUpdates)(t,e)}else if(s===C.DOCUMENTATION_ENTITY.REQUEST&&this.data){let t=this.data.requests.find((e=>e.id===i));(0,T.mergeUpdates)(t,e)}void 0!==t&&(this.loading=t),void 0!==o&&(this.error=o)}getPublishingData(){this._fetchCustomDomains(),this._fetchVersionTags(),this._fetchPublishPermission()}async fetchRequestData(){this._updatePublishStore(this.requestData,{loading:!0});try{await(0,b.resolveStoreInstance)(y.default).onSyncAvailable();let e=await(0,f.fetchRequestData)(this.collectionUid);I.get(e,"body.data[0].metadata.tokenScanId")&&(this.tokenScanId=I.get(e,"body.data[0].metadata.tokenScanId"),this.fetchScanData()),this._updatePublishStore(this.requestData,{data:e,loading:!1})}catch(e){pm.logger.error("Failed to fetch request data:",e),this._updatePublishStore(this.requestData,{loading:!1,error:e})}}async fetchScanData(){this._updatePublishStore(this.tokenScanData,{loading:!0});try{await(0,b.resolveStoreInstance)(y.default).onSyncAvailable();let e=await(0,f.fetchTokenScannerData)(this.tokenScanId);I.get(e,"meta.status")&&(this.tokenScanStatus=I.get(e,"meta.status")),this._updatePublishStore(this.tokenScanData,{data:e,loading:!1})}catch(e){pm.logger.error("PublishDocumentationStore~fetchScanData: Failed to fetch token scanner data:",e),this._updatePublishStore(this.tokenScanData,{loading:!1,error:e})}}async isPublishLimitReached(){try{let s;var e,t,o;if(await(0,b.resolveStoreInstance)(y.default).onSyncAvailable(),await S.default.onPlanFeaturesLoad(),I.get((0,g.toJS)(S.default.featureObject).features,"limit_publish_documentation.value",!1))s=await(0,f.isPublishLimitReached)(),s=null===(e=s)||void 0===e||null===(t=e.body)||void 0===t||null===(o=t.operation)||void 0===o?void 0:o.allowed;else s=!0;(0,g.runInAction)((()=>{this.isLimitReachedForPublish=!s}))}catch(e){pm.logger.error("PublishDocumentationStore~isPublishLimitReached: Failed to fetch the publish limit",e)}}async isPublisherSpamCheck(){try{await(0,b.resolveStoreInstance)(y.default).onSyncAvailable();let e=await(0,f.fetchPublisherSpamStatus)();(0,g.runInAction)((()=>{var t;this.isRepeatSpammer=null==e||null===(t=e.body)||void 0===t?void 0:t.spam}))}catch(e){pm.logger.error("PublishDocumentationStore~isPublisherSpamCheck: Failed to fetch publisher spam status data:",e),(0,g.runInAction)((()=>{this.isRepeatSpammer=!1}))}}async _fetchPublishedData(){this._updatePublishStore(this.publishedData,{loading:!0});try{await(0,b.resolveStoreInstance)(y.default).onSyncAvailable();let e=await(0,f.fetchPublishedData)(this.collectionUid);this._updatePublishStore(this.publishedData,{data:e,loading:!1})}catch(e){pm.logger.error("Failed to fetch published data:",e),this._updatePublishStore(this.publishedData,{loading:!1,error:e})}}async _fetchCustomDomains(){try{await(0,b.resolveStoreInstance)(y.default).onSyncAvailable();const e=E.default.teamId;let t=[];e&&(t=await(0,f.fetchCustomDomains)()),this._updatePublishStore(this.customDomains,{data:t,loading:!1})}catch(e){pm.logger.error("Failed to fetch custom domains data:",e),this._updatePublishStore(this.customDomains,{loading:!1,error:e})}}async _fetchVersionTags(){try{await(0,b.resolveStoreInstance)(y.default).onSyncAvailable();let e=await(0,f.fetchAllTags)(this.collectionUid);this._updatePublishStore(this.versions,{data:e,loading:!1})}catch(e){pm.logger.error("Failed to fetch versions:",e),this._updatePublishStore(this.versions,{loading:!1,error:e})}}async _fetchPublishPermission(){this._updatePublishStore(this.publishPermission,{loading:!0});try{await(0,b.resolveStoreInstance)(y.default).onSyncAvailable();let e=(0,b.resolveStoreInstance)(v.default),t=(0,g.autorun)((async()=>{if(!e.isHydrating){let o={objectId:this.collectionUid,objectType:"collection",entityId:e.id,permission:C.DOCUMENTATION_PUBLISHING.PUBLISH_PERMISSION_NAME,entityType:"user"},s=await(0,f.fetchPermissions)({permissionQuery:o});this._updatePublishStore(this.publishPermission,{data:I.get(s,"permissionQuery.allowed"),loading:!1}),t&&t()}}))}catch(e){pm.logger.error("Failed to fetch publish publish permission for collection:",this.collectionUid,e),this._updatePublishStore(this.publishPermission,{loading:!1,error:e})}}_updatePublishStore(e,{data:t,loading:o,error:s}){e&&(t&&(e.data=t),"boolean"==typeof o&&(e.loading=o),s&&(e.error=s))}getEnvironments(e,t){const o=(0,g.observable)([]),s=t?["api","workspace"]:["workspace"],i=t?[{type:"api",id:t},{type:"workspace",id:e}]:[{type:"workspace",id:e}];return(0,D.getMeta)(e,{parent:s}).then((0,g.action)((e=>{const t=(null==e?void 0:e.getFilteredList({parents:i})).map((e=>{let t={...e},{owner:o,modelId:s}=(0,w.decomposeUID)(e.id);return t.id=s,t.owner=o,t}));o.push(...t)}))).catch((t=>{pm.logger.error(`PublishDocumentationStore~getEnvironments: Error fetching environments for workspace - ${e}`,t)})),o}}).prototype,"data",[g.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),n=L(s.prototype,"loading",[g.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),a=L(s.prototype,"error",[g.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),l=L(s.prototype,"isLimitReachedForPublish",[g.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),r=L(s.prototype,"isRepeatSpammer",[g.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),d=L(s.prototype,"publishedData",[g.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return k()}}),c=L(s.prototype,"requestData",[g.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return k()}}),u=L(s.prototype,"customDomains",[g.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return k()}}),h=L(s.prototype,"versions",[g.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return k()}}),m=L(s.prototype,"publishPermission",[g.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return k(!0)}}),p=L(s.prototype,"tokenScanData",[g.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return k()}}),L(s.prototype,"getEnvironmentsAndApiForCollection",[g.action],Object.getOwnPropertyDescriptor(s.prototype,"getEnvironmentsAndApiForCollection"),s.prototype),L(s.prototype,"isOffline",[g.computed],Object.getOwnPropertyDescriptor(s.prototype,"isOffline"),s.prototype),L(s.prototype,"_updateStore",[g.action],Object.getOwnPropertyDescriptor(s.prototype,"_updateStore"),s.prototype),L(s.prototype,"_updatePublishStore",[g.action],Object.getOwnPropertyDescriptor(s.prototype,"_updatePublishStore"),s.prototype),s)},"./documentation/utils/publish.js":function(e,t,o){"use strict";function s(e=window,t){let o=!1;if("function"==typeof e.postMessage){try{e.postMessage({toString:function(){}},t)}catch(e){o="DataCloneError"===e.name}return o}return o}o.r(t),o.d(t,{getPostMessageSupport:function(){return s}})},"./iam/src/common/styled-components/CopyButton.js":function(e,t,o){"use strict";o.r(t);var s=o("../../node_modules/styled-components/dist/styled-components.browser.esm.js"),i=o("../../node_modules/@postman/aether/esmLib/src/components/Button/Button.js");const n=(0,s.default)(i.default)`
  border-radius: var(--border-radius-default);
  width: var(--size-s);
  height: var(--size-s);
`;t.default=n},"./node_modules/react-image-crop/dist/ReactCrop.min.js":function(e,t,o){var s,i=o("../../node_modules/console-browserify/index.js");e.exports=(s=o("../../node_modules/react/index.js"),(()=>{var e={703:(e,t,o)=>{"use strict";var s=o(414);function i(){}function n(){}n.resetWarningCache=i,e.exports=function(){function e(e,t,o,i,n,a){if(a!==s){var l=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw l.name="Invariant Violation",l}}function t(){return e}e.isRequired=e;var o={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:n,resetWarningCache:i};return o.PropTypes=o,o}},697:(e,t,o)=>{e.exports=o(703)()},414:e=>{"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},427:e=>{"use strict";e.exports=s}},t={};function o(s){var i=t[s];if(void 0!==i)return i.exports;var n=t[s]={exports:{}};return e[s](n,n.exports,o),n.exports}o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var s in t)o.o(t,s)&&!o.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n={};return(()=>{"use strict";o.r(n),o.d(n,{Component:()=>I,containCrop:()=>D,default:()=>I,makeAspectCrop:()=>C});var e=o(427),t=o.n(e),s=o(697),a=o.n(s);function l(e){var t,o,s="";if("string"==typeof e||"number"==typeof e)s+=e;else if("object"==typeof e)if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(o=l(e[t]))&&(s&&(s+=" "),s+=o);else for(t in e)e[t]&&(s&&(s+=" "),s+=t);return s}function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var o=0;o<t.length;o++){var s=t[o];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function h(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?m(e):t}function m(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function g(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,s)}return o}function b(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?g(Object(o),!0).forEach((function(t){y(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):g(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function y(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function v(e,t,o){return Math.min(Math.max(e,t),o)}function E(e){return e&&!isNaN(e.width)&&!isNaN(e.height)}function f(e){return"n"===e?"s":"ne"===e?"sw":"e"===e?"w":"se"===e?"nw":"s"===e?"n":"sw"===e?"ne":"w"===e?"e":"nw"===e?"se":e}function C(e,t,o){if(isNaN(e.aspect))return i.warn("`crop.aspect` should be a number in order to make an aspect crop",e),e;var s=b({unit:"px",x:0,y:0},e);return e.width&&(s.height=s.width/e.aspect),e.height&&(s.width=s.height*e.aspect),s.y+s.height>o&&(s.height=o-s.y,s.width=s.height*e.aspect),s.x+s.width>t&&(s.width=t-s.x,s.height=s.width/e.aspect),s}function w(e,t,o){return"%"===e.unit?e:{unit:"%",aspect:e.aspect,x:e.x/t*100,y:e.y/o*100,width:e.width/t*100,height:e.height/o*100}}function T(e,t,o){return e.unit?"px"===e.unit?e:{unit:"px",aspect:e.aspect,x:e.x*t/100,y:e.y*o/100,width:e.width*t/100,height:e.height*o/100}:b(b({},e),{},{unit:"px"})}function D(e,t,o,s){var i=T(t,o,s),n=T(e,o,s),a=b({},i);if(!i.aspect)return i.x<0?(a.x=0,a.width+=i.x):i.x+i.width>o&&(a.width=o-i.x),i.y+i.height>s&&(a.height=s-i.y),a;var l=!1;i.x<0?(a.x=0,a.width+=i.x,a.height=a.width/i.aspect,l=!0):i.x+i.width>o&&(a.width=o-i.x,a.height=a.width/i.aspect,l=!0),l&&n.y>a.y&&(a.y=i.y+(i.height-a.height));var r=!1;return a.y+a.height>s&&(a.height=s-i.y,a.width=a.height*i.aspect,r=!0),r&&n.x>a.x&&(a.x=i.x+(i.width-a.width)),a}var S={capture:!0,passive:!1},I=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(a,e);var o,s,i,n=(s=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=p(s);if(i){var o=p(this).constructor;e=Reflect.construct(t,arguments,o)}else e=t.apply(this,arguments);return h(this,e)});function a(){var e;d(this,a);for(var t=arguments.length,o=new Array(t),s=0;s<t;s++)o[s]=arguments[s];return y(m(e=n.call.apply(n,[this].concat(o))),"window","undefined"!=typeof window?window:{}),y(m(e),"document","undefined"!=typeof document?document:{}),y(m(e),"state",{}),y(m(e),"keysDown",new Set),y(m(e),"onCropPointerDown",(function(t){var o=e.props,s=o.crop,i=o.disabled,n=e.mediaDimensions,a=T(s,n.width,n.height);if(!i){t.cancelable&&t.preventDefault(),e.bindDocMove(),e.componentRef.focus({preventScroll:!0});var l=t.target.dataset.ord,r="nw"===l||"w"===l||"sw"===l,d="nw"===l||"n"===l||"ne"===l;e.evData={clientStartX:t.clientX,clientStartY:t.clientY,cropStartWidth:a.width,cropStartHeight:a.height,cropStartX:r?a.x+a.width:a.x,cropStartY:d?a.y+a.height:a.y,xInversed:r,yInversed:d,xCrossOver:r,yCrossOver:d,startXCrossOver:r,startYCrossOver:d,isResize:t.target.dataset.ord,ord:l},e.mouseDownOnCrop=!0,e.setState({cropIsActive:!0})}})),y(m(e),"onComponentPointerDown",(function(t){var o=e.props,s=o.crop,i=o.disabled,n=o.locked,a=o.keepSelection,l=o.onChange,r=e.mediaWrapperRef.firstChild;if(t.target===r&&r.contains(t.target)&&!(i||n||a&&E(s))){t.cancelable&&t.preventDefault(),e.bindDocMove(),e.componentRef.focus({preventScroll:!0});var d=e.mediaWrapperRef.getBoundingClientRect(),c=t.clientX-d.left,u=t.clientY-d.top,h={unit:"px",aspect:s?s.aspect:void 0,x:c,y:u,width:0,height:0};e.evData={clientStartX:t.clientX,clientStartY:t.clientY,cropStartWidth:h.width,cropStartHeight:h.height,cropStartX:h.x,cropStartY:h.y,xInversed:!1,yInversed:!1,xCrossOver:!1,yCrossOver:!1,startXCrossOver:!1,startYCrossOver:!1,isResize:!0,ord:"nw"},e.mouseDownOnCrop=!0;var m=e.mediaDimensions,p=m.width,g=m.height;l(T(h,p,g),w(h,p,g)),e.setState({cropIsActive:!0,newCropIsBeingDrawn:!0})}})),y(m(e),"onDocPointerMove",(function(t){var o=e.props,s=o.crop,i=o.disabled,n=o.onChange,a=o.onDragStart;if(!i&&e.mouseDownOnCrop){t.cancelable&&t.preventDefault(),e.dragStarted||(e.dragStarted=!0,a(t));var l,r=m(e).evData;if(r.xDiff=t.clientX-r.clientStartX,r.yDiff=t.clientY-r.clientStartY,(l=r.isResize?e.resizeCrop():e.dragCrop())!==s){var d=e.mediaDimensions,c=d.width,u=d.height;n(T(l,c,u),w(l,c,u))}}})),y(m(e),"onComponentKeyDown",(function(t){var o=e.props,s=o.crop,i=o.disabled,n=o.onChange,l=o.onComplete;if(!i){e.keysDown.add(t.key);var r=!1;if(E(s)){var d=e.makeNewCrop(),c=(navigator.platform.match("Mac")?t.metaKey:t.ctrlKey)?a.nudgeStepLarge:t.shiftKey?a.nudgeStepMedium:a.nudgeStep;if(e.keysDown.has("ArrowLeft")&&(d.x-=c,r=!0),e.keysDown.has("ArrowRight")&&(d.x+=c,r=!0),e.keysDown.has("ArrowUp")&&(d.y-=c,r=!0),e.keysDown.has("ArrowDown")&&(d.y+=c,r=!0),r){t.cancelable&&t.preventDefault();var u=e.mediaDimensions,h=u.width,m=u.height;d.x=v(d.x,0,h-d.width),d.y=v(d.y,0,m-d.height);var p=T(d,h,m),g=w(d,h,m);n(p,g),l(p,g)}}}})),y(m(e),"onComponentKeyUp",(function(t){e.keysDown.delete(t.key)})),y(m(e),"onDocPointerDone",(function(t){var o=e.props,s=o.crop,i=o.disabled,n=o.onComplete,a=o.onDragEnd;if(e.unbindDocMove(),!i&&e.mouseDownOnCrop){e.mouseDownOnCrop=!1,e.dragStarted=!1;var l=e.mediaDimensions,r=l.width,d=l.height;a(t),n(T(s,r,d),w(s,r,d)),e.setState({cropIsActive:!1,newCropIsBeingDrawn:!1})}})),y(m(e),"onMediaLoaded",(function(){var t=e.props,o=t.onComplete,s=t.onChange,i=e.createNewCrop(),n=i.pixelCrop,a=i.percentCrop;s(n,a),o(n,a)})),y(m(e),"onImageLoad",(function(t){var o=t.target,s=e.props,i=s.onComplete,n=s.onChange;if(!1!==(0,s.onImageLoaded)(o)){var a=e.createNewCrop(),l=a.pixelCrop,r=a.percentCrop;n(l,r),i(l,r)}})),y(m(e),"bindComponentRef",(function(t){e.componentRef=t})),y(m(e),"bindMediaWrapperRef",(function(t){e.mediaWrapperRef=t})),y(m(e),"bindImageRef",(function(t){e.imageRef=t})),y(m(e),"bindCropSelectionRef",(function(t){e.cropSelectRef=t})),e}return(o=[{key:"componentDidMount",value:function(){this.componentRef.addEventListener&&this.componentRef.addEventListener("medialoaded",this.onMediaLoaded)}},{key:"componentWillUnmount",value:function(){this.componentRef.removeEventListener&&this.componentRef.removeEventListener("medialoaded",this.onMediaLoaded)}},{key:"componentDidUpdate",value:function(e){var t=this.props.crop;if(this.imageRef&&e.crop!==t&&t.aspect&&(t.width&&!t.height||!t.width&&t.height)){var o=this.imageRef,s=o.width,i=o.height,n=C(this.makeNewCrop(),s,i),a=T(n,s,i),l=w(n,s,i);this.props.onChange(a,l),this.props.onComplete(a,l)}}},{key:"bindDocMove",value:function(){this.docMoveBound||(this.document.addEventListener("pointermove",this.onDocPointerMove,S),this.document.addEventListener("pointerup",this.onDocPointerDone,S),this.document.addEventListener("pointercancel",this.onDocPointerDone,S),this.docMoveBound=!0)}},{key:"unbindDocMove",value:function(){this.docMoveBound&&(this.document.removeEventListener("pointermove",this.onDocPointerMove,S),this.document.removeEventListener("pointerup",this.onDocPointerDone,S),this.document.removeEventListener("pointercancel",this.onDocPointerDone,S),this.docMoveBound=!1)}},{key:"createNewCrop",value:function(){var e,t,o,s=this.mediaDimensions,i=s.width,n=s.height,a=(t=i,o=n,!(e=this.makeNewCrop()).aspect||e.width&&e.height?e:C(e,t,o));return{pixelCrop:T(a,i,n),percentCrop:w(a,i,n)}}},{key:"mediaDimensions",get:function(){var e=this.mediaWrapperRef;return{width:e.clientWidth,height:e.clientHeight}}},{key:"getCropStyle",value:function(){var e=this.makeNewCrop(this.props.crop?this.props.crop.unit:"px");return{top:"".concat(e.y).concat(e.unit),left:"".concat(e.x).concat(e.unit),width:"".concat(e.width).concat(e.unit),height:"".concat(e.height).concat(e.unit)}}},{key:"getNewSize",value:function(){var e,t=this.props,o=t.crop,s=t.minWidth,i=t.maxWidth,n=t.minHeight,a=t.maxHeight,l=this.evData,r=this.mediaDimensions,d=r.width,c=r.height,u=l.cropStartWidth+l.xDiff;return l.xCrossOver&&(u=Math.abs(u)),u=v(u,s,i||d),e=o.aspect?u/o.aspect:l.cropStartHeight+l.yDiff,l.yCrossOver&&(e=Math.min(Math.abs(e),l.cropStartY)),e=v(e,n,a||c),o.aspect&&(u=v(e*o.aspect,0,d)),{width:u,height:e}}},{key:"dragCrop",value:function(){var e=this.makeNewCrop(),t=this.evData,o=this.mediaDimensions,s=o.width,i=o.height;return e.x=v(t.cropStartX+t.xDiff,0,s-e.width),e.y=v(t.cropStartY+t.yDiff,0,i-e.height),e}},{key:"resizeCrop",value:function(){var e=this.evData,t=this.makeNewCrop(),o=e.ord;e.xInversed&&(e.xDiff-=2*e.cropStartWidth),e.yInversed&&(e.yDiff-=2*e.cropStartHeight);var s=this.getNewSize(),i=e.cropStartX,n=e.cropStartY;e.xCrossOver&&(i=t.x+(t.width-s.width)),e.yCrossOver&&(n=!1===e.lastYCrossover?t.y-s.height:t.y+(t.height-s.height));var l=this.mediaDimensions,r=l.width,d=l.height,c=D(this.props.crop,{unit:t.unit,x:i,y:n,width:s.width,height:s.height,aspect:t.aspect},r,d);return t.aspect||a.xyOrds.indexOf(o)>-1?(t.x=c.x,t.y=c.y,t.width=c.width,t.height=c.height):a.xOrds.indexOf(o)>-1?(t.x=c.x,t.width=c.width):a.yOrds.indexOf(o)>-1&&(t.y=c.y,t.height=c.height),e.lastYCrossover=e.yCrossOver,this.crossOverCheck(),t.width<this.props.minWidth||t.height<this.props.minHeight?this.props.crop:t}},{key:"createCropSelection",value:function(){var e=this.props,o=e.disabled,s=e.locked,i=e.renderSelectionAddon,n=e.ruleOfThirds,a=e.crop,l=this.getCropStyle();return t().createElement("div",{ref:this.bindCropSelectionRef,style:l,className:"ReactCrop__crop-selection",onPointerDown:this.onCropPointerDown},!o&&!s&&t().createElement("div",{className:"ReactCrop__drag-elements"},t().createElement("div",{className:"ReactCrop__drag-bar ord-n","data-ord":"n"}),t().createElement("div",{className:"ReactCrop__drag-bar ord-e","data-ord":"e"}),t().createElement("div",{className:"ReactCrop__drag-bar ord-s","data-ord":"s"}),t().createElement("div",{className:"ReactCrop__drag-bar ord-w","data-ord":"w"}),t().createElement("div",{className:"ReactCrop__drag-handle ord-nw","data-ord":"nw"}),t().createElement("div",{className:"ReactCrop__drag-handle ord-n","data-ord":"n"}),t().createElement("div",{className:"ReactCrop__drag-handle ord-ne","data-ord":"ne"}),t().createElement("div",{className:"ReactCrop__drag-handle ord-e","data-ord":"e"}),t().createElement("div",{className:"ReactCrop__drag-handle ord-se","data-ord":"se"}),t().createElement("div",{className:"ReactCrop__drag-handle ord-s","data-ord":"s"}),t().createElement("div",{className:"ReactCrop__drag-handle ord-sw","data-ord":"sw"}),t().createElement("div",{className:"ReactCrop__drag-handle ord-w","data-ord":"w"})),i&&E(a)&&t().createElement("div",{className:"ReactCrop__selection-addon",onMouseDown:function(e){return e.stopPropagation()}},i(this.state)),n&&t().createElement(t().Fragment,null,t().createElement("div",{className:"ReactCrop__rule-of-thirds-hz"}),t().createElement("div",{className:"ReactCrop__rule-of-thirds-vt"})))}},{key:"makeNewCrop",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"px",t=b(b({},a.defaultCrop),this.props.crop||{}),o=this.mediaDimensions,s=o.width,i=o.height;return"px"===e?T(t,s,i):w(t,s,i)}},{key:"crossOverCheck",value:function(){var e=this.evData,t=this.props,o=t.minWidth,s=t.minHeight;!o&&(!e.xCrossOver&&-Math.abs(e.cropStartWidth)-e.xDiff>=0||e.xCrossOver&&-Math.abs(e.cropStartWidth)-e.xDiff<=0)&&(e.xCrossOver=!e.xCrossOver),!s&&(!e.yCrossOver&&-Math.abs(e.cropStartHeight)-e.yDiff>=0||e.yCrossOver&&-Math.abs(e.cropStartHeight)-e.yDiff<=0)&&(e.yCrossOver=!e.yCrossOver);var i=e.xCrossOver!==e.startXCrossOver,n=e.yCrossOver!==e.startYCrossOver;e.inversedXOrd=!!i&&f(e.ord),e.inversedYOrd=!!n&&f(e.ord)}},{key:"render",value:function(){var e=this.props,o=e.children,s=e.circularCrop,i=e.className,n=e.crossorigin,a=e.crop,r=e.disabled,d=e.locked,c=e.imageAlt,u=e.onImageError,h=e.renderComponent,m=e.src,p=e.style,g=e.imageStyle,b=e.ruleOfThirds,y=this.state,v=y.cropIsActive,f=y.newCropIsBeingDrawn,C=E(a)&&this.componentRef?this.createCropSelection():null,w=function(){for(var e,t,o=0,s="";o<arguments.length;)(e=arguments[o++])&&(t=l(e))&&(s&&(s+=" "),s+=t);return s}("ReactCrop",i,{"ReactCrop--active":v,"ReactCrop--disabled":r,"ReactCrop--locked":d,"ReactCrop--new-crop":f,"ReactCrop--fixed-aspect":a&&a.aspect,"ReactCrop--circular-crop":a&&s,"ReactCrop--rule-of-thirds":a&&b,"ReactCrop--invisible-crop":!this.dragStarted&&a&&!a.width&&!a.height});return t().createElement("div",{ref:this.bindComponentRef,className:w,style:p,onPointerDown:this.onComponentPointerDown,tabIndex:0,onKeyDown:this.onComponentKeyDown,onKeyUp:this.onComponentKeyUp},t().createElement("div",{ref:this.bindMediaWrapperRef},h||t().createElement("img",{ref:this.bindImageRef,crossOrigin:n,className:"ReactCrop__image",style:g,src:m,onLoad:this.onImageLoad,onError:u,alt:c})),o,C)}}])&&c(a.prototype,o),a}(e.PureComponent);I.xOrds=["e","w"],I.yOrds=["n","s"],I.xyOrds=["nw","ne","se","sw"],I.nudgeStep=1,I.nudgeStepMedium=10,I.nudgeStepLarge=100,I.defaultCrop={x:0,y:0,width:0,height:0,unit:"px"},I.propTypes={className:a().string,children:a().oneOfType([a().arrayOf(a().node),a().node]),circularCrop:a().bool,crop:a().shape({aspect:a().number,x:a().number,y:a().number,width:a().number,height:a().number,unit:a().oneOf(["px","%"])}),crossorigin:a().string,disabled:a().bool,locked:a().bool,imageAlt:a().string,imageStyle:a().shape({}),keepSelection:a().bool,minWidth:a().number,minHeight:a().number,maxWidth:a().number,maxHeight:a().number,onChange:a().func.isRequired,onImageError:a().func,onComplete:a().func,onImageLoaded:a().func,onDragStart:a().func,onDragEnd:a().func,src:a().string.isRequired,style:a().shape({}),renderComponent:a().node,renderSelectionAddon:a().func,ruleOfThirds:a().bool},I.defaultProps={circularCrop:!1,className:void 0,crop:void 0,crossorigin:void 0,disabled:!1,locked:!1,imageAlt:"",maxWidth:void 0,maxHeight:void 0,minWidth:0,minHeight:0,keepSelection:!1,onComplete:function(){},onImageError:function(){},onImageLoaded:function(){},onDragStart:function(){},onDragEnd:function(){},children:void 0,style:void 0,renderComponent:void 0,imageStyle:void 0,renderSelectionAddon:void 0,ruleOfThirds:!1}})(),n})())}}]);