"use strict";(self.webpackChunk_postman_app_renderer=self.webpackChunk_postman_app_renderer||[]).push([[90],{"../../packages/api-design/client-codegen/src/components/CodeCBView.js":function(e,t,n){n.r(t),n.d(t,{default:function(){return S}});var a,s=n("../../node_modules/react/index.js"),i=n("../../node_modules/mobx-react/dist/mobx-react.module.js"),o=n("../../node_modules/mobx/lib/mobx.module.js"),r=n("./appsdk/contextbar/ContextBarViewHeader.js"),d=n("./js/modules/services/AnalyticsService.js"),c=n("./js/utils/ClipboardHelper.js"),p=n("./js/stores/EditorStore.js"),l=n("./js/stores/StoreManager.js"),g=n("../../packages/api-design/client-codegen/src/stores/CodegenStore.js"),h=n("../../packages/api-design/client-codegen/src/services/CodegenService.js"),u=n("../../packages/api-design/client-codegen/src/components/CodeSnippetEditor.js"),E=n("../../packages/api-design/client-codegen/src/components/CodeControls.js"),m=n("../../packages/api-design/api-design-analytics/index.js"),C=n("../../node_modules/lodash/lodash.js");let S=(0,i.observer)(a=class extends s.Component{constructor(e){super(e),this.state={activeLanguage:{language:"curl",variant:"cURL"},optionsArray:[],optionsPreference:{},codeSnippet:"",originalSnippetHash:"",codeCopied:!1,selectedLanguage:{}},this.handleCodeTypeSelect=this.handleCodeTypeSelect.bind(this),this.handleSnippetChange=this.handleSnippetChange.bind(this),this.handleCopyCode=this.handleCopyCode.bind(this),this.store=(0,l.resolveStoreInstance)(g.default),this.throttledGenerateSnippet=C.throttle(this.handleCodeTypeSelect.bind(this),500,{leading:!0,trailing:!0})}componentDidMount(){var e={id:this.store.languagePreference},{language:t,variant:n}=C.isObject(e.id)?e:JSON.parse(e.id);this.disposePreviewReaction=(0,o.reaction)((()=>{let e=(0,l.resolveStoreInstance)(p.default).find(this.props.contextData.editorId),t=e&&e.model;return t&&t.viewState&&(0,o.toJS)(t.viewState.previewRequest)}),(()=>{this.throttledGenerateSnippet(this.state.selectedLanguage)})),this.handleCodeTypeSelect(e),d.default.addEventV2({category:"codegen",action:"open_codegen_contextbar",label:`${t}_${n}`}),d.default.addEventV2({category:"api-design",action:"interact",label:"read",value:1,entityType:"collection",entityId:C.get(this.props,"contextData.parentCollectionId")}),(0,m.logApiDesignAnalytics)({category:m.EVENT_CATEGORIES.CODEGEN,action:m.EVENT_ACTIONS.OPEN_CODEGEN_CONTEXT_BAR_CLIENT,label:this.state.activeLanguage?`${this.state.activeLanguage.language} - ${this.state.activeLanguage.variant}`:void 0,entityType:"example"===C.get(this.props,"contextData.type")?m.EVENT_ENTITY_TYPES.EXAMPLE:m.EVENT_ENTITY_TYPES.REQUEST,entityId:C.get(this.props,"contextData.id")})}componentWillUnmount(){this.disposePreviewReaction&&this.disposePreviewReaction()}componentDidUpdate(e){const{id:t}=e.contextData||{};t!==C.get(this.props.contextData,"id")&&this.handleCodeTypeSelect(this.state.selectedLanguage)}hash(e){return n("../../node_modules/crypto-browserify/index.js").createHash("sha1").update(e).digest("base64")}handleCodeTypeSelect(e){C.isEmpty(e)||this.setState({selectedLanguage:e});let t,n=C.isEmpty(e)?this.store.languagePreference:JSON.parse(e.id),{language:a,variant:s}=n,i={};this.setState({activeLanguage:{language:a,variant:s}}),(0,m.logApiDesignAnalytics)({category:m.EVENT_CATEGORIES.CODEGEN,action:m.EVENT_ACTIONS.SELECT_LANGUAGE_CLIENT,label:`${a} - ${s}`,entityType:"example"===C.get(this.props,"contextData.type")?m.EVENT_ENTITY_TYPES.EXAMPLE:m.EVENT_ENTITY_TYPES.REQUEST,entityId:C.get(this.props,"contextData.id")}),h.default.getOptions(a,s).then((e=>{e&&e.length&&(this.setState({optionsArray:e}),e.forEach((e=>{i[e.id]=e.default})))})).catch((e=>{this.setState({optionsArray:[]}),pm.logger.error(`CodeCBView~handleCodeTypeSelect - ${e}`)})).then((()=>{t=this.store.getSnippetOptionForLanguage(a,s)||i,this.setState({optionsPreference:t})})).then((()=>{let e=this.props.contextData&&this.props.contextData.type;h.default.getSnippet(this.props.contextData.editorId,{language:a,variant:s,optionsPreference:t},e).then((e=>{if(!e)return;let t=this.hash(e.snippet);t!==this.state.originalSnippetHash&&((0,m.logApiDesignAnalytics)({category:m.EVENT_CATEGORIES.CODEGEN,action:m.EVENT_ACTIONS.CONFIGURE_CLIENT,label:`${a} - ${s}`,entityType:"example"===C.get(this.props,"contextData.type")?m.EVENT_ENTITY_TYPES.EXAMPLE:m.EVENT_ENTITY_TYPES.REQUEST,entityId:C.get(this.props,"contextData.id")}),this.setState({codeSnippet:e.snippet,originalSnippetHash:t},(()=>{let e=JSON.stringify({language:a,variant:s});this.store.updateLanguagePreference(e)})))}))}))}handleSnippetChange(e){this.setState({codeSnippet:e})}handleCopyCode(){var e,t,n;c.default.copy(this.state.codeSnippet),this.setState({codeCopied:!0}),(0,m.logApiDesignAnalytics)({category:m.EVENT_CATEGORIES.CODEGEN,action:m.EVENT_ACTIONS.COPY_CODE_CLIENT,label:null!==(e=this.state)&&void 0!==e&&e.activeLanguage?`${null===(t=this.state.activeLanguage)||void 0===t?void 0:t.language} - ${null===(n=this.state.activeLanguage)||void 0===n?void 0:n.variant}`:void 0,entityType:"example"===C.get(this.props,"contextData.type")?m.EVENT_ENTITY_TYPES.EXAMPLE:m.EVENT_ENTITY_TYPES.REQUEST,entityId:C.get(this.props,"contextData.id")}),clearTimeout(this.timeout),this.timeout=setTimeout((()=>{this.setState({codeCopied:!1})}),1500)}render(){let e,t=C.get(this.state.activeLanguage,"language","curl"),{controller:n={}}=this.props||{},a=C.get(this.state.activeLanguage,"variant","cURL"),i=n.labelEditorMap&&n.labelEditorMap[`${t}_${a}`]?n.labelEditorMap[`${t}_${a}`].editorMode:"powershell",o={indentationType:this.state.optionsPreference.indentType?C.toLower(this.state.optionsPreference.indentType):null,indentationSize:this.state.optionsPreference.indentCount||null},d=this.store.getSnippetOptions();return n.editor&&(e=n.editor.isDirty),"dart"===i&&(i="powershell"),s.createElement("div",{className:"context-bar-code-snippet-view"},s.createElement(r.ContextBarViewHeader,{title:"Code snippet",onClose:this.props.onClose}),s.createElement("div",{className:"context-bar-code-snippet-body"},s.createElement(E.default,{codeCopied:this.state.codeCopied,languageList:n.languageList,onSelectLanguage:this.handleCodeTypeSelect,selectedLanguage:this.state.selectedLanguage,handleCopyCode:this.handleCopyCode,snippetOptions:d,isDirty:e}),s.createElement(u.default,{indentation:o,codeSnippet:this.state.codeSnippet,editorMode:i,handleSnippetChange:this.handleSnippetChange})))}})||a},"../../packages/api-design/client-codegen/src/components/CodeControls.js":function(e,t,n){n.r(t);var a=n("../../node_modules/react/index.js"),s=n("../../node_modules/@postman/aether-icons/esmLib/src/Icon/Icon.js"),i=n("./js/components/base/Buttons.js"),o=n("./js/modules/controllers/ViewHierarchyController.js"),r=n("../../packages/api-design/client-codegen/src/components/ContextBarCodegenDropdown.js"),d=n("../../node_modules/lodash/lodash.js");class c extends a.Component{constructor(e){super(e),this.openLanguageSettingsModal=()=>{o.ModalViewManager.onMount((()=>{pm.mediator.trigger("openLanguageSettingsModel",this.props.selectedLanguage)}))},this.openLanguageSettingsModal=this.openLanguageSettingsModal.bind(this)}componentDidUpdate(e){let t=this.props.snippetOptions,n=e.snippetOptions,a=JSON.parse(this.props.selectedLanguage.id),s=d.get(a,"language","curl"),i=d.get(a,"variant","cURL");(JSON.stringify(n[`${s}_${i}`])!==JSON.stringify(t[`${s}_${i}`])||!this.props.isDirty&&e.isDirty)&&this.props.onSelectLanguage(this.props.selectedLanguage)}render(){return a.createElement("div",{className:"context-bar-codegen-controls"},a.createElement("div",{className:"context-bar-codegen-controls-left"},a.createElement("div",{className:"context-bar-codegen-controls-left__dropdown"},a.createElement(r.default,{selectedTarget:this.props.selectedLanguage,onTargetSelect:this.props.onSelectLanguage,menuClassName:"context-bar-codegen-dropdown",filterItems:this.props.languageList})),a.createElement("div",{className:"context-bar-codegen-controls-left__setting"},a.createElement(i.Button,{type:"tertiary",onClick:this.openLanguageSettingsModal},a.createElement(s.default,{name:"icon-descriptive-setting-stroke",className:"language-settings-icon",tooltip:"Code settings"})))),a.createElement("div",{className:"context-bar-codegen-controls-right"},a.createElement("div",{className:"context-bar-codegen-controls-right__copy"},this.props.codeCopied?a.createElement(i.Button,{onClick:this.props.handleCopyCode,tooltip:"Copied"},a.createElement(s.default,{name:"icon-state-success-stroke",className:"code-copied-icon"})):a.createElement(i.Button,{type:"tertiary",onClick:this.props.handleCopyCode,tooltip:"Copy snippet"},a.createElement(s.default,{name:"icon-action-copy-stroke",className:"code-copy-icon"})))))}}t.default=c},"../../packages/api-design/client-codegen/src/components/CodeSnippetEditor.js":function(e,t,n){n.r(t);var a=n("../../node_modules/react/index.js"),s=n("../../packages/client-foundation/text-editor/index.js");class i extends a.Component{constructor(e){super(e)}render(){return a.createElement("div",{className:"context-bar-code-snippet-editor"},a.createElement(s.TextEditor,{ref:e=>e&&e.focus(),indentation:this.props.indentation,value:this.props.codeSnippet,language:this.props.editorMode,onChange:this.props.handleSnippetChange,wordWrap:!0,ref:"editor"}))}}t.default=i},"../../packages/api-design/client-codegen/src/components/ContextBarCodegenDropdown.js":function(e,t,n){n.r(t),n.d(t,{default:function(){return d}});var a=n("../../node_modules/react/index.js"),s=n("./js/components/base/InputSelectV2.js"),i=n("./js/components/base/XPaths/XPath.js"),o=n("./js/components/base/SearchHighlighter.js"),r=n("../../node_modules/lodash/lodash.js");class d extends a.Component{constructor(e){super(e),this.selectedTarget=this.selectedTarget.bind(this)}getFilteredList(e,t,n={}){return!t||n.firstRender?e:r.filter(e,(e=>e.id&&r.includes(e.name.toLowerCase(),t.toLowerCase())))}selectedTarget(){var e=this.props.filterItems,t=this.props.selectedTarget,n=r.find(e,(e=>e.id===t.id));return n||{id:'{language:"curl",variant:"cURL"}',name:"cURL"}}getOption(e,t,n={}){const s=e.name,r=e.id;return t&&!n.firstRender?a.createElement(i.default,null,a.createElement("div",{className:"input-select-item",key:r},a.createElement(o.default,{source:s,query:t}))):a.createElement(i.default,null,a.createElement("div",{className:"input-select-item",key:r},s))}render(){var{filterItems:e}=this.props;return a.createElement("div",{className:"context-bar-dropdown-wrapper"},a.createElement("div",null,a.createElement(s.InputSelectV2,{style:{height:"32px"},onSelect:this.props.onTargetSelect,getFilteredList:this.getFilteredList.bind(this,e),optionRenderer:this.getOption,selectedItem:this.selectedTarget(),ref:"inputSelect",menuClassName:this.props.menuClassName,getInputValue:e=>e.name||""})))}}}}]);